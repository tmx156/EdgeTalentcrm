/*! For license information please see main.1cbec244.js.LICENSE.txt */
(()=>{var e={14:e=>{e.exports=function(){return!1}},61:e=>{e.exports=function(e,t){return e<t}},143:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},149:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,a=Array(r);++n<r;)a[n]=t(e[n],n,e);return a}},320:e=>{e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},396:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},438:(e,t,n)=>{var r=n(2622);e.exports=function(e){return r(this,e).get(e)}},539:(e,t,n)=>{var r=n(9742),a=n(7498),s=n(3279);e.exports=function(e){return e&&e.length?r(e,s,a):void 0}},579:(e,t,n)=>{"use strict";e.exports=n(1153)},620:(e,t,n)=>{var r=n(6913),a=n(4052),s=n(2761);e.exports=function(e){return"string"==typeof e||!a(e)&&s(e)&&"[object String]"==r(e)}},643:(e,t,n)=>{var r=n(7676)("toUpperCase");e.exports=r},644:e=>{e.exports=function(e){return e!==e}},705:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},715:e=>{var t="\\ud800-\\udfff",n="["+t+"]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",a="\\ud83c[\\udffb-\\udfff]",s="[^"+t+"]",o="(?:\\ud83c[\\udde6-\\uddff]){2}",i="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+r+"|"+a+")"+"?",c="[\\ufe0e\\ufe0f]?",d=c+l+("(?:\\u200d(?:"+[s,o,i].join("|")+")"+c+l+")*"),u="(?:"+[s+r+"?",r,o,i,n].join("|")+")",m=RegExp(a+"(?="+a+")|"+u+d,"g");e.exports=function(e){return e.match(m)||[]}},755:(e,t,n)=>{var r=n(8895),a=n(7116);e.exports=function e(t,n,s,o,i){var l=-1,c=t.length;for(s||(s=a),i||(i=[]);++l<c;){var d=t[l];n>0&&s(d)?n>1?e(d,n-1,s,o,i):r(i,d):o||(i[i.length]=d)}return i}},793:e=>{e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},801:(e,t,n)=>{var r=n(1141),a=n(6686),s=n(9841),o=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(s(e))return NaN;if(a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=i.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):o.test(e)?NaN:+e}},914:(e,t,n)=>{var r=n(9841);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},929:(e,t,n)=>{var r=n(3211),a=n(6571),s=n(9194),o=n(6686);e.exports=function(e,t,n){if(!o(n))return!1;var i=typeof t;return!!("number"==i?a(n)&&s(t,n.length):"string"==i&&t in n)&&r(n[t],e)}},977:(e,t,n)=>{var r=n(9096),a=n(4416);e.exports=function(e,t){return e&&e.length?a(e,r(t,2)):[]}},1069:(e,t,n)=>{var r=n(8541);e.exports=function(e){return null==e?"":r(e)}},1141:(e,t,n)=>{var r=n(143),a=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(a,""):e}},1143:(e,t,n)=>{var r=n(3028)(Object.keys,Object);e.exports=r},1153:(e,t,n)=>{"use strict";var r=n(5043),a=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,d=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:d,props:s,_owner:i.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},1170:e=>{e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},1268:(e,t,n)=>{var r=n(5428),a=n(7574),s=n(6832),o=s&&s.isTypedArray,i=o?a(o):r;e.exports=i},1310:e=>{e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},1340:(e,t,n)=>{var r=n(3211);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},1497:(e,t,n)=>{"use strict";var r=n(3218);function a(){}function s(){}s.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,s,o){if(o!==r){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:a};return n.PropTypes=n,n}},1558:e=>{e.exports=function(e,t,n){for(var r=-1,a=null==e?0:e.length;++r<a;)if(n(t,e[r]))return!0;return!1}},1629:(e,t,n)=>{var r=n(6913),a=n(6686);e.exports=function(e){if(!a(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},1714:(e,t,n)=>{var r=n(1340);e.exports=function(e,t){var n=this.__data__,a=r(n,e);return a<0?(++this.size,n.push([e,t])):n[a][1]=t,this}},1733:(e,t,n)=>{var r=n(1775),a=n(4664),s=n(9096);e.exports=function(e,t){var n={};return t=s(t,3),a(e,function(e,a,s){r(n,a,t(e,a,s))}),n}},1775:(e,t,n)=>{var r=n(5654);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},1946:(e,t,n)=>{var r=n(1340);e.exports=function(e){return r(this.__data__,e)>-1}},2070:(e,t,n)=>{var r=n(7937)(n(6552),"Set");e.exports=r},2074:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},2154:(e,t,n)=>{var r=n(5575),a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return a.call(t,e)?t[e]:void 0}},2165:(e,t,n)=>{var r=n(5652);e.exports=function(e,t){var n;return r(e,function(e,r,a){return!(n=t(e,r,a))}),!!n}},2322:(e,t,n)=>{var r=n(6913),a=n(5990),s=n(2761),o=Function.prototype,i=Object.prototype,l=o.toString,c=i.hasOwnProperty,d=l.call(Object);e.exports=function(e){if(!s(e)||"[object Object]"!=r(e))return!1;var t=a(e);if(null===t)return!0;var n=c.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==d}},2520:(e,t,n)=>{var r=n(5816),a=n(9096),s=n(9140),o=Math.max;e.exports=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var l=null==n?0:s(n);return l<0&&(l=o(i+l,0)),r(e,a(t,3),l)}},2536:(e,t,n)=>{var r=n(149),a=n(2969),s=n(9096),o=n(8883),i=n(320),l=n(7574),c=n(5893),d=n(3279),u=n(4052);e.exports=function(e,t,n){t=t.length?r(t,function(e){return u(e)?function(t){return a(t,1===e.length?e[0]:e)}:e}):[d];var m=-1;t=r(t,l(s));var h=o(e,function(e,n,a){return{criteria:r(t,function(t){return t(e)}),index:++m,value:e}});return i(h,function(e,t){return c(e,t,n)})}},2541:e=>{e.exports=function(e){return function(){return e}}},2587:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},2597:(e,t,n)=>{var r=n(4052),a=n(9841),s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!a(e))||(o.test(e)||!s.test(e)||null!=t&&e in Object(t))}},2622:(e,t,n)=>{var r=n(705);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},2662:(e,t,n)=>{var r=n(5575);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},2730:(e,t,n)=>{"use strict";var r=n(5043),a=n(8853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,i={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(i[e]=t,e=0;e<t.length;e++)o.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function f(e,t,n,r,a,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new f(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new f(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new f(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new f(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new f(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!u.call(p,e)||!u.call(h,e)&&(m.test(e)?p[e]=!0:(h[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(x,y);g[t]=new f(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(x,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(x,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)});var v=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),j=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),_=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),T=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function I(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var L,R=Object.assign;function F(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var B=!1;function U(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),s=r.stack.split("\n"),o=a.length-1,i=s.length-1;1<=o&&0<=i&&a[o]!==s[i];)i--;for(;1<=o&&0<=i;o--,i--)if(a[o]!==s[i]){if(1!==o||1!==i)do{if(o--,0>--i||a[o]!==s[i]){var l="\n"+a[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=i);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function z(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case j:return"Portal";case S:return"Profiler";case k:return"StrictMode";case P:return"Suspense";case O:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case T:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Y(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return R({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Q(e,t){J(e,t);var n=q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return R({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function se(e,t){var n=q(t.value),r=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ie(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function me(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=fe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(he).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]})});var xe=R({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(xe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ve=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var je=null,Ne=null,ke=null;function Se(e){if(e=ba(e)){if("function"!==typeof je)throw Error(s(280));var t=e.stateNode;t&&(t=wa(t),je(e.stateNode,e.type,t))}}function Ce(e){Ne?ke?ke.push(e):ke=[e]:Ne=e}function _e(){if(Ne){var e=Ne,t=ke;if(ke=Ne=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ee(e,t){return e(t)}function Pe(){}var Oe=!1;function Ae(e,t,n){if(Oe)return e(t,n);Oe=!0;try{return Ee(e,t,n)}finally{Oe=!1,(null!==Ne||null!==ke)&&(Pe(),_e())}}function Te(e,t){var n=e.stateNode;if(null===n)return null;var r=wa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var De=!1;if(d)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){De=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(de){De=!1}function Ie(e,t,n,r,a,s,o,i,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Le=!1,Re=null,Fe=!1,Be=null,Ue={onError:function(e){Le=!0,Re=e}};function ze(e,t,n,r,a,s,o,i,l){Le=!1,Re=null,Ie.apply(Ue,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Ve(e)!==e)throw Error(s(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return qe(a),e;if(o===r)return qe(a),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=a,r=o;else{for(var i=!1,l=a.child;l;){if(l===n){i=!0,n=a,r=o;break}if(l===r){i=!0,r=a,n=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===n){i=!0,n=o,r=a;break}if(l===r){i=!0,r=o,n=a;break}l=l.sibling}if(!i)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Ye(e):null}function Ye(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ye(e);if(null!==t)return t;e=e.sibling}return null}var Ge=a.unstable_scheduleCallback,Xe=a.unstable_cancelCallback,$e=a.unstable_shouldYield,Ke=a.unstable_requestPaint,Je=a.unstable_now,Qe=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(it(e)/lt|0)|0},it=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function mt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var i=o&~a;0!==i?r=ut(i):0!==(s&=o)&&(r=ut(s))}else 0!==(o=n&~a)?r=ut(o):0!==s&&(r=ut(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(s=t&-t)||16===a&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function xt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function vt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,jt,Nt,kt,St,Ct=!1,_t=[],Et=null,Pt=null,Ot=null,At=new Map,Tt=new Map,Dt=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function It(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":Ot=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tt.delete(t.pointerId)}}function Lt(e,t,n,r,a,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&jt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Rt(e){var t=ya(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void St(e.priority,function(){Nt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&jt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);ve=r,n.target.dispatchEvent(r),ve=null,t.shift()}return!0}function Bt(e,t,n){Ft(e)&&n.delete(t)}function Ut(){Ct=!1,null!==Et&&Ft(Et)&&(Et=null),null!==Pt&&Ft(Pt)&&(Pt=null),null!==Ot&&Ft(Ot)&&(Ot=null),At.forEach(Bt),Tt.forEach(Bt)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ut)))}function Vt(e){function t(t){return zt(t,e)}if(0<_t.length){zt(_t[0],e);for(var n=1;n<_t.length;n++){var r=_t[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&zt(Et,e),null!==Pt&&zt(Pt,e),null!==Ot&&zt(Ot,e),At.forEach(t),Tt.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Rt(n),null===n.blockedOn&&Dt.shift()}var Wt=v.ReactCurrentBatchConfig,qt=!0;function Ht(e,t,n,r){var a=bt,s=Wt.transition;Wt.transition=null;try{bt=1,Gt(e,t,n,r)}finally{bt=a,Wt.transition=s}}function Yt(e,t,n,r){var a=bt,s=Wt.transition;Wt.transition=null;try{bt=4,Gt(e,t,n,r)}finally{bt=a,Wt.transition=s}}function Gt(e,t,n,r){if(qt){var a=$t(e,t,n,r);if(null===a)qr(e,t,r,Xt,n),It(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Et=Lt(Et,e,t,n,r,a),!0;case"dragenter":return Pt=Lt(Pt,e,t,n,r,a),!0;case"mouseover":return Ot=Lt(Ot,e,t,n,r,a),!0;case"pointerover":var s=a.pointerId;return At.set(s,Lt(At.get(s)||null,e,t,n,r,a)),!0;case"gotpointercapture":return s=a.pointerId,Tt.set(s,Lt(Tt.get(s)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(It(e,r),4&t&&-1<Mt.indexOf(e)){for(;null!==a;){var s=ba(a);if(null!==s&&wt(s),null===(s=$t(e,t,n,r))&&qr(e,t,r,Xt,n),s===a)break;a=s}null!==a&&r.stopPropagation()}else qr(e,t,r,null,n)}}var Xt=null;function $t(e,t,n,r){if(Xt=null,null!==(e=ya(e=we(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Qt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Qt,r=n.length,a="value"in Jt?Jt.value:Jt.textContent,s=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[s-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return R(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=an(cn),un=R({},cn,{view:0,detail:0}),mn=an(un),hn=R({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=an(hn),fn=an(R({},hn,{dataTransfer:0})),gn=an(R({},un,{relatedTarget:0})),xn=an(R({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=R({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),vn=an(R({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Nn[e])&&!!t[e]}function Sn(){return kn}var Cn=R({},un,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?jn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),_n=an(Cn),En=an(R({},hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=an(R({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),On=an(R({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=R({},hn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Tn=an(An),Dn=[9,13,27,32],Mn=d&&"CompositionEvent"in window,In=null;d&&"documentMode"in document&&(In=document.documentMode);var Ln=d&&"TextEvent"in window&&!In,Rn=d&&(!Mn||In&&8<In&&11>=In),Fn=String.fromCharCode(32),Bn=!1;function Un(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function Hn(e,t,n,r){Ce(r),0<(t=Yr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Yn=null,Gn=null;function Xn(e){Fr(e,0)}function $n(e){if(G(va(e)))return e}function Kn(e,t){if("change"===e)return t}var Jn=!1;if(d){var Qn;if(d){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Qn=Zn}else Qn=!1;Jn=Qn&&(!document.documentMode||9<document.documentMode)}function tr(){Yn&&(Yn.detachEvent("onpropertychange",nr),Gn=Yn=null)}function nr(e){if("value"===e.propertyName&&$n(Gn)){var t=[];Hn(t,Gn,e,we(e)),Ae(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Gn=n,(Yn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $n(Gn)}function sr(e,t){if("click"===e)return $n(t)}function or(e,t){if("input"===e||"change"===e)return $n(t)}var ir="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(ir(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!u.call(t,a)||!ir(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function ur(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ur(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function mr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=mr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ur(n.ownerDocument.documentElement,n)){if(null!==r&&hr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,s=Math.min(r.start,a);r=void 0===r.end?s:Math.min(r.end,a),!e.extend&&s>r&&(a=r,r=s,s=a),a=dr(n,s);var o=dr(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fr=d&&"documentMode"in document&&11>=document.documentMode,gr=null,xr=null,yr=null,br=!1;function vr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==X(r)||("selectionStart"in(r=gr)&&hr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Yr(xr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var jr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Nr={},kr={};function Sr(e){if(Nr[e])return Nr[e];if(!jr[e])return e;var t,n=jr[e];for(t in n)if(n.hasOwnProperty(t)&&t in kr)return Nr[e]=n[t];return e}d&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete jr.animationend.animation,delete jr.animationiteration.animation,delete jr.animationstart.animation),"TransitionEvent"in window||delete jr.transitionend.transition);var Cr=Sr("animationend"),_r=Sr("animationiteration"),Er=Sr("animationstart"),Pr=Sr("transitionend"),Or=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tr(e,t){Or.set(e,t),l(t,[e])}for(var Dr=0;Dr<Ar.length;Dr++){var Mr=Ar[Dr];Tr(Mr.toLowerCase(),"on"+(Mr[0].toUpperCase()+Mr.slice(1)))}Tr(Cr,"onAnimationEnd"),Tr(_r,"onAnimationIteration"),Tr(Er,"onAnimationStart"),Tr("dblclick","onDoubleClick"),Tr("focusin","onFocus"),Tr("focusout","onBlur"),Tr(Pr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ir="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ir));function Rr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,i,l,c){if(ze.apply(this,arguments),Le){if(!Le)throw Error(s(198));var d=Re;Le=!1,Re=null,Fe||(Fe=!0,Be=d)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var i=r[o],l=i.instance,c=i.currentTarget;if(i=i.listener,l!==s&&a.isPropagationStopped())break e;Rr(a,i,c),s=l}else for(o=0;o<r.length;o++){if(l=(i=r[o]).instance,c=i.currentTarget,i=i.listener,l!==s&&a.isPropagationStopped())break e;Rr(a,i,c),s=l}}}if(Fe)throw e=Be,Fe=!1,Be=null,e}function Br(e,t){var n=t[fa];void 0===n&&(n=t[fa]=new Set);var r=e+"__bubble";n.has(r)||(Wr(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),Wr(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[zr]){e[zr]=!0,o.forEach(function(t){"selectionchange"!==t&&(Lr.has(t)||Ur(t,!1,e),Ur(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Ur("selectionchange",!1,t))}}function Wr(e,t,n,r){switch(Kt(t)){case 1:var a=Ht;break;case 4:a=Yt;break;default:a=Gt}n=a.bind(null,t,n,e),a=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function qr(e,t,n,r,a){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var i=r.stateNode.containerInfo;if(i===a||8===i.nodeType&&i.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;o=o.return}for(;null!==i;){if(null===(o=ya(i)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}i=i.parentNode}}r=r.return}Ae(function(){var r=s,a=we(n),o=[];e:{var i=Or.get(e);if(void 0!==i){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=_n;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Pn;break;case Cr:case _r:case Er:l=xn;break;case Pr:l=On;break;case"scroll":l=mn;break;case"wheel":l=Tn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=En}var d=0!==(4&t),u=!d&&"scroll"===e,m=d?null!==i?i+"Capture":null:i;d=[];for(var h,p=r;null!==p;){var f=(h=p).stateNode;if(5===h.tag&&null!==f&&(h=f,null!==m&&(null!=(f=Te(p,m))&&d.push(Hr(p,f,h)))),u)break;p=p.return}0<d.length&&(i=new l(i,c,null,n,a),o.push({event:i,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(i="mouseover"===e||"pointerover"===e)||n===ve||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[pa])&&(l||i)&&(i=a.window===a?a:(i=a.ownerDocument)?i.defaultView||i.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(u=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(d=pn,f="onMouseLeave",m="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(d=En,f="onPointerLeave",m="onPointerEnter",p="pointer"),u=null==l?i:va(l),h=null==c?i:va(c),(i=new d(f,p+"leave",l,n,a)).target=u,i.relatedTarget=h,f=null,ya(a)===r&&((d=new d(m,p+"enter",c,n,a)).target=h,d.relatedTarget=u,f=d),u=f,l&&c)e:{for(m=c,p=0,h=d=l;h;h=Gr(h))p++;for(h=0,f=m;f;f=Gr(f))h++;for(;0<p-h;)d=Gr(d),p--;for(;0<h-p;)m=Gr(m),h--;for(;p--;){if(d===m||null!==m&&d===m.alternate)break e;d=Gr(d),m=Gr(m)}d=null}else d=null;null!==l&&Xr(o,i,l,d,!1),null!==c&&null!==u&&Xr(o,u,c,d,!0)}if("select"===(l=(i=r?va(r):window).nodeName&&i.nodeName.toLowerCase())||"input"===l&&"file"===i.type)var g=Kn;else if(qn(i))if(Jn)g=or;else{g=ar;var x=rr}else(l=i.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(g=sr);switch(g&&(g=g(e,r))?Hn(o,g,n,a):(x&&x(e,i,r),"focusout"===e&&(x=i._wrapperState)&&x.controlled&&"number"===i.type&&ee(i,"number",i.value)),x=r?va(r):window,e){case"focusin":(qn(x)||"true"===x.contentEditable)&&(gr=x,xr=r,yr=null);break;case"focusout":yr=xr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,vr(o,n,a);break;case"selectionchange":if(fr)break;case"keydown":case"keyup":vr(o,n,a)}var y;if(Mn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Vn?Un(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Rn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vn&&(y=en()):(Qt="value"in(Jt=a)?Jt.value:Jt.textContent,Vn=!0)),0<(x=Yr(r,b)).length&&(b=new vn(b,e,null,n,a),o.push({event:b,listeners:x}),y?b.data=y:null!==(y=zn(n))&&(b.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Bn=!0,Fn);case"textInput":return(e=t.data)===Fn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Mn&&Un(e,t)?(e=en(),Zt=Qt=Jt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Rn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Yr(r,"onBeforeInput")).length&&(a=new vn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=y))}Fr(o,t)})}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Yr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,s=a.stateNode;5===a.tag&&null!==s&&(a=s,null!=(s=Te(e,n))&&r.unshift(Hr(e,s,a)),null!=(s=Te(e,t))&&r.push(Hr(e,s,a))),e=e.return}return r}function Gr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,a){for(var s=t._reactName,o=[];null!==n&&n!==r;){var i=n,l=i.alternate,c=i.stateNode;if(null!==l&&l===r)break;5===i.tag&&null!==c&&(i=c,a?null!=(l=Te(n,s))&&o.unshift(Hr(n,l,i)):a||null!=(l=Te(n,s))&&o.push(Hr(n,l,i))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var $r=/\r\n?/g,Kr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace($r,"\n").replace(Kr,"")}function Qr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(s(425))}function Zr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,sa="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sa?function(e){return sa.resolve(null).then(e).catch(ia)}:ra;function ia(e){setTimeout(function(){throw e})}function la(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Vt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function da(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ua=Math.random().toString(36).slice(2),ma="__reactFiber$"+ua,ha="__reactProps$"+ua,pa="__reactContainer$"+ua,fa="__reactEvents$"+ua,ga="__reactListeners$"+ua,xa="__reactHandles$"+ua;function ya(e){var t=e[ma];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pa]||n[ma]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=da(e);null!==e;){if(n=e[ma])return n;e=da(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[ma]||e[pa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function va(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function wa(e){return e[ha]||null}var ja=[],Na=-1;function ka(e){return{current:e}}function Sa(e){0>Na||(e.current=ja[Na],ja[Na]=null,Na--)}function Ca(e,t){Na++,ja[Na]=e.current,e.current=t}var _a={},Ea=ka(_a),Pa=ka(!1),Oa=_a;function Aa(e,t){var n=e.type.contextTypes;if(!n)return _a;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,s={};for(a in n)s[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ta(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Da(){Sa(Pa),Sa(Ea)}function Ma(e,t,n){if(Ea.current!==_a)throw Error(s(168));Ca(Ea,t),Ca(Pa,n)}function Ia(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(s(108,W(e)||"Unknown",a));return R({},n,r)}function La(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_a,Oa=Ea.current,Ca(Ea,e),Ca(Pa,Pa.current),!0}function Ra(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Ia(e,t,Oa),r.__reactInternalMemoizedMergedChildContext=e,Sa(Pa),Sa(Ea),Ca(Ea,e)):Sa(Pa),Ca(Pa,n)}var Fa=null,Ba=!1,Ua=!1;function za(e){null===Fa?Fa=[e]:Fa.push(e)}function Va(){if(!Ua&&null!==Fa){Ua=!0;var e=0,t=bt;try{var n=Fa;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fa=null,Ba=!1}catch(a){throw null!==Fa&&(Fa=Fa.slice(e+1)),Ge(Ze,Va),a}finally{bt=t,Ua=!1}}return null}var Wa=[],qa=0,Ha=null,Ya=0,Ga=[],Xa=0,$a=null,Ka=1,Ja="";function Qa(e,t){Wa[qa++]=Ya,Wa[qa++]=Ha,Ha=e,Ya=t}function Za(e,t,n){Ga[Xa++]=Ka,Ga[Xa++]=Ja,Ga[Xa++]=$a,$a=e;var r=Ka;e=Ja;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var s=32-ot(t)+a;if(30<s){var o=a-a%5;s=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Ka=1<<32-ot(t)+a|n<<a|r,Ja=s+e}else Ka=1<<s|n<<a|r,Ja=e}function es(e){null!==e.return&&(Qa(e,1),Za(e,1,0))}function ts(e){for(;e===Ha;)Ha=Wa[--qa],Wa[qa]=null,Ya=Wa[--qa],Wa[qa]=null;for(;e===$a;)$a=Ga[--Xa],Ga[Xa]=null,Ja=Ga[--Xa],Ga[Xa]=null,Ka=Ga[--Xa],Ga[Xa]=null}var ns=null,rs=null,as=!1,ss=null;function os(e,t){var n=Ac(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function is(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==$a?{id:Ka,overflow:Ja}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ac(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(as){var t=rs;if(t){var n=t;if(!is(e,t)){if(ls(e))throw Error(s(418));t=ca(n.nextSibling);var r=ns;t&&is(e,t)?os(r,n):(e.flags=-4097&e.flags|2,as=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,as=!1,ns=e}}}function ds(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function us(e){if(e!==ns)return!1;if(!as)return ds(e),as=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw ms(),Error(s(418));for(;t;)os(e,t),t=ca(t.nextSibling)}if(ds(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ca(e.stateNode.nextSibling):null;return!0}function ms(){for(var e=rs;e;)e=ca(e.nextSibling)}function hs(){rs=ns=null,as=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var fs=v.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function xs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ys(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function i(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Rc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===N?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===T&&ys(s)===t.type)?((r=a(t,n.props)).ref=gs(e,t,n),r.return=e,r):((r=Mc(n.type,n.key,n.props,null,e.mode,r)).ref=gs(e,t,n),r.return=e,r)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function u(e,t,n,r,s){return null===t||7!==t.tag?((t=Ic(n,e.mode,r,s)).return=e,t):((t=a(t,n)).return=e,t)}function m(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Rc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Mc(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case j:return(t=Fc(t,e.mode,n)).return=e,t;case T:return m(e,(0,t._init)(t._payload),n)}if(te(t)||I(t))return(t=Ic(t,e.mode,n,null)).return=e,t;xs(e,t)}return null}function h(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===a?c(e,t,n,r):null;case j:return n.key===a?d(e,t,n,r):null;case T:return h(e,t,(a=n._init)(n._payload),r)}if(te(n)||I(n))return null!==a?null:u(e,t,n,r,null);xs(e,n)}return null}function p(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case j:return d(t,e=e.get(null===r.key?n:r.key)||null,r,a);case T:return p(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||I(r))return u(t,e=e.get(n)||null,r,a,null);xs(t,r)}return null}function f(a,s,i,l){for(var c=null,d=null,u=s,f=s=0,g=null;null!==u&&f<i.length;f++){u.index>f?(g=u,u=null):g=u.sibling;var x=h(a,u,i[f],l);if(null===x){null===u&&(u=g);break}e&&u&&null===x.alternate&&t(a,u),s=o(x,s,f),null===d?c=x:d.sibling=x,d=x,u=g}if(f===i.length)return n(a,u),as&&Qa(a,f),c;if(null===u){for(;f<i.length;f++)null!==(u=m(a,i[f],l))&&(s=o(u,s,f),null===d?c=u:d.sibling=u,d=u);return as&&Qa(a,f),c}for(u=r(a,u);f<i.length;f++)null!==(g=p(u,a,f,i[f],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?f:g.key),s=o(g,s,f),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(a,e)}),as&&Qa(a,f),c}function g(a,i,l,c){var d=I(l);if("function"!==typeof d)throw Error(s(150));if(null==(l=d.call(l)))throw Error(s(151));for(var u=d=null,f=i,g=i=0,x=null,y=l.next();null!==f&&!y.done;g++,y=l.next()){f.index>g?(x=f,f=null):x=f.sibling;var b=h(a,f,y.value,c);if(null===b){null===f&&(f=x);break}e&&f&&null===b.alternate&&t(a,f),i=o(b,i,g),null===u?d=b:u.sibling=b,u=b,f=x}if(y.done)return n(a,f),as&&Qa(a,g),d;if(null===f){for(;!y.done;g++,y=l.next())null!==(y=m(a,y.value,c))&&(i=o(y,i,g),null===u?d=y:u.sibling=y,u=y);return as&&Qa(a,g),d}for(f=r(a,f);!y.done;g++,y=l.next())null!==(y=p(f,a,g,y.value,c))&&(e&&null!==y.alternate&&f.delete(null===y.key?g:y.key),i=o(y,i,g),null===u?d=y:u.sibling=y,u=y);return e&&f.forEach(function(e){return t(a,e)}),as&&Qa(a,g),d}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===N&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,d=s;null!==d;){if(d.key===c){if((c=o.type)===N){if(7===d.tag){n(r,d.sibling),(s=a(d,o.props.children)).return=r,r=s;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===T&&ys(c)===d.type){n(r,d.sibling),(s=a(d,o.props)).ref=gs(r,d,o),s.return=r,r=s;break e}n(r,d);break}t(r,d),d=d.sibling}o.type===N?((s=Ic(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Mc(o.type,o.key,o.props,null,r.mode,l)).ref=gs(r,s,o),l.return=r,r=l)}return i(r);case j:e:{for(d=o.key;null!==s;){if(s.key===d){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=a(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Fc(o,r.mode,l)).return=r,r=s}return i(r);case T:return e(r,s,(d=o._init)(o._payload),l)}if(te(o))return f(r,s,o,l);if(I(o))return g(r,s,o,l);xs(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=a(s,o)).return=r,r=s):(n(r,s),(s=Rc(o,r.mode,l)).return=r,r=s),i(r)):n(r,s)}}var vs=bs(!0),ws=bs(!1),js=ka(null),Ns=null,ks=null,Ss=null;function Cs(){Ss=ks=Ns=null}function _s(e){var t=js.current;Sa(js),e._currentValue=t}function Es(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ps(e,t){Ns=e,Ss=ks=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bi=!0),e.firstContext=null)}function Os(e){var t=e._currentValue;if(Ss!==e)if(e={context:e,memoizedValue:t,next:null},null===ks){if(null===Ns)throw Error(s(308));ks=e,Ns.dependencies={lanes:0,firstContext:e}}else ks=ks.next=e;return t}var As=null;function Ts(e){null===As?As=[e]:As.push(e)}function Ds(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Ts(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ms(e,r)}function Ms(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Is=!1;function Ls(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Rs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bs(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&El)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ms(e,n)}return null===(a=r.interleaved)?(t.next=t,Ts(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ms(e,n)}function Us(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function zs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?a=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?a=s=t:s=s.next=t}else a=s=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Vs(e,t,n,r){var a=e.updateQueue;Is=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,i=a.shared.pending;if(null!==i){a.shared.pending=null;var l=i,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var d=e.alternate;null!==d&&((i=(d=d.updateQueue).lastBaseUpdate)!==o&&(null===i?d.firstBaseUpdate=c:i.next=c,d.lastBaseUpdate=l))}if(null!==s){var u=a.baseState;for(o=0,d=c=l=null,i=s;;){var m=i.lane,h=i.eventTime;if((r&m)===m){null!==d&&(d=d.next={eventTime:h,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var p=e,f=i;switch(m=t,h=n,f.tag){case 1:if("function"===typeof(p=f.payload)){u=p.call(h,u,m);break e}u=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(m="function"===typeof(p=f.payload)?p.call(h,u,m):p)||void 0===m)break e;u=R({},u,m);break e;case 2:Is=!0}}null!==i.callback&&0!==i.lane&&(e.flags|=64,null===(m=a.effects)?a.effects=[i]:m.push(i))}else h={eventTime:h,lane:m,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===d?(c=d=h,l=u):d=d.next=h,o|=m;if(null===(i=i.next)){if(null===(i=a.shared.pending))break;i=(m=i).next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}if(null===d&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===s&&(a.shared.lanes=0);Ll|=o,e.lanes=o,e.memoizedState=u}}function Ws(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(s(191,a));a.call(r)}}}var qs={},Hs=ka(qs),Ys=ka(qs),Gs=ka(qs);function Xs(e){if(e===qs)throw Error(s(174));return e}function $s(e,t){switch(Ca(Gs,t),Ca(Ys,e),Ca(Hs,qs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Sa(Hs),Ca(Hs,t)}function Ks(){Sa(Hs),Sa(Ys),Sa(Gs)}function Js(e){Xs(Gs.current);var t=Xs(Hs.current),n=le(t,e.type);t!==n&&(Ca(Ys,e),Ca(Hs,n))}function Qs(e){Ys.current===e&&(Sa(Hs),Sa(Ys))}var Zs=ka(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var ro=v.ReactCurrentDispatcher,ao=v.ReactCurrentBatchConfig,so=0,oo=null,io=null,lo=null,co=!1,uo=!1,mo=0,ho=0;function po(){throw Error(s(321))}function fo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ir(e[n],t[n]))return!1;return!0}function go(e,t,n,r,a,o){if(so=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ro.current=null===e||null===e.memoizedState?Zo:ei,e=n(r,a),uo){o=0;do{if(uo=!1,mo=0,25<=o)throw Error(s(301));o+=1,lo=io=null,t.updateQueue=null,ro.current=ti,e=n(r,a)}while(uo)}if(ro.current=Qo,t=null!==io&&null!==io.next,so=0,lo=io=oo=null,co=!1,t)throw Error(s(300));return e}function xo(){var e=0!==mo;return mo=0,e}function yo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function bo(){if(null===io){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=io.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,io=e;else{if(null===e)throw Error(s(310));e={memoizedState:(io=e).memoizedState,baseState:io.baseState,baseQueue:io.baseQueue,queue:io.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function vo(e,t){return"function"===typeof t?t(e):t}function wo(e){var t=bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=io,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var i=a.next;a.next=o.next,o.next=i}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var l=i=null,c=null,d=o;do{var u=d.lane;if((so&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var m={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=m,i=r):c=c.next=m,oo.lanes|=u,Ll|=u}d=d.next}while(null!==d&&d!==o);null===c?i=r:c.next=l,ir(r,t.memoizedState)||(bi=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,oo.lanes|=o,Ll|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function jo(e){var t=bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var i=a=a.next;do{o=e(o,i.action),i=i.next}while(i!==a);ir(o,t.memoizedState)||(bi=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function No(){}function ko(e,t){var n=oo,r=bo(),a=t(),o=!ir(r.memoizedState,a);if(o&&(r.memoizedState=a,bi=!0),r=r.queue,Lo(_o.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Ao(9,Co.bind(null,n,r,a,t),void 0,null),null===Pl)throw Error(s(349));0!==(30&so)||So(n,t,a)}return a}function So(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Co(e,t,n,r){t.value=n,t.getSnapshot=r,Eo(t)&&Po(e)}function _o(e,t,n){return n(function(){Eo(t)&&Po(e)})}function Eo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ir(e,n)}catch(r){return!0}}function Po(e){var t=Ms(e,1);null!==t&&nc(t,e,1,-1)}function Oo(e){var t=yo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vo,lastRenderedState:e},t.queue=e,e=e.dispatch=Xo.bind(null,oo,e),[t.memoizedState,e]}function Ao(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function To(){return bo().memoizedState}function Do(e,t,n,r){var a=yo();oo.flags|=e,a.memoizedState=Ao(1|t,n,void 0,void 0===r?null:r)}function Mo(e,t,n,r){var a=bo();r=void 0===r?null:r;var s=void 0;if(null!==io){var o=io.memoizedState;if(s=o.destroy,null!==r&&fo(r,o.deps))return void(a.memoizedState=Ao(t,n,s,r))}oo.flags|=e,a.memoizedState=Ao(1|t,n,s,r)}function Io(e,t){return Do(8390656,8,e,t)}function Lo(e,t){return Mo(2048,8,e,t)}function Ro(e,t){return Mo(4,2,e,t)}function Fo(e,t){return Mo(4,4,e,t)}function Bo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Uo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Mo(4,4,Bo.bind(null,t,e),n)}function zo(){}function Vo(e,t){var n=bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Wo(e,t){var n=bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function qo(e,t,n){return 0===(21&so)?(e.baseState&&(e.baseState=!1,bi=!0),e.memoizedState=n):(ir(n,t)||(n=ft(),oo.lanes|=n,Ll|=n,e.baseState=!0),t)}function Ho(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ao.transition;ao.transition={};try{e(!1),t()}finally{bt=n,ao.transition=r}}function Yo(){return bo().memoizedState}function Go(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},$o(e))Ko(t,n);else if(null!==(n=Ds(e,t,n,r))){nc(n,e,r,ec()),Jo(n,t,r)}}function Xo(e,t,n){var r=tc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if($o(e))Ko(t,a);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,i=s(o,n);if(a.hasEagerState=!0,a.eagerState=i,ir(i,o)){var l=t.interleaved;return null===l?(a.next=a,Ts(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Ds(e,t,a,r))&&(nc(n,e,r,a=ec()),Jo(n,t,r))}}function $o(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Ko(e,t){uo=co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Jo(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Qo={readContext:Os,useCallback:po,useContext:po,useEffect:po,useImperativeHandle:po,useInsertionEffect:po,useLayoutEffect:po,useMemo:po,useReducer:po,useRef:po,useState:po,useDebugValue:po,useDeferredValue:po,useTransition:po,useMutableSource:po,useSyncExternalStore:po,useId:po,unstable_isNewReconciler:!1},Zo={readContext:Os,useCallback:function(e,t){return yo().memoizedState=[e,void 0===t?null:t],e},useContext:Os,useEffect:Io,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Do(4194308,4,Bo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Do(4194308,4,e,t)},useInsertionEffect:function(e,t){return Do(4,2,e,t)},useMemo:function(e,t){var n=yo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=yo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Go.bind(null,oo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},yo().memoizedState=e},useState:Oo,useDebugValue:zo,useDeferredValue:function(e){return yo().memoizedState=e},useTransition:function(){var e=Oo(!1),t=e[0];return e=Ho.bind(null,e[1]),yo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=oo,a=yo();if(as){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Pl)throw Error(s(349));0!==(30&so)||So(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,Io(_o.bind(null,r,o,e),[e]),r.flags|=2048,Ao(9,Co.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=yo(),t=Pl.identifierPrefix;if(as){var n=Ja;t=":"+t+"R"+(n=(Ka&~(1<<32-ot(Ka)-1)).toString(32)+n),0<(n=mo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ho++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ei={readContext:Os,useCallback:Vo,useContext:Os,useEffect:Lo,useImperativeHandle:Uo,useInsertionEffect:Ro,useLayoutEffect:Fo,useMemo:Wo,useReducer:wo,useRef:To,useState:function(){return wo(vo)},useDebugValue:zo,useDeferredValue:function(e){return qo(bo(),io.memoizedState,e)},useTransition:function(){return[wo(vo)[0],bo().memoizedState]},useMutableSource:No,useSyncExternalStore:ko,useId:Yo,unstable_isNewReconciler:!1},ti={readContext:Os,useCallback:Vo,useContext:Os,useEffect:Lo,useImperativeHandle:Uo,useInsertionEffect:Ro,useLayoutEffect:Fo,useMemo:Wo,useReducer:jo,useRef:To,useState:function(){return jo(vo)},useDebugValue:zo,useDeferredValue:function(e){var t=bo();return null===io?t.memoizedState=e:qo(t,io.memoizedState,e)},useTransition:function(){return[jo(vo)[0],bo().memoizedState]},useMutableSource:No,useSyncExternalStore:ko,useId:Yo,unstable_isNewReconciler:!1};function ni(e,t){if(e&&e.defaultProps){for(var n in t=R({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ri(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:R({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ai={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),s=Fs(r,a);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Bs(e,s,a))&&(nc(t,e,a,r),Us(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),s=Fs(r,a);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Bs(e,s,a))&&(nc(t,e,a,r),Us(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),a=Fs(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Bs(e,a,r))&&(nc(t,e,r,n),Us(t,e,r))}};function si(e,t,n,r,a,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(a,s))}function oi(e,t,n){var r=!1,a=_a,s=t.contextType;return"object"===typeof s&&null!==s?s=Os(s):(a=Ta(t)?Oa:Ea.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Aa(e,a):_a),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ai,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function ii(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ai.enqueueReplaceState(t,t.state,null)}function li(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Ls(e);var s=t.contextType;"object"===typeof s&&null!==s?a.context=Os(s):(s=Ta(t)?Oa:Ea.current,a.context=Aa(e,s)),a.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ri(e,t,s,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&ai.enqueueReplaceState(a,a.state,null),Vs(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function ci(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var a=n}catch(s){a="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:a,digest:null}}function di(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ui(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var mi="function"===typeof WeakMap?WeakMap:Map;function hi(e,t,n){(n=Fs(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ql||(ql=!0,Hl=r),ui(0,t)},n}function pi(e,t,n){(n=Fs(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){ui(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ui(0,t),"function"!==typeof r&&(null===Yl?Yl=new Set([this]):Yl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fi(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new mi;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function gi(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function xi(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fs(-1,1)).tag=2,Bs(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var yi=v.ReactCurrentOwner,bi=!1;function vi(e,t,n,r){t.child=null===e?ws(t,null,n,r):vs(t,e.child,n,r)}function wi(e,t,n,r,a){n=n.render;var s=t.ref;return Ps(t,a),r=go(e,t,n,r,s,a),n=xo(),null===e||bi?(as&&n&&es(t),t.flags|=1,vi(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,qi(e,t,a))}function ji(e,t,n,r,a){if(null===e){var s=n.type;return"function"!==typeof s||Tc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Mc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ni(e,t,s,r,a))}if(s=e.child,0===(e.lanes&a)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return qi(e,t,a)}return t.flags|=1,(e=Dc(s,r)).ref=t.ref,e.return=t,t.child=e}function Ni(e,t,n,r,a){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(bi=!1,t.pendingProps=r=s,0===(e.lanes&a))return t.lanes=e.lanes,qi(e,t,a);0!==(131072&e.flags)&&(bi=!0)}}return Ci(e,t,n,r,a)}function ki(e,t,n){var r=t.pendingProps,a=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ca(Dl,Tl),Tl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ca(Dl,Tl),Tl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Ca(Dl,Tl),Tl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Ca(Dl,Tl),Tl|=r;return vi(e,t,a,n),t.child}function Si(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ci(e,t,n,r,a){var s=Ta(n)?Oa:Ea.current;return s=Aa(t,s),Ps(t,a),n=go(e,t,n,r,s,a),r=xo(),null===e||bi?(as&&r&&es(t),t.flags|=1,vi(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,qi(e,t,a))}function _i(e,t,n,r,a){if(Ta(n)){var s=!0;La(t)}else s=!1;if(Ps(t,a),null===t.stateNode)Wi(e,t),oi(t,n,r),li(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,i=t.memoizedProps;o.props=i;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Os(c):c=Aa(t,c=Ta(n)?Oa:Ea.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate;u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(i!==r||l!==c)&&ii(t,o,r,c),Is=!1;var m=t.memoizedState;o.state=m,Vs(t,r,o,a),l=t.memoizedState,i!==r||m!==l||Pa.current||Is?("function"===typeof d&&(ri(t,n,d,r),l=t.memoizedState),(i=Is||si(t,n,i,r,m,l,c))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=i):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Rs(e,t),i=t.memoizedProps,c=t.type===t.elementType?i:ni(t.type,i),o.props=c,u=t.pendingProps,m=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Os(l):l=Aa(t,l=Ta(n)?Oa:Ea.current);var h=n.getDerivedStateFromProps;(d="function"===typeof h||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(i!==u||m!==l)&&ii(t,o,r,l),Is=!1,m=t.memoizedState,o.state=m,Vs(t,r,o,a);var p=t.memoizedState;i!==u||m!==p||Pa.current||Is?("function"===typeof h&&(ri(t,n,h,r),p=t.memoizedState),(c=Is||si(t,n,c,r,m,p,l)||!1)?(d||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),r=!1)}return Ei(e,t,n,r,s,a)}function Ei(e,t,n,r,a,s){Si(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&Ra(t,n,!1),qi(e,t,s);r=t.stateNode,yi.current=t;var i=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=vs(t,e.child,null,s),t.child=vs(t,null,i,s)):vi(e,t,i,s),t.memoizedState=r.state,a&&Ra(t,n,!0),t.child}function Pi(e){var t=e.stateNode;t.pendingContext?Ma(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ma(0,t.context,!1),$s(e,t.containerInfo)}function Oi(e,t,n,r,a){return hs(),ps(a),t.flags|=256,vi(e,t,n,r),t.child}var Ai,Ti,Di,Mi,Ii={dehydrated:null,treeContext:null,retryLane:0};function Li(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ri(e,t,n){var r,a=t.pendingProps,o=Zs.current,i=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(i=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ca(Zs,1&o),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,i?(a=t.mode,i=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==i?(i.childLanes=0,i.pendingProps=l):i=Lc(l,a,0,null),e=Ic(e,a,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Li(n),t.memoizedState=Ii,e):Fi(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,a,o,i){if(n)return 256&t.flags?(t.flags&=-257,Bi(e,t,i,r=di(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=Lc({mode:"visible",children:r.children},a,0,null),(o=Ic(o,a,i,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&vs(t,e.child,null,i),t.child.memoizedState=Li(i),t.memoizedState=Ii,o);if(0===(1&t.mode))return Bi(e,t,i,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var l=r.dgst;return r=l,Bi(e,t,i,r=di(o=Error(s(419)),r,void 0))}if(l=0!==(i&e.childLanes),bi||l){if(null!==(r=Pl)){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|i))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Ms(e,a),nc(r,e,a,-1))}return fc(),Bi(e,t,i,r=di(Error(s(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,rs=ca(a.nextSibling),ns=t,as=!0,ss=null,null!==e&&(Ga[Xa++]=Ka,Ga[Xa++]=Ja,Ga[Xa++]=$a,Ka=e.id,Ja=e.overflow,$a=t),t=Fi(t,r.children),t.flags|=4096,t)}(e,t,l,a,r,o,n);if(i){i=a.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Dc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?i=Dc(r,i):(i=Ic(i,l,n,null)).flags|=2,i.return=t,a.return=t,a.sibling=i,t.child=a,a=i,i=t.child,l=null===(l=e.child.memoizedState)?Li(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~n,t.memoizedState=Ii,a}return e=(i=e.child).sibling,a=Dc(i,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Fi(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bi(e,t,n,r){return null!==r&&ps(r),vs(t,e.child,null,n),(e=Fi(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ui(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Es(e.return,t,n)}function zi(e,t,n,r,a){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=a)}function Vi(e,t,n){var r=t.pendingProps,a=r.revealOrder,s=r.tail;if(vi(e,t,r.children,n),0!==(2&(r=Zs.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ui(e,n,t);else if(19===e.tag)Ui(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ca(Zs,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),zi(t,!1,a,n,s);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===eo(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}zi(t,!0,n,null,s);break;case"together":zi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wi(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qi(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Dc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Hi(e,t){if(!as)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Yi(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Gi(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yi(t),null;case 1:case 17:return Ta(t.type)&&Da(),Yi(t),null;case 3:return r=t.stateNode,Ks(),Sa(Pa),Sa(Ea),no(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(us(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(oc(ss),ss=null))),Ti(e,t),Yi(t),null;case 5:Qs(t);var a=Xs(Gs.current);if(n=t.type,null!==e&&null!=t.stateNode)Di(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Yi(t),null}if(e=Xs(Hs.current),us(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[ma]=t,r[ha]=o,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(a=0;a<Ir.length;a++)Br(Ir[a],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":K(r,o),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Br("invalid",r);break;case"textarea":ae(r,o),Br("invalid",r)}for(var l in ye(n,o),a=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,c,e),a=["children",""+c]):i.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Br("scroll",r)}switch(n){case"input":Y(r),Z(r,o,!0);break;case"textarea":Y(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ie(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[ma]=t,e[ha]=r,Ai(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Br("cancel",e),Br("close",e),a=r;break;case"iframe":case"object":case"embed":Br("load",e),a=r;break;case"video":case"audio":for(a=0;a<Ir.length;a++)Br(Ir[a],e);a=r;break;case"source":Br("error",e),a=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),a=r;break;case"details":Br("toggle",e),a=r;break;case"input":K(e,r),a=$(e,r),Br("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=R({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Br("invalid",e)}for(o in ye(n,a),c=a)if(c.hasOwnProperty(o)){var d=c[o];"style"===o?ge(e,d):"dangerouslySetInnerHTML"===o?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===o?"string"===typeof d?("textarea"!==n||""!==d)&&me(e,d):"number"===typeof d&&me(e,""+d):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(i.hasOwnProperty(o)?null!=d&&"onScroll"===o&&Br("scroll",e):null!=d&&b(e,o,d,l))}switch(n){case"input":Y(e),Z(e,r,!1);break;case"textarea":Y(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Yi(t),null;case 6:if(e&&null!=t.stateNode)Mi(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Xs(Gs.current),Xs(Hs.current),us(t)){if(r=t.stateNode,n=t.memoizedProps,r[ma]=t,(o=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Qr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ma]=t,t.stateNode=r}return Yi(t),null;case 13:if(Sa(Zs),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(as&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))ms(),hs(),t.flags|=98560,o=!1;else if(o=us(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[ma]=t}else hs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Yi(t),o=!1}else null!==ss&&(oc(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===Ml&&(Ml=3):fc())),null!==t.updateQueue&&(t.flags|=4),Yi(t),null);case 4:return Ks(),Ti(e,t),null===e&&Vr(t.stateNode.containerInfo),Yi(t),null;case 10:return _s(t.type._context),Yi(t),null;case 19:if(Sa(Zs),null===(o=t.memoizedState))return Yi(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Hi(o,!1);else{if(0!==Ml||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,Hi(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ca(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==o.tail&&Je()>Vl&&(t.flags|=128,r=!0,Hi(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=eo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Hi(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!as)return Yi(t),null}else 2*Je()-o.renderingStartTime>Vl&&1073741824!==n&&(t.flags|=128,r=!0,Hi(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Je(),t.sibling=null,n=Zs.current,Ca(Zs,r?1&n|2:1&n),t):(Yi(t),null);case 22:case 23:return uc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Tl)&&(Yi(t),6&t.subtreeFlags&&(t.flags|=8192)):Yi(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Xi(e,t){switch(ts(t),t.tag){case 1:return Ta(t.type)&&Da(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ks(),Sa(Pa),Sa(Ea),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qs(t),null;case 13:if(Sa(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));hs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Sa(Zs),null;case 4:return Ks(),null;case 10:return _s(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Ai=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ti=function(){},Di=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Xs(Hs.current);var s,o=null;switch(n){case"input":a=$(e,a),r=$(e,r),o=[];break;case"select":a=R({},a,{value:void 0}),r=R({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(d in ye(n,r),n=null,a)if(!r.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var l=a[d];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(i.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var c=r[d];if(l=null!=a?a[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(i.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Br("scroll",e),o||l===c||(o=[])):(o=o||[]).push(d,c))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}},Mi=function(e,t,n,r){n!==r&&(t.flags|=4)};var $i=!1,Ki=!1,Ji="function"===typeof WeakSet?WeakSet:Set,Qi=null;function Zi(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){kc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){kc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,void 0!==s&&el(t,n,s)}a=a.next}while(a!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ma],delete t[ha],delete t[fa],delete t[ga],delete t[xa])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function il(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var dl=null,ul=!1;function ml(e,t,n){for(n=n.child;null!==n;)hl(e,t,n),n=n.sibling}function hl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(at,n)}catch(i){}switch(n.tag){case 5:Ki||Zi(n,t);case 6:var r=dl,a=ul;dl=null,ml(e,t,n),ul=a,null!==(dl=r)&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?la(e.parentNode,n):1===e.nodeType&&la(e,n),Vt(e)):la(dl,n.stateNode));break;case 4:r=dl,a=ul,dl=n.stateNode.containerInfo,ul=!0,ml(e,t,n),dl=r,ul=a;break;case 0:case 11:case 14:case 15:if(!Ki&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var s=a,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&el(n,t,o),a=a.next}while(a!==r)}ml(e,t,n);break;case 1:if(!Ki&&(Zi(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(i){kc(n,t,i)}ml(e,t,n);break;case 21:ml(e,t,n);break;case 22:1&n.mode?(Ki=(r=Ki)||null!==n.memoizedState,ml(e,t,n),Ki=r):ml(e,t,n);break;default:ml(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ji),t.forEach(function(t){var r=Ec.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function fl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,i=t,l=i;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,ul=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===dl)throw Error(s(160));hl(o,i,a),dl=null,ul=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(d){kc(a,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),xl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){kc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){kc(e,e.return,g)}}break;case 1:fl(t,e),xl(e),512&r&&null!==n&&Zi(n,n.return);break;case 5:if(fl(t,e),xl(e),512&r&&null!==n&&Zi(n,n.return),32&e.flags){var a=e.stateNode;try{me(a,"")}catch(g){kc(e,e.return,g)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,i=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&J(a,o),be(l,i);var d=be(l,o);for(i=0;i<c.length;i+=2){var u=c[i],m=c[i+1];"style"===u?ge(a,m):"dangerouslySetInnerHTML"===u?ue(a,m):"children"===u?me(a,m):b(a,u,m,d)}switch(l){case"input":Q(a,o);break;case"textarea":se(a,o);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(a,!!o.multiple,p,!1):h!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[ha]=o}catch(g){kc(e,e.return,g)}}break;case 6:if(fl(t,e),xl(e),4&r){if(null===e.stateNode)throw Error(s(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(g){kc(e,e.return,g)}}break;case 3:if(fl(t,e),xl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){kc(e,e.return,g)}break;case 4:default:fl(t,e),xl(e);break;case 13:fl(t,e),xl(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(zl=Je())),4&r&&pl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Ki=(d=Ki)||u,fl(t,e),Ki=d):fl(t,e),xl(e),8192&r){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Qi=e,u=e.child;null!==u;){for(m=Qi=u;null!==Qi;){switch(p=(h=Qi).child,h.tag){case 0:case 11:case 14:case 15:nl(4,h,h.return);break;case 1:Zi(h,h.return);var f=h.stateNode;if("function"===typeof f.componentWillUnmount){r=h,n=h.return;try{t=r,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){kc(r,n,g)}}break;case 5:Zi(h,h.return);break;case 22:if(null!==h.memoizedState){wl(m);continue}}null!==p?(p.return=h,Qi=p):wl(m)}u=u.sibling}e:for(u=null,m=e;;){if(5===m.tag){if(null===u){u=m;try{a=m.stateNode,d?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=m.stateNode,i=void 0!==(c=m.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",i))}catch(g){kc(e,e.return,g)}}}else if(6===m.tag){if(null===u)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(g){kc(e,e.return,g)}}else if((22!==m.tag&&23!==m.tag||null===m.memoizedState||m===e)&&null!==m.child){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;null===m.sibling;){if(null===m.return||m.return===e)break e;u===m&&(u=null),m=m.return}u===m&&(u=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:fl(t,e),xl(e),4&r&&pl(e);case 21:}}function xl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(me(a,""),r.flags&=-33),cl(e,il(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;ll(e,il(e),o);break;default:throw Error(s(161))}}catch(i){kc(e,e.return,i)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Qi=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==Qi;){var a=Qi,s=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||$i;if(!o){var i=a.alternate,l=null!==i&&null!==i.memoizedState||Ki;i=$i;var c=Ki;if($i=o,(Ki=l)&&!c)for(Qi=a;null!==Qi;)l=(o=Qi).child,22===o.tag&&null!==o.memoizedState?jl(a):null!==l?(l.return=o,Qi=l):jl(a);for(;null!==s;)Qi=s,bl(s,t,n),s=s.sibling;Qi=a,$i=i,Ki=c}vl(e)}else 0!==(8772&a.subtreeFlags)&&null!==s?(s.return=a,Qi=s):vl(e)}}function vl(e){for(;null!==Qi;){var t=Qi;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ki||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ki)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:ni(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Ws(t,o,r);break;case 3:var i=t.updateQueue;if(null!==i){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ws(t,i,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var m=u.dehydrated;null!==m&&Vt(m)}}}break;default:throw Error(s(163))}Ki||512&t.flags&&al(t)}catch(h){kc(t,t.return,h)}}if(t===e){Qi=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qi=n;break}Qi=t.return}}function wl(e){for(;null!==Qi;){var t=Qi;if(t===e){Qi=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qi=n;break}Qi=t.return}}function jl(e){for(;null!==Qi;){var t=Qi;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){kc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(l){kc(t,a,l)}}var s=t.return;try{al(t)}catch(l){kc(t,s,l)}break;case 5:var o=t.return;try{al(t)}catch(l){kc(t,o,l)}}}catch(l){kc(t,t.return,l)}if(t===e){Qi=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Qi=i;break}Qi=t.return}}var Nl,kl=Math.ceil,Sl=v.ReactCurrentDispatcher,Cl=v.ReactCurrentOwner,_l=v.ReactCurrentBatchConfig,El=0,Pl=null,Ol=null,Al=0,Tl=0,Dl=ka(0),Ml=0,Il=null,Ll=0,Rl=0,Fl=0,Bl=null,Ul=null,zl=0,Vl=1/0,Wl=null,ql=!1,Hl=null,Yl=null,Gl=!1,Xl=null,$l=0,Kl=0,Jl=null,Ql=-1,Zl=0;function ec(){return 0!==(6&El)?Je():-1!==Ql?Ql:Ql=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&El)&&0!==Al?Al&-Al:null!==fs.transition?(0===Zl&&(Zl=ft()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function nc(e,t,n,r){if(50<Kl)throw Kl=0,Jl=null,Error(s(185));xt(e,n,r),0!==(2&El)&&e===Pl||(e===Pl&&(0===(2&El)&&(Rl|=n),4===Ml&&ic(e,Al)),rc(e,r),1===n&&0===El&&0===(1&t.mode)&&(Vl=Je()+500,Ba&&Va()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),i=1<<o,l=a[o];-1===l?0!==(i&n)&&0===(i&r)||(a[o]=ht(i,t)):l<=t&&(e.expiredLanes|=i),s&=~i}}(e,t);var r=mt(e,e===Pl?Al:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Ba=!0,za(e)}(lc.bind(null,e)):za(lc.bind(null,e)),oa(function(){0===(6&El)&&Va()}),n=null;else{switch(vt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Pc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Ql=-1,Zl=0,0!==(6&El))throw Error(s(327));var n=e.callbackNode;if(jc()&&e.callbackNode!==n)return null;var r=mt(e,e===Pl?Al:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var a=El;El|=2;var o=pc();for(Pl===e&&Al===t||(Wl=null,Vl=Je()+500,mc(e,t));;)try{yc();break}catch(l){hc(e,l)}Cs(),Sl.current=o,El=a,null!==Ol?t=0:(Pl=null,Al=0,t=Ml)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(r=a,t=sc(e,a))),1===t)throw n=Il,mc(e,0),ic(e,r),rc(e,Je()),n;if(6===t)ic(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],s=a.getSnapshot;a=a.value;try{if(!ir(s(),a))return!1}catch(i){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,r))&&(0!==(o=pt(e))&&(r=o,t=sc(e,o))),1===t))throw n=Il,mc(e,0),ic(e,r),rc(e,Je()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:wc(e,Ul,Wl);break;case 3:if(ic(e,r),(130023424&r)===r&&10<(t=zl+500-Je())){if(0!==mt(e,0))break;if(((a=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(wc.bind(null,e,Ul,Wl),t);break}wc(e,Ul,Wl);break;case 4:if(ic(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var i=31-ot(r);o=1<<i,(i=t[i])>a&&(a=i),r&=~o}if(r=a,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*kl(r/1960))-r)){e.timeoutHandle=ra(wc.bind(null,e,Ul,Wl),r);break}wc(e,Ul,Wl);break;default:throw Error(s(329))}}}return rc(e,Je()),e.callbackNode===n?ac.bind(null,e):null}function sc(e,t){var n=Bl;return e.current.memoizedState.isDehydrated&&(mc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Ul,Ul=n,null!==t&&oc(t)),e}function oc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function ic(e,t){for(t&=~Fl,t&=~Rl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&El))throw Error(s(327));jc();var t=mt(e,0);if(0===(1&t))return rc(e,Je()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=sc(e,r))}if(1===n)throw n=Il,mc(e,0),ic(e,t),rc(e,Je()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Ul,Wl),rc(e,Je()),null}function cc(e,t){var n=El;El|=1;try{return e(t)}finally{0===(El=n)&&(Vl=Je()+500,Ba&&Va())}}function dc(e){null!==Xl&&0===Xl.tag&&0===(6&El)&&jc();var t=El;El|=1;var n=_l.transition,r=bt;try{if(_l.transition=null,bt=1,e)return e()}finally{bt=r,_l.transition=n,0===(6&(El=t))&&Va()}}function uc(){Tl=Dl.current,Sa(Dl)}function mc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Ol)for(n=Ol.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Da();break;case 3:Ks(),Sa(Pa),Sa(Ea),no();break;case 5:Qs(r);break;case 4:Ks();break;case 13:case 19:Sa(Zs);break;case 10:_s(r.type._context);break;case 22:case 23:uc()}n=n.return}if(Pl=e,Ol=e=Dc(e.current,null),Al=Tl=t,Ml=0,Il=null,Fl=Rl=Ll=0,Ul=Bl=null,null!==As){for(t=0;t<As.length;t++)if(null!==(r=(n=As[t]).interleaved)){n.interleaved=null;var a=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=a,r.next=o}n.pending=r}As=null}return e}function hc(e,t){for(;;){var n=Ol;try{if(Cs(),ro.current=Qo,co){for(var r=oo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}co=!1}if(so=0,lo=io=oo=null,uo=!1,mo=0,Cl.current=null,null===n||null===n.return){Ml=1,Il=t,Ol=null;break}e:{var o=e,i=n.return,l=n,c=t;if(t=Al,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,m=u.tag;if(0===(1&u.mode)&&(0===m||11===m||15===m)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=gi(i);if(null!==p){p.flags&=-257,xi(p,i,l,0,t),1&p.mode&&fi(o,d,t),c=d;var f=(t=p).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){fi(o,d,t),fc();break e}c=Error(s(426))}else if(as&&1&l.mode){var x=gi(i);if(null!==x){0===(65536&x.flags)&&(x.flags|=256),xi(x,i,l,0,t),ps(ci(c,l));break e}}o=c=ci(c,l),4!==Ml&&(Ml=2),null===Bl?Bl=[o]:Bl.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,zs(o,hi(0,c,t));break e;case 1:l=c;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Yl||!Yl.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,zs(o,pi(o,l,t));break e}}o=o.return}while(null!==o)}vc(n)}catch(v){t=v,Ol===n&&null!==n&&(Ol=n=n.return);continue}break}}function pc(){var e=Sl.current;return Sl.current=Qo,null===e?Qo:e}function fc(){0!==Ml&&3!==Ml&&2!==Ml||(Ml=4),null===Pl||0===(268435455&Ll)&&0===(268435455&Rl)||ic(Pl,Al)}function gc(e,t){var n=El;El|=2;var r=pc();for(Pl===e&&Al===t||(Wl=null,mc(e,t));;)try{xc();break}catch(a){hc(e,a)}if(Cs(),El=n,Sl.current=r,null!==Ol)throw Error(s(261));return Pl=null,Al=0,Ml}function xc(){for(;null!==Ol;)bc(Ol)}function yc(){for(;null!==Ol&&!$e();)bc(Ol)}function bc(e){var t=Nl(e.alternate,e,Tl);e.memoizedProps=e.pendingProps,null===t?vc(e):Ol=t,Cl.current=null}function vc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Gi(n,t,Tl)))return void(Ol=n)}else{if(null!==(n=Xi(n,t)))return n.flags&=32767,void(Ol=n);if(null===e)return Ml=6,void(Ol=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ol=t);Ol=t=e}while(null!==t);0===Ml&&(Ml=5)}function wc(e,t,n){var r=bt,a=_l.transition;try{_l.transition=null,bt=1,function(e,t,n,r){do{jc()}while(null!==Xl);if(0!==(6&El))throw Error(s(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),s=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~s}}(e,o),e===Pl&&(Ol=Pl=null,Al=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gl||(Gl=!0,Pc(tt,function(){return jc(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=_l.transition,_l.transition=null;var i=bt;bt=1;var l=El;El|=4,Cl.current=null,function(e,t){if(ea=qt,hr(e=mr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var i=0,l=-1,c=-1,d=0,u=0,m=e,h=null;t:for(;;){for(var p;m!==n||0!==a&&3!==m.nodeType||(l=i+a),m!==o||0!==r&&3!==m.nodeType||(c=i+r),3===m.nodeType&&(i+=m.nodeValue.length),null!==(p=m.firstChild);)h=m,m=p;for(;;){if(m===e)break t;if(h===n&&++d===a&&(l=i),h===o&&++u===r&&(c=i),null!==(p=m.nextSibling))break;h=(m=h).parentNode}m=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},qt=!1,Qi=t;null!==Qi;)if(e=(t=Qi).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qi=e;else for(;null!==Qi;){t=Qi;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,x=f.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ni(t.type,g),x);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(s(163))}}catch(w){kc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Qi=e;break}Qi=t.return}f=tl,tl=!1}(e,n),gl(n,e),pr(ta),qt=!!ea,ta=ea=null,e.current=n,yl(n,e,a),Ke(),El=l,bt=i,_l.transition=o}else e.current=n;if(Gl&&(Gl=!1,Xl=e,$l=a),o=e.pendingLanes,0===o&&(Yl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(ql)throw ql=!1,e=Hl,Hl=null,e;0!==(1&$l)&&0!==e.tag&&jc(),o=e.pendingLanes,0!==(1&o)?e===Jl?Kl++:(Kl=0,Jl=e):Kl=0,Va()}(e,t,n,r)}finally{_l.transition=a,bt=r}return null}function jc(){if(null!==Xl){var e=vt($l),t=_l.transition,n=bt;try{if(_l.transition=null,bt=16>e?16:e,null===Xl)var r=!1;else{if(e=Xl,Xl=null,$l=0,0!==(6&El))throw Error(s(331));var a=El;for(El|=4,Qi=e.current;null!==Qi;){var o=Qi,i=o.child;if(0!==(16&Qi.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Qi=d;null!==Qi;){var u=Qi;switch(u.tag){case 0:case 11:case 15:nl(8,u,o)}var m=u.child;if(null!==m)m.return=u,Qi=m;else for(;null!==Qi;){var h=(u=Qi).sibling,p=u.return;if(sl(u),u===d){Qi=null;break}if(null!==h){h.return=p,Qi=h;break}Qi=p}}}var f=o.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(null!==g)}}Qi=o}}if(0!==(2064&o.subtreeFlags)&&null!==i)i.return=o,Qi=i;else e:for(;null!==Qi;){if(0!==(2048&(o=Qi).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Qi=y;break e}Qi=o.return}}var b=e.current;for(Qi=b;null!==Qi;){var v=(i=Qi).child;if(0!==(2064&i.subtreeFlags)&&null!==v)v.return=i,Qi=v;else e:for(i=b;null!==Qi;){if(0!==(2048&(l=Qi).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(j){kc(l,l.return,j)}if(l===i){Qi=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Qi=w;break e}Qi=l.return}}if(El=a,Va(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(at,e)}catch(j){}r=!0}return r}finally{bt=n,_l.transition=t}}return!1}function Nc(e,t,n){e=Bs(e,t=hi(0,t=ci(n,t),1),1),t=ec(),null!==e&&(xt(e,1,t),rc(e,t))}function kc(e,t,n){if(3===e.tag)Nc(e,e,n);else for(;null!==t;){if(3===t.tag){Nc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Yl||!Yl.has(r))){t=Bs(t,e=pi(t,e=ci(n,e),1),1),e=ec(),null!==t&&(xt(t,1,e),rc(t,e));break}}t=t.return}}function Sc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Pl===e&&(Al&n)===n&&(4===Ml||3===Ml&&(130023424&Al)===Al&&500>Je()-zl?mc(e,0):Fl|=n),rc(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=ec();null!==(e=Ms(e,t))&&(xt(e,t,n),rc(e,n))}function _c(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function Ec(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Cc(e,n)}function Pc(e,t){return Ge(e,t)}function Oc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,n,r){return new Oc(e,t,n,r)}function Tc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var n=e.alternate;return null===n?((n=Ac(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mc(e,t,n,r,a,o){var i=2;if(r=e,"function"===typeof e)Tc(e)&&(i=1);else if("string"===typeof e)i=5;else e:switch(e){case N:return Ic(n.children,a,o,t);case k:i=8,a|=8;break;case S:return(e=Ac(12,n,t,2|a)).elementType=S,e.lanes=o,e;case P:return(e=Ac(13,n,t,a)).elementType=P,e.lanes=o,e;case O:return(e=Ac(19,n,t,a)).elementType=O,e.lanes=o,e;case D:return Lc(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:i=10;break e;case _:i=9;break e;case E:i=11;break e;case A:i=14;break e;case T:i=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Ac(i,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Ic(e,t,n,r){return(e=Ac(7,e,r,t)).lanes=n,e}function Lc(e,t,n,r){return(e=Ac(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Rc(e,t,n){return(e=Ac(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Ac(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,r,a,s,o,i,l){return e=new Bc(e,t,n,i,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Ac(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ls(s),e}function zc(e){if(!e)return _a;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ta(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Ta(n))return Ia(e,n,t)}return t}function Vc(e,t,n,r,a,s,o,i,l){return(e=Uc(n,r,!0,e,0,s,0,i,l)).context=zc(null),n=e.current,(s=Fs(r=ec(),a=tc(n))).callback=void 0!==t&&null!==t?t:null,Bs(n,s,a),e.current.lanes=a,xt(e,a,r),rc(e,r),e}function Wc(e,t,n,r){var a=t.current,s=ec(),o=tc(a);return n=zc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fs(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Bs(a,t,o))&&(nc(e,a,o,s),Us(e,a,o)),o}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Yc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}Nl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Pa.current)bi=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bi=!1,function(e,t,n){switch(t.tag){case 3:Pi(t),hs();break;case 5:Js(t);break;case 1:Ta(t.type)&&La(t);break;case 4:$s(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ca(js,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ca(Zs,1&Zs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ri(e,t,n):(Ca(Zs,1&Zs.current),null!==(e=qi(e,t,n))?e.sibling:null);Ca(Zs,1&Zs.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Vi(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ca(Zs,Zs.current),r)break;return null;case 22:case 23:return t.lanes=0,ki(e,t,n)}return qi(e,t,n)}(e,t,n);bi=0!==(131072&e.flags)}else bi=!1,as&&0!==(1048576&t.flags)&&Za(t,Ya,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Wi(e,t),e=t.pendingProps;var a=Aa(t,Ea.current);Ps(t,n),a=go(null,t,r,e,a,n);var o=xo();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ta(r)?(o=!0,La(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ls(t),a.updater=ai,t.stateNode=a,a._reactInternals=t,li(t,r,e,n),t=Ei(null,t,r,!0,o,n)):(t.tag=0,as&&o&&es(t),vi(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Wi(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Tc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===A)return 14}return 2}(r),e=ni(r,e),a){case 0:t=Ci(null,t,r,e,n);break e;case 1:t=_i(null,t,r,e,n);break e;case 11:t=wi(null,t,r,e,n);break e;case 14:t=ji(null,t,r,ni(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Ci(e,t,r,a=t.elementType===r?a:ni(r,a),n);case 1:return r=t.type,a=t.pendingProps,_i(e,t,r,a=t.elementType===r?a:ni(r,a),n);case 3:e:{if(Pi(t),null===e)throw Error(s(387));r=t.pendingProps,a=(o=t.memoizedState).element,Rs(e,t),Vs(t,r,null,n);var i=t.memoizedState;if(r=i.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Oi(e,t,r,n,a=ci(Error(s(423)),t));break e}if(r!==a){t=Oi(e,t,r,n,a=ci(Error(s(424)),t));break e}for(rs=ca(t.stateNode.containerInfo.firstChild),ns=t,as=!0,ss=null,n=ws(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(hs(),r===a){t=qi(e,t,n);break e}vi(e,t,r,n)}t=t.child}return t;case 5:return Js(t),null===e&&cs(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,i=a.children,na(r,a)?i=null:null!==o&&na(r,o)&&(t.flags|=32),Si(e,t),vi(e,t,i,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Ri(e,t,n);case 4:return $s(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=vs(t,null,r,n):vi(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,wi(e,t,r,a=t.elementType===r?a:ni(r,a),n);case 7:return vi(e,t,t.pendingProps,n),t.child;case 8:case 12:return vi(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,i=a.value,Ca(js,r._currentValue),r._currentValue=i,null!==o)if(ir(o.value,i)){if(o.children===a.children&&!Pa.current){t=qi(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){i=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Fs(-1,n&-n)).tag=2;var d=o.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Es(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)i=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(i=o.return))throw Error(s(341));i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),Es(i,n,t),i=o.sibling}else i=o.child;if(null!==i)i.return=o;else for(i=o;null!==i;){if(i===t){i=null;break}if(null!==(o=i.sibling)){o.return=i.return,i=o;break}i=i.return}o=i}vi(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ps(t,n),r=r(a=Os(a)),t.flags|=1,vi(e,t,r,n),t.child;case 14:return a=ni(r=t.type,t.pendingProps),ji(e,t,r,a=ni(r.type,a),n);case 15:return Ni(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:ni(r,a),Wi(e,t),t.tag=1,Ta(r)?(e=!0,La(t)):e=!1,Ps(t,n),oi(t,r,a),li(t,r,a,n),Ei(null,t,r,!0,e,n);case 19:return Vi(e,t,n);case 22:return ki(e,t,n)}throw Error(s(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function $c(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function Zc(e,t,n,r,a){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof a){var i=a;a=function(){var e=qc(o);i.call(e)}}Wc(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var s=r;r=function(){var e=qc(o);s.call(e)}}var o=Vc(t,r,e,0,null,!1,0,"",Qc);return e._reactRootContainer=o,e[pa]=o.current,Vr(8===e.nodeType?e.parentNode:e),dc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var i=r;r=function(){var e=qc(l);i.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[pa]=l.current,Vr(8===e.nodeType?e.parentNode:e),dc(function(){Wc(t,l,n,r)}),l}(n,t,e,a,r);return qc(o)}$c.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Wc(e,t,null,null)},$c.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){Wc(null,e,null,null)}),t[pa]=null}},$c.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Rt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,Je()),0===(6&El)&&(Vl=Je()+500,Va()))}break;case 13:dc(function(){var t=Ms(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Yc(e,1)}},jt=function(e){if(13===e.tag){var t=Ms(e,134217728);if(null!==t)nc(t,e,134217728,ec());Yc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=tc(e),n=Ms(e,t);if(null!==n)nc(n,e,t,ec());Yc(e,t)}},kt=function(){return bt},St=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},je=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=wa(r);if(!a)throw Error(s(90));G(r),Q(r,a)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=cc,Pe=dc;var ed={usingClientEntryPoint:!1,Events:[ba,va,wa,Ce,_e,cc]},td={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:v.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rd.isDisabled&&rd.supportsFiber)try{at=rd.inject(nd),st=rd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:j,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Kc(e))throw Error(s(299));var n=!1,r="",a=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,r,a),e[pa]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Xc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(s(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Kc(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",i=Gc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(i=n.onRecoverableError)),t=Vc(t,null,e,1,null!=n?n:null,a,0,o,i),e[pa]=t.current,Vr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new $c(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(s(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(s(40));return!!e._reactRootContainer&&(dc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[pa]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},2761:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},2777:(e,t,n)=>{var r=n(5193),a=n(2761),s=Object.prototype,o=s.hasOwnProperty,i=s.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(e){return a(e)&&o.call(e,"callee")&&!i.call(e,"callee")};e.exports=l},2794:(e,t,n)=>{var r=n(9742),a=n(7498),s=n(9096);e.exports=function(e,t){return e&&e.length?r(e,s(t,2),a):void 0}},2866:(e,t,n)=>{var r=n(2969);e.exports=function(e){return function(t){return r(t,e)}}},2929:(e,t,n)=>{var r=n(6552).Uint8Array;e.exports=r},2969:(e,t,n)=>{var r=n(5324),a=n(914);e.exports=function(e,t){for(var n=0,s=(t=r(t,e)).length;null!=e&&n<s;)e=e[a(t[n++])];return n&&n==s?e:void 0}},3028:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},3097:(e,t,n)=>{var r=n(2969);e.exports=function(e,t,n){var a=null==e?void 0:r(e,t);return void 0===a?n:a}},3204:(e,t,n)=>{var r=n(3343),a=n(2777),s=n(4052),o=n(4543),i=n(9194),l=n(1268),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=s(e),d=!n&&a(e),u=!n&&!d&&o(e),m=!n&&!d&&!u&&l(e),h=n||d||u||m,p=h?r(e.length,String):[],f=p.length;for(var g in e)!t&&!c.call(e,g)||h&&("length"==g||u&&("offset"==g||"parent"==g)||m&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||i(g,f))||p.push(g);return p}},3211:e=>{e.exports=function(e,t){return e===t||e!==e&&t!==t}},3218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},3279:e=>{e.exports=function(e){return e}},3331:(e,t,n)=>{var r=n(9676),a=n(929),s=n(7303);e.exports=function(e){return function(t,n,o){return o&&"number"!=typeof o&&a(t,n,o)&&(n=o=void 0),t=s(t),void 0===n?(n=t,t=0):n=s(n),o=void 0===o?t<n?1:-1:s(o),r(t,n,o,e)}}},3343:e=>{e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},3366:(e,t,n)=>{var r=n(7894),a=n(9057);e.exports=function(e,t){return null!=e&&a(e,t,r)}},3411:(e,t,n)=>{var r=n(149),a=n(9096),s=n(8883),o=n(4052);e.exports=function(e,t){return(o(e)?r:s)(e,a(t,3))}},3440:(e,t,n)=>{var r=n(6552)["__core-js_shared__"];e.exports=r},3538:(e,t,n)=>{var r=n(755),a=n(3411);e.exports=function(e,t){return r(a(e,t),1)}},3668:(e,t,n)=>{var r=n(8902),a=n(2587),s=n(8114);e.exports=function(e,t,n,o,i,l){var c=1&n,d=e.length,u=t.length;if(d!=u&&!(c&&u>d))return!1;var m=l.get(e),h=l.get(t);if(m&&h)return m==t&&h==e;var p=-1,f=!0,g=2&n?new r:void 0;for(l.set(e,t),l.set(t,e);++p<d;){var x=e[p],y=t[p];if(o)var b=c?o(y,x,p,t,e,l):o(x,y,p,e,t,l);if(void 0!==b){if(b)continue;f=!1;break}if(g){if(!a(t,function(e,t){if(!s(g,t)&&(x===e||i(x,e,n,o,l)))return g.push(t)})){f=!1;break}}else if(x!==y&&!i(x,y,n,o,l)){f=!1;break}}return l.delete(e),l.delete(t),f}},3713:(e,t,n)=>{var r=n(6140),a=n(1143),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return a(e);var t=[];for(var n in Object(e))s.call(e,n)&&"constructor"!=n&&t.push(n);return t}},3781:(e,t,n)=>{var r=n(9417),a=n(8673);e.exports=function(e){for(var t=a(e),n=t.length;n--;){var s=t[n],o=e[s];t[n]=[s,o,r(o)]}return t}},3871:e=>{e.exports=function(e,t,n){var r=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(n=n>a?a:n)<0&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var s=Array(a);++r<a;)s[r]=e[r+t];return s}},3892:e=>{e.exports=function(e){return this.__data__.has(e)}},3932:(e,t,n)=>{var r=n(396),a=n(2866),s=n(2597),o=n(914);e.exports=function(e){return s(e)?r(o(e)):a(e)}},3950:(e,t,n)=>{var r=n(6686),a=n(4757),s=n(801),o=Math.max,i=Math.min;e.exports=function(e,t,n){var l,c,d,u,m,h,p=0,f=!1,g=!1,x=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=l,r=c;return l=c=void 0,p=t,u=e.apply(r,n)}function b(e){var n=e-h;return void 0===h||n>=t||n<0||g&&e-p>=d}function v(){var e=a();if(b(e))return w(e);m=setTimeout(v,function(e){var n=t-(e-h);return g?i(n,d-(e-p)):n}(e))}function w(e){return m=void 0,x&&l?y(e):(l=c=void 0,u)}function j(){var e=a(),n=b(e);if(l=arguments,c=this,h=e,n){if(void 0===m)return function(e){return p=e,m=setTimeout(v,t),f?y(e):u}(h);if(g)return clearTimeout(m),m=setTimeout(v,t),y(h)}return void 0===m&&(m=setTimeout(v,t)),u}return t=s(t)||0,r(n)&&(f=!!n.leading,d=(g="maxWait"in n)?o(s(n.maxWait)||0,t):d,x="trailing"in n?!!n.trailing:x),j.cancel=function(){void 0!==m&&clearTimeout(m),p=0,l=h=c=m=void 0},j.flush=function(){return void 0===m?u:w(a())},j}},4020:e=>{e.exports=function(e,t,n){for(var r=n-1,a=e.length;++r<a;)if(e[r]===t)return r;return-1}},4052:e=>{var t=Array.isArray;e.exports=t},4065:e=>{e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},4079:(e,t,n)=>{var r=n(8259),a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,o=r(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(a,function(e,n,r,a){t.push(r?a.replace(s,"$1"):n||e)}),t});e.exports=o},4160:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}},4190:(e,t,n)=>{var r=n(1340);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),h=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function x(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=x.prototype;var v=b.prototype=new y;v.constructor=b,f(v,x.prototype),v.isPureReactComponent=!0;var w=Array.isArray,j=Object.prototype.hasOwnProperty,N={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,r){var a,s={},o=null,i=null;if(null!=t)for(a in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(o=""+t.key),t)j.call(t,a)&&!k.hasOwnProperty(a)&&(s[a]=t[a]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===s[a]&&(s[a]=l[a]);return{$$typeof:n,type:e,key:o,ref:i,props:s,_owner:N.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var _=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function P(e,t,a,s,o){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var l=!1;if(null===e)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+E(l,0):s,w(o)?(a="",null!=e&&(a=e.replace(_,"$&/")+"/"),P(o,t,a,"",function(e){return e})):null!=o&&(C(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(_,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",w(e))for(var c=0;c<e.length;c++){var d=s+E(i=e[c],c);l+=P(i,t,a,d,o)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(i=e.next()).done;)l+=P(i=i.value,t,a,d=s+E(i,c++),o);else if("object"===i)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function O(e,t,n){if(null==e)return e;var r=[],a=0;return P(e,r,"","",function(e){return t.call(n,e,a++)}),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var T={current:null},D={transition:null},M={ReactCurrentDispatcher:T,ReactCurrentBatchConfig:D,ReactCurrentOwner:N};function I(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:O,forEach:function(e,t,n){O(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return O(e,function(){t++}),t},toArray:function(e){return O(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=x,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=s,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.act=I,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=f({},e.props),s=e.key,o=e.ref,i=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,i=N.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)j.call(t,c)&&!k.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];a.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:a,_owner:i}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:i,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:m,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=I,t.useCallback=function(e,t){return T.current.useCallback(e,t)},t.useContext=function(e){return T.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return T.current.useDeferredValue(e)},t.useEffect=function(e,t){return T.current.useEffect(e,t)},t.useId=function(){return T.current.useId()},t.useImperativeHandle=function(e,t,n){return T.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return T.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return T.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return T.current.useMemo(e,t)},t.useReducer=function(e,t,n){return T.current.useReducer(e,t,n)},t.useRef=function(e){return T.current.useRef(e)},t.useState=function(e){return T.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return T.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return T.current.useTransition()},t.version="18.3.1"},4258:(e,t,n)=>{var r=n(5906)();e.exports=r},4262:(e,t,n)=>{var r=n(8895),a=n(4052);e.exports=function(e,t,n){var s=t(e);return a(e)?s:r(s,n(e))}},4391:(e,t,n)=>{"use strict";var r=n(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4416:(e,t,n)=>{var r=n(8902),a=n(5866),s=n(1558),o=n(8114),i=n(8182),l=n(2074);e.exports=function(e,t,n){var c=-1,d=a,u=e.length,m=!0,h=[],p=h;if(n)m=!1,d=s;else if(u>=200){var f=t?null:i(e);if(f)return l(f);m=!1,d=o,p=new r}else p=t?[]:h;e:for(;++c<u;){var g=e[c],x=t?t(g):g;if(g=n||0!==g?g:0,m&&x===x){for(var y=p.length;y--;)if(p[y]===x)continue e;t&&p.push(x),h.push(g)}else d(p,x,n)||(p!==h&&p.push(x),h.push(g))}return h}},4543:(e,t,n)=>{e=n.nmd(e);var r=n(6552),a=n(14),s=t&&!t.nodeType&&t,o=s&&e&&!e.nodeType&&e,i=o&&o.exports===s?r.Buffer:void 0,l=(i?i.isBuffer:void 0)||a;e.exports=l},4545:(e,t,n)=>{var r=n(7160);e.exports=function(){this.__data__=new r,this.size=0}},4552:(e,t,n)=>{var r=n(9812),a=Object.prototype,s=a.hasOwnProperty,o=a.toString,i=r?r.toStringTag:void 0;e.exports=function(e){var t=s.call(e,i),n=e[i];try{e[i]=void 0;var r=!0}catch(l){}var a=o.call(e);return r&&(t?e[i]=n:delete e[i]),a}},4597:(e,t,n)=>{var r=n(2587),a=n(9096),s=n(2165),o=n(4052),i=n(929);e.exports=function(e,t,n){var l=o(e)?r:s;return n&&i(e,t,n)&&(t=void 0),l(e,a(t,3))}},4657:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},4664:(e,t,n)=>{var r=n(4258),a=n(8673);e.exports=function(e,t){return e&&r(e,t,a)}},4746:(e,t,n)=>{var r=n(5652);e.exports=function(e,t){var n=!0;return r(e,function(e,r,a){return n=!!t(e,r,a)}),n}},4757:(e,t,n)=>{var r=n(6552);e.exports=function(){return r.Date.now()}},4816:(e,t,n)=>{var r=n(7251),a=n(7159),s=n(438),o=n(9394),i=n(6874);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=a,l.prototype.get=s,l.prototype.has=o,l.prototype.set=i,e.exports=l},5029:(e,t,n)=>{var r=n(6989),a=n(3097),s=n(3366),o=n(2597),i=n(9417),l=n(1310),c=n(914);e.exports=function(e,t){return o(e)&&i(t)?l(c(e),t):function(n){var o=a(n,e);return void 0===o&&o===t?s(n,e):r(t,o,3)}}},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},5051:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},5173:(e,t,n)=>{e.exports=n(1497)()},5193:(e,t,n)=>{var r=n(6913),a=n(2761);e.exports=function(e){return a(e)&&"[object Arguments]"==r(e)}},5204:(e,t,n)=>{var r=n(7937)(n(6552),"Map");e.exports=r},5268:(e,t,n)=>{var r=n(9160);e.exports=function(e){return r(e)&&e!=+e}},5295:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}},5324:(e,t,n)=>{var r=n(4052),a=n(2597),s=n(4079),o=n(1069);e.exports=function(e,t){return r(e)?e:a(e,t)?[e]:s(o(e))}},5387:(e,t,n)=>{var r=n(7937)(n(6552),"Promise");e.exports=r},5428:(e,t,n)=>{var r=n(6913),a=n(6173),s=n(2761),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(e){return s(e)&&a(e.length)&&!!o[r(e)]}},5538:(e,t,n)=>{var r=n(7160),a=n(4545),s=n(793),o=n(7760),i=n(3892),l=n(6788);function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=a,c.prototype.delete=s,c.prototype.get=o,c.prototype.has=i,c.prototype.set=l,e.exports=c},5575:(e,t,n)=>{var r=n(7937)(Object,"create");e.exports=r},5636:(e,t,n)=>{var r=n(1170),a=Math.max;e.exports=function(e,t,n){return t=a(void 0===t?e.length-1:t,0),function(){for(var s=arguments,o=-1,i=a(s.length-t,0),l=Array(i);++o<i;)l[o]=s[t+o];o=-1;for(var c=Array(t+1);++o<t;)c[o]=s[o];return c[t]=n(l),r(e,this,c)}}},5647:(e,t,n)=>{var r=n(3279),a=n(5636),s=n(6350);e.exports=function(e,t){return s(a(e,t,r),e+"")}},5652:(e,t,n)=>{var r=n(4664),a=n(6516)(r);e.exports=a},5654:(e,t,n)=>{var r=n(7937),a=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=a},5713:e=>{e.exports=function(){}},5752:(e,t,n)=>{var r=n(9395),a=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,s,o,i){var l=1&n,c=r(e),d=c.length;if(d!=r(t).length&&!l)return!1;for(var u=d;u--;){var m=c[u];if(!(l?m in t:a.call(t,m)))return!1}var h=i.get(e),p=i.get(t);if(h&&p)return h==t&&p==e;var f=!0;i.set(e,t),i.set(t,e);for(var g=l;++u<d;){var x=e[m=c[u]],y=t[m];if(s)var b=l?s(y,x,m,t,e,i):s(x,y,m,e,t,i);if(!(void 0===b?x===y||o(x,y,n,s,i):b)){f=!1;break}g||(g="constructor"==m)}if(f&&!g){var v=e.constructor,w=t.constructor;v==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof w&&w instanceof w||(f=!1)}return i.delete(e),i.delete(t),f}},5797:(e,t,n)=>{var r=n(4816);function a(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,a=t?t.apply(this,r):r[0],s=n.cache;if(s.has(a))return s.get(a);var o=e.apply(this,r);return n.cache=s.set(a,o)||s,o};return n.cache=new(a.Cache||r),n}a.Cache=r,e.exports=a},5816:e=>{e.exports=function(e,t,n,r){for(var a=e.length,s=n+(r?1:-1);r?s--:++s<a;)if(t(e[s],s,e))return s;return-1}},5866:(e,t,n)=>{var r=n(8468);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},5893:(e,t,n)=>{var r=n(6599);e.exports=function(e,t,n){for(var a=-1,s=e.criteria,o=t.criteria,i=s.length,l=n.length;++a<i;){var c=r(s[a],o[a]);if(c)return a>=l?c:c*("desc"==n[a]?-1:1)}return e.index-t.index}},5906:e=>{e.exports=function(e){return function(t,n,r){for(var a=-1,s=Object(t),o=r(t),i=o.length;i--;){var l=o[e?i:++a];if(!1===n(s[l],l,s))break}return t}}},5967:e=>{e.exports=function(e){return e.split("")}},5990:(e,t,n)=>{var r=n(3028)(Object.getPrototypeOf,Object);e.exports=r},6095:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},6140:e=>{var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},6173:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},6179:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},6311:e=>{var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},6350:(e,t,n)=>{var r=n(8325),a=n(6578)(r);e.exports=a},6361:(e,t,n)=>{var r=n(6913),a=n(2761);e.exports=function(e){return!0===e||!1===e||a(e)&&"[object Boolean]"==r(e)}},6378:(e,t)=>{"use strict";var n,r=Symbol.for("react.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.server_context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen");function x(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case s:case i:case o:case m:case h:return e;default:switch(e=e&&e.$$typeof){case d:case c:case u:case f:case p:case l:return e;default:return t}}case a:return t}}}n=Symbol.for("react.module.reference"),t.isFragment=function(e){return x(e)===s}},6399:(e,t,n)=>{var r=n(5538),a=n(3668),s=n(9987),o=n(5752),i=n(6924),l=n(4052),c=n(4543),d=n(1268),u="[object Arguments]",m="[object Array]",h="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,f,g,x){var y=l(e),b=l(t),v=y?m:i(e),w=b?m:i(t),j=(v=v==u?h:v)==h,N=(w=w==u?h:w)==h,k=v==w;if(k&&c(e)){if(!c(t))return!1;y=!0,j=!1}if(k&&!j)return x||(x=new r),y||d(e)?a(e,t,n,f,g,x):s(e,t,v,n,f,g,x);if(!(1&n)){var S=j&&p.call(e,"__wrapped__"),C=N&&p.call(t,"__wrapped__");if(S||C){var _=S?e.value():e,E=C?t.value():t;return x||(x=new r),g(_,E,n,f,x)}}return!!k&&(x||(x=new r),o(e,t,n,f,g,x))}},6516:(e,t,n)=>{var r=n(6571);e.exports=function(e,t){return function(n,a){if(null==n)return n;if(!r(n))return e(n,a);for(var s=n.length,o=t?s:-1,i=Object(n);(t?o--:++o<s)&&!1!==a(i[o],o,i););return n}}},6532:(e,t,n)=>{var r=n(5538),a=n(6989);e.exports=function(e,t,n,s){var o=n.length,i=o,l=!s;if(null==e)return!i;for(e=Object(e);o--;){var c=n[o];if(l&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<i;){var d=(c=n[o])[0],u=e[d],m=c[1];if(l&&c[2]){if(void 0===u&&!(d in e))return!1}else{var h=new r;if(s)var p=s(u,m,d,e,t,h);if(!(void 0===p?a(m,u,3,s,h):p))return!1}}return!0}},6552:(e,t,n)=>{var r=n(7105),a="object"==typeof self&&self&&self.Object===Object&&self,s=r||a||Function("return this")();e.exports=s},6571:(e,t,n)=>{var r=n(1629),a=n(6173);e.exports=function(e){return null!=e&&a(e.length)&&!r(e)}},6578:e=>{var t=Date.now;e.exports=function(e){var n=0,r=0;return function(){var a=t(),s=16-(a-r);if(r=a,s>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},6599:(e,t,n)=>{var r=n(9841);e.exports=function(e,t){if(e!==t){var n=void 0!==e,a=null===e,s=e===e,o=r(e),i=void 0!==t,l=null===t,c=t===t,d=r(t);if(!l&&!d&&!o&&e>t||o&&i&&c&&!l&&!d||a&&i&&c||!n&&c||!s)return 1;if(!a&&!o&&!d&&e<t||d&&n&&s&&!a&&!o||l&&n&&s||!i&&s||!c)return-1}return 0}},6600:(e,t,n)=>{var r=n(7937)(n(6552),"WeakMap");e.exports=r},6604:(e,t,n)=>{var r=n(3331)();e.exports=r},6686:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},6704:e=>{e.exports=function(e){return this.__data__.has(e)}},6745:(e,t,n)=>{var r=n(9742),a=n(61),s=n(3279);e.exports=function(e){return e&&e.length?r(e,s,a):void 0}},6788:(e,t,n)=>{var r=n(7160),a=n(5204),s=n(4816);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var o=n.__data__;if(!a||o.length<199)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new s(o)}return n.set(e,t),this.size=n.size,this}},6832:(e,t,n)=>{e=n.nmd(e);var r=n(7105),a=t&&!t.nodeType&&t,s=a&&e&&!e.nodeType&&e,o=s&&s.exports===a&&r.process,i=function(){try{var e=s&&s.require&&s.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(t){}}();e.exports=i},6874:(e,t,n)=>{var r=n(2622);e.exports=function(e,t){var n=r(this,e),a=n.size;return n.set(e,t),this.size+=n.size==a?0:1,this}},6913:(e,t,n)=>{var r=n(9812),a=n(4552),s=n(6095),o=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?a(e):s(e)}},6924:(e,t,n)=>{var r=n(7685),a=n(5204),s=n(5387),o=n(2070),i=n(6600),l=n(6913),c=n(6996),d="[object Map]",u="[object Promise]",m="[object Set]",h="[object WeakMap]",p="[object DataView]",f=c(r),g=c(a),x=c(s),y=c(o),b=c(i),v=l;(r&&v(new r(new ArrayBuffer(1)))!=p||a&&v(new a)!=d||s&&v(s.resolve())!=u||o&&v(new o)!=m||i&&v(new i)!=h)&&(v=function(e){var t=l(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case f:return p;case g:return d;case x:return u;case y:return m;case b:return h}return t}),e.exports=v},6954:(e,t,n)=>{var r=n(1629),a=n(7857),s=n(6686),o=n(6996),i=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,d=l.toString,u=c.hasOwnProperty,m=RegExp("^"+d.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!s(e)||a(e))&&(r(e)?m:i).test(o(e))}},6989:(e,t,n)=>{var r=n(6399),a=n(2761);e.exports=function e(t,n,s,o,i){return t===n||(null==t||null==n||!a(t)&&!a(n)?t!==t&&n!==n:r(t,n,s,o,e,i))}},6996:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(n){}try{return e+""}catch(n){}}return""}},7002:(e,t,n)=>{var r=n(5295),a=n(4746),s=n(9096),o=n(4052),i=n(929);e.exports=function(e,t,n){var l=o(e)?r:a;return n&&i(e,t,n)&&(t=void 0),l(e,s(t,3))}},7105:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},7116:(e,t,n)=>{var r=n(9812),a=n(2777),s=n(4052),o=r?r.isConcatSpreadable:void 0;e.exports=function(e){return s(e)||a(e)||!!(o&&e&&e[o])}},7159:(e,t,n)=>{var r=n(2622);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},7160:(e,t,n)=>{var r=n(7563),a=n(9935),s=n(4190),o=n(1946),i=n(1714);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=a,l.prototype.get=s,l.prototype.has=o,l.prototype.set=i,e.exports=l},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<s(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var i=2*(r+1)-1,l=e[i],c=i+1,d=e[c];if(0>s(l,n))c<a&&0>s(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[i]=n,r=i);else{if(!(c<a&&0>s(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],d=[],u=1,m=null,h=3,p=!1,f=!1,g=!1,x="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function v(e){for(var t=r(d);null!==t;){if(null===t.callback)a(d);else{if(!(t.startTime<=e))break;a(d),t.sortIndex=t.expirationTime,n(c,t)}t=r(d)}}function w(e){if(g=!1,v(e),!f)if(null!==r(c))f=!0,D(j);else{var t=r(d);null!==t&&M(w,t.startTime-e)}}function j(e,n){f=!1,g&&(g=!1,y(C),C=-1),p=!0;var s=h;try{for(v(n),m=r(c);null!==m&&(!(m.expirationTime>n)||e&&!P());){var o=m.callback;if("function"===typeof o){m.callback=null,h=m.priorityLevel;var i=o(m.expirationTime<=n);n=t.unstable_now(),"function"===typeof i?m.callback=i:m===r(c)&&a(c),v(n)}else a(c);m=r(c)}if(null!==m)var l=!0;else{var u=r(d);null!==u&&M(w,u.startTime-n),l=!1}return l}finally{m=null,h=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,k=!1,S=null,C=-1,_=5,E=-1;function P(){return!(t.unstable_now()-E<_)}function O(){if(null!==S){var e=t.unstable_now();E=e;var n=!0;try{n=S(!0,e)}finally{n?N():(k=!1,S=null)}}else k=!1}if("function"===typeof b)N=function(){b(O)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,T=A.port2;A.port1.onmessage=O,N=function(){T.postMessage(null)}}else N=function(){x(O,0)};function D(e){S=e,k||(k=!0,N())}function M(e,n){C=x(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||p||(f=!0,D(j))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},t.unstable_scheduleCallback=function(e,a,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return e={id:u++,callback:a,priorityLevel:e,startTime:s,expirationTime:i=s+i,sortIndex:-1},s>o?(e.sortIndex=s,n(d,e),null===r(c)&&e===r(d)&&(g?(y(C),C=-1):g=!0,M(w,s-o))):(e.sortIndex=i,n(c,e),f||p||(f=!0,D(j))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}},7251:(e,t,n)=>{var r=n(8724),a=n(7160),s=n(5204);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(s||a),string:new r}}},7283:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,r,s,o){if("function"!==typeof r)throw new TypeError("The listener must be a function");var i=new a(r,s||e,o),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],i]:e._events[l].push(i):(e._events[l]=i,e._eventsCount++),e}function o(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function i(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),i.prototype.eventNames=function(){var e,r,a=[];if(0===this._eventsCount)return a;for(r in e=this._events)t.call(e,r)&&a.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},i.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var a=0,s=r.length,o=new Array(s);a<s;a++)o[a]=r[a].fn;return o},i.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},i.prototype.emit=function(e,t,r,a,s,o){var i=n?n+e:e;if(!this._events[i])return!1;var l,c,d=this._events[i],u=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,r),!0;case 4:return d.fn.call(d.context,t,r,a),!0;case 5:return d.fn.call(d.context,t,r,a,s),!0;case 6:return d.fn.call(d.context,t,r,a,s,o),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];d.fn.apply(d.context,l)}else{var m,h=d.length;for(c=0;c<h;c++)switch(d[c].once&&this.removeListener(e,d[c].fn,void 0,!0),u){case 1:d[c].fn.call(d[c].context);break;case 2:d[c].fn.call(d[c].context,t);break;case 3:d[c].fn.call(d[c].context,t,r);break;case 4:d[c].fn.call(d[c].context,t,r,a);break;default:if(!l)for(m=1,l=new Array(u-1);m<u;m++)l[m-1]=arguments[m];d[c].fn.apply(d[c].context,l)}}return!0},i.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},i.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},i.prototype.removeListener=function(e,t,r,a){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return o(this,s),this;var i=this._events[s];if(i.fn)i.fn!==t||a&&!i.once||r&&i.context!==r||o(this,s);else{for(var l=0,c=[],d=i.length;l<d;l++)(i[l].fn!==t||a&&!i[l].once||r&&i[l].context!==r)&&c.push(i[l]);c.length?this._events[s]=1===c.length?c[0]:c:o(this,s)}return this},i.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new r,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=n,i.EventEmitter=i,e.exports=i},7303:(e,t,n)=>{var r=n(801),a=1/0;e.exports=function(e){return e?(e=r(e))===a||e===-1/0?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0}},7424:(e,t,n)=>{var r=n(755),a=n(2536),s=n(5647),o=n(929),i=s(function(e,t){if(null==e)return[];var n=t.length;return n>1&&o(e,t[0],t[1])?t=[]:n>2&&o(t[0],t[1],t[2])&&(t=[t[0]]),a(e,r(t,1),[])});e.exports=i},7498:e=>{e.exports=function(e,t){return e>t}},7529:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,a=0,s=[];++n<r;){var o=e[n];t(o,n,e)&&(s[a++]=o)}return s}},7563:e=>{e.exports=function(){this.__data__=[],this.size=0}},7574:e=>{e.exports=function(e){return function(t){return e(t)}}},7615:(e,t,n)=>{var r=n(5575);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},7676:(e,t,n)=>{var r=n(8189),a=n(6311),s=n(9115),o=n(1069);e.exports=function(e){return function(t){t=o(t);var n=a(t)?s(t):void 0,i=n?n[0]:t.charAt(0),l=n?r(n,1).join(""):t.slice(1);return i[e]()+l}}},7685:(e,t,n)=>{var r=n(7937)(n(6552),"DataView");e.exports=r},7760:e=>{e.exports=function(e){return this.__data__.get(e)}},7828:e=>{e.exports=function(){return[]}},7857:(e,t,n)=>{var r=n(3440),a=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!a&&a in e}},7894:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},7937:(e,t,n)=>{var r=n(6954),a=n(4657);e.exports=function(e,t){var n=a(e,t);return r(n)?n:void 0}},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},8114:e=>{e.exports=function(e,t){return e.has(t)}},8182:(e,t,n)=>{var r=n(2070),a=n(5713),s=n(2074),o=r&&1/s(new r([,-0]))[1]==1/0?function(e){return new r(e)}:a;e.exports=o},8189:(e,t,n)=>{var r=n(3871);e.exports=function(e,t,n){var a=e.length;return n=void 0===n?a:n,!t&&n>=a?e:r(e,t,n)}},8210:function(e,t,n){var r;!function(){"use strict";var a,s=1e9,o={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},i=!0,l="[DecimalError] ",c=l+"Invalid argument: ",d=l+"Exponent out of range: ",u=Math.floor,m=Math.pow,h=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,p=1e7,f=9007199254740991,g=u(1286742750677284.5),x={};function y(e,t){var n,r,a,s,o,l,c,d,u=e.constructor,m=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),i?E(t,m):t;if(c=e.d,d=t.d,o=e.e,a=t.e,c=c.slice(),s=o-a){for(s<0?(r=c,s=-s,l=d.length):(r=d,a=o,l=c.length),s>(l=(o=Math.ceil(m/7))>l?o+1:l+1)&&(s=l,r.length=1),r.reverse();s--;)r.push(0);r.reverse()}for((l=c.length)-(s=d.length)<0&&(s=l,r=d,d=c,c=r),n=0;s;)n=(c[--s]=c[s]+d[s]+n)/p|0,c[s]%=p;for(n&&(c.unshift(n),++a),l=c.length;0==c[--l];)c.pop();return t.d=c,t.e=a,i?E(t,m):t}function b(e,t,n){if(e!==~~e||e<t||e>n)throw Error(c+e)}function v(e){var t,n,r,a=e.length-1,s="",o=e[0];if(a>0){for(s+=o,t=1;t<a;t++)(n=7-(r=e[t]+"").length)&&(s+=S(n)),s+=r;(n=7-(r=(o=e[t])+"").length)&&(s+=S(n))}else if(0===o)return"0";for(;o%10===0;)o/=10;return s+o}x.absoluteValue=x.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},x.comparedTo=x.cmp=function(e){var t,n,r,a,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(t=0,n=(r=s.d.length)<(a=e.d.length)?r:a;t<n;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return r===a?0:r>a^s.s<0?1:-1},x.decimalPlaces=x.dp=function(){var e=this,t=e.d.length-1,n=7*(t-e.e);if(t=e.d[t])for(;t%10==0;t/=10)n--;return n<0?0:n},x.dividedBy=x.div=function(e){return w(this,new this.constructor(e))},x.dividedToIntegerBy=x.idiv=function(e){var t=this.constructor;return E(w(this,new t(e),0,1),t.precision)},x.equals=x.eq=function(e){return!this.cmp(e)},x.exponent=function(){return N(this)},x.greaterThan=x.gt=function(e){return this.cmp(e)>0},x.greaterThanOrEqualTo=x.gte=function(e){return this.cmp(e)>=0},x.isInteger=x.isint=function(){return this.e>this.d.length-2},x.isNegative=x.isneg=function(){return this.s<0},x.isPositive=x.ispos=function(){return this.s>0},x.isZero=function(){return 0===this.s},x.lessThan=x.lt=function(e){return this.cmp(e)<0},x.lessThanOrEqualTo=x.lte=function(e){return this.cmp(e)<1},x.logarithm=x.log=function(e){var t,n=this,r=n.constructor,s=r.precision,o=s+5;if(void 0===e)e=new r(10);else if((e=new r(e)).s<1||e.eq(a))throw Error(l+"NaN");if(n.s<1)throw Error(l+(n.s?"NaN":"-Infinity"));return n.eq(a)?new r(0):(i=!1,t=w(C(n,o),C(e,o),o),i=!0,E(t,s))},x.minus=x.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?P(t,e):y(t,(e.s=-e.s,e))},x.modulo=x.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(!(e=new r(e)).s)throw Error(l+"NaN");return n.s?(i=!1,t=w(n,e,0,1).times(e),i=!0,n.minus(t)):E(new r(n),a)},x.naturalExponential=x.exp=function(){return j(this)},x.naturalLogarithm=x.ln=function(){return C(this)},x.negated=x.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},x.plus=x.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?y(t,e):P(t,(e.s=-e.s,e))},x.precision=x.sd=function(e){var t,n,r,a=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(c+e);if(t=N(a)+1,n=7*(r=a.d.length-1)+1,r=a.d[r]){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},x.squareRoot=x.sqrt=function(){var e,t,n,r,a,s,o,c=this,d=c.constructor;if(c.s<1){if(!c.s)return new d(0);throw Error(l+"NaN")}for(e=N(c),i=!1,0==(a=Math.sqrt(+c))||a==1/0?(((t=v(c.d)).length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=u((e+1)/2)-(e<0||e%2),r=new d(t=a==1/0?"5e"+e:(t=a.toExponential()).slice(0,t.indexOf("e")+1)+e)):r=new d(a.toString()),a=o=(n=d.precision)+3;;)if(r=(s=r).plus(w(c,s,o+2)).times(.5),v(s.d).slice(0,o)===(t=v(r.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&"4999"==t){if(E(s,n+1,0),s.times(s).eq(c)){r=s;break}}else if("9999"!=t)break;o+=4}return i=!0,E(r,n)},x.times=x.mul=function(e){var t,n,r,a,s,o,l,c,d,u=this,m=u.constructor,h=u.d,f=(e=new m(e)).d;if(!u.s||!e.s)return new m(0);for(e.s*=u.s,n=u.e+e.e,(c=h.length)<(d=f.length)&&(s=h,h=f,f=s,o=c,c=d,d=o),s=[],r=o=c+d;r--;)s.push(0);for(r=d;--r>=0;){for(t=0,a=c+r;a>r;)l=s[a]+f[r]*h[a-r-1]+t,s[a--]=l%p|0,t=l/p|0;s[a]=(s[a]+t)%p|0}for(;!s[--o];)s.pop();return t?++n:s.shift(),e.d=s,e.e=n,i?E(e,m.precision):e},x.toDecimalPlaces=x.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(b(e,0,s),void 0===t?t=r.rounding:b(t,0,8),E(n,e+N(n)+1,t))},x.toExponential=function(e,t){var n,r=this,a=r.constructor;return void 0===e?n=O(r,!0):(b(e,0,s),void 0===t?t=a.rounding:b(t,0,8),n=O(r=E(new a(r),e+1,t),!0,e+1)),n},x.toFixed=function(e,t){var n,r,a=this,o=a.constructor;return void 0===e?O(a):(b(e,0,s),void 0===t?t=o.rounding:b(t,0,8),n=O((r=E(new o(a),e+N(a)+1,t)).abs(),!1,e+N(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)},x.toInteger=x.toint=function(){var e=this,t=e.constructor;return E(new t(e),N(e)+1,t.rounding)},x.toNumber=function(){return+this},x.toPower=x.pow=function(e){var t,n,r,s,o,c,d=this,m=d.constructor,h=+(e=new m(e));if(!e.s)return new m(a);if(!(d=new m(d)).s){if(e.s<1)throw Error(l+"Infinity");return d}if(d.eq(a))return d;if(r=m.precision,e.eq(a))return E(d,r);if(c=(t=e.e)>=(n=e.d.length-1),o=d.s,c){if((n=h<0?-h:h)<=f){for(s=new m(a),t=Math.ceil(r/7+4),i=!1;n%2&&A((s=s.times(d)).d,t),0!==(n=u(n/2));)A((d=d.times(d)).d,t);return i=!0,e.s<0?new m(a).div(s):E(s,r)}}else if(o<0)throw Error(l+"NaN");return o=o<0&&1&e.d[Math.max(t,n)]?-1:1,d.s=1,i=!1,s=e.times(C(d,r+12)),i=!0,(s=j(s)).s=o,s},x.toPrecision=function(e,t){var n,r,a=this,o=a.constructor;return void 0===e?r=O(a,(n=N(a))<=o.toExpNeg||n>=o.toExpPos):(b(e,1,s),void 0===t?t=o.rounding:b(t,0,8),r=O(a=E(new o(a),e,t),e<=(n=N(a))||n<=o.toExpNeg,e)),r},x.toSignificantDigits=x.tosd=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(b(e,1,s),void 0===t?t=n.rounding:b(t,0,8)),E(new n(this),e,t)},x.toString=x.valueOf=x.val=x.toJSON=function(){var e=this,t=N(e),n=e.constructor;return O(e,t<=n.toExpNeg||t>=n.toExpPos)};var w=function(){function e(e,t){var n,r=0,a=e.length;for(e=e.slice();a--;)n=e[a]*t+r,e[a]=n%p|0,r=n/p|0;return r&&e.unshift(r),e}function t(e,t,n,r){var a,s;if(n!=r)s=n>r?1:-1;else for(a=s=0;a<n;a++)if(e[a]!=t[a]){s=e[a]>t[a]?1:-1;break}return s}function n(e,t,n){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*p+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,a,s,o){var i,c,d,u,m,h,f,g,x,y,b,v,w,j,k,S,C,_,P=r.constructor,O=r.s==a.s?1:-1,A=r.d,T=a.d;if(!r.s)return new P(r);if(!a.s)throw Error(l+"Division by zero");for(c=r.e-a.e,C=T.length,k=A.length,g=(f=new P(O)).d=[],d=0;T[d]==(A[d]||0);)++d;if(T[d]>(A[d]||0)&&--c,(v=null==s?s=P.precision:o?s+(N(r)-N(a))+1:s)<0)return new P(0);if(v=v/7+2|0,d=0,1==C)for(u=0,T=T[0],v++;(d<k||u)&&v--;d++)w=u*p+(A[d]||0),g[d]=w/T|0,u=w%T|0;else{for((u=p/(T[0]+1)|0)>1&&(T=e(T,u),A=e(A,u),C=T.length,k=A.length),j=C,y=(x=A.slice(0,C)).length;y<C;)x[y++]=0;(_=T.slice()).unshift(0),S=T[0],T[1]>=p/2&&++S;do{u=0,(i=t(T,x,C,y))<0?(b=x[0],C!=y&&(b=b*p+(x[1]||0)),(u=b/S|0)>1?(u>=p&&(u=p-1),1==(i=t(m=e(T,u),x,h=m.length,y=x.length))&&(u--,n(m,C<h?_:T,h))):(0==u&&(i=u=1),m=T.slice()),(h=m.length)<y&&m.unshift(0),n(x,m,y),-1==i&&(i=t(T,x,C,y=x.length))<1&&(u++,n(x,C<y?_:T,y)),y=x.length):0===i&&(u++,x=[0]),g[d++]=u,i&&x[0]?x[y++]=A[j]||0:(x=[A[j]],y=1)}while((j++<k||void 0!==x[0])&&v--)}return g[0]||g.shift(),f.e=c,E(f,o?s+N(f)+1:s)}}();function j(e,t){var n,r,s,o,l,c=0,u=0,h=e.constructor,p=h.precision;if(N(e)>16)throw Error(d+N(e));if(!e.s)return new h(a);for(null==t?(i=!1,l=p):l=t,o=new h(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(l+=Math.log(m(2,u))/Math.LN10*2+5|0,n=r=s=new h(a),h.precision=l;;){if(r=E(r.times(e),l),n=n.times(++c),v((o=s.plus(w(r,n,l))).d).slice(0,l)===v(s.d).slice(0,l)){for(;u--;)s=E(s.times(s),l);return h.precision=p,null==t?(i=!0,E(s,p)):s}s=o}}function N(e){for(var t=7*e.e,n=e.d[0];n>=10;n/=10)t++;return t}function k(e,t,n){if(t>e.LN10.sd())throw i=!0,n&&(e.precision=n),Error(l+"LN10 precision limit exceeded");return E(new e(e.LN10),t)}function S(e){for(var t="";e--;)t+="0";return t}function C(e,t){var n,r,s,o,c,d,u,m,h,p=1,f=e,g=f.d,x=f.constructor,y=x.precision;if(f.s<1)throw Error(l+(f.s?"NaN":"-Infinity"));if(f.eq(a))return new x(0);if(null==t?(i=!1,m=y):m=t,f.eq(10))return null==t&&(i=!0),k(x,m);if(m+=10,x.precision=m,r=(n=v(g)).charAt(0),o=N(f),!(Math.abs(o)<15e14))return u=k(x,m+2,y).times(o+""),f=C(new x(r+"."+n.slice(1)),m-10).plus(u),x.precision=y,null==t?(i=!0,E(f,y)):f;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=v((f=f.times(e)).d)).charAt(0),p++;for(o=N(f),r>1?(f=new x("0."+n),o++):f=new x(r+"."+n.slice(1)),d=c=f=w(f.minus(a),f.plus(a),m),h=E(f.times(f),m),s=3;;){if(c=E(c.times(h),m),v((u=d.plus(w(c,new x(s),m))).d).slice(0,m)===v(d.d).slice(0,m))return d=d.times(2),0!==o&&(d=d.plus(k(x,m+2,y).times(o+""))),d=w(d,new x(p),m),x.precision=y,null==t?(i=!0,E(d,y)):d;d=u,s+=2}}function _(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);)++r;for(a=t.length;48===t.charCodeAt(a-1);)--a;if(t=t.slice(r,a)){if(a-=r,n=n-r-1,e.e=u(n/7),e.d=[],r=(n+1)%7,n<0&&(r+=7),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=7;r<a;)e.d.push(+t.slice(r,r+=7));r=7-(t=t.slice(r)).length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),i&&(e.e>g||e.e<-g))throw Error(d+n)}else e.s=0,e.e=0,e.d=[0];return e}function E(e,t,n){var r,a,s,o,l,c,h,f,x=e.d;for(o=1,s=x[0];s>=10;s/=10)o++;if((r=t-o)<0)r+=7,a=t,h=x[f=0];else{if((f=Math.ceil((r+1)/7))>=(s=x.length))return e;for(h=s=x[f],o=1;s>=10;s/=10)o++;a=(r%=7)-7+o}if(void 0!==n&&(l=h/(s=m(10,o-a-1))%10|0,c=t<0||void 0!==x[f+1]||h%s,c=n<4?(l||c)&&(0==n||n==(e.s<0?3:2)):l>5||5==l&&(4==n||c||6==n&&(r>0?a>0?h/m(10,o-a):0:x[f-1])%10&1||n==(e.s<0?8:7))),t<1||!x[0])return c?(s=N(e),x.length=1,t=t-s-1,x[0]=m(10,(7-t%7)%7),e.e=u(-t/7)||0):(x.length=1,x[0]=e.e=e.s=0),e;if(0==r?(x.length=f,s=1,f--):(x.length=f+1,s=m(10,7-r),x[f]=a>0?(h/m(10,o-a)%m(10,a)|0)*s:0),c)for(;;){if(0==f){(x[0]+=s)==p&&(x[0]=1,++e.e);break}if(x[f]+=s,x[f]!=p)break;x[f--]=0,s=1}for(r=x.length;0===x[--r];)x.pop();if(i&&(e.e>g||e.e<-g))throw Error(d+N(e));return e}function P(e,t){var n,r,a,s,o,l,c,d,u,m,h=e.constructor,f=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),i?E(t,f):t;if(c=e.d,m=t.d,r=t.e,d=e.e,c=c.slice(),o=d-r){for((u=o<0)?(n=c,o=-o,l=m.length):(n=m,r=d,l=c.length),o>(a=Math.max(Math.ceil(f/7),l)+2)&&(o=a,n.length=1),n.reverse(),a=o;a--;)n.push(0);n.reverse()}else{for((u=(a=c.length)<(l=m.length))&&(l=a),a=0;a<l;a++)if(c[a]!=m[a]){u=c[a]<m[a];break}o=0}for(u&&(n=c,c=m,m=n,t.s=-t.s),l=c.length,a=m.length-l;a>0;--a)c[l++]=0;for(a=m.length;a>o;){if(c[--a]<m[a]){for(s=a;s&&0===c[--s];)c[s]=p-1;--c[s],c[a]+=p}c[a]-=m[a]}for(;0===c[--l];)c.pop();for(;0===c[0];c.shift())--r;return c[0]?(t.d=c,t.e=r,i?E(t,f):t):new h(0)}function O(e,t,n){var r,a=N(e),s=v(e.d),o=s.length;return t?(n&&(r=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+S(r):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+S(-a-1)+s,n&&(r=n-o)>0&&(s+=S(r))):a>=o?(s+=S(a+1-o),n&&(r=n-a-1)>0&&(s=s+"."+S(r))):((r=a+1)<o&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-o)>0&&(a+1===o&&(s+="."),s+=S(r))),e.s<0?"-"+s:s}function A(e,t){if(e.length>t)return e.length=t,!0}function T(e){if(!e||"object"!==typeof e)throw Error(l+"Object expected");var t,n,r,a=["precision",1,s,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if(void 0!==(r=e[n=a[t]])){if(!(u(r)===r&&r>=a[t+1]&&r<=a[t+2]))throw Error(c+n+": "+r);this[n]=r}if(void 0!==(r=e[n="LN10"])){if(r!=Math.LN10)throw Error(c+n+": "+r);this[n]=new this(r)}return this}o=function e(t){var n,r,a;function s(e){var t=this;if(!(t instanceof s))return new s(e);if(t.constructor=s,e instanceof s)return t.s=e.s,t.e=e.e,void(t.d=(e=e.d)?e.slice():e);if("number"===typeof e){if(0*e!==0)throw Error(c+e);if(e>0)t.s=1;else{if(!(e<0))return t.s=0,t.e=0,void(t.d=[0]);e=-e,t.s=-1}return e===~~e&&e<1e7?(t.e=0,void(t.d=[e])):_(t,e.toString())}if("string"!==typeof e)throw Error(c+e);if(45===e.charCodeAt(0)?(e=e.slice(1),t.s=-1):t.s=1,!h.test(e))throw Error(c+e);_(t,e)}if(s.prototype=x,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=e,s.config=s.set=T,void 0===t&&(t={}),t)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<a.length;)t.hasOwnProperty(r=a[n++])||(t[r]=this[r]);return s.config(t),s}(o),o.default=o.Decimal=o,a=new o(1),void 0===(r=function(){return o}.call(t,n,t,e))||(e.exports=r)}()},8259:(e,t,n)=>{var r=n(5797);e.exports=function(e){var t=r(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}},8325:(e,t,n)=>{var r=n(2541),a=n(5654),s=n(3279),o=a?function(e,t){return a(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:s;e.exports=o},8468:(e,t,n)=>{var r=n(5816),a=n(644),s=n(4020);e.exports=function(e,t,n){return t===t?s(e,t,n):r(e,a,n)}},8541:(e,t,n)=>{var r=n(9812),a=n(149),s=n(4052),o=n(9841),i=r?r.prototype:void 0,l=i?i.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(s(t))return a(t,e)+"";if(o(t))return l?l.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},8673:(e,t,n)=>{var r=n(3204),a=n(3713),s=n(6571);e.exports=function(e){return s(e)?r(e):a(e)}},8724:(e,t,n)=>{var r=n(7615),a=n(5051),s=n(2154),o=n(8734),i=n(2662);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=a,l.prototype.get=s,l.prototype.has=o,l.prototype.set=i,e.exports=l},8734:(e,t,n)=>{var r=n(5575),a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:a.call(t,e)}},8853:(e,t,n)=>{"use strict";e.exports=n(7234)},8883:(e,t,n)=>{var r=n(5652),a=n(6571);e.exports=function(e,t){var n=-1,s=a(e)?Array(e.length):[];return r(e,function(e,r,a){s[++n]=t(e,r,a)}),s}},8895:e=>{e.exports=function(e,t){for(var n=-1,r=t.length,a=e.length;++n<r;)e[a+n]=t[n];return e}},8902:(e,t,n)=>{var r=n(4816),a=n(6179),s=n(6704);function o(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}o.prototype.add=o.prototype.push=a,o.prototype.has=s,e.exports=o},8990:(e,t,n)=>{var r=n(9995)(n(2520));e.exports=r},9057:(e,t,n)=>{var r=n(5324),a=n(2777),s=n(4052),o=n(9194),i=n(6173),l=n(914);e.exports=function(e,t,n){for(var c=-1,d=(t=r(t,e)).length,u=!1;++c<d;){var m=l(t[c]);if(!(u=null!=e&&n(e,m)))break;e=e[m]}return u||++c!=d?u:!!(d=null==e?0:e.length)&&i(d)&&o(m,d)&&(s(e)||a(e))}},9062:(e,t,n)=>{"use strict";e.exports=n(6378)},9096:(e,t,n)=>{var r=n(9256),a=n(5029),s=n(3279),o=n(4052),i=n(3932);e.exports=function(e){return"function"==typeof e?e:null==e?s:"object"==typeof e?o(e)?a(e[0],e[1]):r(e):i(e)}},9115:(e,t,n)=>{var r=n(5967),a=n(6311),s=n(715);e.exports=function(e){return a(e)?s(e):r(e)}},9140:(e,t,n)=>{var r=n(7303);e.exports=function(e){var t=r(e),n=t%1;return t===t?n?t-n:t:0}},9160:(e,t,n)=>{var r=n(6913),a=n(2761);e.exports=function(e){return"number"==typeof e||a(e)&&"[object Number]"==r(e)}},9194:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},9256:(e,t,n)=>{var r=n(6532),a=n(3781),s=n(1310);e.exports=function(e){var t=a(e);return 1==t.length&&t[0][2]?s(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},9364:(e,t,n)=>{var r=n(9742),a=n(9096),s=n(61);e.exports=function(e,t){return e&&e.length?r(e,a(t,2),s):void 0}},9394:(e,t,n)=>{var r=n(2622);e.exports=function(e){return r(this,e).has(e)}},9395:(e,t,n)=>{var r=n(4262),a=n(9621),s=n(8673);e.exports=function(e){return r(e,s,a)}},9417:(e,t,n)=>{var r=n(6686);e.exports=function(e){return e===e&&!r(e)}},9621:(e,t,n)=>{var r=n(7529),a=n(7828),s=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,i=o?function(e){return null==e?[]:(e=Object(e),r(o(e),function(t){return s.call(e,t)}))}:a;e.exports=i},9634:(e,t,n)=>{(()=>{var t={296:(e,t,n)=>{var r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,i=parseInt,l="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,c="object"==typeof self&&self&&self.Object===Object&&self,d=l||c||Function("return this")(),u=Object.prototype.toString,m=Math.max,h=Math.min,p=function(){return d.Date.now()};function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(f(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=f(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var n=s.test(e);return n||o.test(e)?i(e.slice(2),n?2:8):a.test(e)?NaN:+e}e.exports=function(e,t,n){var r,a,s,o,i,l,c=0,d=!1,u=!1,x=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=r,s=a;return r=a=void 0,c=t,o=e.apply(s,n)}function b(e){var n=e-l;return void 0===l||n>=t||n<0||u&&e-c>=s}function v(){var e=p();if(b(e))return w(e);i=setTimeout(v,function(e){var n=t-(e-l);return u?h(n,s-(e-c)):n}(e))}function w(e){return i=void 0,x&&r?y(e):(r=a=void 0,o)}function j(){var e=p(),n=b(e);if(r=arguments,a=this,l=e,n){if(void 0===i)return function(e){return c=e,i=setTimeout(v,t),d?y(e):o}(l);if(u)return i=setTimeout(v,t),y(l)}return void 0===i&&(i=setTimeout(v,t)),o}return t=g(t)||0,f(n)&&(d=!!n.leading,s=(u="maxWait"in n)?m(g(n.maxWait)||0,t):s,x="trailing"in n?!!n.trailing:x),j.cancel=function(){void 0!==i&&clearTimeout(i),c=0,r=l=a=i=void 0},j.flush=function(){return void 0===i?o:w(p())},j}},96:(e,t,n)=>{var r="Expected a function",a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,l=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,d="object"==typeof self&&self&&self.Object===Object&&self,u=c||d||Function("return this")(),m=Object.prototype.toString,h=Math.max,p=Math.min,f=function(){return u.Date.now()};function g(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function x(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==m.call(e)}(e))return NaN;if(g(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=g(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=o.test(e);return n||i.test(e)?l(e.slice(2),n?2:8):s.test(e)?NaN:+e}e.exports=function(e,t,n){var a=!0,s=!0;if("function"!=typeof e)throw new TypeError(r);return g(n)&&(a="leading"in n?!!n.leading:a,s="trailing"in n?!!n.trailing:s),function(e,t,n){var a,s,o,i,l,c,d=0,u=!1,m=!1,y=!0;if("function"!=typeof e)throw new TypeError(r);function b(t){var n=a,r=s;return a=s=void 0,d=t,i=e.apply(r,n)}function v(e){var n=e-c;return void 0===c||n>=t||n<0||m&&e-d>=o}function w(){var e=f();if(v(e))return j(e);l=setTimeout(w,function(e){var n=t-(e-c);return m?p(n,o-(e-d)):n}(e))}function j(e){return l=void 0,y&&a?b(e):(a=s=void 0,i)}function N(){var e=f(),n=v(e);if(a=arguments,s=this,c=e,n){if(void 0===l)return function(e){return d=e,l=setTimeout(w,t),u?b(e):i}(c);if(m)return l=setTimeout(w,t),b(c)}return void 0===l&&(l=setTimeout(w,t)),i}return t=x(t)||0,g(n)&&(u=!!n.leading,o=(m="maxWait"in n)?h(x(n.maxWait)||0,t):o,y="trailing"in n?!!n.trailing:y),N.cancel=function(){void 0!==l&&clearTimeout(l),d=0,a=c=s=l=void 0},N.flush=function(){return void 0===l?i:j(f())},N}(e,t,{leading:a,maxWait:t,trailing:s})}},703:(e,t,n)=>{"use strict";var r=n(414);function a(){}function s(){}s.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,s,o){if(o!==r){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:a};return n.PropTypes=n,n}},697:(e,t,n)=>{e.exports=n(703)()},414:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},r={};function a(e){var n=r[e];if(void 0!==n)return n.exports;var s=r[e]={exports:{}};return t[e](s,s.exports,a),s.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};(()=>{"use strict";a.r(s),a.d(s,{LazyLoadComponent:()=>q,LazyLoadImage:()=>te,trackWindowScroll:()=>D});const e=n(5043);var t=a.n(e),r=a(697);function o(){return"undefined"!=typeof window&&"IntersectionObserver"in window&&"isIntersecting"in window.IntersectionObserverEntry.prototype}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e,t,n){return(t=u(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e){if("object"!==i(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===i(t)?t:String(t)}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var p=function(e){e.forEach(function(e){e.isIntersecting&&e.target.onVisible()})},f={},g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(g,e);var n,r,a,s,u=(a=g,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=h(a);if(s){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function g(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),(t=u.call(this,e)).supportsObserver=!e.scrollPosition&&e.useIntersectionObserver&&o(),t.supportsObserver){var n=e.threshold;t.observer=function(e){return f[e]=f[e]||new IntersectionObserver(p,{rootMargin:e+"px"}),f[e]}(n)}return t}return n=g,r=[{key:"componentDidMount",value:function(){this.placeholder&&this.observer&&(this.placeholder.onVisible=this.props.onVisible,this.observer.observe(this.placeholder)),this.supportsObserver||this.updateVisibility()}},{key:"componentWillUnmount",value:function(){this.observer&&this.placeholder&&this.observer.unobserve(this.placeholder)}},{key:"componentDidUpdate",value:function(){this.supportsObserver||this.updateVisibility()}},{key:"getPlaceholderBoundingBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.scrollPosition,t=this.placeholder.getBoundingClientRect(),n=this.placeholder.style,r=parseInt(n.getPropertyValue("margin-left"),10)||0,a=parseInt(n.getPropertyValue("margin-top"),10)||0;return{bottom:e.y+t.bottom+a,left:e.x+t.left+r,right:e.x+t.right+r,top:e.y+t.top+a}}},{key:"isPlaceholderInViewport",value:function(){if("undefined"==typeof window||!this.placeholder)return!1;var e=this.props,t=e.scrollPosition,n=e.threshold,r=this.getPlaceholderBoundingBox(t),a=t.y+window.innerHeight,s=t.x,o=t.x+window.innerWidth,i=t.y;return Boolean(i-n<=r.bottom&&a+n>=r.top&&s-n<=r.right&&o+n>=r.left)}},{key:"updateVisibility",value:function(){this.isPlaceholderInViewport()&&this.props.onVisible()}},{key:"render",value:function(){var e=this,n=this.props,r=n.className,a=n.height,s=n.placeholder,o=n.style,i=n.width;if(s&&"function"!=typeof s.type)return t().cloneElement(s,{ref:function(t){return e.placeholder=t}});var d=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({display:"inline-block"},o);return void 0!==i&&(d.width=i),void 0!==a&&(d.height=a),t().createElement("span",{className:r,ref:function(t){return e.placeholder=t},style:d},s)}}],r&&d(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),g}(t().Component);g.propTypes={onVisible:r.PropTypes.func.isRequired,className:r.PropTypes.string,height:r.PropTypes.oneOfType([r.PropTypes.number,r.PropTypes.string]),placeholder:r.PropTypes.element,threshold:r.PropTypes.number,useIntersectionObserver:r.PropTypes.bool,scrollPosition:r.PropTypes.shape({x:r.PropTypes.number.isRequired,y:r.PropTypes.number.isRequired}),width:r.PropTypes.oneOfType([r.PropTypes.number,r.PropTypes.string])},g.defaultProps={className:"",placeholder:null,threshold:100,useIntersectionObserver:!0};const x=g;var y=a(296),b=a.n(y),v=a(96),w=a.n(v),j=function(e){var t=getComputedStyle(e,null);return t.getPropertyValue("overflow")+t.getPropertyValue("overflow-y")+t.getPropertyValue("overflow-x")};const N=function(e){if(!(e instanceof HTMLElement))return window;for(var t=e;t&&t instanceof HTMLElement;){if(/(scroll|auto)/.test(j(t)))return t;t=t.parentNode}return window};function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}var S=["delayMethod","delayTime"];function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},C.apply(this,arguments)}function _(e,t){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_(e,t)}function E(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return P(e)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},O(e)}var A=function(){return"undefined"==typeof window?0:window.scrollX||window.pageXOffset},T=function(){return"undefined"==typeof window?0:window.scrollY||window.pageYOffset};const D=function(e){var n=function(n){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}(c,n);var r,a,s,i,l=(s=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=O(s);if(i){var n=O(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return E(this,e)});function c(e){var n;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(n=l.call(this,e)).useIntersectionObserver=e.useIntersectionObserver&&o(),n.useIntersectionObserver)return E(n);var r=n.onChangeScroll.bind(P(n));return"debounce"===e.delayMethod?n.delayedScroll=b()(r,e.delayTime):"throttle"===e.delayMethod&&(n.delayedScroll=w()(r,e.delayTime)),n.state={scrollPosition:{x:A(),y:T()}},n.baseComponentRef=t().createRef(),n}return r=c,(a=[{key:"componentDidMount",value:function(){this.addListeners()}},{key:"componentWillUnmount",value:function(){this.removeListeners()}},{key:"componentDidUpdate",value:function(){"undefined"==typeof window||this.useIntersectionObserver||N(this.baseComponentRef.current)!==this.scrollElement&&(this.removeListeners(),this.addListeners())}},{key:"addListeners",value:function(){"undefined"==typeof window||this.useIntersectionObserver||(this.scrollElement=N(this.baseComponentRef.current),this.scrollElement.addEventListener("scroll",this.delayedScroll,{passive:!0}),window.addEventListener("resize",this.delayedScroll,{passive:!0}),this.scrollElement!==window&&window.addEventListener("scroll",this.delayedScroll,{passive:!0}))}},{key:"removeListeners",value:function(){"undefined"==typeof window||this.useIntersectionObserver||(this.scrollElement.removeEventListener("scroll",this.delayedScroll),window.removeEventListener("resize",this.delayedScroll),this.scrollElement!==window&&window.removeEventListener("scroll",this.delayedScroll))}},{key:"onChangeScroll",value:function(){this.useIntersectionObserver||this.setState({scrollPosition:{x:A(),y:T()}})}},{key:"render",value:function(){var n=this.props,r=(n.delayMethod,n.delayTime,function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(n,S)),a=this.useIntersectionObserver?null:this.state.scrollPosition;return t().createElement(e,C({forwardRef:this.baseComponentRef,scrollPosition:a},r))}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=function(e){if("object"!==k(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!==k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===k(a)?a:String(a)),r)}var a}(r.prototype,a),Object.defineProperty(r,"prototype",{writable:!1}),c}(t().Component);return n.propTypes={delayMethod:r.PropTypes.oneOf(["debounce","throttle"]),delayTime:r.PropTypes.number,useIntersectionObserver:r.PropTypes.bool},n.defaultProps={delayMethod:"throttle",delayTime:300,useIntersectionObserver:!0},n};function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(i,e);var n,r,a,s,o=(a=i,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=L(a);if(s){var n=L(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===M(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return n=i,(r=[{key:"render",value:function(){return t().createElement(x,this.props)}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=function(e){if("object"!==M(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!==M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===M(a)?a:String(a)),r)}var a}(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),i}(t().Component);const F=D(R);function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function U(e,t){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},U(e,t)}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V(e){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},V(e)}var W=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U(e,t)}(l,e);var n,r,a,s,i=(a=l,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=V(a);if(s){var n=V(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===B(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return z(e)}(this,e)});function l(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=i.call(this,e);var n=e.afterLoad,r=e.beforeLoad,a=e.scrollPosition,s=e.visibleByDefault;return t.state={visible:s},s&&(r(),n()),t.onVisible=t.onVisible.bind(z(t)),t.isScrollTracked=Boolean(a&&Number.isFinite(a.x)&&a.x>=0&&Number.isFinite(a.y)&&a.y>=0),t}return n=l,(r=[{key:"componentDidUpdate",value:function(e,t){t.visible!==this.state.visible&&this.props.afterLoad()}},{key:"onVisible",value:function(){this.props.beforeLoad(),this.setState({visible:!0})}},{key:"render",value:function(){if(this.state.visible)return this.props.children;var e=this.props,n=e.className,r=e.delayMethod,a=e.delayTime,s=e.height,i=e.placeholder,l=e.scrollPosition,c=e.style,d=e.threshold,u=e.useIntersectionObserver,m=e.width;return this.isScrollTracked||u&&o()?t().createElement(x,{className:n,height:s,onVisible:this.onVisible,placeholder:i,scrollPosition:l,style:c,threshold:d,useIntersectionObserver:u,width:m}):t().createElement(F,{className:n,delayMethod:r,delayTime:a,height:s,onVisible:this.onVisible,placeholder:i,style:c,threshold:d,width:m})}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=function(e){if("object"!==B(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!==B(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===B(a)?a:String(a)),r)}var a}(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),l}(t().Component);W.propTypes={afterLoad:r.PropTypes.func,beforeLoad:r.PropTypes.func,useIntersectionObserver:r.PropTypes.bool,visibleByDefault:r.PropTypes.bool},W.defaultProps={afterLoad:function(){return{}},beforeLoad:function(){return{}},useIntersectionObserver:!0,visibleByDefault:!1};const q=W;function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}var Y=["afterLoad","beforeLoad","delayMethod","delayTime","effect","placeholder","placeholderSrc","scrollPosition","threshold","useIntersectionObserver","visibleByDefault","wrapperClassName","wrapperProps"];function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach(function(t){$(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function $(e,t,n){return(t=J(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function K(){return K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},K.apply(this,arguments)}function J(e){var t=function(e){if("object"!==H(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!==H(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===H(t)?t:String(t)}function Q(e,t){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Q(e,t)}function Z(e){return Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Z(e)}var ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(i,e);var n,r,a,s,o=(a=i,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=Z(a);if(s){var n=Z(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===H(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={loaded:!1},t}return n=i,(r=[{key:"onImageLoad",value:function(){var e=this;return this.state.loaded?null:function(t){e.props.onLoad(t),e.props.afterLoad(),e.setState({loaded:!0})}}},{key:"getImg",value:function(){var e=this.props,n=(e.afterLoad,e.beforeLoad,e.delayMethod,e.delayTime,e.effect,e.placeholder,e.placeholderSrc,e.scrollPosition,e.threshold,e.useIntersectionObserver,e.visibleByDefault,e.wrapperClassName,e.wrapperProps,function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,Y));return t().createElement("img",K({},n,{onLoad:this.onImageLoad()}))}},{key:"getLazyLoadImage",value:function(){var e=this.props,n=e.beforeLoad,r=e.className,a=e.delayMethod,s=e.delayTime,o=e.height,i=e.placeholder,l=e.scrollPosition,c=e.style,d=e.threshold,u=e.useIntersectionObserver,m=e.visibleByDefault,h=e.width;return t().createElement(q,{beforeLoad:n,className:r,delayMethod:a,delayTime:s,height:o,placeholder:i,scrollPosition:l,style:c,threshold:d,useIntersectionObserver:u,visibleByDefault:m,width:h},this.getImg())}},{key:"getWrappedLazyLoadImage",value:function(e){var n=this.props,r=n.effect,a=n.height,s=n.placeholderSrc,o=n.width,i=n.wrapperClassName,l=n.wrapperProps,c=this.state.loaded,d=c?" lazy-load-image-loaded":"",u=c||!s?{}:{backgroundImage:"url(".concat(s,")"),backgroundSize:"100% 100%"};return t().createElement("span",K({className:i+" lazy-load-image-background "+r+d,style:X(X({},u),{},{color:"transparent",display:"inline-block",height:a,width:o})},l),e)}},{key:"render",value:function(){var e=this.props,t=e.effect,n=e.placeholderSrc,r=e.visibleByDefault,a=e.wrapperClassName,s=e.wrapperProps,o=this.getLazyLoadImage();return(t||n)&&!r||a||s?this.getWrappedLazyLoadImage(o):o}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,J(r.key),r)}}(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),i}(t().Component);ee.propTypes={onLoad:r.PropTypes.func,afterLoad:r.PropTypes.func,beforeLoad:r.PropTypes.func,delayMethod:r.PropTypes.string,delayTime:r.PropTypes.number,effect:r.PropTypes.string,placeholderSrc:r.PropTypes.string,threshold:r.PropTypes.number,useIntersectionObserver:r.PropTypes.bool,visibleByDefault:r.PropTypes.bool,wrapperClassName:r.PropTypes.string,wrapperProps:r.PropTypes.object},ee.defaultProps={onLoad:function(){},afterLoad:function(){return{}},beforeLoad:function(){return{}},delayMethod:"throttle",delayTime:300,effect:"",placeholderSrc:null,threshold:100,useIntersectionObserver:!0,visibleByDefault:!1,wrapperClassName:""};const te=ee})(),e.exports=s})()},9676:e=>{var t=Math.ceil,n=Math.max;e.exports=function(e,r,a,s){for(var o=-1,i=n(t((r-e)/(a||1)),0),l=Array(i);i--;)l[s?i:++o]=e,e+=a;return l}},9686:e=>{e.exports=function(e){return null==e}},9742:(e,t,n)=>{var r=n(9841);e.exports=function(e,t,n){for(var a=-1,s=e.length;++a<s;){var o=e[a],i=t(o);if(null!=i&&(void 0===l?i===i&&!r(i):n(i,l)))var l=i,c=o}return c}},9812:(e,t,n)=>{var r=n(6552).Symbol;e.exports=r},9841:(e,t,n)=>{var r=n(6913),a=n(2761);e.exports=function(e){return"symbol"==typeof e||a(e)&&"[object Symbol]"==r(e)}},9853:(e,t,n)=>{var r=n(6989);e.exports=function(e,t){return r(e,t)}},9889:(e,t,n)=>{var r=n(3950),a=n(6686);e.exports=function(e,t,n){var s=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return a(n)&&(s="leading"in n?!!n.leading:s,o="trailing"in n?!!n.trailing:o),r(e,t,{leading:s,maxWait:t,trailing:o})}},9935:(e,t,n)=>{var r=n(1340),a=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():a.call(t,n,1),--this.size,!0)}},9987:(e,t,n)=>{var r=n(9812),a=n(2929),s=n(3211),o=n(3668),i=n(4160),l=n(2074),c=r?r.prototype:void 0,d=c?c.valueOf:void 0;e.exports=function(e,t,n,r,c,u,m){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!u(new a(e),new a(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return s(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var h=i;case"[object Set]":var p=1&r;if(h||(h=l),e.size!=t.size&&!p)return!1;var f=m.get(e);if(f)return f==t;r|=2,m.set(e,t);var g=o(h(e),h(t),r,c,u,m);return m.delete(e),g;case"[object Symbol]":if(d)return d.call(e)==d.call(t)}return!1}},9995:(e,t,n)=>{var r=n(9096),a=n(6571),s=n(8673);e.exports=function(e){return function(t,n,o){var i=Object(t);if(!a(t)){var l=r(n,3);t=s(t),n=function(e){return l(i[e],e,i)}}var c=e(t,n,o);return c>-1?i[l?t[c]:c]:void 0}}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var i=2&a&&r;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach(e=>o[e]=()=>r[e]);return o.default=()=>r,n.d(s,o),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";var e={};n.r(e),n.d(e,{hasBrowserEnv:()=>Kt,hasStandardBrowserEnv:()=>Qt,hasStandardBrowserWebWorkerEnv:()=>Zt,navigator:()=>Jt,origin:()=>en});var t={};n.r(t),n.d(t,{Decoder:()=>Fa,Encoder:()=>La,PacketType:()=>Ia,protocol:()=>Ma});var r={};n.r(r),n.d(r,{scaleBand:()=>cg,scaleDiverging:()=>Uw,scaleDivergingLog:()=>zw,scaleDivergingPow:()=>Ww,scaleDivergingSqrt:()=>qw,scaleDivergingSymlog:()=>Vw,scaleIdentity:()=>My,scaleImplicit:()=>ig,scaleLinear:()=>Dy,scaleLog:()=>Wy,scaleOrdinal:()=>lg,scalePoint:()=>ug,scalePow:()=>Qy,scaleQuantile:()=>db,scaleQuantize:()=>ub,scaleRadial:()=>tb,scaleSequential:()=>Dw,scaleSequentialLog:()=>Mw,scaleSequentialPow:()=>Lw,scaleSequentialQuantile:()=>Fw,scaleSequentialSqrt:()=>Rw,scaleSequentialSymlog:()=>Iw,scaleSqrt:()=>Zy,scaleSymlog:()=>Gy,scaleThreshold:()=>mb,scaleTime:()=>Pw,scaleUtc:()=>Ow,tickFormat:()=>Ay});var a,s=n(5043),o=n.t(s,2),i=n(4391);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(a||(a={}));function c(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function d(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function u(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function m(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}var h;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(h||(h={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function p(e,t,n){return void 0===n&&(n="/"),f(e,t,n,!1)}function f(e,t,n,r){let a=P(("string"===typeof t?m(t):t).pathname||"/",n);if(null==a)return null;let s=g(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let o=null;for(let i=0;null==o&&i<s.length;++i){let e=E(a);o=C(s[i],e,r)}return o}function g(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let a=(e,a,s)=>{let o={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};o.relativePath.startsWith("/")&&(c(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));let i=M([r,o.relativePath]),l=n.concat(o);e.children&&e.children.length>0&&(c(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+i+'".'),g(e.children,t,l,i)),(null!=e.path||e.index)&&t.push({path:i,score:S(i,e.index),routesMeta:l})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of x(e.path))a(e,t,r);else a(e,t)}),t}function x(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===r.length)return a?[s,""]:[s];let o=x(r.join("/")),i=[];return i.push(...o.map(e=>""===e?s:[s,e].join("/"))),a&&i.push(...o),i.map(t=>e.startsWith("/")&&""===t?"/":t)}const y=/^:[\w-]+$/,b=3,v=2,w=1,j=10,N=-2,k=e=>"*"===e;function S(e,t){let n=e.split("/"),r=n.length;return n.some(k)&&(r+=N),t&&(r+=v),n.filter(e=>!k(e)).reduce((e,t)=>e+(y.test(t)?b:""===t?w:j),r)}function C(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,a={},s="/",o=[];for(let i=0;i<r.length;++i){let e=r[i],l=i===r.length-1,c="/"===s?t:t.slice(s.length)||"/",d=_({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=_({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(a,d.params),o.push({params:a,pathname:M([s,d.pathname]),pathnameBase:I(M([s,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(s=M([s,d.pathnameBase]))}return o}function _(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);d("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let s=new RegExp(a,t?void 0:"i");return[s,r]}(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let s=a[0],o=s.replace(/(.)\/+$/,"$1"),i=a.slice(1),l=r.reduce((e,t,n)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=i[n]||"";o=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=i[n];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{});return{params:l,pathname:s,pathnameBase:o,pattern:e}}function E(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return d(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function P(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function O(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function A(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function T(e,t){let n=A(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function D(e,t,n,r){let a;void 0===r&&(r=!1),"string"===typeof e?a=m(e):(a=l({},e),c(!a.pathname||!a.pathname.includes("?"),O("?","pathname","search",a)),c(!a.pathname||!a.pathname.includes("#"),O("#","pathname","hash",a)),c(!a.search||!a.search.includes("#"),O("#","search","hash",a)));let s,o=""===e||""===a.pathname,i=o?"/":a.pathname;if(null==i)s=n;else{let e=t.length-1;if(!r&&i.startsWith("..")){let t=i.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}s=e>=0?t[e]:"/"}let d=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:a=""}="string"===typeof e?m(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:L(r),hash:R(a)}}(a,s),u=i&&"/"!==i&&i.endsWith("/"),h=(o||"."===i)&&n.endsWith("/");return d.pathname.endsWith("/")||!u&&!h||(d.pathname+="/"),d}const M=e=>e.join("/").replace(/\/\/+/g,"/"),I=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),L=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",R=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function F(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const B=["post","put","patch","delete"],U=(new Set(B),["get",...B]);new Set(U),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function z(){return z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},z.apply(this,arguments)}const V=s.createContext(null);const W=s.createContext(null);const q=s.createContext(null);const H=s.createContext(null);const Y=s.createContext({outlet:null,matches:[],isDataRoute:!1});const G=s.createContext(null);function X(){return null!=s.useContext(H)}function $(){return X()||c(!1),s.useContext(H).location}function K(e){s.useContext(q).static||s.useLayoutEffect(e)}function J(){let{isDataRoute:e}=s.useContext(Y);return e?function(){let{router:e}=le(oe.UseNavigateStable),t=de(ie.UseNavigateStable),n=s.useRef(!1);K(()=>{n.current=!0});let r=s.useCallback(function(r,a){void 0===a&&(a={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,z({fromRouteId:t},a)))},[e,t]);return r}():function(){X()||c(!1);let e=s.useContext(V),{basename:t,future:n,navigator:r}=s.useContext(q),{matches:a}=s.useContext(Y),{pathname:o}=$(),i=JSON.stringify(T(a,n.v7_relativeSplatPath)),l=s.useRef(!1);K(()=>{l.current=!0});let d=s.useCallback(function(n,a){if(void 0===a&&(a={}),!l.current)return;if("number"===typeof n)return void r.go(n);let s=D(n,JSON.parse(i),o,"path"===a.relative);null==e&&"/"!==t&&(s.pathname="/"===s.pathname?t:M([t,s.pathname])),(a.replace?r.replace:r.push)(s,a.state,a)},[t,r,i,o,e]);return d}()}function Q(){let{matches:e}=s.useContext(Y),t=e[e.length-1];return t?t.params:{}}function Z(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=s.useContext(q),{matches:a}=s.useContext(Y),{pathname:o}=$(),i=JSON.stringify(T(a,r.v7_relativeSplatPath));return s.useMemo(()=>D(e,JSON.parse(i),o,"path"===n),[e,i,o,n])}function ee(e,t,n,r){X()||c(!1);let{navigator:o}=s.useContext(q),{matches:i}=s.useContext(Y),l=i[i.length-1],d=l?l.params:{},u=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let h,f=$();if(t){var g;let e="string"===typeof t?m(t):t;"/"===u||(null==(g=e.pathname)?void 0:g.startsWith(u))||c(!1),h=e}else h=f;let x=h.pathname||"/",y=x;if("/"!==u){let e=u.replace(/^\//,"").split("/");y="/"+x.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=p(e,{pathname:y});let v=se(b&&b.map(e=>Object.assign({},e,{params:Object.assign({},d,e.params),pathname:M([u,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:M([u,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),i,n,r);return t&&v?s.createElement(H.Provider,{value:{location:z({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:a.Pop}},v):v}function te(){let e=function(){var e;let t=s.useContext(G),n=ce(ie.UseRouteError),r=de(ie.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=F(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r};return s.createElement(s.Fragment,null,s.createElement("h2",null,"Unexpected Application Error!"),s.createElement("h3",{style:{fontStyle:"italic"}},t),n?s.createElement("pre",{style:a},n):null,null)}const ne=s.createElement(te,null);class re extends s.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?s.createElement(Y.Provider,{value:this.props.routeContext},s.createElement(G.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ae(e){let{routeContext:t,match:n,children:r}=e,a=s.useContext(V);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),s.createElement(Y.Provider,{value:t},r)}function se(e,t,n,r){var a;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var o;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(o=r)&&o.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let i=e,l=null==(a=n)?void 0:a.errors;if(null!=l){let e=i.findIndex(e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id]));e>=0||c(!1),i=i.slice(0,Math.min(i.length,e+1))}let d=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let s=0;s<i.length;s++){let e=i[s];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=s),e.route.id){let{loaderData:t,errors:r}=n,a=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||a){d=!0,i=u>=0?i.slice(0,u+1):[i[0]];break}}}return i.reduceRight((e,r,a)=>{let o,c=!1,m=null,h=null;var p;n&&(o=l&&r.route.id?l[r.route.id]:void 0,m=r.route.errorElement||ne,d&&(u<0&&0===a?(p="route-fallback",!1||ue[p]||(ue[p]=!0),c=!0,h=null):u===a&&(c=!0,h=r.route.hydrateFallbackElement||null)));let f=t.concat(i.slice(0,a+1)),g=()=>{let t;return t=o?m:c?h:r.route.Component?s.createElement(r.route.Component,null):r.route.element?r.route.element:e,s.createElement(ae,{match:r,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===a)?s.createElement(re,{location:n.location,revalidation:n.revalidation,component:m,error:o,children:g(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):g()},null)}var oe=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(oe||{}),ie=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ie||{});function le(e){let t=s.useContext(V);return t||c(!1),t}function ce(e){let t=s.useContext(W);return t||c(!1),t}function de(e){let t=function(){let e=s.useContext(Y);return e||c(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||c(!1),n.route.id}const ue={};function me(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}o.startTransition;function he(e){let{to:t,replace:n,state:r,relative:a}=e;X()||c(!1);let{future:o,static:i}=s.useContext(q),{matches:l}=s.useContext(Y),{pathname:d}=$(),u=J(),m=D(t,T(l,o.v7_relativeSplatPath),d,"path"===a),h=JSON.stringify(m);return s.useEffect(()=>u(JSON.parse(h),{replace:n,state:r,relative:a}),[u,h,a,n,r]),null}function pe(e){c(!1)}function fe(e){let{basename:t="/",children:n=null,location:r,navigationType:o=a.Pop,navigator:i,static:l=!1,future:d}=e;X()&&c(!1);let u=t.replace(/^\/*/,"/"),h=s.useMemo(()=>({basename:u,navigator:i,static:l,future:z({v7_relativeSplatPath:!1},d)}),[u,d,i,l]);"string"===typeof r&&(r=m(r));let{pathname:p="/",search:f="",hash:g="",state:x=null,key:y="default"}=r,b=s.useMemo(()=>{let e=P(p,u);return null==e?null:{location:{pathname:e,search:f,hash:g,state:x,key:y},navigationType:o}},[u,p,f,g,x,y,o]);return null==b?null:s.createElement(q.Provider,{value:h},s.createElement(H.Provider,{children:n,value:b}))}function ge(e){let{children:t,location:n}=e;return ee(xe(t),n)}new Promise(()=>{});s.Component;function xe(e,t){void 0===t&&(t=[]);let n=[];return s.Children.forEach(e,(e,r)=>{if(!s.isValidElement(e))return;let a=[...t,r];if(e.type===s.Fragment)return void n.push.apply(n,xe(e.props.children,a));e.type!==pe&&c(!1),e.props.index&&e.props.children&&c(!1);let o={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=xe(e.props.children,a)),n.push(o)}),n}var ye=n(7950),be=n.t(ye,2);function ve(){return ve=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ve.apply(this,arguments)}function we(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}function je(e){return void 0===e&&(e=""),new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(e=>[n,e]):[[n,r]])},[]))}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const Ne=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(FB){}new Map;const ke=o.startTransition;be.flushSync,o.useId;function Se(e){let{basename:t,children:n,future:r,history:a}=e,[o,i]=s.useState({action:a.action,location:a.location}),{v7_startTransition:l}=r||{},c=s.useCallback(e=>{l&&ke?ke(()=>i(e)):i(e)},[i,l]);return s.useLayoutEffect(()=>a.listen(c),[a,c]),s.useEffect(()=>me(r),[r]),s.createElement(fe,{basename:t,children:n,location:o.location,navigationType:o.action,navigator:a,future:r})}const Ce="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,_e=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ee=s.forwardRef(function(e,t){let n,{onClick:r,relative:a,reloadDocument:o,replace:i,state:l,target:d,to:m,preventScrollReset:h,viewTransition:p}=e,f=we(e,Ne),{basename:g}=s.useContext(q),x=!1;if("string"===typeof m&&_e.test(m)&&(n=m,Ce))try{let e=new URL(window.location.href),t=m.startsWith("//")?new URL(e.protocol+m):new URL(m),n=P(t.pathname,g);t.origin===e.origin&&null!=n?m=n+t.search+t.hash:x=!0}catch(FB){}let y=function(e,t){let{relative:n}=void 0===t?{}:t;X()||c(!1);let{basename:r,navigator:a}=s.useContext(q),{hash:o,pathname:i,search:l}=Z(e,{relative:n}),d=i;return"/"!==r&&(d="/"===i?r:M([r,i])),a.createHref({pathname:d,search:l,hash:o})}(m,{relative:a}),b=function(e,t){let{target:n,replace:r,state:a,preventScrollReset:o,relative:i,viewTransition:l}=void 0===t?{}:t,c=J(),d=$(),m=Z(e,{relative:i});return s.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:u(d)===u(m);c(e,{replace:n,state:a,preventScrollReset:o,relative:i,viewTransition:l})}},[d,c,m,r,a,n,e,o,i,l])}(m,{replace:i,state:l,target:d,preventScrollReset:h,relative:a,viewTransition:p});return s.createElement("a",ve({},f,{href:n||y,onClick:x||o?r:function(e){r&&r(e),e.defaultPrevented||b(e)},ref:t,target:d}))});var Pe,Oe;function Ae(e){let t=s.useRef(je(e)),n=s.useRef(!1),r=$(),a=s.useMemo(()=>function(e,t){let n=je(e);return t&&t.forEach((e,r)=>{n.has(r)||t.getAll(r).forEach(e=>{n.append(r,e)})}),n}(r.search,n.current?null:t.current),[r.search]),o=J(),i=s.useCallback((e,t)=>{const r=je("function"===typeof e?e(a):e);n.current=!0,o("?"+r,t)},[o,a]);return[a,i]}(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Pe||(Pe={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Oe||(Oe={}));function Te(){return Te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Te.apply(null,arguments)}var De;!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(De||(De={}));var Me=function(e){return e};var Ie="beforeunload",Le="popstate";function Re(e){e.preventDefault(),e.returnValue=""}function Fe(){var e=[];return{get length(){return e.length},push:function(t){return e.push(t),function(){e=e.filter(function(e){return e!==t})}},call:function(t){e.forEach(function(e){return e&&e(t)})}}}function Be(){return Math.random().toString(36).substr(2,8)}function Ue(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,a=void 0===r?"":r,s=e.hash,o=void 0===s?"":s;return a&&"?"!==a&&(n+="?"===a.charAt(0)?a:"?"+a),o&&"#"!==o&&(n+="#"===o.charAt(0)?o:"#"+o),n}function ze(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function Ve(e){return Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ve(e)}function We(e){var t=function(e,t){if("object"!=Ve(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Ve(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ve(t)?t:t+""}function qe(e,t,n){return(t=We(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(Object(n),!0).forEach(function(t){qe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ge(e,t){return function(){return e.apply(t,arguments)}}const{toString:Xe}=Object.prototype,{getPrototypeOf:$e}=Object,{iterator:Ke,toStringTag:Je}=Symbol,Qe=(e=>t=>{const n=Xe.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ze=e=>(e=e.toLowerCase(),t=>Qe(t)===e),et=e=>t=>typeof t===e,{isArray:tt}=Array,nt=et("undefined");const rt=Ze("ArrayBuffer");const at=et("string"),st=et("function"),ot=et("number"),it=e=>null!==e&&"object"===typeof e,lt=e=>{if("object"!==Qe(e))return!1;const t=$e(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Je in e)&&!(Ke in e)},ct=Ze("Date"),dt=Ze("File"),ut=Ze("Blob"),mt=Ze("FileList"),ht=Ze("URLSearchParams"),[pt,ft,gt,xt]=["ReadableStream","Request","Response","Headers"].map(Ze);function yt(e,t){let n,r,{allOwnKeys:a=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),tt(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{const r=a?Object.getOwnPropertyNames(e):Object.keys(e),s=r.length;let o;for(n=0;n<s;n++)o=r[n],t.call(null,e[o],o,e)}}function bt(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,a=n.length;for(;a-- >0;)if(r=n[a],t===r.toLowerCase())return r;return null}const vt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,wt=e=>!nt(e)&&e!==vt;const jt=(Nt="undefined"!==typeof Uint8Array&&$e(Uint8Array),e=>Nt&&e instanceof Nt);var Nt;const kt=Ze("HTMLFormElement"),St=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),Ct=Ze("RegExp"),_t=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};yt(n,(n,a)=>{let s;!1!==(s=t(n,a,e))&&(r[a]=s||n)}),Object.defineProperties(e,r)};const Et=Ze("AsyncFunction"),Pt=((e,t)=>{return e?setImmediate:t?(n="axios@".concat(Math.random()),r=[],vt.addEventListener("message",e=>{let{source:t,data:a}=e;t===vt&&a===n&&r.length&&r.shift()()},!1),e=>{r.push(e),vt.postMessage(n,"*")}):e=>setTimeout(e);var n,r})("function"===typeof setImmediate,st(vt.postMessage)),Ot="undefined"!==typeof queueMicrotask?queueMicrotask.bind(vt):"undefined"!==typeof process&&process.nextTick||Pt,At={isArray:tt,isArrayBuffer:rt,isBuffer:function(e){return null!==e&&!nt(e)&&null!==e.constructor&&!nt(e.constructor)&&st(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||st(e.append)&&("formdata"===(t=Qe(e))||"object"===t&&st(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&rt(e.buffer),t},isString:at,isNumber:ot,isBoolean:e=>!0===e||!1===e,isObject:it,isPlainObject:lt,isReadableStream:pt,isRequest:ft,isResponse:gt,isHeaders:xt,isUndefined:nt,isDate:ct,isFile:dt,isBlob:ut,isRegExp:Ct,isFunction:st,isStream:e=>it(e)&&st(e.pipe),isURLSearchParams:ht,isTypedArray:jt,isFileList:mt,forEach:yt,merge:function e(){const{caseless:t}=wt(this)&&this||{},n={},r=(r,a)=>{const s=t&&bt(n,a)||a;lt(n[s])&&lt(r)?n[s]=e(n[s],r):lt(r)?n[s]=e({},r):tt(r)?n[s]=r.slice():n[s]=r};for(let a=0,s=arguments.length;a<s;a++)arguments[a]&&yt(arguments[a],r);return n},extend:function(e,t,n){let{allOwnKeys:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return yt(t,(t,r)=>{n&&st(t)?e[r]=Ge(t,n):e[r]=t},{allOwnKeys:r}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let a,s,o;const i={};if(t=t||{},null==e)return t;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)o=a[s],r&&!r(o,e,t)||i[o]||(t[o]=e[o],i[o]=!0);e=!1!==n&&$e(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:Qe,kindOfTest:Ze,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(tt(e))return e;let t=e.length;if(!ot(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Ke]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:kt,hasOwnProperty:St,hasOwnProp:St,reduceDescriptors:_t,freezeMethods:e=>{_t(e,(t,n)=>{if(st(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];st(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach(e=>{n[e]=!0})};return tt(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,n){return t.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:bt,global:vt,isContextDefined:wt,isSpecCompliantForm:function(e){return!!(e&&st(e.append)&&"FormData"===e[Je]&&e[Ke])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(it(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const a=tt(e)?[]:{};return yt(e,(e,t)=>{const s=n(e,r+1);!nt(s)&&(a[t]=s)}),t[r]=void 0,a}}return e};return n(e,0)},isAsyncFn:Et,isThenable:e=>e&&(it(e)||st(e))&&st(e.then)&&st(e.catch),setImmediate:Pt,asap:Ot,isIterable:e=>null!=e&&st(e[Ke])};function Tt(e,t,n,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}At.inherits(Tt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:At.toJSONObject(this.config),code:this.code,status:this.status}}});const Dt=Tt.prototype,Mt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Mt[e]={value:e}}),Object.defineProperties(Tt,Mt),Object.defineProperty(Dt,"isAxiosError",{value:!0}),Tt.from=(e,t,n,r,a,s)=>{const o=Object.create(Dt);return At.toFlatObject(e,o,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e),Tt.call(o,e.message,t,n,r,a),o.cause=e,o.name=e.name,s&&Object.assign(o,s),o};const It=Tt;function Lt(e){return At.isPlainObject(e)||At.isArray(e)}function Rt(e){return At.endsWith(e,"[]")?e.slice(0,-2):e}function Ft(e,t,n){return e?e.concat(t).map(function(e,t){return e=Rt(e),!n&&t?"["+e+"]":e}).join(n?".":""):t}const Bt=At.toFlatObject(At,{},null,function(e){return/^is[A-Z]/.test(e)});const Ut=function(e,t,n){if(!At.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=At.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!At.isUndefined(t[e])})).metaTokens,a=n.visitor||c,s=n.dots,o=n.indexes,i=(n.Blob||"undefined"!==typeof Blob&&Blob)&&At.isSpecCompliantForm(t);if(!At.isFunction(a))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(At.isDate(e))return e.toISOString();if(At.isBoolean(e))return e.toString();if(!i&&At.isBlob(e))throw new It("Blob is not supported. Use a Buffer instead.");return At.isArrayBuffer(e)||At.isTypedArray(e)?i&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,a){let i=e;if(e&&!a&&"object"===typeof e)if(At.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(At.isArray(e)&&function(e){return At.isArray(e)&&!e.some(Lt)}(e)||(At.isFileList(e)||At.endsWith(n,"[]"))&&(i=At.toArray(e)))return n=Rt(n),i.forEach(function(e,r){!At.isUndefined(e)&&null!==e&&t.append(!0===o?Ft([n],r,s):null===o?n:n+"[]",l(e))}),!1;return!!Lt(e)||(t.append(Ft(a,n,s),l(e)),!1)}const d=[],u=Object.assign(Bt,{defaultVisitor:c,convertValue:l,isVisitable:Lt});if(!At.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!At.isUndefined(n)){if(-1!==d.indexOf(n))throw Error("Circular reference detected in "+r.join("."));d.push(n),At.forEach(n,function(n,s){!0===(!(At.isUndefined(n)||null===n)&&a.call(t,n,At.isString(s)?s.trim():s,r,u))&&e(n,r?r.concat(s):[s])}),d.pop()}}(e),t};function zt(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function Vt(e,t){this._pairs=[],e&&Ut(e,this,t)}const Wt=Vt.prototype;Wt.append=function(e,t){this._pairs.push([e,t])},Wt.toString=function(e){const t=e?function(t){return e.call(this,t,zt)}:zt;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const qt=Vt;function Ht(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Yt(e,t,n){if(!t)return e;const r=n&&n.encode||Ht;At.isFunction(n)&&(n={serialize:n});const a=n&&n.serialize;let s;if(s=a?a(t,n):At.isURLSearchParams(t)?t.toString():new qt(t,n).toString(r),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}const Gt=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){At.forEach(this.handlers,function(t){null!==t&&e(t)})}},Xt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},$t={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:qt,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Kt="undefined"!==typeof window&&"undefined"!==typeof document,Jt="object"===typeof navigator&&navigator||void 0,Qt=Kt&&(!Jt||["ReactNative","NativeScript","NS"].indexOf(Jt.product)<0),Zt="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,en=Kt&&window.location.href||"http://localhost",tn=Ye(Ye({},e),$t);const nn=function(e){function t(e,n,r,a){let s=e[a++];if("__proto__"===s)return!0;const o=Number.isFinite(+s),i=a>=e.length;if(s=!s&&At.isArray(r)?r.length:s,i)return At.hasOwnProp(r,s)?r[s]=[r[s],n]:r[s]=n,!o;r[s]&&At.isObject(r[s])||(r[s]=[]);return t(e,n,r[s],a)&&At.isArray(r[s])&&(r[s]=function(e){const t={},n=Object.keys(e);let r;const a=n.length;let s;for(r=0;r<a;r++)s=n[r],t[s]=e[s];return t}(r[s])),!o}if(At.isFormData(e)&&At.isFunction(e.entries)){const n={};return At.forEachEntry(e,(e,r)=>{t(function(e){return At.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),r,n,0)}),n}return null};const rn={transitional:Xt,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,a=At.isObject(e);a&&At.isHTMLForm(e)&&(e=new FormData(e));if(At.isFormData(e))return r?JSON.stringify(nn(e)):e;if(At.isArrayBuffer(e)||At.isBuffer(e)||At.isStream(e)||At.isFile(e)||At.isBlob(e)||At.isReadableStream(e))return e;if(At.isArrayBufferView(e))return e.buffer;if(At.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Ut(e,new tn.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return tn.isNode&&At.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((s=At.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Ut(s?{"files[]":e}:e,t&&new t,this.formSerializer)}}return a||r?(t.setContentType("application/json",!1),function(e,t,n){if(At.isString(e))try{return(t||JSON.parse)(e),At.trim(e)}catch(FB){if("SyntaxError"!==FB.name)throw FB}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||rn.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(At.isResponse(e)||At.isReadableStream(e))return e;if(e&&At.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(FB){if(n){if("SyntaxError"===FB.name)throw It.from(FB,It.ERR_BAD_RESPONSE,this,null,this.response);throw FB}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:tn.classes.FormData,Blob:tn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};At.forEach(["delete","get","head","post","put","patch"],e=>{rn.headers[e]={}});const an=rn,sn=At.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),on=Symbol("internals");function ln(e){return e&&String(e).trim().toLowerCase()}function cn(e){return!1===e||null==e?e:At.isArray(e)?e.map(cn):String(e)}function dn(e,t,n,r,a){return At.isFunction(r)?r.call(this,t,n):(a&&(t=n),At.isString(t)?At.isString(r)?-1!==t.indexOf(r):At.isRegExp(r)?r.test(t):void 0:void 0)}class un{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function a(e,t,n){const a=ln(t);if(!a)throw new Error("header name must be a non-empty string");const s=At.findKey(r,a);(!s||void 0===r[s]||!0===n||void 0===n&&!1!==r[s])&&(r[s||t]=cn(e))}const s=(e,t)=>At.forEach(e,(e,n)=>a(e,n,t));if(At.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(At.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))s((e=>{const t={};let n,r,a;return e&&e.split("\n").forEach(function(e){a=e.indexOf(":"),n=e.substring(0,a).trim().toLowerCase(),r=e.substring(a+1).trim(),!n||t[n]&&sn[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t})(e),t);else if(At.isObject(e)&&At.isIterable(e)){let n,r,a={};for(const t of e){if(!At.isArray(t))throw TypeError("Object iterator must return a key-value pair");a[r=t[0]]=(n=a[r])?At.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}s(a,t)}else null!=e&&a(t,e,n);return this}get(e,t){if(e=ln(e)){const n=At.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(At.isFunction(t))return t.call(this,e,n);if(At.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=ln(e)){const n=At.findKey(this,e);return!(!n||void 0===this[n]||t&&!dn(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function a(e){if(e=ln(e)){const a=At.findKey(n,e);!a||t&&!dn(0,n[a],a,t)||(delete n[a],r=!0)}}return At.isArray(e)?e.forEach(a):a(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const a=t[n];e&&!dn(0,this[a],a,e,!0)||(delete this[a],r=!0)}return r}normalize(e){const t=this,n={};return At.forEach(this,(r,a)=>{const s=At.findKey(n,a);if(s)return t[s]=cn(r),void delete t[a];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}(a):String(a).trim();o!==a&&delete t[a],t[o]=cn(r),n[o]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return At.forEach(this,(n,r)=>{null!=n&&!1!==n&&(t[r]=e&&At.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,n]=e;return t+": "+n}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[on]=this[on]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=ln(e);t[r]||(!function(e,t){const n=At.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(e,n,a){return this[r].call(this,t,e,n,a)},configurable:!0})})}(n,e),t[r]=!0)}return At.isArray(e)?e.forEach(r):r(e),this}}un.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),At.reduceDescriptors(un.prototype,(e,t)=>{let{value:n}=e,r=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[r]=e}}}),At.freezeMethods(un);const mn=un;function hn(e,t){const n=this||an,r=t||n,a=mn.from(r.headers);let s=r.data;return At.forEach(e,function(e){s=e.call(n,s,a.normalize(),t?t.status:void 0)}),a.normalize(),s}function pn(e){return!(!e||!e.__CANCEL__)}function fn(e,t,n){It.call(this,null==e?"canceled":e,It.ERR_CANCELED,t,n),this.name="CanceledError"}At.inherits(fn,It,{__CANCEL__:!0});const gn=fn;function xn(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new It("Request failed with status code "+n.status,[It.ERR_BAD_REQUEST,It.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const yn=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let a,s=0,o=0;return t=void 0!==t?t:1e3,function(i){const l=Date.now(),c=r[o];a||(a=l),n[s]=i,r[s]=l;let d=o,u=0;for(;d!==s;)u+=n[d++],d%=e;if(s=(s+1)%e,s===o&&(o=(o+1)%e),l-a<t)return;const m=c&&l-c;return m?Math.round(1e3*u/m):void 0}};const bn=function(e,t){let n,r,a=0,s=1e3/t;const o=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();a=s,n=null,r&&(clearTimeout(r),r=null),e.apply(null,t)};return[function(){const e=Date.now(),t=e-a;for(var i=arguments.length,l=new Array(i),c=0;c<i;c++)l[c]=arguments[c];t>=s?o(l,e):(n=l,r||(r=setTimeout(()=>{r=null,o(n)},s-t)))},()=>n&&o(n)]},vn=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=0;const a=yn(50,250);return bn(n=>{const s=n.loaded,o=n.lengthComputable?n.total:void 0,i=s-r,l=a(i);r=s;e({loaded:s,total:o,progress:o?s/o:void 0,bytes:i,rate:l||void 0,estimated:l&&o&&s<=o?(o-s)/l:void 0,event:n,lengthComputable:null!=o,[t?"download":"upload"]:!0})},n)},wn=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},jn=e=>function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return At.asap(()=>e(...n))},Nn=tn.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,tn.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(tn.origin),tn.navigator&&/(msie|trident)/i.test(tn.navigator.userAgent)):()=>!0,kn=tn.hasStandardBrowserEnv?{write(e,t,n,r,a,s){const o=[e+"="+encodeURIComponent(t)];At.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),At.isString(r)&&o.push("path="+r),At.isString(a)&&o.push("domain="+a),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Sn(e,t,n){let r=!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t);return e&&(r||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const Cn=e=>e instanceof mn?Ye({},e):e;function _n(e,t){t=t||{};const n={};function r(e,t,n,r){return At.isPlainObject(e)&&At.isPlainObject(t)?At.merge.call({caseless:r},e,t):At.isPlainObject(t)?At.merge({},t):At.isArray(t)?t.slice():t}function a(e,t,n,a){return At.isUndefined(t)?At.isUndefined(e)?void 0:r(void 0,e,0,a):r(e,t,0,a)}function s(e,t){if(!At.isUndefined(t))return r(void 0,t)}function o(e,t){return At.isUndefined(t)?At.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function i(n,a,s){return s in t?r(n,a):s in e?r(void 0,n):void 0}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:i,headers:(e,t,n)=>a(Cn(e),Cn(t),0,!0)};return At.forEach(Object.keys(Object.assign({},e,t)),function(r){const s=l[r]||a,o=s(e[r],t[r],r);At.isUndefined(o)&&s!==i||(n[r]=o)}),n}const En=e=>{const t=_n({},e);let n,{data:r,withXSRFToken:a,xsrfHeaderName:s,xsrfCookieName:o,headers:i,auth:l}=t;if(t.headers=i=mn.from(i),t.url=Yt(Sn(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),At.isFormData(r))if(tn.hasStandardBrowserEnv||tn.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(!1!==(n=i.getContentType())){const[e,...t]=n?n.split(";").map(e=>e.trim()).filter(Boolean):[];i.setContentType([e||"multipart/form-data",...t].join("; "))}if(tn.hasStandardBrowserEnv&&(a&&At.isFunction(a)&&(a=a(t)),a||!1!==a&&Nn(t.url))){const e=s&&o&&kn.read(o);e&&i.set(s,e)}return t},Pn="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,n){const r=En(e);let a=r.data;const s=mn.from(r.headers).normalize();let o,i,l,c,d,{responseType:u,onUploadProgress:m,onDownloadProgress:h}=r;function p(){c&&c(),d&&d(),r.cancelToken&&r.cancelToken.unsubscribe(o),r.signal&&r.signal.removeEventListener("abort",o)}let f=new XMLHttpRequest;function g(){if(!f)return;const r=mn.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders());xn(function(e){t(e),p()},function(e){n(e),p()},{data:u&&"text"!==u&&"json"!==u?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:r,config:e,request:f}),f=null}f.open(r.method.toUpperCase(),r.url,!0),f.timeout=r.timeout,"onloadend"in f?f.onloadend=g:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(g)},f.onabort=function(){f&&(n(new It("Request aborted",It.ECONNABORTED,e,f)),f=null)},f.onerror=function(){n(new It("Network Error",It.ERR_NETWORK,e,f)),f=null},f.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const a=r.transitional||Xt;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new It(t,a.clarifyTimeoutError?It.ETIMEDOUT:It.ECONNABORTED,e,f)),f=null},void 0===a&&s.setContentType(null),"setRequestHeader"in f&&At.forEach(s.toJSON(),function(e,t){f.setRequestHeader(t,e)}),At.isUndefined(r.withCredentials)||(f.withCredentials=!!r.withCredentials),u&&"json"!==u&&(f.responseType=r.responseType),h&&([l,d]=vn(h,!0),f.addEventListener("progress",l)),m&&f.upload&&([i,c]=vn(m),f.upload.addEventListener("progress",i),f.upload.addEventListener("loadend",c)),(r.cancelToken||r.signal)&&(o=t=>{f&&(n(!t||t.type?new gn(null,e,f):t),f.abort(),f=null)},r.cancelToken&&r.cancelToken.subscribe(o),r.signal&&(r.signal.aborted?o():r.signal.addEventListener("abort",o)));const x=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);x&&-1===tn.protocols.indexOf(x)?n(new It("Unsupported protocol "+x+":",It.ERR_BAD_REQUEST,e)):f.send(a||null)})},On=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const a=function(e){if(!n){n=!0,o();const t=e instanceof Error?e:this.reason;r.abort(t instanceof It?t:new gn(t instanceof Error?t.message:t))}};let s=t&&setTimeout(()=>{s=null,a(new It("timeout ".concat(t," of ms exceeded"),It.ETIMEDOUT))},t);const o=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(a):e.removeEventListener("abort",a)}),e=null)};e.forEach(e=>e.addEventListener("abort",a));const{signal:i}=r;return i.unsubscribe=()=>At.asap(o),i}};function An(e,t){this.v=e,this.k=t}function Tn(e){return function(){return new Dn(e.apply(this,arguments))}}function Dn(e){var t,n;function r(t,n){try{var s=e[t](n),o=s.value,i=o instanceof An;Promise.resolve(i?o.v:o).then(function(n){if(i){var l="return"===t?"return":"next";if(!o.k||n.done)return r(l,n);n=e[l](n).value}a(s.done?"return":"normal",n)},function(e){r("throw",e)})}catch(e){a("throw",e)}}function a(e,a){switch(e){case"return":t.resolve({value:a,done:!0});break;case"throw":t.reject(a);break;default:t.resolve({value:a,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,a){return new Promise(function(s,o){var i={key:e,arg:a,resolve:s,reject:o,next:null};n?n=n.next=i:(t=n=i,r(e,a))})},"function"!=typeof e.return&&(this.return=void 0)}function Mn(e){return new An(e,0)}function In(e){var t={},n=!1;function r(t,r){return n=!0,r=new Promise(function(n){n(e[t](r))}),{done:!1,value:new An(r,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):r("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return r("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):r("return",e)}),t}function Ln(e){var t,n,r,a=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);a--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new Rn(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function Rn(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return Rn=function(e){this.s=e,this.n=e.next},Rn.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new Rn(e)}Dn.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Dn.prototype.next=function(e){return this._invoke("next",e)},Dn.prototype.throw=function(e){return this._invoke("throw",e)},Dn.prototype.return=function(e){return this._invoke("return",e)};const Fn=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let r,a=0;for(;a<n;)r=a+t,yield e.slice(a,r),a=r},Bn=function(){var e=Tn(function*(e,t){var n,r=!1,a=!1;try{for(var s,o=Ln(Un(e));r=!(s=yield Mn(o.next())).done;r=!1){const e=s.value;yield*In(Ln(Fn(e,t)))}}catch(i){a=!0,n=i}finally{try{r&&null!=o.return&&(yield Mn(o.return()))}finally{if(a)throw n}}});return function(t,n){return e.apply(this,arguments)}}(),Un=function(){var e=Tn(function*(e){if(e[Symbol.asyncIterator])return void(yield*In(Ln(e)));const t=e.getReader();try{for(;;){const{done:e,value:n}=yield Mn(t.read());if(e)break;yield n}}finally{yield Mn(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),zn=(e,t,n,r)=>{const a=Bn(e,t);let s,o=0,i=e=>{s||(s=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await a.next();if(t)return i(),void e.close();let s=r.byteLength;if(n){let e=o+=s;n(e)}e.enqueue(new Uint8Array(r))}catch(t){throw i(t),t}},cancel:e=>(i(e),a.return())},{highWaterMark:2})},Vn="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,Wn=Vn&&"function"===typeof ReadableStream,qn=Vn&&("function"===typeof TextEncoder?(Hn=new TextEncoder,e=>Hn.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var Hn;const Yn=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!!e(...n)}catch(FB){return!1}},Gn=Wn&&Yn(()=>{let e=!1;const t=new Request(tn.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Xn=Wn&&Yn(()=>At.isReadableStream(new Response("").body)),$n={stream:Xn&&(e=>e.body)};var Kn;Vn&&(Kn=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!$n[e]&&($n[e]=At.isFunction(Kn[e])?t=>t[e]():(t,n)=>{throw new It("Response type '".concat(e,"' is not supported"),It.ERR_NOT_SUPPORT,n)})}));const Jn=async(e,t)=>{const n=At.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(At.isBlob(e))return e.size;if(At.isSpecCompliantForm(e)){const t=new Request(tn.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return At.isArrayBufferView(e)||At.isArrayBuffer(e)?e.byteLength:(At.isURLSearchParams(e)&&(e+=""),At.isString(e)?(await qn(e)).byteLength:void 0)})(t):n},Qn=Vn&&(async e=>{let{url:t,method:n,data:r,signal:a,cancelToken:s,timeout:o,onDownloadProgress:i,onUploadProgress:l,responseType:c,headers:d,withCredentials:u="same-origin",fetchOptions:m}=En(e);c=c?(c+"").toLowerCase():"text";let h,p=On([a,s&&s.toAbortSignal()],o);const f=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let g;try{if(l&&Gn&&"get"!==n&&"head"!==n&&0!==(g=await Jn(d,r))){let e,n=new Request(t,{method:"POST",body:r,duplex:"half"});if(At.isFormData(r)&&(e=n.headers.get("content-type"))&&d.setContentType(e),n.body){const[e,t]=wn(g,vn(jn(l)));r=zn(n.body,65536,e,t)}}At.isString(u)||(u=u?"include":"omit");const a="credentials"in Request.prototype;h=new Request(t,Ye(Ye({},m),{},{signal:p,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:a?u:void 0}));let s=await fetch(h,m);const o=Xn&&("stream"===c||"response"===c);if(Xn&&(i||o&&f)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=s[t]});const t=At.toFiniteNumber(s.headers.get("content-length")),[n,r]=i&&wn(t,vn(jn(i),!0))||[];s=new Response(zn(s.body,65536,n,()=>{r&&r(),f&&f()}),e)}c=c||"text";let x=await $n[At.findKey($n,c)||"text"](s,e);return!o&&f&&f(),await new Promise((t,n)=>{xn(t,n,{data:x,headers:mn.from(s.headers),status:s.status,statusText:s.statusText,config:e,request:h})})}catch(x){if(f&&f(),x&&"TypeError"===x.name&&/Load failed|fetch/i.test(x.message))throw Object.assign(new It("Network Error",It.ERR_NETWORK,e,h),{cause:x.cause||x});throw It.from(x,x&&x.code,e,h)}}),Zn={http:null,xhr:Pn,fetch:Qn};At.forEach(Zn,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(FB){}Object.defineProperty(e,"adapterName",{value:t})}});const er=e=>"- ".concat(e),tr=e=>At.isFunction(e)||null===e||!1===e,nr=e=>{e=At.isArray(e)?e:[e];const{length:t}=e;let n,r;const a={};for(let s=0;s<t;s++){let t;if(n=e[s],r=n,!tr(n)&&(r=Zn[(t=String(n)).toLowerCase()],void 0===r))throw new It("Unknown adapter '".concat(t,"'"));if(r)break;a[t||"#"+s]=r}if(!r){const e=Object.entries(a).map(e=>{let[t,n]=e;return"adapter ".concat(t," ")+(!1===n?"is not supported by the environment":"is not available in the build")});let n=t?e.length>1?"since :\n"+e.map(er).join("\n"):" "+er(e[0]):"as no adapter specified";throw new It("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return r};function rr(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new gn(null,e)}function ar(e){rr(e),e.headers=mn.from(e.headers),e.data=hn.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return nr(e.adapter||an.adapter)(e).then(function(t){return rr(e),t.data=hn.call(e,e.transformResponse,t),t.headers=mn.from(t.headers),t},function(t){return pn(t)||(rr(e),t&&t.response&&(t.response.data=hn.call(e,e.transformResponse,t.response),t.response.headers=mn.from(t.response.headers))),Promise.reject(t)})}const sr="1.10.0",or={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{or[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const ir={};or.transitional=function(e,t,n){function r(e,t){return"[Axios v"+sr+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,a,s)=>{if(!1===e)throw new It(r(a," has been removed"+(t?" in "+t:"")),It.ERR_DEPRECATED);return t&&!ir[a]&&(ir[a]=!0,console.warn(r(a," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,a,s)}},or.spelling=function(e){return(t,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(e)),!0)};const lr={assertOptions:function(e,t,n){if("object"!==typeof e)throw new It("options must be an object",It.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const s=r[a],o=t[s];if(o){const t=e[s],n=void 0===t||o(t,s,e);if(!0!==n)throw new It("option "+s+" must be "+n,It.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new It("Unknown option "+s,It.ERR_BAD_OPTION)}},validators:or},cr=lr.validators;class dr{constructor(e){this.defaults=e||{},this.interceptors={request:new Gt,response:new Gt}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(FB){}}throw n}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=_n(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:a}=t;void 0!==n&&lr.assertOptions(n,{silentJSONParsing:cr.transitional(cr.boolean),forcedJSONParsing:cr.transitional(cr.boolean),clarifyTimeoutError:cr.transitional(cr.boolean)},!1),null!=r&&(At.isFunction(r)?t.paramsSerializer={serialize:r}:lr.assertOptions(r,{encode:cr.function,serialize:cr.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),lr.assertOptions(t,{baseUrl:cr.spelling("baseURL"),withXsrfToken:cr.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=a&&At.merge(a.common,a[t.method]);a&&At.forEach(["delete","get","head","post","put","patch","common"],e=>{delete a[e]}),t.headers=mn.concat(s,a);const o=[];let i=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(i=i&&e.synchronous,o.unshift(e.fulfilled,e.rejected))});const l=[];let c;this.interceptors.response.forEach(function(e){l.push(e.fulfilled,e.rejected)});let d,u=0;if(!i){const e=[ar.bind(this),void 0];for(e.unshift.apply(e,o),e.push.apply(e,l),d=e.length,c=Promise.resolve(t);u<d;)c=c.then(e[u++],e[u++]);return c}d=o.length;let m=t;for(u=0;u<d;){const e=o[u++],t=o[u++];try{m=e(m)}catch(h){t.call(this,h);break}}try{c=ar.call(this,m)}catch(h){return Promise.reject(h)}for(u=0,d=l.length;u<d;)c=c.then(l[u++],l[u++]);return c}getUri(e){return Yt(Sn((e=_n(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}At.forEach(["delete","get","head","options"],function(e){dr.prototype[e]=function(t,n){return this.request(_n(n||{},{method:e,url:t,data:(n||{}).data}))}}),At.forEach(["post","put","patch"],function(e){function t(t){return function(n,r,a){return this.request(_n(a||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}dr.prototype[e]=t(),dr.prototype[e+"Form"]=t(!0)});const ur=dr;class mr{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const r=new Promise(e=>{n.subscribe(e),t=e}).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e(function(e,r,a){n.reason||(n.reason=new gn(e,r,a),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;const t=new mr(function(t){e=t});return{token:t,cancel:e}}}const hr=mr;const pr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(pr).forEach(e=>{let[t,n]=e;pr[n]=t});const fr=pr;const gr=function e(t){const n=new ur(t),r=Ge(ur.prototype.request,n);return At.extend(r,ur.prototype,n,{allOwnKeys:!0}),At.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(_n(t,n))},r}(an);gr.Axios=ur,gr.CanceledError=gn,gr.CancelToken=hr,gr.isCancel=pn,gr.VERSION=sr,gr.toFormData=Ut,gr.AxiosError=It,gr.Cancel=gr.CanceledError,gr.all=function(e){return Promise.all(e)},gr.spread=function(e){return function(t){return e.apply(null,t)}},gr.isAxiosError=function(e){return At.isObject(e)&&!0===e.isAxiosError},gr.mergeConfig=_n,gr.AxiosHeaders=mn,gr.formToJSON=e=>nn(At.isHTMLForm(e)?new FormData(e):e),gr.getAdapter=nr,gr.HttpStatusCode=fr,gr.default=gr;const xr=gr;var yr=n(579);xr.defaults.baseURL="";const br=(0,s.createContext)(),vr=(e,t)=>{switch(t.type){case"LOGIN_START":return Ye(Ye({},e),{},{loading:!0,error:null});case"LOGIN_SUCCESS":return Ye(Ye({},e),{},{loading:!1,isAuthenticated:!0,user:t.payload.user,token:t.payload.token,error:null});case"LOGIN_FAILURE":return Ye(Ye({},e),{},{loading:!1,isAuthenticated:!1,user:null,token:null,error:t.payload});case"LOGOUT":return Ye(Ye({},e),{},{isAuthenticated:!1,user:null,token:null,loading:!1,error:null});case"SET_USER":return Ye(Ye({},e),{},{user:t.payload});default:return e}},wr={isAuthenticated:!!localStorage.getItem("token"),user:null,token:localStorage.getItem("token"),loading:!!localStorage.getItem("token"),error:null},jr=e=>{let{children:t}=e;const[n,r]=(0,s.useReducer)(vr,wr);(0,s.useEffect)(()=>{n.token?xr.defaults.headers.common.Authorization="Bearer ".concat(n.token):delete xr.defaults.headers.common.Authorization},[n.token]),(0,s.useEffect)(()=>{(async()=>{const e=localStorage.getItem("token");if(e)try{let t;try{t=await xr.get("/api/auth/me")}catch(c){t=await xr.get("/api/auth/profile")}r({type:"LOGIN_SUCCESS",payload:{user:t.data.user||t.data,token:e}})}catch(d){var t,n,a,s,o,i,l;console.error("Token verification failed:",d),null!==(t=d.response)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.forceLogout||null!==(a=d.response)&&void 0!==a&&null!==(s=a.data)&&void 0!==s&&s.clearToken||null!==(o=d.response)&&void 0!==o&&null!==(i=o.data)&&void 0!==i&&null!==(l=i.message)&&void 0!==l&&l.includes("Invalid user session")?(console.log("\ud83d\udea8 FORCE LOGOUT - Clearing all auth data"),localStorage.removeItem("token"),localStorage.removeItem("authToken"),localStorage.removeItem("jwt"),sessionStorage.clear()):localStorage.removeItem("token"),r({type:"LOGOUT"})}else r({type:"LOGOUT"})})()},[]);return(0,yr.jsx)(br.Provider,{value:Ye(Ye({},n),{},{login:async(e,t)=>{r({type:"LOGIN_START"});try{console.log("\ud83d\udd10 AuthContext: Sending login request to API");const n=await xr.post("/api/auth/login",{email:e,password:t});console.log("\u2705 AuthContext: Login response received:",n.data);const{token:a,user:s}=n.data;return localStorage.setItem("token",a),xr.defaults.headers.common.Authorization="Bearer ".concat(a),r({type:"LOGIN_SUCCESS",payload:{user:s,token:a}}),{success:!0}}catch(u){var n,a,s,o,i,l,c,d;console.error("\u274c AuthContext: Login error:",u),console.error("\u274c Error details:",{message:u.message,response:null===(n=u.response)||void 0===n?void 0:n.data,status:null===(a=u.response)||void 0===a?void 0:a.status});const e=(null===(s=u.response)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.message)||"Login failed";return e.includes("Account error")||null!==(i=u.response)&&void 0!==i&&null!==(l=i.data)&&void 0!==l&&l.clearToken||null!==(c=u.response)&&void 0!==c&&null!==(d=c.data)&&void 0!==d&&d.forceLogout||e.includes("Invalid user session")?(console.log("\ud83d\udea8 FORCE LOGOUT DETECTED - Clearing all auth data"),localStorage.removeItem("token"),localStorage.removeItem("authToken"),localStorage.removeItem("jwt"),sessionStorage.clear(),r({type:"LOGOUT"})):r({type:"LOGIN_FAILURE",payload:e}),{success:!1,message:e}}},register:async e=>{r({type:"LOGIN_START"});try{const t=await xr.post("/api/auth/register",e),{token:n,user:a}=t.data;return localStorage.setItem("token",n),r({type:"LOGIN_SUCCESS",payload:{user:a,token:n}}),{success:!0}}catch(a){var t,n;const e=(null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Registration failed";return r({type:"LOGIN_FAILURE",payload:e}),{success:!1,message:e}}},logout:()=>{console.log("\ud83d\udea8 LOGOUT CALLED - Clearing all auth data"),localStorage.removeItem("token"),localStorage.removeItem("authToken"),localStorage.removeItem("jwt"),localStorage.removeItem("user"),localStorage.removeItem("userData"),sessionStorage.clear(),delete xr.defaults.headers.common.Authorization,r({type:"LOGOUT"})}}),children:t})},Nr=()=>{const e=(0,s.useContext)(br);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},kr=Object.create(null);kr.open="0",kr.close="1",kr.ping="2",kr.pong="3",kr.message="4",kr.upgrade="5",kr.noop="6";const Sr=Object.create(null);Object.keys(kr).forEach(e=>{Sr[kr[e]]=e});const Cr={type:"error",data:"parser error"},_r="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Er="function"===typeof ArrayBuffer,Pr=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Or=(e,t,n)=>{let{type:r,data:a}=e;return _r&&a instanceof Blob?t?n(a):Ar(a,n):Er&&(a instanceof ArrayBuffer||Pr(a))?t?n(a):Ar(new Blob([a]),n):n(kr[r]+(a||""))},Ar=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function Tr(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Dr;const Mr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ir="undefined"===typeof Uint8Array?[]:new Uint8Array(256);for(let n=0;n<64;n++)Ir[Mr.charCodeAt(n)]=n;const Lr="function"===typeof ArrayBuffer,Rr=(e,t)=>{if("string"!==typeof e)return{type:"message",data:Br(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:Fr(e.substring(1),t)};return Sr[n]?e.length>1?{type:Sr[n],data:e.substring(1)}:{type:Sr[n]}:Cr},Fr=(e,t)=>{if(Lr){const n=(e=>{let t,n,r,a,s,o=.75*e.length,i=e.length,l=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);const c=new ArrayBuffer(o),d=new Uint8Array(c);for(t=0;t<i;t+=4)n=Ir[e.charCodeAt(t)],r=Ir[e.charCodeAt(t+1)],a=Ir[e.charCodeAt(t+2)],s=Ir[e.charCodeAt(t+3)],d[l++]=n<<2|r>>4,d[l++]=(15&r)<<4|a>>2,d[l++]=(3&a)<<6|63&s;return c})(e);return Br(n,t)}return{base64:!0,data:e}},Br=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,Ur=String.fromCharCode(30);function zr(){return new TransformStream({transform(e,t){!function(e,t){_r&&e.data instanceof Blob?e.data.arrayBuffer().then(Tr).then(t):Er&&(e.data instanceof ArrayBuffer||Pr(e.data))?t(Tr(e.data)):Or(e,!1,e=>{Dr||(Dr=new TextEncoder),t(Dr.encode(e))})}(e,n=>{const r=n.length;let a;if(r<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,r);else if(r<65536){a=new Uint8Array(3);const e=new DataView(a.buffer);e.setUint8(0,126),e.setUint16(1,r)}else{a=new Uint8Array(9);const e=new DataView(a.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(r))}e.data&&"string"!==typeof e.data&&(a[0]|=128),t.enqueue(a),t.enqueue(n)})}})}let Vr;function Wr(e){return e.reduce((e,t)=>e+t.length,0)}function qr(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let a=0;a<t;a++)n[a]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function Hr(e){if(e)return function(e){for(var t in Hr.prototype)e[t]=Hr.prototype[t];return e}(e)}Hr.prototype.on=Hr.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},Hr.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},Hr.prototype.off=Hr.prototype.removeListener=Hr.prototype.removeAllListeners=Hr.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var a=0;a<r.length;a++)if((n=r[a])===t||n.fn===t){r.splice(a,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},Hr.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var a=(n=n.slice(0)).length;r<a;++r)n[r].apply(this,t)}return this},Hr.prototype.emitReserved=Hr.prototype.emit,Hr.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},Hr.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Yr="function"===typeof Promise&&"function"===typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Gr="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")();function Xr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t),{})}const $r=Gr.setTimeout,Kr=Gr.clearTimeout;function Jr(e,t){t.useNativeTimers?(e.setTimeoutFn=$r.bind(Gr),e.clearTimeoutFn=Kr.bind(Gr)):(e.setTimeoutFn=Gr.setTimeout.bind(Gr),e.clearTimeoutFn=Gr.clearTimeout.bind(Gr))}function Qr(e){return"string"===typeof e?function(e){let t=0,n=0;for(let r=0,a=e.length;r<a;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))}function Zr(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class ea extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class ta extends Hr{constructor(e){super(),this.writable=!1,Jr(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new ea(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Rr(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}(e);return t.length?"?"+t:""}}class na extends ta{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(e++,this.once("pollComplete",function(){--e||t()})),this.writable||(e++,this.once("drain",function(){--e||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const n=e.split(Ur),r=[];for(let a=0;a<n.length;a++){const e=Rr(n[a],t);if(r.push(e),"error"===e.type)break}return r})(e,this.socket.binaryType).forEach(e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const n=e.length,r=new Array(n);let a=0;e.forEach((e,s)=>{Or(e,!1,e=>{r[s]=e,++a===n&&t(r.join(Ur))})})})(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=Zr()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}let ra=!1;try{ra="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(BB){}const aa=ra;function sa(){}class oa extends na{constructor(e){if(super(e),"undefined"!==typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}class ia extends Hr{constructor(e,t,n){super(),this.createRequest=e,Jr(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=void 0!==n.data?n.data:null,this._create()}_create(){var e;const t=Xr(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this._opts.extraHeaders[e])}}catch(FB){}if("POST"===this._method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(FB){}try{n.setRequestHeader("Accept","*/*")}catch(FB){}null===(e=this._opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this._opts.cookieJar)||void 0===e||e.parseCookies(n.getResponseHeader("set-cookie"))),4===n.readyState&&(200===n.status||1223===n.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"===typeof n.status?n.status:0)},0))},n.send(this._data)}catch(FB){return void this.setTimeoutFn(()=>{this._onError(FB)},0)}"undefined"!==typeof document&&(this._index=ia.requestsCount++,ia.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if("undefined"!==typeof this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=sa,e)try{this._xhr.abort()}catch(FB){}"undefined"!==typeof document&&delete ia.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(ia.requestsCount=0,ia.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",la);else if("function"===typeof addEventListener){addEventListener("onpagehide"in Gr?"pagehide":"unload",la,!1)}function la(){for(let e in ia.requests)ia.requests.hasOwnProperty(e)&&ia.requests[e].abort()}const ca=function(){const e=da({xdomain:!1});return e&&null!==e.responseType}();function da(e){const t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||aa))return new XMLHttpRequest}catch(FB){}if(!t)try{return new(Gr[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(FB){}}const ua="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class ma extends ta{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=ua?{}:Xr(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(BB){return this.emitReserved("error",BB)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;Or(n,this.supportsBinary,e=>{try{this.doWrite(n,e)}catch(FB){}r&&Yr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){"undefined"!==typeof this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Zr()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const ha=Gr.WebSocket||Gr.MozWebSocket;const pa={websocket:class extends ma{createSocket(e,t,n){return ua?new ha(e,t,n):t?new ha(e,t):new ha(e)}doWrite(e,t){this.ws.send(t)}},webtransport:class extends ta{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(BB){return this.emitReserved("error",BB)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=function(e,t){Vr||(Vr=new TextDecoder);const n=[];let r=0,a=-1,s=!1;return new TransformStream({transform(o,i){for(n.push(o);;){if(0===r){if(Wr(n)<1)break;const e=qr(n,1);s=128===(128&e[0]),a=127&e[0],r=a<126?3:126===a?1:2}else if(1===r){if(Wr(n)<2)break;const e=qr(n,2);a=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),r=3}else if(2===r){if(Wr(n)<8)break;const e=qr(n,8),t=new DataView(e.buffer,e.byteOffset,e.length),s=t.getUint32(0);if(s>Math.pow(2,21)-1){i.enqueue(Cr);break}a=s*Math.pow(2,32)+t.getUint32(4),r=3}else{if(Wr(n)<a)break;const e=qr(n,a);i.enqueue(Rr(s?e:Vr.decode(e),t)),r=0}if(0===a||a>e){i.enqueue(Cr);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=zr();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const a=()=>{n.read().then(e=>{let{done:t,value:n}=e;t||(this.onPacket(n),a())}).catch(e=>{})};a();const s={type:"open"};this.query.sid&&(s.data='{"sid":"'.concat(this.query.sid,'"}')),this._writer.write(s).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this._writer.write(n).then(()=>{r&&Yr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null===(e=this._transport)||void 0===e||e.close()}},polling:class extends oa{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=ca&&!t}request(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{xd:this.xd},this.opts),new ia(da,this.uri(),e)}}},fa=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ga=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function xa(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let a=fa.exec(e||""),s={},o=14;for(;o--;)s[ga[o]]=a[o]||"";return-1!=n&&-1!=r&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=function(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1);"/"==t.slice(-1)&&r.splice(r.length-1,1);return r}(0,s.path),s.queryKey=function(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,r){t&&(n[t]=r)}),n}(0,s.query),s}const ya="function"===typeof addEventListener&&"function"===typeof removeEventListener,ba=[];ya&&addEventListener("offline",()=>{ba.forEach(e=>e())},!1);class va extends Hr{constructor(e,t){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"===typeof e&&(t=e,e=null),e){const n=xa(e);t.hostname=n.host,t.secure="https"===n.protocol||"wss"===n.protocol,t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=xa(t.host).host);Jr(this,t),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(e=>{const t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"===typeof this.opts.query&&(this.opts.query=function(e){let t={},n=e.split("&");for(let r=0,a=n.length;r<a;r++){let e=n[r].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}(this.opts.query)),ya&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ba.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);const e=this.opts.rememberUpgrade&&va.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",va.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){const n=this.writeBuffer[t].data;if(n&&(e+=Qr(n)),t>0&&e>this._maxPayload)return this.writeBuffer.slice(0,t);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Yr(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const a={type:e,data:t,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(va.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ya&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const e=ba.indexOf(this._offlineEventListener);-1!==e&&ba.splice(e,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}va.protocol=4;class wa extends va{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;va.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",e=>{if(!n)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;va.priorWebsocketSuccess="websocket"===t.name,this.transport.pause(()=>{n||"closed"!==this.readyState&&(c(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}}))};function a(){n||(n=!0,c(),t.close(),t=null)}const s=e=>{const n=new Error("probe error: "+e);n.transport=t.name,a(),this.emitReserved("upgradeError",n)};function o(){s("transport closed")}function i(){s("socket closed")}function l(e){t&&e.name!==t.name&&a()}const c=()=>{t.removeListener("open",r),t.removeListener("error",s),t.removeListener("close",o),this.off("close",i),this.off("upgrading",l)};t.once("open",r),t.once("error",s),t.once("close",o),this.once("close",i),this.once("upgrading",l),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}class ja extends wa{constructor(e){const t="object"===typeof e?e:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(!t.transports||t.transports&&"string"===typeof t.transports[0])&&(t.transports=(t.transports||["polling","websocket","webtransport"]).map(e=>pa[e]).filter(e=>!!e)),super(e,t)}}const Na="function"===typeof ArrayBuffer,ka=Object.prototype.toString,Sa="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===ka.call(Blob),Ca="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===ka.call(File);function _a(e){return Na&&(e instanceof ArrayBuffer||(e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||Sa&&e instanceof Blob||Ca&&e instanceof File}function Ea(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(Ea(e[t]))return!0;return!1}if(_a(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return Ea(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&Ea(e[n]))return!0;return!1}function Pa(e){const t=[],n=e.data,r=e;return r.data=Oa(n,t),r.attachments=t.length,{packet:r,buffers:t}}function Oa(e,t){if(!e)return e;if(_a(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=Oa(e[r],t);return n}if("object"===typeof e&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=Oa(e[r],t));return n}return e}function Aa(e,t){return e.data=Ta(e.data,t),delete e.attachments,e}function Ta(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=Ta(e[n],t);else if("object"===typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=Ta(e[n],t));return e}const Da=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Ma=5;var Ia;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(Ia||(Ia={}));class La{constructor(e){this.replacer=e}encode(e){return e.type!==Ia.EVENT&&e.type!==Ia.ACK||!Ea(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===Ia.EVENT?Ia.BINARY_EVENT:Ia.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==Ia.BINARY_EVENT&&e.type!==Ia.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Pa(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}function Ra(e){return"[object Object]"===Object.prototype.toString.call(e)}class Fa extends Hr{constructor(e){super(),this.reviver=e}add(e){let t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===Ia.BINARY_EVENT;n||t.type===Ia.BINARY_ACK?(t.type=n?Ia.EVENT:Ia.ACK,this.reconstructor=new Ba(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!_a(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===Ia[n.type])throw new Error("unknown packet type "+n.type);if(n.type===Ia.BINARY_EVENT||n.type===Ia.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const a=e.substring(r,t);if(a!=Number(a)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(a)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!Fa.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(FB){return!1}}static isPayloadValid(e,t){switch(e){case Ia.CONNECT:return Ra(t);case Ia.DISCONNECT:return void 0===t;case Ia.CONNECT_ERROR:return"string"===typeof t||Ra(t);case Ia.EVENT:case Ia.BINARY_EVENT:return Array.isArray(t)&&("number"===typeof t[0]||"string"===typeof t[0]&&-1===Da.indexOf(t[0]));case Ia.ACK:case Ia.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Ba{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=Aa(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Ua(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const za=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Va extends Hr{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Ua(e,"open",this.onopen.bind(this)),Ua(e,"packet",this.onpacket.bind(this)),Ua(e,"error",this.onerror.bind(this)),Ua(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift("message"),this.emit.apply(this,t),this}emit(e){var t,n,r;if(za.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var a=arguments.length,s=new Array(a>1?a-1:0),o=1;o<a;o++)s[o-1]=arguments[o];if(s.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const i={type:Ia.EVENT,data:s,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"===typeof s[s.length-1]){const e=this.ids++,t=s.pop();this._registerAckCallback(e,t),i.id=e}const l=null===(n=null===(t=this.io.engine)||void 0===t?void 0:t.transport)||void 0===n?void 0:n.writable,c=this.connected&&!(null===(r=this.io.engine)||void 0===r?void 0:r._hasPingExpired());return this.flags.volatile&&!l||(c?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(e,t){var n,r=this;const a=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===a)return void(this.acks[e]=t);const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))},a),o=function(){r.io.clearTimeoutFn(s);for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];t.apply(r,n)};o.withError=!0,this.acks[e]=o}emitWithAck(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Promise((t,r)=>{const a=(e,n)=>e?r(e):t(n);a.withError=!0,n.push(a),this.emit(e,...n)})}_addToQueue(e){var t=this;let n;"function"===typeof e[e.length-1]&&(n=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(function(e){if(r!==t._queue[0])return;if(null!==e)r.tryCount>t._opts.retries&&(t._queue.shift(),n&&n(e));else if(t._queue.shift(),n){for(var a=arguments.length,s=new Array(a>1?a-1:0),o=1;o<a;o++)s[o-1]=arguments[o];n(null,...s)}return r.pending=!1,t._drainQueue()}),this._queue.push(r),this._drainQueue()}_drainQueue(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Ia.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Ia.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ia.EVENT:case Ia.BINARY_EVENT:this.onevent(e);break;case Ia.ACK:case Ia.BINARY_ACK:this.onack(e);break;case Ia.DISCONNECT:this.ondisconnect();break;case Ia.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];t.packet({type:Ia.ACK,id:e,data:a})}}}onack(e){const t=this.acks[e.id];"function"===typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ia.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function Wa(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Wa.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},Wa.prototype.reset=function(){this.attempts=0},Wa.prototype.setMin=function(e){this.ms=e},Wa.prototype.setMax=function(e){this.max=e},Wa.prototype.setJitter=function(e){this.jitter=e};class qa extends Hr{constructor(e,n){var r;super(),this.nsps={},this.subs=[],e&&"object"===typeof e&&(n=e,e=void 0),(n=n||{}).path=n.path||"/socket.io",this.opts=n,Jr(this,n),this.reconnection(!1!==n.reconnection),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(r=n.randomizationFactor)&&void 0!==r?r:.5),this.backoff=new Wa({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==n.timeout?2e4:n.timeout),this._readyState="closed",this.uri=e;const a=n.parser||t;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=!1!==n.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new ja(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=Ua(t,"open",function(){n.onopen(),e&&e()}),a=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},s=Ua(t,"error",a);if(!1!==this._timeout){const e=this._timeout,n=this.setTimeoutFn(()=>{r(),a(new Error("timeout")),t.close()},e);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}return this.subs.push(r),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Ua(e,"ping",this.onping.bind(this)),Ua(e,"data",this.ondata.bind(this)),Ua(e,"error",this.onerror.bind(this)),Ua(e,"close",this.onclose.bind(this)),Ua(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(FB){this.onclose("parse error",FB)}}ondecoded(e){Yr(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Va(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t){if(this.nsps[n].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),null===(n=this.engine)||void 0===n||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Ha={};function Ya(e,t){"object"===typeof e&&(t=e,e=void 0);const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=e;n=n||"undefined"!==typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof n?n.protocol+"//"+e:"https://"+e),r=xa(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const a=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port+t,r.href=r.protocol+"://"+a+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),r=n.source,a=n.id,s=n.path,o=Ha[a]&&s in Ha[a].nsps;let i;return t.forceNew||t["force new connection"]||!1===t.multiplex||o?i=new qa(r,t):(Ha[a]||(Ha[a]=new qa(r,t)),i=Ha[a]),n.query&&!t.query&&(t.query=n.queryKey),i.socket(n.path,t)}Object.assign(Ya,{Manager:qa,Socket:Va,io:Ya,connect:Ya});const Ga=(0,s.createContext)(),Xa=()=>{const e=(0,s.useContext)(Ga);if(!e)throw new Error("useSocket must be used within a SocketProvider");return e},$a=e=>{let{children:t}=e;const[n,r]=(0,s.useState)(null),[a,o]=(0,s.useState)(!1),[i,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(0),[u,m]=(0,s.useState)(null),{user:h}=Nr(),p=(0,s.useRef)(null),f=(0,s.useRef)(null),g=(0,s.useRef)(!1);(0,s.useEffect)(()=>{if(h&&!g.current){g.current=!0;const e=window.location.origin;console.log("\ud83d\udd0c Connecting to WebSocket server:",e);const t=Ya(e,{withCredentials:!0,transports:["websocket","polling"],timeout:2e4,forceNew:!0,reconnection:!0,reconnectionDelay:2e3,reconnectionDelayMax:15e3,reconnectionAttempts:10,autoConnect:!0,upgrade:!0,rememberUpgrade:!1,rejectUnauthorized:!1,secure:!1,multiplex:!1});return t.on("connect",()=>{console.log("\u2705 Connected to WebSocket server"),console.log("\ud83d\udc64 User data:",{id:h.id,name:h.name,role:h.role}),o(!0),d(0),m(null),g.current=!1,f.current&&(clearTimeout(f.current),f.current=null),t.emit("join",{id:h.id,name:h.name,role:h.role}),x(t)}),t.on("disconnect",e=>{console.log("\u274c Disconnected from WebSocket server: ".concat(e)),o(!1),g.current=!1,p.current&&(clearInterval(p.current),p.current=null),"io server disconnect"===e&&(console.log("\ud83d\udd04 Server initiated disconnect, attempting to reconnect..."),f.current=setTimeout(()=>{t&&!t.connected&&t.connect()},2e3))}),t.on("connect_error",e=>{console.error("\u274c Socket connection error:",e.message),o(!1),g.current=!1,d(e=>e+1),m(e.message);const t=Math.min(1e3*Math.pow(2,c),3e4);console.log("\ud83d\udd04 Will retry connection in ".concat(t,"ms"))}),t.on("reconnect",e=>{console.log("\ud83d\udd04 Reconnected after ".concat(e," attempts")),o(!0),g.current=!1,d(0),m(null),f.current&&(clearTimeout(f.current),f.current=null),t.emit("join",{id:h.id,name:h.name,role:h.role}),x(t)}),t.on("reconnect_attempt",e=>{console.log("\ud83d\udd04 Reconnection attempt ".concat(e)),d(e)}),t.on("reconnect_error",e=>{console.error("\u274c Reconnection failed:",e.message),m(e.message)}),t.on("reconnect_failed",()=>{console.error("\u274c All reconnection attempts failed"),o(!1),g.current=!1,m("Max reconnection attempts reached")}),t.on("ping",()=>{t.emit("pong")}),r(t),()=>{console.log("\ud83e\uddf9 Cleaning up socket connection..."),p.current&&(clearInterval(p.current),p.current=null),f.current&&(clearTimeout(f.current),f.current=null),g.current=!1,t&&!t.disconnected&&(t.removeAllListeners(),setTimeout(()=>{t&&!t.disconnected&&t.disconnect()},100)),console.log("\u2705 Socket connection cleaned up")}}},[h]);const x=e=>{p.current&&clearInterval(p.current),p.current=setInterval(()=>{e.connected&&e.emit("heartbeat",{timestamp:Date.now()})},3e4)},y=(0,s.useCallback)(e=>{if(!n)return()=>{};const t=t=>{console.log("\ud83d\udcf1 Real-time: Lead created",t),e({type:"LEAD_CREATED",data:t}),l({type:"LEAD_CREATED",timestamp:new Date,data:t})},r=t=>{console.log("\ud83d\udcf1 Real-time: Lead updated",t),e({type:"LEAD_UPDATED",data:t}),l({type:"LEAD_UPDATED",timestamp:new Date,data:t})},a=t=>{console.log("\ud83d\udcf1 Real-time: Lead assigned",t),e({type:"LEAD_ASSIGNED",data:t}),l({type:"LEAD_ASSIGNED",timestamp:new Date,data:t})},s=t=>{console.log("\ud83d\udcf1 Real-time: Lead deleted",t),e({type:"LEAD_DELETED",data:t}),l({type:"LEAD_DELETED",timestamp:new Date,data:t})},o=t=>{console.log("\ud83d\udcdd Real-time: Notes updated",t),e({type:"NOTES_UPDATED",data:t}),l({type:"NOTES_UPDATED",timestamp:new Date,data:t})};return n.on("lead_created",t),n.on("lead_updated",r),n.on("lead_assigned",a),n.on("lead_deleted",s),n.on("notes_updated",o),()=>{n.off("lead_created",t),n.off("lead_updated",r),n.off("lead_assigned",a),n.off("lead_deleted",s),n.off("notes_updated",o)}},[n]),b=(0,s.useCallback)(e=>{if(!n)return()=>{};const t=t=>{console.log("\ud83d\udcca Real-time: Stats update needed",t),e({type:"STATS_UPDATE_NEEDED",data:t}),l({type:"STATS_UPDATE_NEEDED",timestamp:new Date,data:t})},r=t=>{console.log("\ud83d\udcc5 Real-time: Booking activity",t),e({type:"BOOKING_ACTIVITY",data:t}),l({type:"BOOKING_ACTIVITY",timestamp:new Date,data:t})};return n.on("stats_update_needed",t),n.on("booking_activity",r),()=>{n.off("stats_update_needed",t),n.off("booking_activity",r)}},[n]),v=(0,s.useCallback)(e=>{if(!n)return()=>{};const t=t=>{console.log("\ud83d\udcc5 Real-time: Calendar updated",t),e({type:"CALENDAR_UPDATED",data:t}),l({type:"CALENDAR_UPDATED",timestamp:new Date,data:t})};return n.on("calendar_updated",t),()=>{n.off("calendar_updated",t)}},[n]),w=(0,s.useCallback)(e=>{if(!n)return()=>{};const t=t=>{console.log("\ud83d\udcc5 Real-time: Diary updated",t),e({type:"DIARY_UPDATED",data:t}),l({type:"DIARY_UPDATED",timestamp:new Date,data:t})};return n.on("diary_updated",t),()=>{n.off("diary_updated",t)}},[n]),j=(0,s.useCallback)(e=>{n&&n.connected&&n.emit("lead_update",e)},[n]),N=(0,s.useCallback)(e=>{n&&n.connected&&n.emit("stats_update",e)},[n]),k=(0,s.useCallback)(e=>{n&&n.connected&&n.emit("calendar_update",e)},[n]),S=(0,s.useCallback)(e=>{n&&n.connected&&n.emit("diary_update",e)},[n]),C={socket:n,isConnected:a,lastUpdate:i,connectionAttempts:c,lastConnectionError:u,subscribeToLeadUpdates:y,subscribeToStatsUpdates:b,subscribeToCalendarUpdates:v,subscribeToDiaryUpdates:w,emitLeadUpdate:j,emitStatsUpdate:N,emitCalendarUpdate:k,emitDiaryUpdate:S};return(0,yr.jsx)(Ga.Provider,{value:C,children:t})};class Ka extends s.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null},this.handleGlobalError=this.handleGlobalError.bind(this),this.handleUnhandledRejection=this.handleUnhandledRejection.bind(this)}componentDidMount(){window.addEventListener("error",this.handleGlobalError),window.addEventListener("unhandledrejection",this.handleUnhandledRejection)}componentWillUnmount(){window.removeEventListener("error",this.handleGlobalError),window.removeEventListener("unhandledrejection",this.handleUnhandledRejection)}handleGlobalError(e){var t,n,r,a,s;var o;if((null===(t=e.error)||void 0===t||null===(n=t.message)||void 0===n?void 0:n.includes("chrome-extension://"))||(null===(r=e.error)||void 0===r||null===(a=r.stack)||void 0===a?void 0:a.includes("chrome-extension://"))||(null===(s=e.filename)||void 0===s?void 0:s.includes("chrome-extension://")))return console.warn("\ud83d\udd0c Chrome extension error caught by global handler, ignoring:",null===(o=e.error)||void 0===o?void 0:o.message),void e.preventDefault()}handleUnhandledRejection(e){var t,n,r,a,s;var o;if((null===(t=e.reason)||void 0===t||null===(n=t.message)||void 0===n?void 0:n.includes("chrome-extension://"))||(null===(r=e.reason)||void 0===r||null===(a=r.stack)||void 0===a?void 0:a.includes("chrome-extension://"))||(null===(s=e.reason)||void 0===s?void 0:s.toString().includes("chrome-extension://")))return console.warn("\ud83d\udd0c Chrome extension promise rejection caught by global handler, ignoring:",null===(o=e.reason)||void 0===o?void 0:o.message),void e.preventDefault()}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){var n,r,a;console.error("\ud83d\udea8 Error Boundary caught an error:",e,t);(null===e||void 0===e||null===(n=e.message)||void 0===n?void 0:n.includes("chrome-extension://"))||(null===e||void 0===e||null===(r=e.stack)||void 0===r?void 0:r.includes("chrome-extension://"))||(null===t||void 0===t||null===(a=t.componentStack)||void 0===a?void 0:a.includes("chrome-extension://"))?console.warn("\ud83d\udd0c Chrome extension error detected, ignoring:",e.message):this.setState({error:e,errorInfo:t})}render(){if(this.state.hasError){var e,t,n,r;return(null===(e=this.state.error)||void 0===e||null===(t=e.message)||void 0===t?void 0:t.includes("chrome-extension://"))||(null===(n=this.state.error)||void 0===n||null===(r=n.stack)||void 0===r?void 0:r.includes("chrome-extension://"))?this.props.children:(0,yr.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,yr.jsxs)("div",{className:"max-w-md w-full bg-white shadow-lg rounded-lg p-6",children:[(0,yr.jsxs)("div",{className:"flex items-center mb-4",children:[(0,yr.jsx)("div",{className:"flex-shrink-0",children:(0,yr.jsx)("svg",{className:"h-8 w-8 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,yr.jsx)("div",{className:"ml-3",children:(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Something went wrong"})})]}),(0,yr.jsx)("div",{className:"mt-2",children:(0,yr.jsx)("p",{className:"text-sm text-gray-500",children:"We're sorry, but something unexpected happened. Please try refreshing the page."})}),(0,yr.jsx)("div",{className:"mt-4",children:(0,yr.jsx)("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Refresh Page"})}),!1]})})}return this.props.children}}const Ja=Ka;var Qa={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Za=s.createContext&&s.createContext(Qa),es=function(){return es=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},es.apply(this,arguments)},ts=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};function ns(e){return e&&e.map(function(e,t){return s.createElement(e.tag,es({key:t},e.attr),ns(e.child))})}function rs(e){return function(t){return s.createElement(as,es({attr:es({},e.attr)},t),ns(e.child))}}function as(e){var t=function(t){var n,r=e.attr,a=e.size,o=e.title,i=ts(e,["attr","size","title"]),l=a||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),s.createElement("svg",es({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,i,{className:n,style:es(es({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),o&&s.createElement("title",null,o),e.children)};return void 0!==Za?s.createElement(Za.Consumer,null,function(e){return t(e)}):t(Qa)}function ss(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"22 12 18 12 15 21 9 3 6 12 2 12"}}]})(e)}function os(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"}},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"}}]})(e)}function is(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}},{tag:"line",attr:{x1:"12",y1:"9",x2:"12",y2:"13"}},{tag:"line",attr:{x1:"12",y1:"17",x2:"12.01",y2:"17"}}]})(e)}function ls(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"12",x2:"5",y2:"12"}},{tag:"polyline",attr:{points:"12 19 5 12 12 5"}}]})(e)}function cs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"}},{tag:"polyline",attr:{points:"12 5 19 12 12 19"}}]})(e)}function ds(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"20",x2:"18",y2:"10"}},{tag:"line",attr:{x1:"12",y1:"20",x2:"12",y2:"4"}},{tag:"line",attr:{x1:"6",y1:"20",x2:"6",y2:"14"}}]})(e)}function us(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}},{tag:"path",attr:{d:"M13.73 21a2 2 0 0 1-3.46 0"}}]})(e)}function ms(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"}},{tag:"path",attr:{d:"M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"}}]})(e)}function hs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"}},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"}}]})(e)}function ps(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}},{tag:"circle",attr:{cx:"12",cy:"13",r:"4"}}]})(e)}function fs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}},{tag:"polyline",attr:{points:"22 4 12 14.01 9 11.01"}}]})(e)}function gs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"}}]})(e)}function xs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"}}]})(e)}function ys(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"}}]})(e)}function bs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"}}]})(e)}function vs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"18 15 12 9 6 15"}}]})(e)}function ws(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"polyline",attr:{points:"12 6 12 12 16 14"}}]})(e)}function js(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}},{tag:"line",attr:{x1:"1",y1:"10",x2:"23",y2:"10"}}]})(e)}function Ns(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"23"}},{tag:"path",attr:{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"}}]})(e)}function ks(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}},{tag:"polyline",attr:{points:"7 10 12 15 17 10"}},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"}}]})(e)}function Ss(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"}}]})(e)}function Cs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}},{tag:"path",attr:{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"}}]})(e)}function _s(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}},{tag:"polyline",attr:{points:"15 3 21 3 21 9"}},{tag:"line",attr:{x1:"10",y1:"14",x2:"21",y2:"3"}}]})(e)}function Es(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}},{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"}}]})(e)}function Ps(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}}]})(e)}function Os(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}},{tag:"polyline",attr:{points:"14 2 14 8 20 8"}},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"}},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"}},{tag:"polyline",attr:{points:"10 9 9 9 8 9"}}]})(e)}function As(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"}}]})(e)}function Ts(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}}]})(e)}function Ds(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"4"}},{tag:"line",attr:{x1:"1.05",y1:"12",x2:"7",y2:"12"}},{tag:"line",attr:{x1:"17.01",y1:"12",x2:"22.96",y2:"12"}}]})(e)}function Ms(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"}}]})(e)}function Is(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}},{tag:"circle",attr:{cx:"8.5",cy:"8.5",r:"1.5"}},{tag:"polyline",attr:{points:"21 15 16 10 5 21"}}]})(e)}function Ls(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"line",attr:{x1:"12",y1:"16",x2:"12",y2:"12"}},{tag:"line",attr:{x1:"12",y1:"8",x2:"12.01",y2:"8"}}]})(e)}function Rs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"4",x2:"10",y2:"4"}},{tag:"line",attr:{x1:"14",y1:"20",x2:"5",y2:"20"}},{tag:"line",attr:{x1:"15",y1:"4",x2:"9",y2:"20"}}]})(e)}function Fs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"}}]})(e)}function Bs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"6"}},{tag:"line",attr:{x1:"12",y1:"18",x2:"12",y2:"22"}},{tag:"line",attr:{x1:"4.93",y1:"4.93",x2:"7.76",y2:"7.76"}},{tag:"line",attr:{x1:"16.24",y1:"16.24",x2:"19.07",y2:"19.07"}},{tag:"line",attr:{x1:"2",y1:"12",x2:"6",y2:"12"}},{tag:"line",attr:{x1:"18",y1:"12",x2:"22",y2:"12"}},{tag:"line",attr:{x1:"4.93",y1:"19.07",x2:"7.76",y2:"16.24"}},{tag:"line",attr:{x1:"16.24",y1:"7.76",x2:"19.07",y2:"4.93"}}]})(e)}function Us(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 10 0v4"}}]})(e)}function zs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}},{tag:"polyline",attr:{points:"16 17 21 12 16 7"}},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"}}]})(e)}function Vs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}},{tag:"polyline",attr:{points:"22,6 12,13 2,6"}}]})(e)}function Ws(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"}}]})(e)}function qs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"}}]})(e)}function Hs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"}},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"}}]})(e)}function Ys(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"}}]})(e)}function Gs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"}}]})(e)}function Xs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"16.5",y1:"9.4",x2:"7.5",y2:"4.21"}},{tag:"path",attr:{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}},{tag:"polyline",attr:{points:"3.27 6.96 12 12.01 20.73 6.96"}},{tag:"line",attr:{x1:"12",y1:"22.08",x2:"12",y2:"12"}}]})(e)}function $s(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"}}]})(e)}function Ks(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"6",y:"4",width:"4",height:"16"}},{tag:"rect",attr:{x:"14",y:"4",width:"4",height:"16"}}]})(e)}function Js(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"}}]})(e)}function Qs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}},{tag:"path",attr:{d:"M22 12A10 10 0 0 0 12 2v10z"}}]})(e)}function Zs(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"5 3 19 12 5 21 5 3"}}]})(e)}function eo(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"}},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"}}]})(e)}function to(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"}},{tag:"polyline",attr:{points:"1 20 1 14 7 14"}},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"}}]})(e)}function no(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}},{tag:"polyline",attr:{points:"17 21 17 13 7 13 7 21"}},{tag:"polyline",attr:{points:"7 3 7 8 15 8"}}]})(e)}function ro(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"}},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}}]})(e)}function ao(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"22",y1:"2",x2:"11",y2:"13"}},{tag:"polygon",attr:{points:"22 2 15 22 11 13 2 9 22 2"}}]})(e)}function so(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"}}]})(e)}function oo(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}}]})(e)}function io(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"}},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"}},{tag:"path",attr:{d:"M16 10a4 4 0 0 1-8 0"}}]})(e)}function lo(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"}}]})(e)}function co(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}},{tag:"line",attr:{x1:"7",y1:"7",x2:"7.01",y2:"7"}}]})(e)}function uo(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"5",width:"22",height:"14",rx:"7",ry:"7"}},{tag:"circle",attr:{cx:"8",cy:"12",r:"3"}}]})(e)}function mo(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"5",width:"22",height:"14",rx:"7",ry:"7"}},{tag:"circle",attr:{cx:"16",cy:"12",r:"3"}}]})(e)}function ho(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"}},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"}},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"}}]})(e)}function po(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"}},{tag:"polyline",attr:{points:"17 6 23 6 23 12"}}]})(e)}function fo(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"4 7 4 4 20 4 20 7"}},{tag:"line",attr:{x1:"9",y1:"20",x2:"15",y2:"20"}},{tag:"line",attr:{x1:"12",y1:"4",x2:"12",y2:"20"}}]})(e)}function go(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M6 3v7a6 6 0 0 0 6 6 6 6 0 0 0 6-6V3"}},{tag:"line",attr:{x1:"4",y1:"21",x2:"20",y2:"21"}}]})(e)}function xo(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 9.9-1"}}]})(e)}function yo(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}},{tag:"polyline",attr:{points:"17 8 12 3 7 8"}},{tag:"line",attr:{x1:"12",y1:"3",x2:"12",y2:"15"}}]})(e)}function bo(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"}},{tag:"line",attr:{x1:"20",y1:"8",x2:"20",y2:"14"}},{tag:"line",attr:{x1:"23",y1:"11",x2:"17",y2:"11"}}]})(e)}function vo(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"}}]})(e)}function wo(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"}},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"}},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"}}]})(e)}function jo(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"}},{tag:"path",attr:{d:"M16.72 11.06A10.94 10.94 0 0 1 19 12.55"}},{tag:"path",attr:{d:"M5 12.55a10.94 10.94 0 0 1 5.17-2.39"}},{tag:"path",attr:{d:"M10.71 5.05A16 16 0 0 1 22.58 9"}},{tag:"path",attr:{d:"M1.42 9a15.91 15.91 0 0 1 4.7-2.88"}},{tag:"path",attr:{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}},{tag:"line",attr:{x1:"12",y1:"20",x2:"12.01",y2:"20"}}]})(e)}function No(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M5 12.55a11 11 0 0 1 14.08 0"}},{tag:"path",attr:{d:"M1.42 9a16 16 0 0 1 21.16 0"}},{tag:"path",attr:{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}},{tag:"line",attr:{x1:"12",y1:"20",x2:"12.01",y2:"20"}}]})(e)}function ko(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"}},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"}}]})(e)}function So(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"}},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}},{tag:"line",attr:{x1:"11",y1:"8",x2:"11",y2:"14"}},{tag:"line",attr:{x1:"8",y1:"11",x2:"14",y2:"11"}}]})(e)}function Co(e){return rs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"}},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}},{tag:"line",attr:{x1:"8",y1:"11",x2:"14",y2:"11"}}]})(e)}xr.interceptors.request.use(e=>("get"===e.method&&(e.params=Ye(Ye({},e.params),{},{_t:Date.now()})),e),e=>Promise.reject(e));const _o=e=>{var t;if(!e.response)return!0;const n=e.response.status,r=null===(t=e.response.data)||void 0===t?void 0:t.error;return n>=500||503===n||"DB_CONNECTION_ERROR"===r||"DB_DISCONNECTED"===r},Eo=e=>new Promise(t=>setTimeout(t,e));xr.interceptors.response.use(e=>e,async e=>{const t=e.config;if(t.__retryCount>=1||t.skipRetry||t.__usingCustomRetry)return Promise.reject(e);t.__retryCount=t.__retryCount||0;if(!e.response&&("ECONNREFUSED"===e.code||"ENOTFOUND"===e.code||e.message.includes("Network Error"))){t.__retryCount++;const e=3e3;return console.warn("\u26a0\ufe0f Network error, retrying in ".concat(e,"ms...")),await Eo(e),xr(t)}return Promise.reject(e)});const Po=e=>{let{className:t=""}=e;const{isConnected:n,connectionAttempts:r,lastConnectionError:a}=Xa(),[o,i]=(0,s.useState)({healthy:!0,checking:!1}),[l,c]=(0,s.useState)(!1);(0,s.useEffect)(()=>{const e=async()=>{i(e=>Ye(Ye({},e),{},{checking:!0}));try{const e=await(async()=>{try{var e,t,n;const r=Date.now(),a=await xr.get("/api/health",{timeout:5e3,skipRetry:!0}),s=Date.now()-r,o="connected"===(null===(e=a.data)||void 0===e?void 0:e.database);return{healthy:200===a.status&&o,latency:s,databaseStatus:(null===(t=a.data)||void 0===t?void 0:t.database)||"unknown",serverStatus:(null===(n=a.data)||void 0===n?void 0:n.status)||"unknown"}}catch(a){var r;return{healthy:!1,error:404===(null===(r=a.response)||void 0===r?void 0:r.status)?"Health endpoint not found":a.message,canRetry:_o(a)}}})();i(Ye(Ye({},e),{},{checking:!1}))}catch(e){i({healthy:!1,error:e.message,checking:!1})}};e();const t=setInterval(e,3e4);return()=>clearInterval(t)},[]);const d=n||o.healthy?n&&o.healthy?r>0?{status:"reconnecting",message:"Reconnecting...",icon:to,color:"text-blue-500 bg-blue-100 border-blue-200"}:{status:"connected",message:"Connected",icon:No,color:"text-green-600 bg-green-100 border-green-200"}:{status:"degraded",message:"Partial Connection",icon:is,color:"text-yellow-600 bg-yellow-100 border-yellow-200"}:{status:"offline",message:"Disconnected",icon:jo,color:"text-red-500 bg-red-100 border-red-200"},u=d.icon;return(0,yr.jsxs)("div",{className:"relative ".concat(t),children:[(0,yr.jsxs)("button",{onClick:()=>c(!l),className:"flex items-center space-x-2 px-3 py-1.5 rounded-lg border text-sm font-medium transition-colors ".concat(d.color," hover:opacity-80"),title:"Click for connection details",children:[(0,yr.jsx)(u,{className:"h-4 w-4 ".concat("reconnecting"===d.status?"animate-spin":"")}),(0,yr.jsx)("span",{children:d.message})]}),l&&(0,yr.jsx)("div",{className:"absolute top-full left-0 mt-2 w-72 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:(0,yr.jsxs)("div",{className:"p-4",children:[(0,yr.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Connection Status"}),(0,yr.jsxs)("div",{className:"mb-3",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,yr.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Real-time Sync"}),(0,yr.jsxs)("div",{className:"flex items-center space-x-1 ".concat(n?"text-green-600":"text-red-500"),children:[n?(0,yr.jsx)(No,{className:"h-3 w-3"}):(0,yr.jsx)(jo,{className:"h-3 w-3"}),(0,yr.jsx)("span",{className:"text-xs",children:n?"Connected":"Disconnected"})]})]}),r>0&&(0,yr.jsxs)("p",{className:"text-xs text-blue-600",children:["Reconnecting... (attempt ",r,")"]}),a&&(0,yr.jsxs)("p",{className:"text-xs text-red-500",children:["Error: ",a]})]}),(0,yr.jsxs)("div",{className:"mb-3",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,yr.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Database API"}),(0,yr.jsxs)("div",{className:"flex items-center space-x-1 ".concat(o.healthy?"text-green-600":"text-red-500"),children:[o.checking?(0,yr.jsx)(to,{className:"h-3 w-3 animate-spin"}):o.healthy?(0,yr.jsx)(No,{className:"h-3 w-3"}):(0,yr.jsx)(jo,{className:"h-3 w-3"}),(0,yr.jsx)("span",{className:"text-xs",children:o.checking?"Checking...":o.healthy?"Connected":"Disconnected"})]})]}),o.error&&(0,yr.jsxs)("p",{className:"text-xs text-red-500",children:["Error: ",o.error]}),o.latency&&(0,yr.jsxs)("p",{className:"text-xs text-gray-500",children:["Latency: ",o.latency,"ms"]}),o.databaseStatus&&(0,yr.jsxs)("p",{className:"text-xs text-gray-500",children:["Database: ",o.databaseStatus]}),o.serverStatus&&(0,yr.jsxs)("p",{className:"text-xs text-gray-500",children:["Server: ",o.serverStatus]})]}),(!n||!o.healthy)&&(0,yr.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-2",children:[(0,yr.jsx)("p",{className:"text-xs text-yellow-800 font-medium mb-1",children:"Connection Issues?"}),(0,yr.jsxs)("ul",{className:"text-xs text-yellow-700 space-y-1",children:[(0,yr.jsx)("li",{children:"\u2022 Check your internet connection"}),(0,yr.jsx)("li",{children:"\u2022 Refresh the page if problems persist"}),(0,yr.jsx)("li",{children:"\u2022 Data will sync when connection is restored"})]})]}),(0,yr.jsxs)("button",{onClick:()=>{i(e=>Ye(Ye({},e),{},{checking:!0})),window.location.reload()},className:"w-full mt-3 px-3 py-2 bg-blue-50 text-blue-700 border border-blue-200 rounded text-sm font-medium hover:bg-blue-100 transition-colors",children:[(0,yr.jsx)(to,{className:"h-3 w-3 inline mr-1"}),"Refresh Page"]})]})})]})};function Oo(e){if(!e||"string"!==typeof e)return e;let t=e;return t=t.replace(/^--[A-Za-z0-9._-]+$/gm,""),t=t.replace(/^--[A-Za-z0-9._-]+--$/gm,""),t=t.replace(/^Content-Type:.*$/gm,""),t=t.replace(/^Content-Transfer-Encoding:.*$/gm,""),t=t.replace(/^Content-Disposition:.*$/gm,""),t=t.replace(/^boundary=.*$/gm,""),t=t.replace(/^charset=.*$/gm,""),t=t.replace(/^MIME-Version:.*$/gm,""),t=t.replace(/^X-.*$/gm,""),t=t.replace(/^Message-ID:.*$/gm,""),t=t.replace(/^Date:.*$/gm,""),t=t.replace(/^From:.*$/gm,""),t=t.replace(/^To:.*$/gm,""),t=t.replace(/^Subject:.*$/gm,""),t=function(e){if(!e)return"";try{return e=(e=e.replace(/=\r?\n/g,"")).replace(/=([0-9A-F]{2})/gi,(e,t)=>String.fromCharCode(parseInt(t,16))),e}catch(t){return console.error("Error decoding quoted-printable:",t),e}}(t),t=function(e){if(!e)return"";e=(e=(e=(e=(e=e.replace(/<br\s*\/?>/gi,"\n")).replace(/<\/?(div|p|h[1-6]|li|tr)[^>]*>/gi,"\n")).replace(/<\/td>/gi,"\t")).replace(/<hr[^>]*>/gi,"\n---\n")).replace(/<[^>]+>/g,"");const t={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#34;":'"',"&#39;":"'","&apos;":"'","&#x27;":"'","&ldquo;":'"',"&rdquo;":'"',"&lsquo;":"'","&rsquo;":"'","&mdash;":"-","&ndash;":"-","&hellip;":"...","\xe2\u20ac\u2122":"'","\xe2\u20ac\u0153":'"',"\xe2\u20ac":'"','\xe2\u20ac"':"-",'\xe2\u20ac"':"-","\xe2\u20ac\xa6":"...","\xe2":""};for(const[n,r]of Object.entries(t))e=e.replace(new RegExp(n,"g"),r);return e=(e=e.replace(/&#(\d+);/g,(e,t)=>String.fromCharCode(t))).replace(/&#x([0-9a-f]+);/gi,(e,t)=>String.fromCharCode(parseInt(t,16))),e}(t),t=t.replace(/^\s*=\r?\n/gm,""),t=t.replace(/^=\r?\n/gm,""),t=t.replace(/\n{3,}/g,"\n\n"),t=t.replace(/[ \t]+/g," "),t=t.replace(/^\s+|\s+$/gm,""),t=t.trim(),t}function Ao(e){if(!e)return!1;const t=/^Content-Type:|^Content-Transfer-Encoding:|^charset=/m.test(e),n=/=([0-9A-F]{2})/i.test(e),r=/<[^>]+>/g.test(e),a=/^--[A-Za-z0-9._-]+$/m.test(e);return t||n||r||a}function To(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;if(!e)return"";const n=Oo(e);if(n.length<=t)return n;let r=n.substring(0,t);const a=r.lastIndexOf("."),s=r.lastIndexOf(" ");return a>.7*t?r=n.substring(0,a+1):s>.8*t&&(r=n.substring(0,s)),r+(n.length>t?"...":"")}const Do=e=>{let{htmlContent:t,textContent:n,attachments:r=[],embeddedImages:a=[],className:o=""}=e;const i=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(i.current&&t){const e=i.current,n=e.contentDocument||e.contentWindow.document,r=(e=>{if(!e)return"";const t=(new DOMParser).parseFromString(e,"text/html");["script","iframe","object","embed","form","input","button"].forEach(e=>{const n=t.getElementsByTagName(e);for(;n.length>0;)n[0].remove()});const n=t.getElementsByTagName("*");for(let a=0;a<n.length;a++){const e=n[a],t=[];for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],a=r.name.toLowerCase();(a.startsWith("on")||a.startsWith("data-")||"href"===a&&r.value.startsWith("javascript:")||"src"===a&&r.value.startsWith("javascript:"))&&t.push(r.name)}t.forEach(t=>e.removeAttribute(t))}const r=t.getElementsByTagName("img");for(let o=0;o<r.length;o++){const e=r[o],t=e.getAttribute("src");if(t&&t.startsWith("cid:")){const n=t.replace("cid:",""),r=a.find(e=>e.contentId===n||e.contentId==="<".concat(n,">"));r&&r.dataUrl?e.setAttribute("src",r.dataUrl):e.style.display="none"}e.style.maxWidth="100%",e.style.height="auto"}const s=t.getElementsByTagName("a");for(let a=0;a<s.length;a++){const e=s[a],t=e.getAttribute("href");!t||t.startsWith("http")||t.startsWith("mailto:")||t.startsWith("#")||e.setAttribute("href","https://"+t),e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer")}return t.body.innerHTML})(t);n.open(),n.write('\n        <!DOCTYPE html>\n        <html>\n          <head>\n            <meta charset="utf-8">\n            <meta name="viewport" content="width=device-width, initial-scale=1">\n            <style>'.concat("\n    * {\n      box-sizing: border-box;\n    }\n    \n    body {\n      margin: 0;\n      padding: 0;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n      font-size: 14px;\n      line-height: 1.5;\n      color: #202124;\n      background-color: transparent;\n    }\n    \n    /* Gmail-like typography */\n    p {\n      margin: 0 0 12px 0;\n    }\n    \n    p:last-child {\n      margin-bottom: 0;\n    }\n    \n    /* Headings */\n    h1, h2, h3, h4, h5, h6 {\n      margin: 16px 0 8px 0;\n      font-weight: 600;\n      color: #202124;\n    }\n    \n    h1 { font-size: 20px; }\n    h2 { font-size: 18px; }\n    h3 { font-size: 16px; }\n    h4, h5, h6 { font-size: 14px; }\n    \n    /* Lists */\n    ul, ol {\n      margin: 8px 0;\n      padding-left: 24px;\n    }\n    \n    li {\n      margin: 4px 0;\n    }\n    \n    /* Links */\n    a {\n      color: #1a73e8;\n      text-decoration: none;\n    }\n    \n    a:hover {\n      text-decoration: underline;\n    }\n    \n    /* Images */\n    img {\n      max-width: 100%;\n      height: auto;\n      border: 0;\n    }\n    \n    /* Tables */\n    table {\n      border-collapse: collapse;\n      max-width: 100%;\n    }\n    \n    td, th {\n      padding: 8px;\n      border: 1px solid #dadce0;\n    }\n    \n    /* Blockquotes (for reply chains) */\n    blockquote {\n      margin: 8px 0;\n      padding-left: 12px;\n      border-left: 3px solid #dadce0;\n      color: #5f6368;\n    }\n    \n    /* Gmail quote style for forwarded/replied emails */\n    .gmail_quote {\n      margin: 8px 0;\n      padding-left: 12px;\n      border-left: 3px solid #dadce0;\n    }\n    \n    /* Outlook quote style */\n    div[style*=\"border-left\"] {\n      margin: 8px 0 !important;\n    }\n    \n    /* Horizontal rules */\n    hr {\n      border: none;\n      border-top: 1px solid #dadce0;\n      margin: 16px 0;\n    }\n    \n    /* Preformatted text */\n    pre {\n      background-color: #f8f9fa;\n      padding: 12px;\n      border-radius: 4px;\n      overflow-x: auto;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n      font-size: 13px;\n    }\n    \n    code {\n      background-color: #f8f9fa;\n      padding: 2px 6px;\n      border-radius: 3px;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n      font-size: 13px;\n    }\n    \n    /* Common email template classes */\n    .signature {\n      margin-top: 16px;\n      padding-top: 16px;\n      border-top: 1px solid #dadce0;\n    }\n    \n    /* Hide any tracking pixels */\n    img[width=\"1\"][height=\"1\"],\n    img[width=\"0\"][height=\"0\"] {\n      display: none;\n    }\n    \n    /* Responsive embeds */\n    iframe, video {\n      max-width: 100%;\n    }\n  ","</style>\n          </head>\n          <body>").concat(r,"</body>\n        </html>\n      ")),n.close();const s=()=>{e.style.height=n.body.scrollHeight+"px"};s();const o=n.getElementsByTagName("img");for(let t of o)t.onload=s}},[t,a]);const l=e=>{if(!e)return"";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*10)/10+" "+["B","KB","MB","GB"][t]};if(t&&(e=>{if(!e)return!1;return/<[a-z][\s\S]*>/i.test(e)})(t))return(0,yr.jsxs)("div",{className:"gmail-email-renderer ".concat(o),children:[(0,yr.jsx)("iframe",{ref:i,className:"w-full border-0",style:{minHeight:"100px"},title:"Email Content",sandbox:"allow-same-origin allow-popups"}),r&&r.length>0&&(0,yr.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,yr.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,yr.jsx)($s,{className:"mr-2"}),"Attachments (",r.length,")"]}),(0,yr.jsx)("div",{className:"flex flex-wrap gap-2",children:r.map((e,t)=>{var n;return(0,yr.jsxs)("a",{href:e.url||e.downloadUrl||"#",target:"_blank",rel:"noopener noreferrer",className:"flex items-center px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm text-gray-700 transition-colors",children:[null!==(n=e.contentType)&&void 0!==n&&n.startsWith("image/")?(0,yr.jsx)(Is,{className:"mr-2 text-blue-500"}):(0,yr.jsx)($s,{className:"mr-2 text-gray-500"}),(0,yr.jsx)("span",{className:"truncate max-w-[150px]",children:e.filename||e.name||"Attachment ".concat(t+1)}),e.size&&(0,yr.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",l(e.size),")"]})]},t)})})]})]});return(0,yr.jsxs)("div",{className:"gmail-email-renderer ".concat(o),children:[(e=>{if(!e)return(0,yr.jsx)("p",{className:"text-gray-500 italic",children:"No content"});const t=/(https?:\/\/[^\s<]+|www\.[^\s<]+)/g,n=e.split(t),r=e.match(t)||[];return(0,yr.jsx)("div",{className:"whitespace-pre-wrap break-words text-sm text-gray-900",children:n.map((e,t)=>(0,yr.jsxs)(s.Fragment,{children:[e,r[t]&&(0,yr.jsx)("a",{href:r[t].startsWith("www.")?"https://".concat(r[t]):r[t],target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:r[t]})]},t))})})(n||t),r&&r.length>0&&(0,yr.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,yr.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,yr.jsx)($s,{className:"mr-2"}),"Attachments (",r.length,")"]}),(0,yr.jsx)("div",{className:"flex flex-wrap gap-2",children:r.map((e,t)=>(0,yr.jsxs)("a",{href:e.url||e.downloadUrl||"#",target:"_blank",rel:"noopener noreferrer",className:"flex items-center px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm text-gray-700 transition-colors",children:[(0,yr.jsx)($s,{className:"mr-2 text-gray-500"}),(0,yr.jsx)("span",{className:"truncate max-w-[150px]",children:e.filename||e.name||"Attachment ".concat(t+1)})]},t))})]})]})},Mo=e=>{let{notification:t,isOpen:n,onClose:r,onReply:a}=e;const[o,i]=(0,s.useState)(""),[l,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)([]),[m,h]=(0,s.useState)(!1),[p,f]=(0,s.useState)(!1),[g,x]=(0,s.useState)(null),{socket:y}=Xa(),b=(0,s.useCallback)(async()=>{try{h(!0);const e=localStorage.getItem("token"),n=(await xr.get("/api/messages-list",{headers:e?{Authorization:"Bearer ".concat(e)}:{},params:{limit:200}})).data.messages||[],r=n.filter(e=>e.leadId===t.leadId&&("email"===(null===t||void 0===t?void 0:t.type)&&"email"===e.type||"sms"===(null===t||void 0===t?void 0:t.type)&&"sms"===e.type)).sort((e,t)=>new Date(e.timestamp)-new Date(t.timestamp)).map(e=>{var t,n;return{action:"sent"===e.direction?"email"===e.type?"EMAIL_SENT":"SMS_SENT":"email"===e.type?"EMAIL_RECEIVED":"SMS_RECEIVED",timestamp:e.timestamp,performed_by:e.performedBy,performed_by_name:e.performedByName,details:{subject:e.subject,body:e.content,message:e.content,email_body:e.email_body||(null===(t=e.details)||void 0===t?void 0:t.email_body)||null,html_content:e.email_body||(null===(n=e.details)||void 0===n?void 0:n.email_body)||null,direction:e.direction,channel:e.type,attachments:e.attachments||[],embedded_images:e.embedded_images||[]}}}),a=new Set,s=r.filter(e=>{var t,n,r;const s=e.timestamp?new Date(e.timestamp).toISOString():"",o=e.action||"",i=(null===(t=e.details)||void 0===t?void 0:t.body)||(null===(n=e.details)||void 0===n?void 0:n.message)||"",l=(null===(r=e.details)||void 0===r?void 0:r.subject)||"",c=e.performed_by||"",d=s?new Date(s).setSeconds(0,0):0,u=i.substring(0,200).trim().toLowerCase(),m="".concat(o,"_").concat(d,"_").concat(c,"_").concat(l.substring(0,50),"_").concat(u);return a.has(m)?(console.log("\ud83d\udd04 Client-side deduplication: Removing duplicate entry"),!1):(a.add(m),!0)});u(s)}catch(e){console.error("Error fetching conversation history:",e),u([])}finally{h(!1)}},[null===t||void 0===t?void 0:t.leadId,null===t||void 0===t?void 0:t.type]);if((0,s.useEffect)(()=>{if(n&&t){f(!1),x(null),b();const e=async()=>{console.log("\ud83d\udcf1 MessageModal: Marking message as read (always attempt for consistency)");try{f(!0),x(null),console.log("\ud83d\udcf1 MessageModal: Attempting to mark message as read:",t.id),console.log("\ud83d\udcf1 MessageModal: Notification object:",t);let e=t.messageId||t.id;const n=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;if(!n.test(e)){const t=e.includes("_")?e.split("_")[0]:e;n.test(t)?(e=t,console.log("\ud83d\udcf1 MessageModal: Extracted UUID from composite ID:",e)):console.warn("\ud83d\udcf1 MessageModal: Invalid message ID format, may fail:",e)}console.log("\ud83d\udcf1 MessageModal: Final message identifier:",e),console.log("\ud83d\udcf1 MessageModal: Has leadId:",!!t.leadId,"Has timestamp:",!!t.timestamp);const r=localStorage.getItem("token"),a=await xr.put("/api/messages-list/".concat(e,"/read"),{},{headers:r?{Authorization:"Bearer ".concat(r)}:{}});console.log("\ud83d\udcf1 MessageModal: API response:",a.data),a.data.success?(console.log("\u2705 MessageModal: Message marked as read successfully:",t.id),console.log("\ud83d\udccb MessageModal: Update method used:",a.data.method||"booking_history"),f(!1),y&&(y.emit("message_read_direct",{messageId:t.id,leadId:t.leadId,leadName:t.leadName}),console.log("\ud83d\udce1 MessageModal: Emitted direct socket event as backup"))):(console.error("\u274c MessageModal: API response indicates failure:",a.data),x("Failed to mark message as read"),f(!1))}catch(s){var e,n,r,a;if(console.error("\u274c MessageModal: Error marking message as read:",s),console.error("\u274c MessageModal: Error details:",null===(e=s.response)||void 0===e?void 0:e.data),404===(null===(n=s.response)||void 0===n?void 0:n.status))console.log("\ud83d\uddd1\ufe0f MessageModal: Message not found (404), but keeping modal open:",t.id),x("Message not found in database"),f(!1);else x((null===(r=s.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||"Failed to mark message as read"),f(!1)}},n=setTimeout(()=>{e()},100);return()=>clearTimeout(n)}n||(f(!1),x(null))},[n,t,b,y]),(0,s.useEffect)(()=>{if(y&&n&&t){const e=e=>{"LEAD_UPDATED"===e.type&&e.data.lead&&e.data.lead.id===t.leadId&&b()},n=e=>{e&&e.leadId===t.leadId&&b()},r=e=>{e&&e.leadId===t.leadId&&b()};return y.on("lead_updated",e),y.on("sms_received",n),y.on("message_received",r),()=>{y.off("lead_updated",e),y.off("sms_received",n),y.off("message_received",r)}}},[y,n,t,b]),(0,s.useEffect)(()=>{if(d.length>0){const e=document.querySelector(".conversation-scroll");e&&(e.scrollTop=e.scrollHeight)}},[d]),!n||!t)return null;const v=e=>{try{if(!e)return"Unknown time";let t;if(t="string"===typeof e?new Date(e):"number"===typeof e?new Date(e>1e12?e:1e3*e):new Date(e),isNaN(t.getTime()))return console.warn("Invalid timestamp:",e),"Invalid date";const n=new Date-t,r=n/36e5,a=n/864e5;if(r<1){const e=Math.floor(n/6e4);return e<=0?"Just now":"".concat(e," minute").concat(1===e?"":"s"," ago")}if(r<24)return t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0});if(a<7){const e=Math.floor(a);return"".concat(e," day").concat(1===e?"":"s"," ago at ").concat(t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}))}return t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})}catch(t){return console.error("Error formatting timestamp:",t,"Timestamp:",e),"Unknown time"}};return(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-hidden",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:["email"===(null===t||void 0===t?void 0:t.type)?(0,yr.jsx)(Vs,{className:"h-5 w-5 text-green-600"}):(0,yr.jsx)(Ys,{className:"h-5 w-5 text-blue-600"}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:[t.isGrouped?"Conversation with":"Message from"," ",t.leadName||"Unknown",t.isGrouped&&t.conversationCount>1&&(0,yr.jsxs)("span",{className:"ml-2 text-sm font-normal text-purple-600",children:["(",t.conversationCount," messages)"]})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsxs)("p",{className:"text-sm text-gray-500",children:[(0,yr.jsx)(ws,{className:"h-3 w-3 inline mr-1"}),t.isGrouped?"Latest message: ":"",v(t.timestamp)]}),p&&(0,yr.jsxs)("span",{className:"text-xs text-blue-600 flex items-center",children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600 mr-1"}),"Marking as read..."]}),g&&(0,yr.jsxs)("span",{className:"text-xs text-red-600 flex items-center",children:[(0,yr.jsx)(os,{className:"h-3 w-3 mr-1"}),g]}),!p&&!g&&t.read&&(0,yr.jsxs)("span",{className:"text-xs text-green-600 flex items-center",children:[(0,yr.jsx)(gs,{className:"h-3 w-3 mr-1"}),"Read"]})]})]})]}),(0,yr.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,yr.jsx)(ko,{className:"h-5 w-5"})})]}),(0,yr.jsxs)("div",{className:"p-4 max-h-96 overflow-y-auto conversation-scroll bg-white",children:[(null===t||void 0===t?void 0:t.content)&&(0,yr.jsxs)("div",{className:"mb-4 rounded-lg shadow-sm ".concat("sent"===t.direction?"bg-blue-600 text-white ml-auto max-w-[85%]":"bg-gray-100 text-gray-900 mr-auto max-w-[85%]"),children:[(0,yr.jsx)("div",{className:"px-4 py-3 border-b ".concat("sent"===t.direction?"border-blue-500":"border-gray-300"),children:(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("span",{className:"text-sm font-semibold ".concat("sent"===t.direction?"text-blue-100":"text-gray-900"),children:"sent"===t.direction?"You":t.leadName||"Unknown"}),t.subject&&(0,yr.jsx)("span",{className:"text-xs ".concat("sent"===t.direction?"text-blue-200":"text-gray-600"),children:t.subject})]}),(0,yr.jsx)("span",{className:"text-xs ".concat("sent"===t.direction?"text-blue-200":"text-gray-500"),children:v(t.timestamp)})]})}),(0,yr.jsx)("div",{className:"px-4 py-3",children:"email"===(null===t||void 0===t?void 0:t.type)&&(t.email_body||t.html_content)?(0,yr.jsx)("div",{className:"email-html-wrapper",children:(0,yr.jsx)(Do,{htmlContent:t.email_body||t.html_content,textContent:t.content,attachments:t.attachments||[],embeddedImages:t.embedded_images||[]})}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("p",{className:"text-sm whitespace-pre-wrap break-words ".concat("sent"===t.direction?"text-white":"text-gray-900"),children:Oo(t.content)}),Ao(t.content)&&(0,yr.jsx)("span",{className:"mt-2 inline-block px-2 py-0.5 text-xs rounded ".concat("sent"===t.direction?"bg-blue-500 text-blue-100":"bg-yellow-100 text-yellow-800"),children:"Auto-decoded"})]})})]}),m?(0,yr.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,yr.jsx)("span",{className:"ml-2 text-gray-500",children:"Loading conversation..."})]}):0===d.length?(0,yr.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,yr.jsx)(Ys,{className:"mx-auto h-8 w-8 mb-2"}),(0,yr.jsx)("p",{children:"No previous conversation history"}),(0,yr.jsx)("p",{className:"text-xs mt-1",children:"This is the start of your conversation"})]}):(0,yr.jsx)("div",{className:"space-y-3",children:d.filter((e,n)=>{var r,a,s;const o=(null===t||void 0===t?void 0:t.content)||"",i=(null===(r=e.details)||void 0===r?void 0:r.body)||(null===(a=e.details)||void 0===a?void 0:a.message)||(null===(s=e.details)||void 0===s?void 0:s.subject)||"";if(o.trim()===i.trim())return console.log("\ud83d\udd04 Filtering out duplicate message from conversation history"),!1;if(null!==t&&void 0!==t&&t.timestamp&&e.timestamp){const n=new Date(t.timestamp).getTime(),r=new Date(e.timestamp).getTime();if(Math.abs(n-r)<5e3&&o.includes(i.substring(0,50)))return console.log("\ud83d\udd04 Filtering out near-duplicate message from conversation history"),!1}return!0}).map((e,n)=>{var r,a,s,o,i,l,c,d,u,m,h,p,f,g;const x=["SMS_SENT","EMAIL_SENT"].includes(e.action),y="SMS_FAILED"===e.action;return(0,yr.jsx)("div",{className:"flex ".concat(x?"justify-end":"justify-start"," mb-3"),children:(0,yr.jsxs)("div",{className:"max-w-[85%] rounded-lg shadow-sm ".concat(x?"bg-blue-600 text-white":y?"bg-red-50 border border-red-300 text-red-800":"bg-gray-100 text-gray-900"),children:[(0,yr.jsx)("div",{className:"px-4 py-2 border-b ".concat(x?"border-blue-500":y?"border-red-300":"border-gray-300"),children:(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("span",{className:"text-sm font-semibold ".concat(x?"text-blue-100":y?"text-red-900":"text-gray-900"),children:x?"You":t.leadName||"Unknown"}),(null===(r=e.details)||void 0===r?void 0:r.subject)&&(0,yr.jsx)("span",{className:"text-xs ".concat(x?"text-blue-200":y?"text-red-700":"text-gray-600"),children:e.details.subject})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("span",{className:"text-xs ".concat(x?"text-blue-200":y?"text-red-700":"text-gray-500"),children:v(e.timestamp)}),x&&(0,yr.jsx)(gs,{className:"h-3 w-3 ".concat("delivered"===e.delivery_status?"text-blue-200":"text-blue-300")}),y&&(0,yr.jsx)(os,{className:"h-3 w-3 text-red-600",title:(null===(a=e.details)||void 0===a?void 0:a.error_message)||"Failed"})]})]})}),(0,yr.jsx)("div",{className:"px-4 py-3",children:"email"===(null===t||void 0===t?void 0:t.type)&&(null!==(s=e.details)&&void 0!==s&&s.email_body||null!==(o=e.details)&&void 0!==o&&o.html_content)?(0,yr.jsx)("div",{className:x?"email-sent":y?"email-failed":"email-received",children:(0,yr.jsx)(Do,{htmlContent:(null===(i=e.details)||void 0===i?void 0:i.email_body)||(null===(l=e.details)||void 0===l?void 0:l.html_content),textContent:(null===(c=e.details)||void 0===c?void 0:c.body)||(null===(d=e.details)||void 0===d?void 0:d.message)||(null===(u=e.details)||void 0===u?void 0:u.subject)||"No content",attachments:(null===(m=e.details)||void 0===m?void 0:m.attachments)||[],embeddedImages:(null===(h=e.details)||void 0===h?void 0:h.embedded_images)||[]})}):(0,yr.jsx)("p",{className:"text-sm whitespace-pre-wrap break-words ".concat(x?"text-white":y?"text-red-900":"text-gray-900"),children:Oo((null===(p=e.details)||void 0===p?void 0:p.body)||(null===(f=e.details)||void 0===f?void 0:f.message)||(null===(g=e.details)||void 0===g?void 0:g.subject)||"No content")})})]})},"".concat(e.timestamp,"-").concat(n))})})]}),(0,yr.jsx)("div",{className:"border-t border-gray-200 p-4 bg-white",children:(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"email"===(null===t||void 0===t?void 0:t.type)?"Reply via Email":"Reply via SMS"}),(0,yr.jsx)("div",{className:"flex space-x-3",children:(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("textarea",{value:o,onChange:e=>i(e.target.value),placeholder:"Type your reply message...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:"3",maxLength:"email"===(null===t||void 0===t?void 0:t.type)?5e3:160}),(0,yr.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[(0,yr.jsxs)("p",{className:"text-xs text-gray-500",children:[o.length,"/","email"===(null===t||void 0===t?void 0:t.type)?5e3:160," characters"]}),o.length>140&&(0,yr.jsx)("p",{className:"text-xs text-orange-500",children:"May be sent as multiple messages"})]})]})})]})}),(0,yr.jsxs)("div",{className:"bg-gray-50 px-4 py-3 flex justify-between items-center",children:[(0,yr.jsxs)("button",{onClick:()=>window.open("/leads/".concat(t.leadId),"_blank"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center space-x-1",children:[(0,yr.jsx)(vo,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"View Lead Details"}),(0,yr.jsx)(cs,{className:"h-3 w-3"})]}),(0,yr.jsxs)("div",{className:"flex space-x-3",children:[(0,yr.jsx)("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Close"}),(0,yr.jsx)("button",{onClick:async()=>{if(o.trim())if(l)console.log("Reply already being sent, ignoring duplicate request");else try{if(c(!0),"email"===(null===t||void 0===t?void 0:t.type)){const e=(null===t||void 0===t?void 0:t.subject)||(null===t||void 0===t?void 0:t.content)||"",n=e&&!/^re\s*:/i.test(e)?"Re: ".concat(e):e||"Re:",s=await xr.post("/api/leads/".concat(t.leadId,"/send-email"),{subject:n,body:o});if(s.data.success){alert("Email sent successfully!"),i("");try{await xr.put("/api/messages-list/".concat(t.id,"/read"))}catch(r){}await b(),a&&a({leadId:t.leadId,leadName:t.leadName,content:o}),y&&y.emit("message_read",{leadId:t.leadId})}else alert("Failed to send email: "+(s.data.message||"Unknown error"))}else{const e=await xr.post("/api/leads/".concat(t.leadId,"/send-sms"),{message:o,type:"custom"});if(e.data.success){alert("SMS reply sent successfully!");const e=o;i("");try{await xr.put("/api/messages-list/".concat(t.id,"/read"))}catch(s){}await b(),a&&a({leadId:t.leadId,leadName:t.leadName,leadPhone:t.leadPhone,content:e}),y&&y.emit("message_read",{leadId:t.leadId})}else alert("Failed to send SMS: "+(e.data.message||"Unknown error"))}}catch(d){var e,n;console.error("Error sending reply:",d),alert("Error sending message: "+((null===(e=d.response)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)||d.message))}finally{c(!1)}else alert("Please enter a reply message")},disabled:l||!o.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:l?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,yr.jsx)("span",{children:"Sending..."})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(ao,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"email"===(null===t||void 0===t?void 0:t.type)?"Send Email":"Send SMS"})]})})]})]})]})})},Io=JSON.parse('{"rE":"1.0.251","ui":"0479ef7","df":"Add generic lead webhook for external landing pages","W8":"2026-02-19 23:49:19 +0000","cy":"Tin","tk":"main"}'),Lo="patchNotesSeenCommit",Ro={version:Io.rE||"1.0.0",commitHash:Io.ui||"unknown",commitMessage:Io.df||"No message",commitDate:Io.W8||(new Date).toISOString(),branch:Io.tk||"unknown",author:Io.cy||"Unknown"},Fo=(0,s.createContext)({isOpen:!1,openPatchNotes:()=>{},closePatchNotes:()=>{},currentVersion:Ro,hasUpdate:!1}),Bo=()=>(0,s.useContext)(Fo),Uo=e=>{let{children:t}=e;const{user:n}=Nr(),[r,a]=(0,s.useState)(!1),[o,i]=(0,s.useState)(!1),[l,c]=(0,s.useState)(!1),d="admin"===(null===n||void 0===n?void 0:n.role);(0,s.useEffect)(()=>{if(!d)return;localStorage.getItem(Lo)!==Ro.commitHash&&c(!0)},[d]);const u=(0,s.useCallback)(()=>{a(!0),setTimeout(()=>i(!0),10)},[]),m=(0,s.useCallback)(()=>{i(!1),setTimeout(()=>a(!1),300)},[]),h=(0,s.useCallback)(()=>{localStorage.setItem(Lo,Ro.commitHash),c(!1)},[]),p=(0,s.useCallback)(()=>localStorage.getItem(Lo)===Ro.commitHash,[]);return(0,s.useEffect)(()=>{if(d&&!p()){const e=setTimeout(()=>u(),800);return()=>clearTimeout(e)}},[d,p,u]),(0,yr.jsx)(Fo.Provider,{value:{isOpen:r,isAnimating:o,openPatchNotes:u,closePatchNotes:m,markAsSeen:h,currentVersion:Ro,hasUpdate:l,isAdmin:d},children:t})},zo=()=>{const{isOpen:e,isAnimating:t,closePatchNotes:n,markAsSeen:r,currentVersion:a}=Bo(),[o,i]=(0,s.useState)(!1),[l,c]=(0,s.useState)(null),d=(0,s.useMemo)(()=>[{id:1,date:Ro.commitDate.split(" ")[0],message:Ro.commitMessage,author:Ro.author,hash:Ro.commitHash,isNew:!0,details:"This update includes the latest changes pushed to the ".concat(Ro.branch," branch. Deployed automatically on build."),filesChanged:["server/routes/webhooks.js","server/index.js"],type:"feature"},{id:2,date:"2026-02-17",message:"Add 3rd booking slot column to calendar system",author:"Tin",hash:"841314b",isNew:!1,details:"Added a third booking slot option to the calendar for better scheduling flexibility. Includes database migration for new column.",filesChanged:["client/src/components/Calendar.js","database/migrations/"],type:"feature"}],[]);if(!e)return null;return(0,yr.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 transition-all duration-300 ".concat(t?"opacity-100":"opacity-0 pointer-events-none"),children:[(0,yr.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-xl"}),(0,yr.jsx)("div",{className:"relative w-full max-w-sm transform transition-all duration-300 ".concat(t?"scale-100 translate-y-0":"scale-95 translate-y-4"),children:(0,yr.jsxs)("div",{className:"relative overflow-hidden rounded-3xl bg-white shadow-2xl",children:[(0,yr.jsx)("div",{className:"px-6 pt-6 pb-4 bg-gradient-to-b from-gray-50 to-white border-b border-gray-100",children:(0,yr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,yr.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:(0,yr.jsx)(Ds,{className:"h-5 w-5 text-white"})}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h1",{className:"text-lg font-bold text-gray-900",children:"Updates"}),(0,yr.jsxs)("p",{className:"text-xs text-gray-500",children:[a.branch," \u2022 ",a.commitHash]})]})]})}),(0,yr.jsx)("div",{className:"max-h-[55vh] overflow-y-auto px-4 py-3",children:(0,yr.jsx)("div",{className:"space-y-2",children:d.map(e=>{return(0,yr.jsxs)("div",{className:"rounded-xl overflow-hidden transition-all duration-200 ".concat(e.isNew?"bg-blue-50 border border-blue-100":"bg-gray-50"),children:[(0,yr.jsx)("button",{onClick:()=>(e=>{c(l===e?null:e)})(e.id),className:"w-full p-3 text-left",children:(0,yr.jsxs)("div",{className:"flex items-start gap-3",children:[(0,yr.jsx)("div",{className:"mt-1.5 w-2 h-2 rounded-full flex-shrink-0 ".concat(e.isNew?"bg-blue-500":"bg-gray-300")}),(0,yr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-gray-900 leading-snug",children:e.message}),(0,yr.jsxs)("div",{className:"flex items-center gap-2 mt-1.5 text-xs text-gray-500",children:[(0,yr.jsx)("span",{className:"font-mono text-gray-400",children:e.hash}),(0,yr.jsx)("span",{children:"\u2022"}),(0,yr.jsx)("span",{children:(t=e.date,new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric"}))}),e.isNew&&(0,yr.jsx)("span",{className:"ml-auto px-1.5 py-0.5 bg-blue-500 text-white text-[10px] font-medium rounded",children:"New"})]})]}),(0,yr.jsx)("div",{className:"mt-1 text-gray-400",children:l===e.id?(0,yr.jsx)(vs,{className:"h-4 w-4"}):(0,yr.jsx)(xs,{className:"h-4 w-4"})})]})}),l===e.id&&(0,yr.jsx)("div",{className:"px-3 pb-3 pt-0 border-t border-gray-200/50",children:(0,yr.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,yr.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:e.details}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("p",{className:"text-xs font-medium text-gray-500 mb-1.5 flex items-center gap-1",children:[(0,yr.jsx)(Os,{className:"h-3 w-3"}),"Files changed"]}),(0,yr.jsx)("div",{className:"space-y-1",children:e.filesChanged.map((e,t)=>(0,yr.jsx)("div",{className:"text-xs font-mono text-gray-600 bg-white/50 px-2 py-1 rounded",children:e},t))})]}),(0,yr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yr.jsx)("span",{className:"text-[10px] uppercase font-semibold px-2 py-0.5 rounded-full ".concat("feature"===e.type?"bg-green-100 text-green-700":"fix"===e.type?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"),children:e.type}),(0,yr.jsxs)("span",{className:"text-xs text-gray-400",children:["by ",e.author]})]})]})})]},e.id);var t})})}),(0,yr.jsxs)("div",{className:"p-4 bg-white border-t border-gray-100",children:[(0,yr.jsx)("button",{onClick:()=>{i(!0),r(),setTimeout(()=>{n(),i(!1)},300)},disabled:o,className:"w-full py-3 px-4 rounded-xl font-semibold text-sm transition-all duration-200 ".concat(o?"bg-gray-100 text-gray-400":"text-white bg-gray-900 hover:bg-gray-800"),children:o?"Continuing...":"Continue"}),(0,yr.jsx)("p",{className:"text-center text-[10px] text-gray-400 mt-2",children:"Tap an update to see more details"})]})]})})]})},Vo=()=>{const{openPatchNotes:e,hasUpdate:t,isAdmin:n}=Bo();return n?(0,yr.jsxs)("button",{onClick:e,className:"fixed bottom-4 right-4 z-40 w-12 h-12 rounded-full bg-gray-900 text-white shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-105 flex items-center justify-center",title:"View Updates",children:[(0,yr.jsx)(Ls,{className:"h-5 w-5"}),t&&(0,yr.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full border-2 border-white animate-pulse"})]}):null},Wo=()=>{const{isAdmin:e}=Bo();return e?(0,yr.jsx)(zo,{}):null},qo="/images/edge-talent-logo.png",Ho=e=>{var t,n,r;let{children:a}=e;const o="false"!==String({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_NOTIFICATIONS_ENABLED||"true").toLowerCase(),[i,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(()=>{try{return"true"===localStorage.getItem("sidebarCollapsed")}catch(e){return!1}}),[u,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)(!1),[f,g]=(0,s.useState)(!1),[x,y]=(0,s.useState)(!1),[b,v]=(0,s.useState)([]),[w,j]=(0,s.useState)(()=>{try{const e=localStorage.getItem("readNotificationIds");return e?JSON.parse(e):[]}catch(e){return[]}}),[N,k]=(0,s.useState)(null),[S,C]=(0,s.useState)(!1),{user:_,logout:E,isAuthenticated:P}=Nr(),{socket:O,isConnected:A}=Xa(),T=$(),D=J(),M=(0,s.useRef)(null),I=(0,s.useRef)(null),L=(0,s.useRef)(null),R=(0,s.useRef)(null),F=[{name:"Diary Templates",key:"Diary Templates"},{name:"Sale Templates",key:"Sale Templates"},{name:"Bookers Templates",key:"Bookers Templates"}];(0,s.useEffect)(()=>{const e=e=>{I.current&&!I.current.contains(e.target)&&p(!1)},t=e=>{L.current&&!L.current.contains(e.target)&&y(!1)},n=e=>{R.current&&!R.current.contains(e.target)&&g(!1)};return document.addEventListener("mousedown",e),document.addEventListener("mousedown",t),document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("mousedown",t),document.removeEventListener("mousedown",n)}},[]);const B=e=>{j(e);try{localStorage.setItem("readNotificationIds",JSON.stringify(e.slice(-500)))}catch(t){}},U=e=>{try{localStorage.setItem("lastSeenNotificationsAt",e)}catch(t){}};(0,s.useEffect)(()=>{if(!o)return void console.log("\ud83d\udd14 Notifications disabled");if(!O)return void console.log("\ud83d\udd14 No socket connection for notifications");console.log("\ud83d\udd14 Setting up notification listeners...");const e=e=>{if("LEAD_UPDATED"===e.type&&e.data.lead){const t=e.data.lead;if(t.booking_history){const e=("string"===typeof t.booking_history?JSON.parse(t.booking_history):t.booking_history).find(e=>"SMS_RECEIVED"===e.action&&new Date(e.timestamp)>new Date(Date.now()-3e4));if(e){const n={id:"".concat(t.id,"_").concat(e.timestamp),leadId:t.id,leadName:t.name,leadPhone:t.phone,message:e.details.body,timestamp:e.timestamp,read:!1};v(e=>[n,...e.slice(0,9)]),console.log("\ud83d\udcf1 New SMS notification:",n)}}}},t=e=>{var t;if(console.log("\ud83d\udcf1 Layout: Received message_received event:",e),null===e||void 0===e||!e.leadId)return void console.log("\u274c Layout: No leadId in SMS event data");const n=e.content||e.body||e.message||e.text||"No content",r={id:e.messageId||"".concat(e.leadId,"_").concat(e.timestamp,"_").concat(Date.now()),leadId:e.leadId,leadName:e.leadName||"SMS Reply",leadPhone:e.phone,message:n,content:n,timestamp:e.timestamp,type:"sms",read:!1,formattedTime:"Just now"};console.log("\ud83d\udd14 Layout: Adding NEW notification:",{id:r.id,lead:r.leadName,message:(null===(t=r.message)||void 0===t?void 0:t.substring(0,30))+"..."}),v(e=>{if(e.some(e=>e.id===r.id))return console.log("\u26a0\ufe0f Layout: Notification already exists, skipping duplicate"),e;const t=[r,...e.slice(0,9)];return console.log("\u2705 Layout: Added notification, total unread:",t.filter(e=>!e.read).length),t})},n=e=>{var t;if(console.log("\ud83d\udd14 Layout: Received message_received event:",e),(null===e||void 0===e||!e.leadId)&&(null===e||void 0===e||!e.phone))return void console.log("\u274c Layout: No leadId or phone in message event data");const n=e.messageId||"".concat(e.leadId||e.phone,"_").concat(e.timestamp,"_").concat(Date.now()),r=e.content||e.body||e.message||e.text||"No content",a={id:n,messageId:e.messageId||n,leadId:e.leadId,leadName:e.leadName||("email"===e.channel?"Email Reply":"SMS Reply"),leadPhone:e.phone||e.leadPhone,leadEmail:e.email||e.leadEmail,message:r,content:r,timestamp:e.timestamp,type:e.channel||e.type||"sms",subject:e.subject,email_body:e.email_body||e.html_body||null,read:!1,formattedTime:"Just now"};console.log("\ud83d\udd14 Layout: Adding ".concat(a.type," notification:"),{id:a.id,lead:a.leadName,content:(null===(t=a.content)||void 0===t?void 0:t.substring(0,30))+"..."}),v(e=>{if(e.some(e=>e.id===a.id))return console.log("\u26a0\ufe0f Layout: Notification already exists, skipping duplicate"),e;const t=[a,...e.slice(0,9)];return console.log("\u2705 Layout: Added ".concat(a.type," notification, total notifications:"),t.length),t})},r=e=>{console.log("\ud83d\udce1 Layout: Received message_read event:",e);const t=e.messageId;if(!t)return void console.warn("\u26a0\ufe0f Layout: No messageId in message_read event");v(e=>e.map(e=>e.id===t||e.messageId===t?(console.log("\u2705 Layout: Marking notification as read:",e.id),Ye(Ye({},e),{},{read:!0})):e));const n=Array.from(new Set([...w,t]));B(n),console.log("\ud83d\udcbe Layout: Persisted read status for:",t)},a=e=>{console.log("\ud83d\udcde Callback reminder received:",e);const t={id:"callback_".concat(e.reminderId),type:"callback_reminder",leadId:e.leadId,leadName:e.leadName||"Unknown Lead",message:e.message,timestamp:e.timestamp||(new Date).toISOString(),formattedTime:"Just now",read:!1,callbackTime:e.callbackTime,callbackNote:e.callbackNote||""};v(e=>e.some(e=>e.id===t.id)?e:[t,...e.slice(0,9)]),"Notification"in window&&"granted"===Notification.permission?new Notification("\u23f0 Callback Reminder",{body:e.message,icon:"/favicon.ico",tag:"callback_".concat(e.reminderId),requireInteraction:!0}):"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission().then(t=>{"granted"===t&&new Notification("\u23f0 Callback Reminder",{body:e.message,icon:"/favicon.ico",tag:"callback_".concat(e.reminderId),requireInteraction:!0})})};return O.on("lead_updated",e),O.on("sms_received",t),O.on("message_received",n),O.on("message_read",r),O.on("callback_reminder",a),()=>{O.off("lead_updated",e),O.off("sms_received",t),O.off("message_received",n),O.off("message_read",r),O.off("callback_reminder",a)}},[O,o]),(0,s.useEffect)(()=>{if(!o)return;let e=(()=>{try{return localStorage.getItem("messagesSince")||""}catch(e){return""}})();const t=async()=>{try{var t,n,r,a;if(!o)return void console.log("\ud83d\udd14 Notifications disabled, skipping poll");const i=Date.now(),l=i-W;if(l<1e4)return void console.log("\ud83d\udd14 Skipping poll - too soon (".concat(l,"ms since last poll)"));q(i);const c=localStorage.getItem("token"),d={};e&&(d.since=e),d.limit=200;const u=await xr.get("/api/messages-list",{headers:c?{Authorization:"Bearer ".concat(c)}:{},timeout:1e4,params:d}),m=u.data.messages||[];console.log("\ud83d\udd14 Total messages fetched:",m.length);const h=(null===(t=u.data)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.latestCreatedAt)||(null===(r=u.data)||void 0===r||null===(a=r.meta)||void 0===a?void 0:a.since);if(h){e=h;try{localStorage.setItem("messagesSince",h)}catch(s){}}const p=Date.now()-6048e5,f=m.filter(e=>!((()=>{try{return new Date(e.timestamp).getTime()}catch(t){return Date.now()}})()<p)&&("received"===e.direction&&("sms"===e.type||"SMS"===e.type||"email"===e.type||(Math.random()<.1&&console.log("\ud83d\udd14 Filtering out unknown message type:",e.id,e.type),!1))));console.log("\ud83d\udd14 All recent messages:",f.length);const g=f.map(e=>{var t,n;let r="Just now";if(e.timestamp)try{let t=e.timestamp;"string"!==typeof t||!t.includes("T")||t.endsWith("Z")||t.includes("+")||t.includes("-",10)||(t+="Z");const n=new Date(t);if(!isNaN(n.getTime())){const e=new Date-n,t=Math.floor(e/6e4),a=Math.floor(e/36e5),s=Math.floor(e/864e5);r=t<1?"Just now":t<60?"".concat(t," min ago"):a<24?"".concat(a," hour").concat(a>1?"s":""," ago"):s<7?"".concat(s," day").concat(s>1?"s":""," ago"):n.toLocaleDateString()}}catch(FB){console.warn("Invalid timestamp:",e.timestamp)}const a=e.messageId||e.id,s=w.includes(a),o=!!e.isRead||s;return o?null:{id:a,messageId:e.messageId||e.id,leadId:e.leadId,leadName:e.leadName,leadPhone:e.leadPhone,leadEmail:e.leadEmail,message:e.content,content:e.content,timestamp:e.timestamp,formattedTime:r,type:e.type,subject:(null===(t=e.details)||void 0===t?void 0:t.subject)||e.subject,email_body:e.email_body||(null===(n=e.details)||void 0===n?void 0:n.email_body)||null,read:o}}).filter(e=>null!==e);g.length>0?(console.log("\ud83d\udd14 Found new notifications via polling:",g.length),v(e=>{const t=e.filter(e=>!g.some(t=>t.id===e.id)),n=g.map(t=>{const n=e.find(e=>e.id===t.id||e.messageId===t.id),r=w.includes(t.id);let a=t.read;return r&&(a=!0),n&&n.read&&(a=!0),Ye(Ye({},t),{},{read:a})}).filter(e=>!t.find(t=>t.id===e.id)),r=[...t,...n];r.sort((e,t)=>new Date(t.timestamp)-new Date(e.timestamp));const a=r.slice(0,10);return console.log("\ud83d\udd14 Final notifications:",a.length,"unread:",a.filter(e=>!e.read).length),a})):console.log("\ud83d\udd14 No new notifications found via polling")}catch(i){console.error("Error polling for notifications:",i)}};t();const n=setInterval(()=>{console.log("\ud83d\udd14 Layout: Polling for notifications..."),t()},6e4);return()=>{clearInterval(n),console.log("\ud83d\udd14 Layout: Cleaned up notification polling")}},[o,w]);const[z,V]=(0,s.useState)(new Set),[W,q]=(0,s.useState)(0),H=e=>{if("callback_reminder"===e.type){v(t=>t.map(t=>t.id===e.id?Ye(Ye({},t),{},{read:!0}):t));const t=Array.from(new Set([...w,e.id]));return B(t),void(e.leadId&&(D("/leads/".concat(e.leadId)),y(!1)))}(async e=>{const t=e.id;try{if(console.log("\ud83d\udd14 Marking notification as read:",t),w.includes(t)||z.has(t))return void console.log("\u2139\ufe0f Message already marked as read or being processed, skipping");V(e=>new Set([...e,t])),v(e=>e.map(e=>e.id===t?Ye(Ye({},e),{},{processing:!0}):e)),v(e=>e.map(e=>e.id===t?Ye(Ye({},e),{},{read:!0}):e));const n=e.messageId||t,r=localStorage.getItem("token");if((await xr.put("/api/messages-list/".concat(n,"/read"),{},{headers:r?{Authorization:"Bearer ".concat(r)}:{}})).data.success){console.log("\u2705 Message marked as read on server");const e=Array.from(new Set([...w,t]));B(e),v(e=>e.map(e=>e.id===t?Ye(Ye({},e),{},{processing:!1}):e)),setTimeout(()=>{v(e=>e.filter(e=>e.id!==t))},500)}}catch(r){var n;console.error("\u274c Error marking notification as read:",(null===(n=r.response)||void 0===n?void 0:n.data)||r.message),v(e=>e.map(e=>e.id===t?Ye(Ye({},e),{},{read:!1,processing:!1}):e))}finally{V(e=>{const n=new Set(e);return n.delete(t),n})}})(e),y(!1),k(e),C(!0)};(0,s.useEffect)(()=>{x&&U((new Date).toISOString())},[x]),(0,s.useEffect)(()=>{"/messages"===T.pathname&&(()=>{v(e=>e.map(e=>Ye(Ye({},e),{},{read:!0})));const e=Array.from(new Set([...w,...b.map(e=>e.id)]));B(e),U((new Date).toISOString())})()},[T.pathname]),(0,s.useEffect)(()=>{const e=setInterval(()=>{const e=new Date(Date.now()-6048e5);v(t=>t.filter(t=>new Date(t.timestamp)>e))},36e5);return()=>clearInterval(e)},[]),(0,s.useEffect)(()=>{try{localStorage.setItem("sidebarCollapsed",c.toString())}catch(e){}},[c]);const Y=()=>{d(!c)},G=b.filter(e=>!e.read).length,X=[{name:"All Leads",status:"all",icon:"\ud83d\udcca",color:"text-gray-600"},{name:"New",status:"New",icon:"\ud83c\udd95",color:"text-blue-600"},{name:"Assigned",status:"Assigned",icon:"\ud83d\udc64",color:"text-orange-600"},{name:"Booked",status:"Booked",icon:"\ud83d\udcc5",color:"text-blue-600"},{name:"Attended",status:"Attended",icon:"\u2705",color:"text-green-600"},{name:"Cancelled",status:"Cancelled",icon:"\u274c",color:"text-red-600"},{name:"No answer",status:"No answer",icon:"\ud83d\udcf5",color:"text-yellow-600"},{name:"No Answer x2",status:"No Answer x2",icon:"\ud83d\udcf5",color:"text-orange-600"},{name:"No Answer x3",status:"No Answer x3",icon:"\ud83d\udcf5",color:"text-red-600"},{name:"No photo",status:"No photo",icon:"\ud83d\udcf7",color:"text-purple-600"},{name:"Left Message",status:"Left Message",icon:"\ud83d\udcac",color:"text-yellow-600"},{name:"Not interested",status:"Not interested",icon:"\ud83d\udeab",color:"text-red-600"},{name:"Call back",status:"Call back",icon:"\ud83d\udcde",color:"text-purple-600"},{name:"Wrong number",status:"Wrong number",icon:"\ud83d\udcde",color:"text-teal-600"},{name:"Sales/converted - purchased",status:"Sales/converted - purchased",icon:"\ud83d\udcb0",color:"text-green-600"},{name:"Not Qualified",status:"Not Qualified",icon:"\u274c",color:"text-red-600"},{name:"Rejected",status:"Rejected",icon:"\ud83d\udeab",color:"text-red-600"}],K=[{name:"Dashboard",href:"/dashboard",icon:Ms,viewerHidden:!0},{name:"Leads",href:"/leads",icon:wo,hasDropdown:!0,viewerHidden:!0,dropdownItems:[{name:"All Leads",status:"all",icon:"\ud83d\udccb"},{name:"New Leads",status:"New",icon:"\ud83c\udd95"},{name:"Booked",status:"Booked",icon:"\ud83d\udcc5"},{name:"Attended",status:"Attended",icon:"\u2705"},{name:"Cancelled",status:"Cancelled",icon:"\u274c"}]},{name:"Diary",href:"/calendar",icon:hs},{name:"Photos",href:"/photographer",icon:Is,photographerOnly:!0},{name:"Blocked Slots",href:"/blocked-slots",icon:Us,adminOnly:!0},{name:"Messages",href:"/messages",icon:Ys},{name:"Sales",href:"/sales",icon:po,adminOnly:!0},{name:"Finance",href:"/finance",icon:Ns,adminOnly:!0},{name:"Reports",href:"/reports",icon:ds},{name:"My Templates",href:"/bookers-templates",icon:Vs,bookerOnly:!0},{name:"Templates",href:"/templates",icon:Vs,adminOnly:!0},{name:"Contract Editor",href:"/contract-editor",icon:Os,adminOnly:!0},{name:"Email Accounts",href:"/email-accounts",icon:Vs,adminOnly:!0},{name:"Price List",href:"/price-list",icon:co,adminOnly:!0},{name:"Users",href:"/users",icon:vo,adminOnly:!0}].filter(e=>(!e.adminOnly||"admin"===(null===_||void 0===_?void 0:_.role))&&((!e.bookerOnly||"booker"===(null===_||void 0===_?void 0:_.role))&&((!e.photographerOnly||"photographer"===(null===_||void 0===_?void 0:_.role))&&(!e.viewerHidden||"viewer"!==(null===_||void 0===_?void 0:_.role))))),Q=e=>T.pathname===e,Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";l(!1);const t="all"===e?"/leads":"/leads?status=".concat(encodeURIComponent(e));D(t,{state:{statusFilter:e},replace:!1})},ee=()=>"/leads"===T.pathname,te=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"sms";l(!1);D("/messages?type=".concat("email"===e?"email":"sms"))},ne=e=>ee()&&"all"===e?"bg-blue-50 text-blue-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900";return(0,yr.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,yr.jsxs)("div",{className:"fixed inset-0 flex z-40 md:hidden ".concat(i?"":"pointer-events-none"),children:[(0,yr.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 transition-opacity duration-300 ".concat(i?"opacity-100":"opacity-0"),onClick:()=>l(!1)}),(0,yr.jsxs)("div",{className:"relative flex-1 flex flex-col max-w-xs w-full bg-white transform transition-transform duration-300 ease-in-out ".concat(i?"translate-x-0":"-translate-x-full"),children:[(0,yr.jsx)("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:(0,yr.jsx)("button",{type:"button",className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:()=>l(!1),children:(0,yr.jsx)(ko,{className:"h-6 w-6 text-white"})})}),(0,yr.jsxs)("div",{className:"flex-1 h-0 pt-5 pb-4 overflow-y-auto",children:[(0,yr.jsx)("div",{className:"flex-shrink-0 flex items-center px-4",children:(0,yr.jsx)("img",{src:qo,alt:"EDGE TALENT",className:"h-10 w-auto object-contain"})}),(0,yr.jsx)("nav",{className:"mt-5 px-2 space-y-1",children:K.map(e=>(0,yr.jsx)("div",{children:"Leads"===e.name?(0,yr.jsxs)("div",{className:"relative",ref:M,children:[(0,yr.jsxs)("button",{onClick:()=>m(!u),className:"group flex items-center justify-between w-full px-2 py-2 text-base font-medium rounded-md ".concat(Q(e.href)?"bg-blue-100 text-blue-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)(e.icon,{className:"mr-4 h-6 w-6"}),e.name]}),u?(0,yr.jsx)(vs,{className:"h-4 w-4"}):(0,yr.jsx)(xs,{className:"h-4 w-4"})]}),u&&!c&&(0,yr.jsx)("div",{className:"mt-1 ml-6 space-y-1",children:X.map(e=>(0,yr.jsxs)("button",{onClick:()=>Z(e.status),className:"group flex items-center justify-between w-full px-2 py-2 text-sm rounded-md transition-colors ".concat(ne(e.status)),children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("span",{className:"mr-2",children:e.icon}),(0,yr.jsx)("span",{className:e.color,children:e.name})]}),ee()&&"all"===e.status&&(0,yr.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]},e.status))})]}):"Messages"===e.name?(0,yr.jsxs)("div",{className:"relative",ref:R,children:[(0,yr.jsxs)("button",{onClick:()=>g(!f),className:"group flex items-center justify-between w-full px-2 py-2 text-base font-medium rounded-md ".concat(Q(e.href)?"bg-blue-100 text-blue-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)(e.icon,{className:"mr-4 h-6 w-6"}),e.name]}),f?(0,yr.jsx)(vs,{className:"h-4 w-4"}):(0,yr.jsx)(xs,{className:"h-4 w-4"})]}),f&&!c&&(0,yr.jsxs)("div",{className:"mt-1 ml-6 space-y-1",children:[(0,yr.jsxs)("button",{onClick:()=>te("sms"),className:"group flex items-center justify-between w-full px-2 py-2 text-sm rounded-md text-gray-600 hover:bg-gray-50 hover:text-gray-900",children:[(0,yr.jsx)("span",{className:"mr-2",children:"\ud83d\udce9"}),(0,yr.jsx)("span",{children:"SMS"})]}),(0,yr.jsxs)("button",{onClick:()=>te("email"),className:"group flex items-center justify-between w-full px-2 py-2 text-sm rounded-md text-gray-600 hover:bg-gray-50 hover:text-gray-900",children:[(0,yr.jsx)("span",{className:"mr-2",children:"\u2709\ufe0f"}),(0,yr.jsx)("span",{children:"Email"})]})]})]}):"Templates"===e.name?(0,yr.jsxs)("div",{className:"relative",ref:I,children:[(0,yr.jsxs)("button",{onClick:()=>p(!h),className:"group flex items-center justify-between w-full px-2 py-2 text-base font-medium rounded-md ".concat(T.pathname.startsWith("/templates")?"bg-blue-100 text-blue-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)(Vs,{className:"mr-4 h-6 w-6"}),e.name]}),h?(0,yr.jsx)(vs,{className:"h-4 w-4"}):(0,yr.jsx)(xs,{className:"h-4 w-4"})]}),h&&!c&&(0,yr.jsx)("div",{className:"mt-1 ml-6 space-y-1",children:F.map(e=>{var t;return(0,yr.jsx)("button",{onClick:()=>{"Bookers Templates"===e.key?D("/bookers-templates"):(l(!1),D("/templates",{state:{category:e.key,navKey:Date.now()+Math.random()}}))},className:"group flex items-center w-full px-2 py-2 text-sm rounded-md transition-colors ".concat(T.pathname.startsWith("/templates")&&(null===(t=T.state)||void 0===t?void 0:t.category)===e.key?"bg-blue-50 text-blue-900 font-semibold":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:(0,yr.jsx)("span",{className:"mr-2",children:e.name})},e.key)})})]}):(0,yr.jsxs)(Ee,{to:e.href,className:"group flex items-center px-2 py-2 text-base font-medium rounded-md ".concat(Q(e.href)?"bg-blue-100 text-blue-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),onClick:()=>l(!1),children:[(0,yr.jsx)(e.icon,{className:"mr-4 h-6 w-6"}),e.name]})},e.name))})]}),(0,yr.jsx)("div",{className:"flex-shrink-0 flex border-t border-gray-200 p-4",children:(0,yr.jsxs)("div",{className:"flex items-center w-full",children:[(0,yr.jsx)("div",{className:"flex-shrink-0",children:(0,yr.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center",children:(0,yr.jsx)("span",{className:"text-sm font-medium text-white",children:null===_||void 0===_||null===(t=_.name)||void 0===t?void 0:t.charAt(0).toUpperCase()})})}),(0,yr.jsxs)("div",{className:"ml-3 flex-1 min-w-0",children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-gray-700 truncate",children:null===_||void 0===_?void 0:_.name}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 capitalize",children:null===_||void 0===_?void 0:_.role})]}),(0,yr.jsx)("button",{onClick:E,className:"ml-2 p-2 rounded-md text-gray-400 hover:text-red-500 hover:bg-red-50 transition-colors",title:"Sign out",children:(0,yr.jsx)(zs,{className:"h-5 w-5"})})]})})]})]}),(0,yr.jsx)("div",{className:"hidden md:flex md:flex-col md:fixed md:inset-y-0 transition-all duration-300 ease-in-out ".concat(c?"md:w-16":"md:w-64"),children:(0,yr.jsxs)("div",{className:"flex-1 flex flex-col min-h-0 border-r border-gray-200 bg-white",children:[(0,yr.jsx)("button",{onClick:Y,className:"absolute -right-5 top-1/2 -translate-y-1/2 z-50 group animate-arrow-attention",title:c?"Expand sidebar":"Collapse sidebar","aria-label":c?"Expand sidebar":"Collapse sidebar",children:(0,yr.jsx)("div",{className:"flex items-center",children:(0,yr.jsxs)("div",{className:"flex items-center bg-white border border-gray-200 rounded-full pl-3 pr-2 py-2 shadow-lg hover:shadow-xl hover:border-blue-300 transition-all duration-300 group-hover:scale-105",children:[(0,yr.jsx)("div",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-blue-50 to-indigo-50 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),(0,yr.jsx)("div",{className:"relative text-gray-500 group-hover:text-blue-600 transition-colors duration-300",children:c?(0,yr.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5",children:[(0,yr.jsx)("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z",clipRule:"evenodd"}),(0,yr.jsx)("path",{fillRule:"evenodd",d:"M12.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L10.69 12 3.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z",clipRule:"evenodd"})]}):(0,yr.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5",children:[(0,yr.jsx)("path",{fillRule:"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z",clipRule:"evenodd"}),(0,yr.jsx)("path",{fillRule:"evenodd",d:"M3.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L5.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z",clipRule:"evenodd"})]})}),(0,yr.jsx)("div",{className:"ml-1.5 w-1.5 h-1.5 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 group-hover:from-blue-500 group-hover:to-indigo-600 transition-colors duration-300"})]})})}),(0,yr.jsxs)("div",{className:"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto overflow-x-hidden",children:[(0,yr.jsx)("div",{className:"flex items-center flex-shrink-0 px-4 transition-all duration-300 ".concat(c?"justify-center":""),children:(0,yr.jsx)("img",{src:qo,alt:"EDGE TALENT",className:"h-10 w-auto object-contain transition-all duration-300 ".concat(c?"h-8":"h-10")})}),(0,yr.jsx)("nav",{className:"mt-5 flex-1 bg-white space-y-1 transition-all duration-300 ".concat(c?"px-1":"px-2"),children:K.map(e=>(0,yr.jsx)("div",{children:"Leads"===e.name?(0,yr.jsxs)("div",{className:"relative",ref:M,children:[(0,yr.jsxs)("button",{onClick:()=>c?(Y(),m(!0)):m(!u),className:"group flex items-center ".concat(c?"justify-center px-2":"justify-between px-2"," w-full py-2 text-sm font-medium rounded-md ").concat(Q(e.href)?"bg-blue-100 text-blue-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),title:c?e.name:"",children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)(e.icon,{className:"h-5 w-5 ".concat(c?"":"mr-3")}),!c&&e.name]}),!c&&(u?(0,yr.jsx)(vs,{className:"h-4 w-4"}):(0,yr.jsx)(xs,{className:"h-4 w-4"}))]}),u&&(0,yr.jsx)("div",{className:"mt-1 ml-6 space-y-1",children:X.map(e=>(0,yr.jsxs)("button",{onClick:()=>Z(e.status),className:"group flex items-center justify-between w-full px-2 py-2 text-sm rounded-md transition-colors ".concat(ne(e.status)),children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("span",{className:"mr-2",children:e.icon}),(0,yr.jsx)("span",{className:e.color,children:e.name})]}),ee()&&"all"===e.status&&(0,yr.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]},e.status))})]}):"Messages"===e.name?(0,yr.jsxs)("div",{className:"relative",ref:R,children:[(0,yr.jsxs)("button",{onClick:()=>c?(Y(),g(!0)):g(!f),className:"group flex items-center ".concat(c?"justify-center px-2":"justify-between px-2"," w-full py-2 text-sm font-medium rounded-md ").concat(Q(e.href)?"bg-blue-100 text-blue-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),title:c?e.name:"",children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)(e.icon,{className:"h-5 w-5 ".concat(c?"":"mr-3")}),!c&&e.name]}),!c&&(f?(0,yr.jsx)(vs,{className:"h-4 w-4"}):(0,yr.jsx)(xs,{className:"h-4 w-4"}))]}),f&&(0,yr.jsxs)("div",{className:"mt-1 ml-6 space-y-1",children:[(0,yr.jsxs)("button",{onClick:()=>te("sms"),className:"group flex items-center justify-between w-full px-2 py-2 text-sm rounded-md text-gray-600 hover:bg-gray-50 hover:text-gray-900",children:[(0,yr.jsx)("span",{className:"mr-2",children:"\ud83d\udce9"}),(0,yr.jsx)("span",{children:"SMS"})]}),(0,yr.jsxs)("button",{onClick:()=>te("email"),className:"group flex items-center justify-between w-full px-2 py-2 text-sm rounded-md text-gray-600 hover:bg-gray-50 hover:text-gray-900",children:[(0,yr.jsx)("span",{className:"mr-2",children:"\u2709\ufe0f"}),(0,yr.jsx)("span",{children:"Email"})]})]})]}):"Templates"===e.name?(0,yr.jsxs)("div",{className:"relative",ref:I,children:[(0,yr.jsxs)("button",{onClick:()=>c?(Y(),p(!0)):p(!h),className:"group flex items-center ".concat(c?"justify-center px-2":"justify-between px-2"," w-full py-2 text-sm font-medium rounded-md ").concat(T.pathname.startsWith("/templates")?"bg-blue-100 text-blue-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),title:c?e.name:"",children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)(Vs,{className:"h-5 w-5 ".concat(c?"":"mr-3")}),!c&&e.name]}),!c&&(h?(0,yr.jsx)(vs,{className:"h-4 w-4"}):(0,yr.jsx)(xs,{className:"h-4 w-4"}))]}),h&&(0,yr.jsx)("div",{className:"mt-1 ml-6 space-y-1",children:F.map(e=>{var t;return(0,yr.jsx)("button",{onClick:()=>{"Bookers Templates"===e.key?D("/bookers-templates"):(l(!1),D("/templates",{state:{category:e.key,navKey:Date.now()+Math.random()}}))},className:"group flex items-center w-full px-2 py-2 text-sm rounded-md transition-colors ".concat(T.pathname.startsWith("/templates")&&(null===(t=T.state)||void 0===t?void 0:t.category)===e.key?"bg-blue-50 text-blue-900 font-semibold":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:(0,yr.jsx)("span",{className:"mr-2",children:e.name})},e.key)})})]}):(0,yr.jsxs)(Ee,{to:e.href,className:"group flex items-center ".concat(c?"justify-center px-2":"px-2"," py-2 text-sm font-medium rounded-md ").concat(Q(e.href)?"bg-blue-100 text-blue-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),title:c?e.name:"",children:[(0,yr.jsx)(e.icon,{className:"h-5 w-5 ".concat(c?"":"mr-3")}),!c&&e.name]})},e.name))})]}),(0,yr.jsx)("div",{className:"flex-shrink-0 flex border-t border-gray-200 p-4",children:(0,yr.jsxs)("div",{className:"flex items-center w-full ".concat(c?"justify-center":""),children:[(0,yr.jsx)("div",{className:"flex-shrink-0",children:(0,yr.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center",children:(0,yr.jsx)("span",{className:"text-sm font-medium text-white",children:null===_||void 0===_||null===(n=_.name)||void 0===n?void 0:n.charAt(0).toUpperCase()})})}),!c&&(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsxs)("div",{className:"ml-3 flex-1 min-w-0",children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-gray-700 truncate",children:null===_||void 0===_?void 0:_.name}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 capitalize",children:null===_||void 0===_?void 0:_.role})]}),(0,yr.jsx)("button",{onClick:E,className:"ml-2 p-2 rounded-md text-gray-400 hover:text-red-500 hover:bg-red-50 transition-colors",title:"Sign out",children:(0,yr.jsx)(zs,{className:"h-5 w-5"})})]}),c&&(0,yr.jsx)("button",{onClick:E,className:"absolute -right-4 bottom-20 text-gray-400 hover:text-red-500 transition-colors",title:"Sign out",children:(0,yr.jsx)(zs,{className:"h-5 w-5"})})]})})]})}),(0,yr.jsxs)("div",{className:"flex flex-col flex-1 transition-all duration-300 ".concat(c?"md:pl-16":"md:pl-64"),children:[(0,yr.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-30",children:(0,yr.jsx)("div",{className:"max-w-full mx-auto px-3 sm:px-4 lg:px-8",children:(0,yr.jsxs)("div",{className:"flex justify-between items-center h-14 sm:h-16",children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"flex-shrink-0 md:hidden",children:(0,yr.jsx)("button",{type:"button",className:"p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 touch-target",onClick:()=>l(!0),children:(0,yr.jsx)(Hs,{className:"h-6 w-6"})})}),(0,yr.jsx)("h1",{className:"md:hidden ml-2 text-lg font-bold text-gray-900",children:"CRM"})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[(0,yr.jsx)(Po,{}),(0,yr.jsxs)("div",{className:"relative",ref:L,children:[(0,yr.jsxs)("button",{onClick:()=>y(!x),className:"p-2 rounded-md text-gray-400 hover:text-gray-500 relative touch-target",children:[(0,yr.jsx)(us,{className:"h-5 w-5 sm:h-6 sm:w-6"}),G>0&&(0,yr.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:G>9?"9+":G})]}),x&&(0,yr.jsx)("div",{className:"absolute right-0 mt-2 w-[90vw] sm:w-80 max-w-md bg-white rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 z-50",children:(0,yr.jsxs)("div",{className:"py-2",children:[(0,yr.jsx)("div",{className:"px-4 py-2 border-b border-gray-200",children:(0,yr.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Message Notifications"})}),0===b.length?(0,yr.jsxs)("div",{className:"px-4 py-6 text-center text-gray-500",children:[(0,yr.jsx)(Ys,{className:"mx-auto h-6 w-6 mb-2"}),(0,yr.jsx)("p",{className:"text-sm",children:"No new messages"})]}):(0,yr.jsx)("div",{className:"max-h-80 overflow-y-auto",children:b.map(e=>(0,yr.jsx)("div",{onClick:()=>H(e),className:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 ".concat(e.read?"":"bg-blue-50"),children:(0,yr.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,yr.jsx)("div",{className:"flex-shrink-0",children:"callback_reminder"===e.type?(0,yr.jsx)(Js,{className:"h-5 w-5 ".concat(e.read?"text-gray-400":"text-purple-600")}):"email"===e.type?(0,yr.jsx)(Vs,{className:"h-5 w-5 ".concat(e.read?"text-gray-400":"text-blue-600")}):(0,yr.jsx)(Ys,{className:"h-5 w-5 ".concat(e.read?"text-gray-400":"text-blue-600")})}),(0,yr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsxs)("p",{className:"text-sm font-medium ".concat(e.read?"text-gray-600":"text-gray-900"),children:[e.leadName,"email"===e.type&&e.subject&&(0,yr.jsxs)("span",{className:"text-xs text-gray-500 block",children:["Subject: ",e.subject]}),"callback_reminder"===e.type&&e.callbackTime&&(0,yr.jsxs)("span",{className:"text-xs text-purple-600 block font-semibold",children:["\u23f0 ",e.callbackTime]})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500",children:e.formattedTime||"Just now"})]}),(0,yr.jsx)("p",{className:"text-sm text-gray-600 truncate",children:e.message}),"callback_reminder"===e.type&&e.callbackNote&&(0,yr.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Note: ",e.callbackNote]}),!e.read&&(0,yr.jsx)("div",{className:"w-2 h-2 rounded-full mt-1 ".concat("callback_reminder"===e.type?"bg-purple-600":"bg-blue-600")})]})]})},e.id))}),b.length>0&&(0,yr.jsx)("div",{className:"px-4 py-2 border-t border-gray-200",children:(0,yr.jsx)("button",{onClick:()=>v([]),className:"text-xs text-gray-500 hover:text-gray-700",children:"Clear all notifications"})})]})})]}),(0,yr.jsxs)("div",{className:"hidden sm:flex sm:items-center",children:[(0,yr.jsxs)("span",{className:"hidden lg:block text-sm text-gray-700 mr-2",children:["Welcome, ",null===_||void 0===_?void 0:_.name]}),(0,yr.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center",children:(0,yr.jsx)("span",{className:"text-sm font-medium text-white",children:null===_||void 0===_||null===(r=_.name)||void 0===r?void 0:r.charAt(0).toUpperCase()})})]})]})]})})}),(0,yr.jsx)("main",{className:"flex-1",children:(0,yr.jsx)("div",{className:"py-3 sm:py-4 md:py-6",children:(0,yr.jsx)("div",{className:"max-w-full mx-auto px-3 sm:px-4 lg:px-8",children:a})})})]}),(0,yr.jsx)(Mo,{notification:N,isOpen:S,onClose:()=>{C(!1),k(null)},onReply:()=>{console.log("SMS reply sent successfully")}}),(0,yr.jsxs)(Uo,{children:[(0,yr.jsx)(Wo,{}),(0,yr.jsx)(Vo,{})]})]})},Yo=()=>{const[e,t]=(0,s.useState)({email:"",password:""}),[n,r]=(0,s.useState)(!1),[a,o]=(0,s.useState)(!1),[i,l]=(0,s.useState)({name:"",email:"",password:"",role:"sales"}),{login:c,register:d,loading:u,error:m}=Nr(),h=n=>{t(Ye(Ye({},e),{},{[n.target.name]:n.target.value}))},p=e=>{l(Ye(Ye({},i),{},{[e.target.name]:e.target.value}))};return(0,yr.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,yr.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:a?"Create your account":"Sign in to your account"}),(0,yr.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Modelling Studio CRM System"})]}),m&&(0,yr.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:m}),a?(0,yr.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async e=>{e.preventDefault();(await d(i)).success&&o(!1)},children:[(0,yr.jsxs)("div",{className:"rounded-md shadow-sm space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{htmlFor:"register-name",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),(0,yr.jsx)("input",{id:"register-name",name:"name",type:"text",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Full name",value:i.name,onChange:p})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{htmlFor:"register-email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,yr.jsx)("input",{id:"register-email",name:"email",type:"email",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:i.email,onChange:p})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{htmlFor:"register-password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,yr.jsx)("input",{id:"register-password",name:"password",type:"password",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password",value:i.password,onChange:p})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{htmlFor:"register-role",className:"block text-sm font-medium text-gray-700",children:"Role"}),(0,yr.jsxs)("select",{id:"register-role",name:"role",className:"mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:i.role,onChange:p,children:[(0,yr.jsx)("option",{value:"sales",children:"Sales"}),(0,yr.jsx)("option",{value:"admin",children:"Admin"})]})]})]}),(0,yr.jsx)("div",{children:(0,yr.jsx)("button",{type:"submit",disabled:u,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:u?"Creating account...":"Create account"})}),(0,yr.jsx)("div",{className:"text-center",children:(0,yr.jsx)("button",{type:"button",onClick:()=>o(!1),className:"text-blue-600 hover:text-blue-500 text-sm",children:"Already have an account? Sign in"})})]}):(0,yr.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async t=>{t.preventDefault(),console.log("\ud83d\udd04 Attempting login with:",{email:e.email,password:e.password?"******":"empty"});try{const t=await c(e.email,e.password);console.log("\ud83d\udd04 Login result:",t)}catch(BB){console.error("\u274c Login error:",BB)}},children:[(0,yr.jsxs)("div",{className:"rounded-md shadow-sm space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,yr.jsx)("input",{id:"email",name:"email",type:"email",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:e.email,onChange:h})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,yr.jsxs)("div",{className:"mt-1 relative",children:[(0,yr.jsx)("input",{id:"password",name:"password",type:n?"text":"password",required:!0,className:"appearance-none relative block w-full px-3 py-2 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password",value:e.password,onChange:h}),(0,yr.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>r(!n),children:n?(0,yr.jsx)(Es,{className:"h-5 w-5 text-gray-400"}):(0,yr.jsx)(Ps,{className:"h-5 w-5 text-gray-400"})})]})]})]}),(0,yr.jsx)("div",{children:(0,yr.jsx)("button",{type:"submit",disabled:u,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:u?"Signing in...":"Sign in"})})]})]})})},Go={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function Xo(e){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const $o={date:Xo({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:Xo({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:Xo({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},Ko={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function Jo(e){return(t,n)=>{let r;if("formatting"===(null!==n&&void 0!==n&&n.context?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,a=null!==n&&void 0!==n&&n.width?String(n.width):t;r=e.formattingValues[a]||e.formattingValues[t]}else{const t=e.defaultWidth,a=null!==n&&void 0!==n&&n.width?String(n.width):e.defaultWidth;r=e.values[a]||e.values[t]}return r[e.argumentCallback?e.argumentCallback(t):t]}}const Qo={ordinalNumber:(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:Jo({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:Jo({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:Jo({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:Jo({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:Jo({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function Zo(e){return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=n.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],s=t.match(a);if(!s)return null;const o=s[0],i=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(i)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n;return}(i,e=>e.test(o)):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n;return}(i,e=>e.test(o));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;return{value:c,rest:t.slice(o.length)}}}const ei={ordinalNumber:(ti={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.match(ti.matchPattern);if(!n)return null;const r=n[0],a=e.match(ti.parsePattern);if(!a)return null;let s=ti.valueCallback?ti.valueCallback(a[0]):a[0];return s=t.valueCallback?t.valueCallback(s):s,{value:s,rest:e.slice(r.length)}}),era:Zo({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:Zo({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:Zo({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:Zo({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:Zo({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})};var ti;const ni={code:"en-US",formatDistance:(e,t,n)=>{let r;const a=Go[e];return r="string"===typeof a?a:1===t?a.one:a.other.replace("{{count}}",t.toString()),null!==n&&void 0!==n&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r},formatLong:$o,formatRelative:(e,t,n,r)=>Ko[e],localize:Qo,match:ei,options:{weekStartsOn:0,firstWeekContainsDate:1}};let ri={};function ai(){return ri}Math.pow(10,8);const si=6048e5,oi=Symbol.for("constructDateFrom");function ii(e,t){return"function"===typeof e?e(t):e&&"object"===typeof e&&oi in e?e[oi](t):e instanceof Date?new e.constructor(t):new Date(t)}function li(e,t){return ii(t||e,e)}function ci(e){const t=li(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function di(e,t){const n=li(e,null===t||void 0===t?void 0:t.in);return n.setHours(0,0,0,0),n}function ui(e,t,n){const[r,a]=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=ii.bind(null,e||n.find(e=>"object"===typeof e));return n.map(a)}(null===n||void 0===n?void 0:n.in,e,t),s=di(r),o=di(a),i=+s-ci(s),l=+o-ci(o);return Math.round((i-l)/864e5)}function mi(e,t){const n=li(e,null===t||void 0===t?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function hi(e,t){const n=li(e,null===t||void 0===t?void 0:t.in);return ui(n,mi(n))+1}function pi(e,t){var n,r,a,s,o,i;const l=ai(),c=null!==(n=null!==(r=null!==(a=null!==(s=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==s?s:null===t||void 0===t||null===(o=t.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==a?a:l.weekStartsOn)&&void 0!==r?r:null===(i=l.locale)||void 0===i||null===(i=i.options)||void 0===i?void 0:i.weekStartsOn)&&void 0!==n?n:0,d=li(e,null===t||void 0===t?void 0:t.in),u=d.getDay(),m=(u<c?7:0)+u-c;return d.setDate(d.getDate()-m),d.setHours(0,0,0,0),d}function fi(e,t){return pi(e,Ye(Ye({},t),{},{weekStartsOn:1}))}function gi(e,t){const n=li(e,null===t||void 0===t?void 0:t.in),r=n.getFullYear(),a=ii(n,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const s=fi(a),o=ii(n,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const i=fi(o);return n.getTime()>=s.getTime()?r+1:n.getTime()>=i.getTime()?r:r-1}function xi(e,t){const n=gi(e,t),r=ii((null===t||void 0===t?void 0:t.in)||e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),fi(r)}function yi(e,t){const n=li(e,null===t||void 0===t?void 0:t.in),r=+fi(n)-+xi(n);return Math.round(r/si)+1}function bi(e,t){var n,r,a,s,o,i;const l=li(e,null===t||void 0===t?void 0:t.in),c=l.getFullYear(),d=ai(),u=null!==(n=null!==(r=null!==(a=null!==(s=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==s?s:null===t||void 0===t||null===(o=t.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==a?a:d.firstWeekContainsDate)&&void 0!==r?r:null===(i=d.locale)||void 0===i||null===(i=i.options)||void 0===i?void 0:i.firstWeekContainsDate)&&void 0!==n?n:1,m=ii((null===t||void 0===t?void 0:t.in)||e,0);m.setFullYear(c+1,0,u),m.setHours(0,0,0,0);const h=pi(m,t),p=ii((null===t||void 0===t?void 0:t.in)||e,0);p.setFullYear(c,0,u),p.setHours(0,0,0,0);const f=pi(p,t);return+l>=+h?c+1:+l>=+f?c:c-1}function vi(e,t){var n,r,a,s,o,i;const l=ai(),c=null!==(n=null!==(r=null!==(a=null!==(s=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==s?s:null===t||void 0===t||null===(o=t.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==a?a:l.firstWeekContainsDate)&&void 0!==r?r:null===(i=l.locale)||void 0===i||null===(i=i.options)||void 0===i?void 0:i.firstWeekContainsDate)&&void 0!==n?n:1,d=bi(e,t),u=ii((null===t||void 0===t?void 0:t.in)||e,0);u.setFullYear(d,0,c),u.setHours(0,0,0,0);return pi(u,t)}function wi(e,t){const n=li(e,null===t||void 0===t?void 0:t.in),r=+pi(n,t)-+vi(n,t);return Math.round(r/si)+1}function ji(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const Ni={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return ji("yy"===t?r%100:r,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):ji(n+1,2)},d:(e,t)=>ji(e.getDate(),t.length),a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>ji(e.getHours()%12||12,t.length),H:(e,t)=>ji(e.getHours(),t.length),m:(e,t)=>ji(e.getMinutes(),t.length),s:(e,t)=>ji(e.getSeconds(),t.length),S(e,t){const n=t.length,r=e.getMilliseconds();return ji(Math.trunc(r*Math.pow(10,n-3)),t.length)}},ki="midnight",Si="noon",Ci="morning",_i="afternoon",Ei="evening",Pi="night",Oi={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),r=t>0?t:1-t;return n.ordinalNumber(r,{unit:"year"})}return Ni.y(e,t)},Y:function(e,t,n,r){const a=bi(e,r),s=a>0?a:1-a;if("YY"===t){return ji(s%100,2)}return"Yo"===t?n.ordinalNumber(s,{unit:"year"}):ji(s,t.length)},R:function(e,t){return ji(gi(e),t.length)},u:function(e,t){return ji(e.getFullYear(),t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return ji(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return ji(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return Ni.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return ji(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const a=wi(e,r);return"wo"===t?n.ordinalNumber(a,{unit:"week"}):ji(a,t.length)},I:function(e,t,n){const r=yi(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):ji(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):Ni.d(e,t)},D:function(e,t,n){const r=hi(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):ji(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const a=e.getDay(),s=(a-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return ji(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const a=e.getDay(),s=(a-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return ji(s,t.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),a=0===r?7:r;switch(t){case"i":return String(a);case"ii":return ji(a,t.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let a;switch(a=12===r?Si:0===r?ki:r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let a;switch(a=r>=17?Ei:r>=12?_i:r>=4?Ci:Pi,t){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return Ni.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):Ni.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):ji(r,t.length)},k:function(e,t,n){let r=e.getHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):ji(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ni.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Ni.s(e,t)},S:function(e,t){return Ni.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(0===r)return"Z";switch(t){case"X":return Ti(r);case"XXXX":case"XX":return Di(r);default:return Di(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return Ti(r);case"xxxx":case"xx":return Di(r);default:return Di(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Ai(r,":");default:return"GMT"+Di(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Ai(r,":");default:return"GMT"+Di(r,":")}},t:function(e,t,n){return ji(Math.trunc(+e/1e3),t.length)},T:function(e,t,n){return ji(+e,t.length)}};function Ai(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),s=r%60;return 0===s?n+String(a):n+String(a)+t+ji(s,2)}function Ti(e,t){if(e%60===0){return(e>0?"-":"+")+ji(Math.abs(e)/60,2)}return Di(e,t)}function Di(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e>0?"-":"+",r=Math.abs(e);return n+ji(Math.trunc(r/60),2)+t+ji(r%60,2)}const Mi=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},Ii=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},Li={p:Ii,P:(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],a=n[2];if(!a)return Mi(e,t);let s;switch(r){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;default:s=t.dateTime({width:"full"})}return s.replace("{{date}}",Mi(r,t)).replace("{{time}}",Ii(a,t))}},Ri=/^D+$/,Fi=/^Y+$/,Bi=["D","DD","YY","YYYY"];function Ui(e){return e instanceof Date||"object"===typeof e&&"[object Date]"===Object.prototype.toString.call(e)}function zi(e){return!(!Ui(e)&&"number"!==typeof e||isNaN(+li(e)))}const Vi=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Wi=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,qi=/^'([^]*?)'?$/,Hi=/''/g,Yi=/[a-zA-Z]/;function Gi(e,t,n){var r,a,s,o,i,l,c,d,u,m,h,p,f,g;const x=ai(),y=null!==(r=null!==(a=null===n||void 0===n?void 0:n.locale)&&void 0!==a?a:x.locale)&&void 0!==r?r:ni,b=null!==(s=null!==(o=null!==(i=null!==(l=null===n||void 0===n?void 0:n.firstWeekContainsDate)&&void 0!==l?l:null===n||void 0===n||null===(c=n.locale)||void 0===c||null===(c=c.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==i?i:x.firstWeekContainsDate)&&void 0!==o?o:null===(d=x.locale)||void 0===d||null===(d=d.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==s?s:1,v=null!==(u=null!==(m=null!==(h=null!==(p=null===n||void 0===n?void 0:n.weekStartsOn)&&void 0!==p?p:null===n||void 0===n||null===(f=n.locale)||void 0===f||null===(f=f.options)||void 0===f?void 0:f.weekStartsOn)&&void 0!==h?h:x.weekStartsOn)&&void 0!==m?m:null===(g=x.locale)||void 0===g||null===(g=g.options)||void 0===g?void 0:g.weekStartsOn)&&void 0!==u?u:0,w=li(e,null===n||void 0===n?void 0:n.in);if(!zi(w))throw new RangeError("Invalid time value");let j=t.match(Wi).map(e=>{const t=e[0];if("p"===t||"P"===t){return(0,Li[t])(e,y.formatLong)}return e}).join("").match(Vi).map(e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:Xi(e)};if(Oi[t])return{isToken:!0,value:e};if(t.match(Yi))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}});y.localize.preprocessor&&(j=y.localize.preprocessor(w,j));const N={firstWeekContainsDate:b,weekStartsOn:v,locale:y};return j.map(r=>{if(!r.isToken)return r.value;const a=r.value;(null!==n&&void 0!==n&&n.useAdditionalWeekYearTokens||!function(e){return Fi.test(e)}(a))&&(null!==n&&void 0!==n&&n.useAdditionalDayOfYearTokens||!function(e){return Ri.test(e)}(a))||function(e,t,n){const r=function(e,t,n){const r="Y"===e[0]?"years":"days of the month";return"Use `".concat(e.toLowerCase(),"` instead of `").concat(e,"` (in `").concat(t,"`) for formatting ").concat(r," to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md")}(e,t,n);if(console.warn(r),Bi.includes(e))throw new RangeError(r)}(a,t,String(e));return(0,Oi[a[0]])(w,a,y.localize,N)}).join("")}function Xi(e){const t=e.match(qi);return t?t[1].replace(Hi,"'"):e}function $i(){return Object.assign({},ai())}function Ki(e,t,n){var r;const a=$i(),s=function(e,t,n){return new Intl.DateTimeFormat(n?[n.code,"en-US"]:void 0,{timeZone:t,timeZoneName:e})}(e,n.timeZone,null!==(r=n.locale)&&void 0!==r?r:a.locale);return"formatToParts"in s?function(e,t){const n=e.formatToParts(t);for(let r=n.length-1;r>=0;--r)if("timeZoneName"===n[r].type)return n[r].value;return}(s,t):function(e,t){const n=e.format(t).replace(/\u200E/g,""),r=/ [\w-+ ]+$/.exec(n);return r?r[0].substr(1):""}(s,t)}function Ji(e,t){const n=function(e){Zi[e]||(Zi[e]=tl?new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}));return Zi[e]}(t);return"formatToParts"in n?function(e,t){try{const n=e.formatToParts(t),r=[];for(let e=0;e<n.length;e++){const t=Qi[n[e].type];void 0!==t&&(r[t]=parseInt(n[e].value,10))}return r}catch(n){if(n instanceof RangeError)return[NaN];throw n}}(n,e):function(e,t){const n=e.format(t),r=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(n);return[parseInt(r[3],10),parseInt(r[1],10),parseInt(r[2],10),parseInt(r[4],10),parseInt(r[5],10),parseInt(r[6],10)]}(n,e)}const Qi={year:0,month:1,day:2,hour:3,minute:4,second:5};const Zi={},el=new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),tl="06/25/2014, 00:00:00"===el||"\u200e06\u200e/\u200e25\u200e/\u200e2014\u200e \u200e00\u200e:\u200e00\u200e:\u200e00"===el;function nl(e,t,n,r,a,s,o){const i=new Date(0);return i.setUTCFullYear(e,t,n),i.setUTCHours(r,a,s,o),i}const rl=36e5,al={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function sl(e,t,n){if(!e)return 0;let r,a,s=al.timezoneZ.exec(e);if(s)return 0;if(s=al.timezoneHH.exec(e),s)return r=parseInt(s[1],10),il(r)?-r*rl:NaN;if(s=al.timezoneHHMM.exec(e),s){r=parseInt(s[2],10);const e=parseInt(s[3],10);return il(r,e)?(a=Math.abs(r)*rl+6e4*e,"+"===s[1]?-a:a):NaN}if(function(e){if(ll[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),ll[e]=!0,!0}catch(t){return!1}}(e)){t=new Date(t||Date.now());const r=n?t:function(e){return nl(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}(t),a=ol(r,e),s=n?a:function(e,t,n){const r=e.getTime();let a=r-t;const s=ol(new Date(a),n);if(t===s)return t;a-=s-t;const o=ol(new Date(a),n);if(s===o)return s;return Math.max(s,o)}(t,a,e);return-s}return NaN}function ol(e,t){const n=Ji(e,t),r=nl(n[0],n[1]-1,n[2],n[3]%24,n[4],n[5],0).getTime();let a=e.getTime();const s=a%1e3;return a-=s>=0?s:1e3+s,r-a}function il(e,t){return-23<=e&&e<=23&&(null==t||0<=t&&t<=59)}const ll={};const cl={X:function(e,t,n){const r=dl(n.timeZone,e);if(0===r)return"Z";switch(t){case"X":return hl(r);case"XXXX":case"XX":return ml(r);default:return ml(r,":")}},x:function(e,t,n){const r=dl(n.timeZone,e);switch(t){case"x":return hl(r);case"xxxx":case"xx":return ml(r);default:return ml(r,":")}},O:function(e,t,n){const r=dl(n.timeZone,e);switch(t){case"O":case"OO":case"OOO":return"GMT"+function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e>0?"-":"+",r=Math.abs(e),a=Math.floor(r/60),s=r%60;if(0===s)return n+String(a);return n+String(a)+t+ul(s,2)}(r,":");default:return"GMT"+ml(r,":")}},z:function(e,t,n){switch(t){case"z":case"zz":case"zzz":return Ki("short",e,n);default:return Ki("long",e,n)}}};function dl(e,t){var n;const r=e?sl(e,t,!0)/6e4:null!==(n=null===t||void 0===t?void 0:t.getTimezoneOffset())&&void 0!==n?n:0;if(Number.isNaN(r))throw new RangeError("Invalid time zone specified: "+e);return r}function ul(e,t){const n=e<0?"-":"";let r=Math.abs(e).toString();for(;r.length<t;)r="0"+r;return n+r}function ml(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e>0?"-":"+",r=Math.abs(e);return n+ul(Math.floor(r/60),2)+t+ul(Math.floor(r%60),2)}function hl(e,t){if(e%60===0){return(e>0?"-":"+")+ul(Math.abs(e)/60,2)}return ml(e,t)}function pl(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+e-+t}const fl=36e5,gl=6e4,xl={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/};function yl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(null===e)return new Date(NaN);const n=null==t.additionalDigits?2:Number(t.additionalDigits);if(2!==n&&1!==n&&0!==n)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||"object"===typeof e&&"[object Date]"===Object.prototype.toString.call(e))return new Date(e.getTime());if("number"===typeof e||"[object Number]"===Object.prototype.toString.call(e))return new Date(e);if("[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);const r=function(e){const t={};let n,r=xl.dateTimePattern.exec(e);r?(t.date=r[1],n=r[3]):(r=xl.datePattern.exec(e),r?(t.date=r[1],n=r[2]):(t.date=null,n=e));if(n){const e=xl.timeZone.exec(n);e?(t.time=n.replace(e[1],""),t.timeZone=e[1].trim()):t.time=n}return t}(e),{year:a,restDateString:s}=function(e,t){if(e){const n=xl.YYY[t],r=xl.YYYYY[t];let a=xl.YYYY.exec(e)||r.exec(e);if(a){const t=a[1];return{year:parseInt(t,10),restDateString:e.slice(t.length)}}if(a=xl.YY.exec(e)||n.exec(e),a){const t=a[1];return{year:100*parseInt(t,10),restDateString:e.slice(t.length)}}}return{year:null}}(r.date,n),o=function(e,t){if(null===t)return null;let n,r,a;if(!e||!e.length)return n=new Date(0),n.setUTCFullYear(t),n;let s=xl.MM.exec(e);if(s)return n=new Date(0),r=parseInt(s[1],10)-1,Nl(t,r)?(n.setUTCFullYear(t,r),n):new Date(NaN);if(s=xl.DDD.exec(e),s){n=new Date(0);const e=parseInt(s[1],10);return function(e,t){if(t<1)return!1;const n=jl(e);if(n&&t>366)return!1;if(!n&&t>365)return!1;return!0}(t,e)?(n.setUTCFullYear(t,0,e),n):new Date(NaN)}if(s=xl.MMDD.exec(e),s){n=new Date(0),r=parseInt(s[1],10)-1;const e=parseInt(s[2],10);return Nl(t,r,e)?(n.setUTCFullYear(t,r,e),n):new Date(NaN)}if(s=xl.Www.exec(e),s)return a=parseInt(s[1],10)-1,kl(a)?bl(t,a):new Date(NaN);if(s=xl.WwwD.exec(e),s){a=parseInt(s[1],10)-1;const e=parseInt(s[2],10)-1;return kl(a,e)?bl(t,a,e):new Date(NaN)}return null}(s,a);if(null===o||isNaN(o.getTime()))return new Date(NaN);if(o){const e=o.getTime();let n,a=0;if(r.time&&(a=function(e){let t,n,r=xl.HH.exec(e);if(r)return t=parseFloat(r[1].replace(",",".")),Sl(t)?t%24*fl:NaN;if(r=xl.HHMM.exec(e),r)return t=parseInt(r[1],10),n=parseFloat(r[2].replace(",",".")),Sl(t,n)?t%24*fl+n*gl:NaN;if(r=xl.HHMMSS.exec(e),r){t=parseInt(r[1],10),n=parseInt(r[2],10);const e=parseFloat(r[3].replace(",","."));return Sl(t,n,e)?t%24*fl+n*gl+1e3*e:NaN}return null}(r.time),null===a||isNaN(a)))return new Date(NaN);if(r.timeZone||t.timeZone){if(n=sl(r.timeZone||t.timeZone,new Date(e+a)),isNaN(n))return new Date(NaN)}else n=pl(new Date(e+a)),n=pl(new Date(e+a+n));return new Date(e+a+n)}return new Date(NaN)}function bl(e,t,n){t=t||0,n=n||0;const r=new Date(0);r.setUTCFullYear(e,0,4);const a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}const vl=[31,28,31,30,31,30,31,31,30,31,30,31],wl=[31,29,31,30,31,30,31,31,30,31,30,31];function jl(e){return e%400===0||e%4===0&&e%100!==0}function Nl(e,t,n){if(t<0||t>11)return!1;if(null!=n){if(n<1)return!1;const r=jl(e);if(r&&n>wl[t])return!1;if(!r&&n>vl[t])return!1}return!0}function kl(e,t){return!(e<0||e>52)&&(null==t||!(t<0||t>6))}function Sl(e,t,n){return!(e<0||e>=25)&&((null==t||!(t<0||t>=60))&&(null==n||!(n<0||n>=60)))}const Cl=/([xXOz]+)|''|'(''|[^'])+('|$)/g;function _l(e,t,n){const r=sl(t,e=yl(e,n),!0),a=new Date(e.getTime()-r),s=new Date(0);return s.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),s.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),s}const El="Europe/London",Pl=()=>_l(new Date,El),Ol=e=>{const t=Pl().getHours();let n="";return n=t>=5&&t<12?"Good Morning":t>=12&&t<17?"Good Afternoon":"Good Evening","".concat(n,", ").concat(e)},Al=e=>_l(e,El),Tl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd HH:mm:ss";return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=(t=String(t)).match(Cl);if(r){const a=yl(n.originalDate||e,n);t=r.reduce(function(e,t){if("'"===t[0])return e;const r=e.indexOf(t),s="'"===e[r-1],o=e.replace(t,"'"+cl[t[0]](a,t,n)+"'");return s?o.substring(0,r-1)+o.substring(r+1):o},t)}return Gi(e,t,n)}(Al(e),t,{timeZone:El})},Dl=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return Tl(e,"HH:mm:ss")},Ml=()=>{const{user:e}=Nr(),{isConnected:t,socket:n}=Xa(),[r,a]=(0,s.useState)([]),[o,i]=(0,s.useState)([]),[l,c]=(0,s.useState)(!0),[d,u]=(0,s.useState)(Pl()),[m,h]=(0,s.useState)(new Date),[p,f]=(0,s.useState)(null),[g,x]=(0,s.useState)("sms"),[y,b]=(0,s.useState)(""),[v,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)(null),k=(0,s.useCallback)(async()=>{try{var e;const t=await xr.get("/api/messages-list",{params:{unread:!0,limit:10}});let n=(null===(e=t.data)||void 0===e?void 0:e.messages)||t.data||[];console.log("\ud83d\udce8 Fetched unread messages:",t.data),Array.isArray(n)||(console.warn("\ud83d\udce8 Messages response is not an array:",n),n=[]),console.log("\ud83d\udce8 Fetched ".concat(n.length," unread messages")),n.length>0&&console.log("\ud83d\udce7 Sample message:",{leadName:n[0].leadName,type:n[0].type,content:n[0].content,timestamp:n[0].timestamp}),a(n.slice(0,10))}catch(FB){console.error("Error fetching unread messages:",FB)}},[]),S=(0,s.useCallback)(async()=>{try{var e,t;const n=await xr.get("/api/leads/callback-reminders/upcoming"),r=(null===(e=n.data)||void 0===e?void 0:e.reminders)||[],a=null===(t=n.data)||void 0===t?void 0:t._debug;console.log("\ud83d\udcde Fetched ".concat(r.length," upcoming callback reminders")),a&&console.log("\ud83d\udcde DEBUG: Requesting user: ".concat(a.requestingUserName," (ID: ").concat(a.requestingUserId,")")),i(r)}catch(FB){console.error("Error fetching upcoming callbacks:",FB),i([])}},[]);(0,s.useEffect)(()=>{k(),S(),c(!1);const e=setInterval(()=>u(Pl()),1e3),t=setInterval(()=>{k(),S(),h(new Date)},3e4);return()=>{clearInterval(e),clearInterval(t)}},[k,S]),(0,s.useEffect)(()=>{if(!n)return;const e=()=>{console.log("\ud83d\udce1 Dashboard: Received message update event - refreshing messages"),k(),S()};return n.on("new_message",e),n.on("message_read",e),console.log("\ud83d\udce1 Dashboard: Socket listeners registered for real-time updates"),()=>{n.off("new_message",e),n.off("message_read",e)}},[n,k,S]);return l?(0,yr.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center",children:(0,yr.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):(0,yr.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:[(0,yr.jsxs)("div",{className:"w-full h-full px-2 sm:px-4 lg:px-8 py-3 sm:py-4 lg:py-6",children:[(0,yr.jsx)("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-lg p-3 sm:p-4 lg:p-6 mb-4 sm:mb-6 lg:mb-8 border-l-4 border-red-500",children:(0,yr.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("div",{className:"h-2 w-2 sm:h-3 sm:w-3 bg-red-500 rounded-full animate-pulse"}),(0,yr.jsx)("h1",{className:"text-base sm:text-xl lg:text-2xl font-bold text-gray-900",children:Ol((null===e||void 0===e?void 0:e.name)||"User")})]}),(0,yr.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4 lg:gap-6 text-xs sm:text-sm w-full sm:w-auto",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)(ws,{className:"h-4 w-4 text-gray-500"}),(0,yr.jsxs)("span",{className:"font-mono text-gray-700",children:[Dl(d)," UK"]})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)(No,{className:"h-4 w-4 ".concat(t?"text-green-500":"text-red-500")}),(0,yr.jsx)("span",{className:"font-medium ".concat(t?"text-green-700":"text-red-700"),children:t?"LIVE":"OFFLINE"})]}),(0,yr.jsxs)("div",{className:"text-gray-500",children:["Updated ",m.toLocaleTimeString()]})]})]})}),(0,yr.jsxs)("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-lg p-4 sm:p-6 lg:p-8 h-[calc(100vh-200px)] flex flex-col",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[(0,yr.jsx)(Ys,{className:"h-5 w-5 sm:h-6 sm:w-6 lg:h-7 lg:w-7 text-indigo-500"}),(0,yr.jsx)("h2",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900",children:"TASKS"})]}),((r||[]).length>0||(o||[]).length>0)&&(0,yr.jsx)("div",{className:"bg-red-500 text-white text-sm font-bold px-3 py-1 rounded-full",children:(r||[]).length+(o||[]).length})]}),(0,yr.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-4 pr-2",children:[(o||[]).length>0&&(0,yr.jsx)(yr.Fragment,{children:o.map(e=>(0,yr.jsxs)("div",{className:"bg-white border-l-4 rounded-lg p-5 hover:shadow-md transition-shadow ".concat(e.isToday?"border-red-500 bg-red-50":e.isTomorrow?"border-orange-400 bg-orange-50":"border-purple-400"),children:[(0,yr.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("div",{className:"rounded-full p-2 ".concat(e.isToday?"bg-red-100":e.isTomorrow?"bg-orange-100":"bg-purple-100"),children:(0,yr.jsx)(Js,{className:"h-5 w-5 ".concat(e.isToday?"text-red-600":e.isTomorrow?"text-orange-600":"text-purple-600")})}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"font-bold text-gray-900",children:e.leadName||"Unknown Lead"}),(0,yr.jsx)("span",{className:"inline-block px-2 py-1 text-xs font-medium rounded ".concat(e.isToday?"text-red-700 bg-red-100":e.isTomorrow?"text-orange-700 bg-orange-100":"text-purple-700 bg-purple-100"),children:e.isToday?"\ud83d\udcde CALL TODAY":e.isTomorrow?"\ud83d\udcc5 TOMORROW":"\ud83d\udcc6 SCHEDULED"})]})]})}),(0,yr.jsxs)("p",{className:"font-semibold mb-2 ".concat(e.isToday?"text-red-700":e.isTomorrow?"text-orange-700":"text-gray-900"),children:["\u23f0 ",e.callbackTimeDisplay]}),e.callbackNote&&(0,yr.jsxs)("p",{className:"text-gray-700 text-sm mb-3",children:["\ud83d\udcdd ",e.callbackNote]}),(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsx)("p",{className:"text-xs text-gray-500",children:e.leadPhone&&"\ud83d\udcf1 ".concat(e.leadPhone)}),(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("button",{onClick:()=>(async(e,t)=>{if(window.confirm("Delete callback reminder for ".concat(t,"?"))){N(e);try{const t=await xr.delete("/api/callback-reminders/".concat(e));t.data.success?(i(t=>t.filter(t=>t.id!==e)),console.log("\ud83d\uddd1\ufe0f Callback reminder ".concat(e," deleted"))):alert(t.data.message||"Failed to delete callback reminder")}catch(FB){var n,r;console.error("Error deleting callback:",FB);const t=(null===(n=FB.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||FB.message||"Failed to delete callback reminder";alert(t)}finally{N(null)}}})(e.id,e.leadName),disabled:j===e.id,className:"text-gray-400 hover:text-red-600 transition-colors disabled:opacity-50",title:"Delete callback",children:j===e.id?(0,yr.jsx)("span",{className:"text-xs",children:"..."}):(0,yr.jsx)(ho,{className:"h-4 w-4"})}),(0,yr.jsxs)("button",{onClick:()=>window.location.href="/leads/".concat(e.leadId),className:"font-medium text-sm flex items-center space-x-1 ".concat(e.isToday?"text-red-600 hover:text-red-700":e.isTomorrow?"text-orange-600 hover:text-orange-700":"text-purple-600 hover:text-purple-700"),children:[(0,yr.jsx)("span",{children:"View Lead"}),(0,yr.jsx)(cs,{className:"h-3 w-3"})]})]})]})]},e.id))}),0===(r||[]).length&&0===(o||[]).length?(0,yr.jsxs)("div",{className:"text-center py-16 text-gray-500",children:[(0,yr.jsx)(Ys,{className:"h-16 w-16 mx-auto mb-4 text-gray-300"}),(0,yr.jsx)("p",{className:"text-lg",children:"No unread messages or upcoming tasks"})]}):(r||[]).map(e=>{var t;return(0,yr.jsxs)("div",{className:"bg-white border-l-4 border-orange-400 rounded-lg p-5 hover:shadow-md transition-shadow",children:[(0,yr.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("div",{className:"bg-green-100 rounded-full p-2",children:"email"===e.type?(0,yr.jsx)(Vs,{className:"h-5 w-5 text-green-600"}):(0,yr.jsx)(Ys,{className:"h-5 w-5 text-green-600"})}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"font-bold text-gray-900",children:e.leadName||e.from||e.sender_name||"Unknown"}),(0,yr.jsx)("span",{className:"inline-block px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded",children:"email"===e.type?"EMAIL":"SMS"})]})]})}),e.subject&&(0,yr.jsx)("p",{className:"font-semibold text-gray-900 mb-2",children:e.subject}),(0,yr.jsx)("p",{className:"text-gray-700 text-sm mb-3 line-clamp-2",children:(e.message||e.content||(null===(t=e.details)||void 0===t?void 0:t.body)||e.body||e.preview||"").trim()||"No content"}),(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsx)("p",{className:"text-xs text-gray-500",children:e.timestamp||e.created_at?new Date(e.timestamp||e.created_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):""}),(0,yr.jsxs)("button",{onClick:()=>(e=>{f(e),x("email"===e.type?"email":"sms"),b("")})(e),className:"text-blue-600 hover:text-blue-700 font-medium text-sm flex items-center space-x-1",children:[(0,yr.jsx)("span",{children:"Click to reply"}),(0,yr.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full"})]})]})]},e.id)})]})]})]}),p&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4",children:(0,yr.jsx)("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl max-w-full sm:max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,yr.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,yr.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Reply to Message"}),(0,yr.jsx)("button",{onClick:()=>f(null),className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]}),(0,yr.jsxs)("div",{className:"mb-6",children:[(0,yr.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[(0,yr.jsxs)("div",{className:"mb-3 pb-3 border-b border-gray-200",children:[(0,yr.jsxs)("p",{className:"text-sm font-semibold text-gray-900 mb-1",children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"From:"})," ",p.leadName||p.from||"Unknown"]}),p.leadEmail&&(0,yr.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Email:"})," ",p.leadEmail]}),p.leadPhone&&(0,yr.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Phone:"})," ",p.leadPhone]}),p.subject&&(0,yr.jsxs)("p",{className:"text-sm text-gray-700 mt-2",children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Subject:"})," ",p.subject]})]}),(0,yr.jsx)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:"email"===p.type&&(p.email_body||p.html_content)?(0,yr.jsx)(Do,{htmlContent:p.email_body||p.html_content,textContent:p.content,attachments:p.attachments||[],embeddedImages:p.embedded_images||[]}):(0,yr.jsx)("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:p.content||p.preview})})]}),(0,yr.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:(0,yr.jsxs)("p",{className:"text-sm font-medium text-blue-900",children:[(0,yr.jsx)("span",{className:"text-blue-600",children:"Reply will be sent to:"})," ","email"===g?p.leadEmail?(0,yr.jsxs)(yr.Fragment,{children:[p.leadName," (",p.leadEmail,")"]}):(0,yr.jsx)("span",{className:"text-red-600",children:"\u26a0\ufe0f No email address available"}):p.leadPhone?(0,yr.jsxs)(yr.Fragment,{children:[p.leadName," (",p.leadPhone,")"]}):(0,yr.jsx)("span",{className:"text-red-600",children:"\u26a0\ufe0f No phone number available"})]})}),(0,yr.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,yr.jsx)("button",{onClick:()=>x("sms"),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat("sms"===g?"bg-green-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"SMS"}),(0,yr.jsx)("button",{onClick:()=>x("email"),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat("email"===g?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Email"})]}),(0,yr.jsx)("textarea",{value:y,onChange:e=>b(e.target.value),placeholder:"Type your ".concat(g," message here..."),className:"w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"6"})]}),(0,yr.jsxs)("div",{className:"flex items-center justify-end space-x-3",children:[(0,yr.jsx)("button",{onClick:()=>f(null),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),(0,yr.jsxs)("button",{onClick:async()=>{if(y.trim()&&p)if("email"!==g||p.leadEmail)if("sms"!==g||p.leadPhone){w(!0);try{console.log("\ud83d\udce4 Sending reply:",{messageId:p.id,replyType:g,to:"email"===g?p.leadEmail:p.leadPhone,leadName:p.leadName});const e=await xr.post("/api/messages-list/reply",{messageId:p.id,replyType:g,reply:y});console.log("\u2705 Reply sent successfully:",e.data),await xr.put("/api/messages-list/".concat(p.id,"/read")),f(null),b(""),k();const t="email"===g?p.leadEmail||p.from:p.leadPhone;alert("".concat(g.toUpperCase()," sent successfully to ").concat(p.leadName," (").concat(t,")"))}catch(FB){var e,t;console.error("Error sending reply:",FB);const r=(null===(e=FB.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||FB.message||"Failed to send reply";alert("Failed to send reply: ".concat(r))}finally{w(!1)}}else alert("Cannot send SMS: Lead has no phone number");else alert("Cannot send email: Lead has no email address")},disabled:!y.trim()||v||"email"===g&&!(null!==p&&void 0!==p&&p.leadEmail)||"sms"===g&&!(null!==p&&void 0!==p&&p.leadPhone),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,yr.jsx)(ao,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:v?"Sending...":"Send"})]})]})]})})})]})};function Il(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}let Ll=null;"undefined"!==typeof window&&(null!==Ll?Promise.resolve(Ll):new Promise(e=>{const t=new Image;t.onload=()=>{Ll=1===t.width,e(Ll)},t.onerror=()=>{Ll=!1,e(!1)},t.src="data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA="}));const Rl=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6e5;this.maxSize=e,this.ttl=t,this.cache=new Map}get(e){if(!this.cache.has(e))return null;const t=this.cache.get(e);return Date.now()-t.timestamp>this.ttl?(this.cache.delete(e),null):(this.cache.delete(e),this.cache.set(e,t),t.value)}set(e,t){if(this.cache.has(e)&&this.cache.delete(e),this.cache.size>=this.maxSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,{value:t,timestamp:Date.now()})}has(e){if(!this.cache.has(e))return!1;const t=this.cache.get(e);return!(Date.now()-t.timestamp>this.ttl)||(this.cache.delete(e),!1)}delete(e){this.cache.delete(e)}clear(){this.cache.clear()}get size(){return this.cache.size}cleanup(){const e=Date.now();for(const[t,n]of this.cache)e-n.timestamp>this.ttl&&this.cache.delete(t)}}(500,6e5);"undefined"!==typeof window&&setInterval(()=>Rl.cleanup(),12e4);const Fl=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;this.maxSize=e,this.loadedUrls=new Set,this.urlOrder=[]}add(e){if(e&&!this.loadedUrls.has(e)){if(this.loadedUrls.size>=this.maxSize){const e=this.urlOrder.shift();this.loadedUrls.delete(e)}this.loadedUrls.add(e),this.urlOrder.push(e)}}has(e){return e&&this.loadedUrls.has(e)}clear(){this.loadedUrls.clear(),this.urlOrder=[]}get size(){return this.loadedUrls.size}}(2e3),Bl=e=>{Fl.add(e)},Ul=e=>Fl.has(e),zl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"optimized";if(!e||""===e.trim()||"null"===e)return null;if(e.startsWith("http://")||e.startsWith("https://"))return e;const n=e.split("/").pop();if(!n)return e;switch(t){case"thumbnail":return"/uploads/thumbnails/thumb_".concat(n);case"optimized":return"/uploads/images/opt_".concat(n);default:return e}},Vl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return new Promise((n,r)=>{if(!e)return void r(new Error("No image source provided"));const a=Rl.get(e);if(a)return void n(a);let s=0;const o=()=>{const a=new Image;a.onload=()=>{Rl.set(e,a),n(a)},a.onerror=()=>{s++,s<=t?setTimeout(o,100*Math.pow(2,s)):r(new Error("Failed to load image after ".concat(s," attempts: ").concat(e)))},a.src=e,a.decode&&a.decode().catch(()=>{})};o()})};const Wl=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;this.concurrency=e,this.queue=[],this.activeCount=0}add(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return new Promise((n,r)=>{this.queue.push({url:e,priority:t,resolve:n,reject:r}),this.queue.sort((e,t)=>e.priority-t.priority),this.process()})}process(){for(;this.activeCount<this.concurrency&&this.queue.length>0;){const{url:e,resolve:t,reject:n}=this.queue.shift();this.activeCount++;const r=new Image;r.onload=()=>{this.activeCount--,Bl(e),t(r),this.process()},r.onerror=e=>{this.activeCount--,n(e),this.process()},r.src=e}}clear(){this.queue=[]}}(6),ql=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return e?Ul(e)?Promise.resolve():Wl.add(e,t):Promise.reject(new Error("No URL provided"))},Hl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"medium";if(!e||!e.includes("cloudinary.com"))return e;const n={thumb:{w:100,h:100,q:40},small:{w:200,h:200,q:50},medium:{w:400,h:400,q:70},large:{w:800,h:800,q:80},full:{w:1600,h:1600,q:85},blur:{w:20,h:20,q:20}},r=n[t]||n.medium;if(e.includes("/upload/")){const t="w_".concat(r.w,",h_").concat(r.h,",c_limit,q_").concat(r.q,",f_auto");return e.replace("/upload/","/upload/".concat(t,"/"))}return e},Yl=e=>e&&e.includes("cloudinary.com")&&e.includes("/upload/")?e.replace("/upload/","/upload/w_20,h_20,q_10,e_blur:500,f_auto/"):null,Gl=["src","alt","className","onClick","onLoad","onError","style","title","fallbackClassName","lazy","preload","enableFadeIn","showBlurPlaceholder","videoAutoPlay","videoMuted","videoLoop"],Xl=(0,s.memo)(e=>{let{className:t,style:n,isVisible:r}=e;return r?(0,yr.jsx)("div",{className:"absolute inset-0 ".concat(t||""),style:Ye(Ye({},n),{},{background:"linear-gradient(135deg, #e0e0e0 0%, #f5f5f5 50%, #e8e8e8 100%)",animation:"shimmer 1.5s ease-in-out infinite",borderRadius:"inherit",zIndex:1})}):null});Xl.displayName="BlurPlaceholder";const $l=(0,s.memo)(e=>{let{src:t,alt:n,className:r="",onClick:a,onLoad:o,onError:i,style:l,title:c,fallbackClassName:d,lazy:u,preload:m,enableFadeIn:h=!0,showBlurPlaceholder:p=!0,videoAutoPlay:f=!0,videoMuted:g=!0,videoLoop:x=!0}=e,y=Il(e,Gl);const b=t&&"null"!==t&&""!==t,v=b?t:"/images/fallback.jpeg",w=(e=>{if(!e)return"image";const t=e.toLowerCase();return t.includes(".mp4")||t.includes(".webm")||t.includes(".mov")||t.includes(".avi")||t.includes(".mkv")||t.includes("video/")?"video":t.includes(".gif")?"gif":t.includes(".heic")||t.includes(".heif")?"heic":t.includes(".pdf")?"pdf":t.includes(".svg")?"svg":(t.match(/^https?:\/\/[^\/]+\/?$/)||t.startsWith("http")&&t.match(/\.(jpg|jpeg|png|gif|webp|bmp|ico|tiff?|avif)/),"image")})(v),j=!b||Ul(v),[N,k]=(0,s.useState)(v),[S,C]=(0,s.useState)(j||!b),[_,E]=(0,s.useState)(!b),[P,O]=(0,s.useState)(0),A=(0,s.useRef)(0),T=(0,s.useRef)(null),D="/images/fallback.jpeg";(0,s.useEffect)(()=>{if(!b)return k(D),C(!0),void E(!0);A.current+=1,k(t);const e=Ul(t);C(e),E(!1),O(0)},[t,b]);const M=(0,s.useCallback)(e=>{const n=A.current;requestAnimationFrame(()=>{A.current===n&&(C(!0),E(!1),b&&Bl(t),o&&o(e))})},[o,t,b]),I=(0,s.useCallback)(e=>{const n=A.current;if(A.current===n){if(N===D)return C(!0),E(!0),void(i&&i(e));if(P<2){const e=500*Math.pow(2,P);setTimeout(()=>{if(A.current===n){O(e=>e+1);const e=null!==N&&void 0!==N&&N.includes("?")?"&":"?";k("".concat(t).concat(e,"_retry=").concat(Date.now()))}},e)}else k(D),C(!0),E(!0),i&&i(e)}},[N,P,t,i]),L=(0,s.useMemo)(()=>{if(!h)return r;const e=S||_?"opacity-100":"opacity-0";return r?"".concat(r," ").concat(e):e},[r,h,S,_]),R=(0,s.useMemo)(()=>h?Ye(Ye({},l),{},{transition:"opacity 0.2s ease-out, filter 0.3s ease-out",filter:S||_?"blur(0px)":"blur(8px)"}):l,[l,h,S,_]),F=(0,s.useMemo)(()=>Ye({position:"relative",display:"inline-block",overflow:"hidden"},l),[l]);if("heic"===(B=w)||"pdf"===B)return(0,yr.jsx)("div",{className:"".concat(r," flex items-center justify-center bg-gray-100 border border-gray-200"),style:l,onClick:a,title:"heic"===w?"HEIC format not supported in browsers":"PDF file",children:(0,yr.jsx)("div",{className:"text-center p-1",children:(0,yr.jsx)("span",{className:"text-gray-400 text-xs",children:"heic"===w?"\ud83d\udcf7":"\ud83d\udcc4"})})});var B;const U=(null===r||void 0===r?void 0:r.includes("w-6"))||(null===r||void 0===r?void 0:r.includes("w-8"))||(null===r||void 0===r?void 0:r.includes("w-10"));return"video"===w?(0,yr.jsx)("video",Ye({ref:T,src:N,className:L,style:R,autoPlay:f,muted:g,loop:x,playsInline:!0,preload:!1===u?"auto":"metadata",onClick:a,onLoadedData:M,onError:I,title:c||n},y)):U||!p?(0,yr.jsx)("img",Ye({ref:T,src:N,alt:n||"Image",className:L,style:R,loading:!1===u?"eager":"lazy",decoding:"async",onLoad:M,onError:I,onClick:a,title:c},y)):(0,yr.jsxs)("div",{style:F,className:r,onClick:a,children:[(0,yr.jsx)(Xl,{isVisible:!S&&!_&&p}),(0,yr.jsx)("img",Ye({ref:T,src:N,alt:n||"Image",className:"w-full h-full object-cover",style:{transition:"opacity 0.3s ease-out",opacity:S?1:0,position:"relative",zIndex:2},loading:!1===u?"eager":"lazy",decoding:"async",onLoad:M,onError:I,title:c},y))]})});$l.displayName="LazyImage";const Kl=$l,Jl=e=>{let{src:t,alt:n="Photo",onClose:r}=e;return(0,s.useEffect)(()=>{if(!t)return;const e=e=>{"Escape"===e.key&&(null===r||void 0===r||r())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,r]),t?(0,yr.jsx)("div",{className:"fixed inset-0 z-[1000] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:r,children:(0,yr.jsxs)("div",{className:"relative max-w-5xl max-h-[90vh]",onClick:e=>e.stopPropagation(),children:[(0,yr.jsx)("button",{onClick:r,className:"absolute top-2 right-2 z-10 bg-red-600 hover:bg-red-700 text-white rounded-full p-2 transition-all duration-200 shadow-lg","aria-label":"Close image",title:"Close (ESC)",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})}),(0,yr.jsx)("img",{src:t,alt:n,className:"block max-w-full max-h-[90vh] rounded-lg shadow-2xl"})]})}):null},Ql=e=>{let{isOpen:t,onClose:n,selectedLeads:r,onSuccess:a}=e;const[o,i]=(0,s.useState)([]),[l,c]=(0,s.useState)(""),[d,u]=(0,s.useState)(!1),[m,h]=(0,s.useState)(!1),[p,f]=(0,s.useState)(null),[g,x]=(0,s.useState)(!1),[y,b]=(0,s.useState)("both"),[v,w]=(0,s.useState)(""),[j,N]=(0,s.useState)(""),[k,S]=(0,s.useState)("");(0,s.useEffect)(()=>{t&&(C(),c(""),w(""),N(""),S(""),b("both"))},[t]),(0,s.useEffect)(()=>{l&&_()},[l]);const C=async()=>{try{u(!0);const e=(await xr.get("/api/templates?bookersOnly=true",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})).data.filter(e=>!e.type.startsWith("sale_"));i(e)}catch(e){console.error("Error fetching templates:",e),alert("Error fetching templates. Please try again.")}finally{u(!1)}},_=async()=>{if(l)try{const e=o.find(e=>e.id===l||e._id===l);e&&(w(e.subject||""),N(e.email_body||e.emailBody||""),S(e.sms_body||e.smsBody||""),e.send_email&&e.send_sms?b("both"):e.send_email?b("email"):e.send_sms&&b("sms"))}catch(e){console.error("Error loading template:",e)}};return t?(0,yr.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,yr.jsxs)("div",{className:"relative top-10 mx-auto p-6 border w-full max-w-4xl shadow-lg rounded-md bg-white",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yr.jsxs)("h3",{className:"text-xl font-semibold text-gray-900",children:["Send Communication to ",r.length," Lead",1!==r.length?"s":""]}),(0,yr.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]}),(0,yr.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,yr.jsxs)("div",{className:"flex items-center mb-3",children:[(0,yr.jsx)(wo,{className:"h-5 w-5 text-gray-600 mr-2"}),(0,yr.jsx)("span",{className:"font-medium text-gray-700",children:"Selected Leads:"}),(0,yr.jsxs)("span",{className:"ml-2 text-sm text-gray-500",children:["(",r.length," selected)"]})]}),(0,yr.jsx)("div",{className:"text-sm text-gray-600",children:"Individual messages will be sent to each selected lead using the template below."})]}),(0,yr.jsxs)("div",{className:"mb-6",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Template"}),(0,yr.jsxs)("select",{value:l,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:d,children:[(0,yr.jsx)("option",{value:"",children:"Choose a template..."}),o.map(e=>(0,yr.jsxs)("option",{value:e.id||e._id,children:[e.name," ",e.type?"(".concat(e.type.replace(/_/g," "),")"):""]},e.id||e._id))]}),d&&(0,yr.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Loading templates..."})]}),(0,yr.jsxs)("div",{className:"mb-6",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Communication Type"}),(0,yr.jsxs)("div",{className:"flex space-x-4",children:[(0,yr.jsxs)("label",{className:"flex items-center",children:[(0,yr.jsx)("input",{type:"radio",value:"email",checked:"email"===y,onChange:e=>b(e.target.value),className:"mr-2"}),(0,yr.jsx)(Vs,{className:"h-4 w-4 text-blue-600 mr-1"}),"Email Only"]}),(0,yr.jsxs)("label",{className:"flex items-center",children:[(0,yr.jsx)("input",{type:"radio",value:"sms",checked:"sms"===y,onChange:e=>b(e.target.value),className:"mr-2"}),(0,yr.jsx)(Js,{className:"h-4 w-4 text-green-600 mr-1"}),"SMS Only"]}),(0,yr.jsxs)("label",{className:"flex items-center",children:[(0,yr.jsx)("input",{type:"radio",value:"both",checked:"both"===y,onChange:e=>b(e.target.value),className:"mr-2"}),(0,yr.jsx)(Vs,{className:"h-4 w-4 text-blue-600 mr-1"}),(0,yr.jsx)(Js,{className:"h-4 w-4 text-green-600 mr-1"}),"Both"]})]})]}),("email"===y||"both"===y)&&(0,yr.jsxs)("div",{className:"mb-6",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Subject"}),(0,yr.jsx)("input",{type:"text",value:v,onChange:e=>w(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email subject (optional - will use template default if empty)..."})]}),("email"===y||"both"===y)&&(0,yr.jsxs)("div",{className:"mb-6",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Body"}),(0,yr.jsx)("textarea",{value:j,onChange:e=>N(e.target.value),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email body (optional - will use template default if empty)..."}),(0,yr.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Leave empty to use template default. Use variables like ","{leadName}",", ","{leadEmail}",", ","{leadPhone}",", etc."]})]}),("sms"===y||"both"===y)&&(0,yr.jsxs)("div",{className:"mb-6",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SMS Body"}),(0,yr.jsx)("textarea",{value:k,onChange:e=>S(e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter SMS message (optional - will use template default if empty)..."}),(0,yr.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Character count: ",k.length," (SMS limit: 160 characters per message)"]})]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,yr.jsx)("button",{onClick:n,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",disabled:m,children:"Cancel"}),(0,yr.jsx)("button",{onClick:async()=>{if(l&&0!==r.length)try{h(!0);const e={templateId:l,leadIds:r,communicationType:y,customSubject:v||void 0,customEmailBody:j||void 0,customSmsBody:k||void 0},t=await xr.post("/api/leads/bulk-communication",e,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});let s="".concat(t.data.message,"\n\n").concat(t.data.note||"");t.data.errorCount>0&&(s+="\n\nErrors:",t.data.results.forEach(e=>{if(e.error||!e.emailSent&&!e.smsSent){const t=e.error||(e.emailError?"Email: ".concat(e.emailError):"")+(e.smsError?"SMS: ".concat(e.smsError):"");s+="\n\u2022 ".concat(e.customerName||e.leadId,": ").concat(t||"Failed to send")}})),alert(s),a(),n()}catch(s){var e,t;console.error("Error sending communications:",s),alert((null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Error sending communications. Please try again.")}finally{h(!1)}},disabled:!l||m||0===r.length,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 flex items-center",children:m?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(ao,{className:"h-4 w-4 mr-2"}),"Send to ",r.length," Lead",1!==r.length?"s":""]})})]})]})}):null},Zl=()=>{var e,t,n,r,a;const o=J(),i=$(),{user:l}=Nr(),{subscribeToLeadUpdates:c,isConnected:d}=Xa(),[u,m]=(0,s.useState)([]),[h,p]=(0,s.useState)(!0),[f,g]=(0,s.useState)({total:0,new:0,booked:0,attended:0,cancelled:0,assigned:0,rejected:0,noAnswerCall:0,noAnswerX2:0,noAnswerX3:0,leftMessage:0,notInterestedCall:0,callBack:0,wrongNumber:0,salesConverted:0,notQualified:0,attendedFilter:0,cancelledFilter:0,noShow:0}),[x,y]=(0,s.useState)(""),b=(0,s.useRef)(null),[v,w]=(0,s.useState)(()=>{var e;return new URLSearchParams(i.search).get("status")||(null===(e=i.state)||void 0===e?void 0:e.statusFilter)||"all"}),[j,N]=(0,s.useState)("all"),[k,S]=(0,s.useState)(""),[C,_]=(0,s.useState)(""),[E,P]=(0,s.useState)(()=>{const e=new URLSearchParams(i.search);return parseInt(e.get("page"))||1}),O=(0,s.useRef)(""),[A,T]=(0,s.useState)(1),[D,M]=(0,s.useState)(0),[I]=(0,s.useState)(30),[L,R]=(0,s.useState)([]),[F,B]=(0,s.useState)("table"),[U,z]=(0,s.useState)(null),[V,W]=(0,s.useState)(!1),[q,H]=(0,s.useState)(!1),[Y,G]=(0,s.useState)(!1),[X,K]=(0,s.useState)(!1),[Q,Z]=(0,s.useState)(!1),[ee,te]=(0,s.useState)(!1),[ne,re]=(0,s.useState)(!1),[ae,se]=(0,s.useState)(null),[oe,ie]=(0,s.useState)([]),[le,ce]=(0,s.useState)(""),[de,ue]=(0,s.useState)(null),[me,he]=(0,s.useState)(0),[pe,fe]=(0,s.useState)(""),[ge,xe]=(0,s.useState)(!1),[ye,be]=(0,s.useState)(null),[ve,we]=(0,s.useState)({}),[je,Ne]=(0,s.useState)(!1),[ke,Se]=(0,s.useState)(null),[Ce,_e]=(0,s.useState)(!1),[Ee,Pe]=(0,s.useState)({name:"",phone:"",email:"",postcode:"",status:"New",image_url:""});(0,s.useEffect)(()=>{P(1)},[x,j,k,C]);const Oe=(0,s.useCallback)(()=>{const e=(new Date).toLocaleDateString("en-CA",{timeZone:"Europe/London"}),t=new Date(e+"T00:00:00.000Z");switch(j){case"today":return{start:e+"T00:00:00.000Z",end:new Date(t.getTime()+864e5).toISOString().split("T")[0]+"T00:00:00.000Z"};case"yesterday":return{start:new Date(t.getTime()-864e5).toISOString().split("T")[0]+"T00:00:00.000Z",end:e+"T00:00:00.000Z"};case"week":return{start:new Date(t.getTime()-6048e5).toISOString().split("T")[0]+"T00:00:00.000Z",end:(new Date).toISOString()};case"month":return{start:new Date(t.getTime()-2592e6).toISOString().split("T")[0]+"T00:00:00.000Z",end:(new Date).toISOString()};case"custom":return k&&C?{start:k+"T00:00:00.000Z",end:C+"T23:59:59.999Z"}:null;default:return null}},[j,k,C]),Ae=(0,s.useCallback)(async()=>{p(!0);try{const e=localStorage.getItem("token"),t={page:E,limit:I,status:"all"===v?void 0:v,search:x},n=Oe();if(n){const e={all:"created_at",New:"created_at",Assigned:"assigned_at",Booked:"booked_at",Sales:"date_booked",Attended:"date_booked",Cancelled:"booked_at","No Show":"booked_at",Rejected:"assigned_at","No answer":"assigned_at","No Answer x2":"assigned_at","No Answer x3":"assigned_at","Left Message":"assigned_at","Not interested":"assigned_at","Call back":"assigned_at","Wrong number":"assigned_at","Not Qualified":"assigned_at"}[v]||"assigned_at";"created_at"===e?(t.created_at_start=n.start,t.created_at_end=n.end):"assigned_at"===e?(t.assigned_at_start=n.start,t.assigned_at_end=n.end):"booked_at"===e?(t.booked_at_start=n.start,t.booked_at_end=n.end):"date_booked"===e?(t.date_booked_start=n.start,t.date_booked_end=n.end):"booking_history"!==e&&"call_status"!==e||(t.status_changed_at_start=n.start,t.status_changed_at_end=n.end)}else 0;console.log("\ud83d\udd0d Fetching leads:",{status:v,dateFilter:j,dateRange:n||"none",params:t});const r=await xr.get("/api/leads",{params:t,headers:e?{Authorization:"Bearer ".concat(e)}:{},timeout:1e4});m(r.data.leads||[]),T(r.data.totalPages||1),M(r.data.total||0)}catch(e){console.error("Error fetching leads:",e),m([])}finally{p(!1)}},[E,I,v,x,Oe,j]),Te=(0,s.useCallback)(async()=>{try{const e={},t=Oe();t&&(e.date_start=t.start,e.date_end=t.end),console.log("\ud83d\udcca Fetching counts:",{dateFilter:j,dateRange:t||"none",params:e});const n=await xr.get("/api/stats/leads",{params:e});0,g(n.data)}catch(e){console.error("Error fetching lead counts:",e)}},[Oe]);(0,s.useEffect)(()=>{Ae()},[Ae]),(0,s.useEffect)(()=>{const e=()=>{const e=window.pageYOffset;let t=null;const n=r=>{t||(t=r);const a=r-t,s=Math.min(a/600,1),o=(i=s,1-Math.pow(1-i,3));var i;window.scrollTo(0,e*(1-o)),s<1&&requestAnimationFrame(n)};requestAnimationFrame(n)};window.pageYOffset>0&&e()},[E]),(0,s.useEffect)(()=>{l&&(Te(),Ve())},[l,j,k,C,Te]);const De=(0,s.useMemo)(()=>[{value:"all",label:"All",count:f.total},..."admin"===(null===l||void 0===l?void 0:l.role)?[{value:"New",label:"\ud83c\udd95 New",count:f.new}]:[],{value:"Assigned",label:"\ud83d\udc64 Assigned",count:f.assigned},{value:"Booked",label:"\ud83d\udcc5 Booked",count:f.booked},{value:"Attended",label:"\u2705 Attended",count:f.attendedFilter},{value:"Cancelled",label:"\u274c Cancelled",count:f.cancelledFilter},{value:"No Show",label:"\ud83d\udeab No Show",count:f.noShow},{value:"No answer",label:"\ud83d\udcf5 No answer",count:f.noAnswerCall},{value:"No Answer x2",label:"\ud83d\udcf5 No Answer x2",count:f.noAnswerX2},{value:"No Answer x3",label:"\ud83d\udcf5 No Answer x3",count:f.noAnswerX3},{value:"Left Message",label:"\ud83d\udcac Left Message",count:f.leftMessage},{value:"Not interested",label:"\ud83d\udeab Not interested",count:f.notInterestedCall},{value:"Call back",label:"\ud83d\udcde Call back",count:f.callBack},{value:"Wrong number",label:"\ud83d\udcde Wrong number",count:f.wrongNumber},{value:"Sales",label:"\ud83d\udcb0 Sales",count:f.salesConverted},{value:"Not Qualified",label:"\u274c Not Qualified",count:f.notQualified},..."admin"===(null===l||void 0===l?void 0:l.role)?[{value:"Rejected",label:"Rejected",count:f.rejected}]:[]],[f.total,f.new,f.assigned,f.booked,f.attendedFilter,f.cancelledFilter,f.noShow,f.noAnswerCall,f.noAnswerX2,f.noAnswerX3,f.leftMessage,f.notInterestedCall,f.callBack,f.wrongNumber,f.salesConverted,f.notQualified,f.rejected,null===l||void 0===l?void 0:l.role]);(0,s.useEffect)(()=>{var e;if(void 0!==(null===(e=i.state)||void 0===e?void 0:e.statusFilter)){const e=i.state.statusFilter,t=new URLSearchParams(i.search).get("status");if(console.log("\ud83d\udd35 [NavState] Effect triggered:",{navStatus:e,urlStatus:t,currentStatusFilter:v}),t)console.log("\ud83d\udd35 [NavState] Skipping - URL already has status");else{console.log("\ud83d\udd35 [NavState] Applying navigation state:",e),w(e),P(1);const t=new URLSearchParams;"all"!==e&&t.set("status",e);const n=t.toString()?"".concat(i.pathname,"?").concat(t.toString()):i.pathname;O.current=n,o(n,{replace:!0})}}},[null===(e=i.state)||void 0===e?void 0:e.statusFilter,o,i.pathname]),(0,s.useEffect)(()=>{const e=new URLSearchParams(i.search),t=e.get("status")||"all",n=parseInt(e.get("page"))||1,r=v!==t,a=E!==n;if(console.log("\ud83d\udfe2 [URLSync-Write] Effect triggered:",{statusFilter:v,urlStatus:t,currentPage:E,urlPage:n,statusDiffers:r,pageDiffers:a,locationSearch:i.search}),r||a){const e=new URLSearchParams;v&&"all"!==v&&e.set("status",v),E>1&&e.set("page",E.toString());const t=e.toString()?"".concat(i.pathname,"?").concat(e.toString()):i.pathname;console.log("\ud83d\udfe2 [URLSync-Write] Updating URL:",{from:i.pathname+i.search,to:t}),O.current=t,o(t,{replace:!0})}else console.log("\ud83d\udfe2 [URLSync-Write] No change needed - state matches URL")},[v,E,o,i.pathname]),(0,s.useEffect)(()=>{const e=i.pathname+i.search;if(e===O.current)return console.log("\ud83d\udfe1 [URLSync-Read] Skipping - we just wrote this URL:",e),void(O.current="");const t=new URLSearchParams(i.search),n=t.get("status")||"all",r=parseInt(t.get("page"))||1;console.log("\ud83d\udfe1 [URLSync-Read] Effect triggered:",{currentUrl:e,urlStatus:n,urlPage:r,currentStatusFilter:v,currentPage:E,lastWritten:O.current}),n!==v&&(console.log("\ud83d\udfe1 [URLSync-Read] Updating statusFilter:",{from:v,to:n}),w(n)),r!==E&&(console.log("\ud83d\udfe1 [URLSync-Read] Updating currentPage:",{from:E,to:r}),P(r))},[i.search]);const Me=(0,s.useCallback)(e=>{const t=Oe(),n={};t&&("all"===v?(n.created_at_start=t.start,n.created_at_end=t.end):"Booked"===v||"Sales"===v?(n.booked_at_start=t.start,n.booked_at_end=t.end):(n.assigned_at_start=t.start,n.assigned_at_end=t.end)),o("/leads/".concat(e.id),{state:Ye({statusFilter:v,searchTerm:x,dateFilter:j,customDateStart:k,customDateEnd:C},n)})},[o,v,x,j,k,C,Oe]),Ie=(0,s.useCallback)((e,t)=>{t.stopPropagation(),localStorage.setItem("bookingLead",JSON.stringify({id:e.id,name:e.name,phone:e.phone,email:e.email,postcode:e.postcode,notes:e.notes,image_url:e.image_url,currentStatus:e.status,isReschedule:"Booked"===e.status||"Rescheduled"===e.status})),o("/calendar")},[o]),Le=(0,s.useCallback)(e=>({New:"bg-amber-100 text-amber-800 border-amber-300",Booked:"bg-blue-100 text-blue-800 border-blue-300",Attended:"bg-green-100 text-green-800 border-green-300",Cancelled:"bg-red-100 text-red-800 border-red-300","No Show":"bg-gray-100 text-gray-800 border-gray-300",Assigned:"bg-purple-100 text-purple-800 border-purple-300",Rejected:"bg-gray-100 text-gray-800 border-gray-300","No answer":"bg-yellow-100 text-yellow-800 border-yellow-300","No Answer x2":"bg-orange-100 text-orange-800 border-orange-300","No Answer x3":"bg-red-100 text-red-800 border-red-300","Left Message":"bg-yellow-100 text-yellow-800 border-yellow-300","Not interested":"bg-red-100 text-red-800 border-red-300","Call back":"bg-purple-100 text-purple-800 border-purple-300","Wrong number":"bg-teal-100 text-teal-800 border-teal-300","No photo":"bg-purple-100 text-purple-800 border-purple-300",Sales:"bg-green-600 text-white border-green-400",Sale:"bg-green-600 text-white border-green-400","Not Qualified":"bg-red-100 text-red-800 border-red-300"}[e]||"bg-gray-100 text-gray-800 border-gray-300"),[]),Re=(0,s.useCallback)(e=>{var t;if(e.has_sale>0&&("Attended"===e.status||"Booked"===e.status))return"Attended";return["Booked","Attended","Cancelled","Rejected","Sale","No Show"].includes(e.status)?e.status:e.call_status?e.call_status:null!==(t=e.custom_fields)&&void 0!==t&&t.call_status?e.custom_fields.call_status:e.status},[]),Fe=(0,s.useCallback)(e=>{if(!e)return"Not set";const t=new Date(e);return isNaN(t.getTime())?"Invalid date":t.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})},[]),Be=(0,s.useCallback)(e=>{R(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[]),Ue=(0,s.useCallback)(()=>{R(e=>e.length===u.length&&u.length>0?[]:u.map(e=>e.id))},[u]),ze=[{key:"name",label:"Name"},{key:"phone",label:"Phone"},{key:"email",label:"Email"},{key:"postcode",label:"Postcode"},{key:"age",label:"Age"},{key:"lead_source",label:"Lead Source"},{key:"entry_date",label:"Entry Date"},{key:"parent_phone",label:"Parent Phone"},{key:"gender",label:"Gender"},{key:"image_url",label:"Image URL"}],Ve=(0,s.useCallback)(async()=>{try{const e=localStorage.getItem("token"),t=await xr.get("/api/users/bookers",{headers:e?{Authorization:"Bearer ".concat(e)}:{}});ie(t.data||[])}catch(e){console.error("Error fetching sales team:",e),ie([])}},[]);return h&&0===u.length&&!x?(0,yr.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 flex items-center justify-center",children:(0,yr.jsxs)("div",{className:"text-center space-y-4",children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto"}),(0,yr.jsx)("div",{className:"text-xl text-gray-700 font-medium",children:"Loading leads..."})]})}):(0,yr.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100",children:[(0,yr.jsxs)("div",{className:"backdrop-blur-xl bg-white/80 border-b border-gray-200/50 shadow-sm",children:[(0,yr.jsxs)("div",{className:"px-6 py-4",children:[(0,yr.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-4",children:[(0,yr.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4",children:[(0,yr.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent",children:"Leads Management"}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)(No,{className:"h-4 w-4 ".concat(d?"text-green-500":"text-red-500")}),(0,yr.jsx)("span",{className:"text-xs px-2 py-1 rounded-full font-medium ".concat(d?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:d?"Live":"Offline"})]}),(0,yr.jsx)("div",{className:"px-3 py-1 bg-gradient-to-r from-blue-100 to-indigo-100 text-blue-700 rounded-full text-sm font-semibold",children:((e,t)=>{const n=De.find(e=>e.value===v),r=null!==(e=null===n||void 0===n?void 0:n.count)&&void 0!==e?e:f.total,a="all"===v?"Total Leads":"".concat((null===n||void 0===n||null===(t=n.label)||void 0===t?void 0:t.replace(/^[^\w]*/,""))||v," Leads");return"".concat(r," ").concat(a)})()})]}),(0,yr.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[L.length>0&&(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 px-4 py-2 bg-purple-100 text-purple-700 rounded-xl",children:[(0,yr.jsx)(gs,{className:"h-4 w-4"}),(0,yr.jsxs)("span",{className:"font-medium",children:[L.length," Selected"]})]}),(0,yr.jsxs)("button",{onClick:()=>Z(!0),className:"group px-4 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 text-white rounded-xl hover:from-blue-700 hover:to-cyan-700 transition-all duration-200 shadow-lg hover:shadow-xl flex items-center space-x-2 hover:scale-105 transform",style:{pointerEvents:"auto",cursor:"pointer"},children:[(0,yr.jsx)(Ys,{className:"h-5 w-5 group-hover:animate-pulse"}),(0,yr.jsx)("span",{className:"font-medium",children:"Send Email/SMS"})]}),"admin"===(null===l||void 0===l?void 0:l.role)&&(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsxs)("button",{onClick:()=>G(!0),className:"group px-4 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-xl hover:from-purple-700 hover:to-indigo-700 transition-all duration-200 shadow-lg hover:shadow-xl flex items-center space-x-2 hover:scale-105 transform",style:{pointerEvents:"auto",cursor:"pointer"},children:[(0,yr.jsx)(bo,{className:"h-5 w-5 group-hover:animate-pulse"}),(0,yr.jsx)("span",{className:"font-medium",children:"Assign Leads"})]}),(0,yr.jsxs)("button",{onClick:()=>K(!0),className:"group px-4 py-2 bg-gradient-to-r from-red-600 to-pink-600 text-white rounded-xl hover:from-red-700 hover:to-pink-700 transition-all duration-200 shadow-lg hover:shadow-xl flex items-center space-x-2 hover:scale-105 transform",style:{pointerEvents:"auto",cursor:"pointer"},children:[(0,yr.jsx)(ho,{className:"h-5 w-5 group-hover:animate-bounce"}),(0,yr.jsx)("span",{className:"font-medium",children:"Delete Leads"})]})]}),"admin"!==(null===l||void 0===l?void 0:l.role)&&(0,yr.jsxs)("button",{onClick:()=>R([]),className:"group px-4 py-2 bg-gray-200 text-gray-700 rounded-xl hover:bg-gray-300 transition-all duration-200 shadow-lg hover:shadow-xl flex items-center space-x-2 hover:scale-105 transform",style:{pointerEvents:"auto",cursor:"pointer"},children:[(0,yr.jsx)(ko,{className:"h-5 w-5"}),(0,yr.jsx)("span",{className:"font-medium",children:"Clear Selection"})]})]}),(0,yr.jsxs)("button",{onClick:()=>H(!0),className:"group px-4 py-2 bg-gradient-to-r from-emerald-600 to-green-600 text-white rounded-xl hover:from-emerald-700 hover:to-green-700 transition-all duration-200 shadow-lg hover:shadow-xl flex items-center space-x-2 hover:scale-105 transform",style:{pointerEvents:"auto",cursor:"pointer"},children:[(0,yr.jsx)(yo,{className:"h-5 w-5 group-hover:animate-bounce"}),(0,yr.jsx)("span",{className:"font-medium",children:"Upload CSV"})]}),(0,yr.jsxs)("button",{onClick:()=>W(!0),className:"group px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 shadow-lg hover:shadow-xl flex items-center space-x-2 hover:scale-105 transform",style:{pointerEvents:"auto",cursor:"pointer"},children:[(0,yr.jsx)(eo,{className:"h-5 w-5 group-hover:rotate-90 transition-transform"}),(0,yr.jsx)("span",{className:"font-medium",children:"Add Lead"})]})]})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yr.jsxs)("div",{className:"flex-1 relative",children:[(0,yr.jsx)(ro,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),(0,yr.jsx)("input",{ref:b,type:"text",placeholder:"Search by name, phone, email, or postcode...",className:"w-full pl-12 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-gray-800 placeholder-gray-400",value:x,onChange:e=>y(e.target.value)})]}),(0,yr.jsxs)("div",{className:"flex items-center bg-white border border-gray-200 rounded-xl p-1",children:[(0,yr.jsx)("button",{onClick:()=>B("grid"),className:"px-3 py-2 rounded-lg transition-all duration-200 ".concat("grid"===F?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"),children:"Grid"}),(0,yr.jsx)("button",{onClick:()=>B("table"),className:"px-3 py-2 rounded-lg transition-all duration-200 ".concat("table"===F?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"),children:"Table"})]})]})]}),(0,yr.jsx)("div",{className:"px-3 sm:px-6 pb-3",children:(0,yr.jsx)("div",{className:"flex flex-wrap gap-1.5 sm:gap-2",children:De.map(e=>(0,yr.jsxs)("button",{onClick:()=>{console.log("\ud83d\udd34 [FilterClick] Button clicked:",{filter:e.value,currentFilter:v,currentPage:E}),w(e.value),P(1),console.log("\ud83d\udd34 [FilterClick] State updated:",{newFilter:e.value,newPage:1})},className:"inline-flex items-center px-2.5 sm:px-3 py-1.5 rounded-lg text-xs sm:text-sm font-medium transition-all duration-200 ".concat((()=>{if(v!==e.value)return"bg-white text-gray-600 border border-gray-200 hover:bg-gray-50 hover:border-gray-300";switch(e.value){case"all":default:return"bg-gray-700 text-white shadow-md ring-2 ring-gray-400/30";case"Assigned":case"No Answer x2":return"bg-orange-500 text-white shadow-md ring-2 ring-orange-400/30";case"Booked":return"bg-blue-500 text-white shadow-md ring-2 ring-blue-400/30";case"Attended":return"bg-green-500 text-white shadow-md ring-2 ring-green-400/30";case"Cancelled":case"No Answer x3":case"Not interested":case"Not Qualified":return"bg-red-500 text-white shadow-md ring-2 ring-red-400/30";case"No Show":return"bg-gray-500 text-white shadow-md ring-2 ring-gray-400/30";case"No answer":return"bg-yellow-500 text-white shadow-md ring-2 ring-yellow-400/30";case"Left Message":return"bg-amber-500 text-white shadow-md ring-2 ring-amber-400/30";case"Call back":return"bg-purple-500 text-white shadow-md ring-2 ring-purple-400/30";case"Wrong Number":return"bg-teal-500 text-white shadow-md ring-2 ring-teal-400/30";case"Sales":return"bg-green-600 text-white shadow-md ring-2 ring-green-400/30"}})()),children:[(0,yr.jsx)("span",{className:"truncate max-w-[80px] sm:max-w-none",children:e.label}),(0,yr.jsx)("span",{className:"ml-1.5 px-1.5 py-0.5 rounded-md text-[10px] sm:text-xs font-semibold ".concat(v===e.value?"bg-white/25 text-white":"bg-gray-100 text-gray-500"),children:e.count})]},e.value))})})]}),(0,yr.jsx)("div",{className:"px-3 sm:px-6 pt-4 pb-4 bg-gradient-to-br from-gray-50 via-white to-gray-100",children:(0,yr.jsxs)("div",{className:"flex flex-col gap-3 bg-gradient-to-r from-blue-50 to-purple-50 p-3 sm:p-4 rounded-xl border-[0.3px] border-blue-200",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[(0,yr.jsx)(hs,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-600"}),(0,yr.jsx)("span",{className:"text-xs sm:text-sm font-semibold text-gray-800 whitespace-nowrap",children:"all"===v?"Date Created:":"Booked"===v||"Sales"===v?"Date Booked:":"Attended"===v||"Cancelled"===v||"No Show"===v?"Date Changed:":"No answer"===v||"No Answer x2"===v||"No Answer x3"===v||"Left Message"===v||"Not interested"===v||"Call back"===v||"Wrong number"===v||"Not Qualified"===v?"Call Date:":"Date Assigned:"})]}),(0,yr.jsxs)("div",{className:"flex flex-wrap items-center gap-2 w-full",children:[(0,yr.jsx)("button",{onClick:()=>N("today"),className:"px-2 sm:px-3 py-1.5 text-xs sm:text-sm rounded-lg font-medium transition-all duration-200 whitespace-nowrap ".concat("today"===j?"bg-blue-600 text-white shadow-md transform scale-105":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"),children:"Today"}),(0,yr.jsx)("button",{onClick:()=>N("yesterday"),className:"px-2 sm:px-3 py-1.5 text-xs sm:text-sm rounded-lg font-medium transition-all duration-200 whitespace-nowrap ".concat("yesterday"===j?"bg-blue-600 text-white shadow-md transform scale-105":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"),children:"Yesterday"}),(0,yr.jsx)("button",{onClick:()=>N("week"),className:"px-2 sm:px-3 py-1.5 text-xs sm:text-sm rounded-lg font-medium transition-all duration-200 whitespace-nowrap ".concat("week"===j?"bg-blue-600 text-white shadow-md transform scale-105":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"),children:"Last 7 Days"}),(0,yr.jsx)("button",{onClick:()=>N("month"),className:"px-2 sm:px-3 py-1.5 text-xs sm:text-sm rounded-lg font-medium transition-all duration-200 whitespace-nowrap ".concat("month"===j?"bg-blue-600 text-white shadow-md transform scale-105":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"),children:"Last 30 Days"}),(0,yr.jsx)("button",{onClick:()=>N("all"),className:"px-2 sm:px-3 py-1.5 text-xs sm:text-sm rounded-lg font-medium transition-all duration-200 whitespace-nowrap ".concat("all"===j?"bg-blue-600 text-white shadow-md transform scale-105":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"),children:"All Time"}),(0,yr.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[(0,yr.jsx)("input",{type:"date",value:k,onChange:e=>{S(e.target.value),e.target.value&&N("custom")},className:"border border-gray-300 rounded-lg px-2 sm:px-3 py-1.5 text-xs sm:text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-w-[140px]",placeholder:"Start date"}),(0,yr.jsx)("span",{className:"text-gray-500 text-xs sm:text-sm whitespace-nowrap",children:"to"}),(0,yr.jsx)("input",{type:"date",value:C,onChange:e=>{_(e.target.value),e.target.value&&N("custom")},className:"border border-gray-300 rounded-lg px-2 sm:px-3 py-1.5 text-xs sm:text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-w-[140px]",placeholder:"End date"}),(k||C)&&(0,yr.jsx)("button",{onClick:()=>{S(""),_(""),N("all")},className:"text-gray-500 hover:text-red-600 p-1.5 hover:bg-red-50 rounded-lg transition-colors flex-shrink-0",title:"Clear custom dates",children:(0,yr.jsx)(ko,{className:"h-4 w-4"})})]})]})]})}),(0,yr.jsxs)("div",{className:"px-6 py-6",children:["grid"===F?(0,yr.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6",children:u.map(e=>(0,yr.jsxs)("div",{onClick:()=>Me(e),className:"group bg-white rounded-2xl shadow-md hover:shadow-2xl transition-all duration-300 cursor-pointer overflow-hidden border border-gray-100 hover:border-blue-200 transform hover:scale-105",children:[(0,yr.jsxs)("div",{className:"relative h-32 bg-gradient-to-br from-blue-400 via-indigo-500 to-purple-600",children:[e.image_url&&(0,yr.jsx)(Kl,{src:zl(e.image_url,"thumbnail"),alt:e.name,className:"absolute inset-0 w-full h-full object-cover opacity-30 cursor-zoom-in",onClick:t=>{t.stopPropagation();const n=zl(e.image_url,"original")||e.image_url;n&&z(n)}}),(0,yr.jsxs)("div",{className:"absolute top-3 right-3 flex items-center gap-1",children:[(0,yr.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold border ".concat(Le(Re(e))),children:Re(e)}),e.has_sale>0&&(0,yr.jsx)("span",{className:"px-2 py-0.5 rounded-full text-[10px] font-semibold border whitespace-nowrap bg-green-600 text-white border-green-500",children:"Sale"}),e.booking_status&&"Pending"!==e.booking_status&&(()=>{const t={Arrived:"bg-green-100 text-green-800 border-green-300",Left:"bg-orange-100 text-orange-800 border-orange-300","No Show":"bg-gray-200 text-gray-700 border-gray-400",Cancel:"bg-red-100 text-red-800 border-red-300",Complete:"bg-emerald-100 text-emerald-800 border-emerald-300","No Sale":"bg-amber-100 text-amber-800 border-amber-300",Reschedule:"bg-blue-100 text-blue-800 border-blue-300",Review:"bg-purple-100 text-purple-800 border-purple-300"}[e.booking_status]||"bg-gray-100 text-gray-700 border-gray-300";return(0,yr.jsx)("span",{className:"px-2 py-0.5 rounded-full text-[10px] font-semibold border whitespace-nowrap ".concat(t),children:e.booking_status})})()]}),(0,yr.jsxs)("div",{className:"absolute bottom-3 left-3 flex items-center space-x-3",children:[e.image_url?(0,yr.jsx)(Kl,{src:zl(e.image_url,"thumbnail"),alt:e.name,className:"w-12 h-12 rounded-full border-2 border-white shadow-lg object-cover cursor-zoom-in",onClick:t=>{t.stopPropagation();const n=zl(e.image_url,"original")||e.image_url;n&&z(n)}}):(0,yr.jsx)("div",{className:"w-12 h-12 rounded-full bg-white/90 flex items-center justify-center border-2 border-white shadow-lg",children:(0,yr.jsx)(vo,{className:"h-6 w-6 text-gray-600"})}),(0,yr.jsx)("div",{className:"text-white",children:(0,yr.jsxs)("h3",{className:"font-bold text-lg",children:[e.name,e.lead_source&&(0,yr.jsx)("span",{className:"ml-2 inline-flex px-1.5 py-0.5 text-[9px] bg-teal-100 text-teal-700 rounded-full font-medium align-middle",children:e.lead_source})]})})]})]}),(0,yr.jsxs)("div",{className:"p-4 space-y-3",children:[(0,yr.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,yr.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,yr.jsx)(Js,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,yr.jsx)("span",{children:e.phone||"No phone"})]}),e.email&&(0,yr.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,yr.jsx)(Vs,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,yr.jsx)("span",{className:"truncate",children:e.email})]}),(0,yr.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,yr.jsx)(Ws,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,yr.jsx)("span",{children:e.postcode||"No postcode"})]}),e.date_booked&&(0,yr.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,yr.jsx)(hs,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,yr.jsx)("span",{children:Fe(e.date_booked)})]})]}),(0,yr.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,yr.jsx)("button",{onClick:t=>Ie(e,t),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Book Appointment",children:(0,yr.jsx)(hs,{className:"h-4 w-4"})}),(0,yr.jsx)("button",{onClick:t=>{t.stopPropagation(),Be(e.id)},className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:(0,yr.jsx)(gs,{className:"h-4 w-4"})})]}),(0,yr.jsx)("button",{className:"text-gray-400 hover:text-blue-600 transition-colors",children:(0,yr.jsx)(bs,{className:"h-5 w-5"})})]})]})]},e.id))}):(0,yr.jsx)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:(0,yr.jsx)("div",{className:"overflow-x-auto",children:(0,yr.jsxs)("table",{className:"w-full",children:[(0,yr.jsx)("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b border-gray-200",children:(0,yr.jsxs)("tr",{children:[(0,yr.jsx)("th",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-4 text-left",children:(0,yr.jsx)("input",{type:"checkbox",checked:L.length===u.length&&u.length>0,onChange:Ue,className:"w-4 h-4 sm:w-5 sm:h-5 rounded text-blue-600 cursor-pointer"})}),(0,yr.jsx)("th",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-4 text-left text-[10px] sm:text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Lead"}),(0,yr.jsx)("th",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-4 text-left text-[10px] sm:text-xs font-semibold text-gray-700 uppercase tracking-wider hidden sm:table-cell",children:"Contact"}),(0,yr.jsx)("th",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-4 text-left text-[10px] sm:text-xs font-semibold text-gray-700 uppercase tracking-wider hidden lg:table-cell",children:"Assigned"}),(0,yr.jsx)("th",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-4 text-left text-[10px] sm:text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),(0,yr.jsx)("th",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-4 text-left text-[10px] sm:text-xs font-semibold text-gray-700 uppercase tracking-wider hidden md:table-cell",children:"Date Booked"}),(0,yr.jsx)("th",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-4 text-left text-[10px] sm:text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),(0,yr.jsx)("tbody",{className:"divide-y divide-gray-100",children:u.map(e=>(0,yr.jsxs)("tr",{onClick:()=>Me(e),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[(0,yr.jsx)("td",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-4",children:(0,yr.jsx)("input",{type:"checkbox",checked:L.includes(e.id),onChange:t=>{t.stopPropagation(),Be(e.id)},onClick:e=>e.stopPropagation(),className:"w-4 h-4 sm:w-5 sm:h-5 rounded text-blue-600 cursor-pointer"})}),(0,yr.jsx)("td",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-4",children:(0,yr.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[e.image_url?(0,yr.jsx)(Kl,{src:zl(e.image_url,"thumbnail"),alt:e.name,className:"w-8 h-8 sm:w-10 sm:h-10 rounded-full object-cover cursor-zoom-in flex-shrink-0",onClick:t=>{t.stopPropagation();const n=zl(e.image_url,"original")||e.image_url;n&&z(n)}}):(0,yr.jsx)("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-gray-200 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(vo,{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-500"})}),(0,yr.jsxs)("div",{className:"min-w-0",children:[(0,yr.jsx)("div",{className:"font-medium text-gray-900 text-xs sm:text-sm truncate max-w-[80px] sm:max-w-[120px] lg:max-w-none",children:e.name}),(0,yr.jsxs)("div",{className:"text-[10px] sm:text-sm text-gray-500",children:[e.postcode,e.lead_source&&(0,yr.jsx)("span",{className:"ml-1 px-1.5 py-0.5 text-[9px] bg-teal-100 text-teal-700 rounded-full font-medium",children:e.lead_source})]})]})]})}),(0,yr.jsx)("td",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-4 hidden sm:table-cell",children:(0,yr.jsxs)("div",{className:"text-xs sm:text-sm",children:[(0,yr.jsx)("div",{className:"text-gray-900",children:e.phone}),e.email&&(0,yr.jsx)("div",{className:"text-gray-500 truncate max-w-[120px] lg:max-w-none",children:e.email})]})}),(0,yr.jsx)("td",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-4 hidden lg:table-cell",children:(0,yr.jsx)("div",{className:"text-xs sm:text-sm text-purple-600 font-medium",children:e.booker?"".concat(e.booker.name):"Not assigned"})}),(0,yr.jsx)("td",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-4",children:(0,yr.jsxs)("div",{className:"flex items-center gap-1",children:[(0,yr.jsx)("span",{className:"px-1.5 sm:px-3 py-0.5 sm:py-1 rounded-full text-[10px] sm:text-xs font-semibold border whitespace-nowrap ".concat(Le(Re(e))),children:Re(e)}),e.has_sale>0&&(0,yr.jsx)("span",{className:"px-1.5 sm:px-2 py-0.5 rounded-full text-[9px] sm:text-[10px] font-semibold border whitespace-nowrap bg-green-600 text-white border-green-500",children:"Sale"}),e.booking_status&&"Pending"!==e.booking_status&&(()=>{const t={Arrived:"bg-green-100 text-green-800 border-green-300",Left:"bg-orange-100 text-orange-800 border-orange-300","No Show":"bg-gray-200 text-gray-700 border-gray-400",Cancel:"bg-red-100 text-red-800 border-red-300",Complete:"bg-emerald-100 text-emerald-800 border-emerald-300","No Sale":"bg-amber-100 text-amber-800 border-amber-300",Reschedule:"bg-blue-100 text-blue-800 border-blue-300",Review:"bg-purple-100 text-purple-800 border-purple-300"}[e.booking_status]||"bg-gray-100 text-gray-700 border-gray-300";return(0,yr.jsx)("span",{className:"px-1.5 sm:px-2 py-0.5 rounded-full text-[9px] sm:text-[10px] font-semibold border whitespace-nowrap ".concat(t),children:e.booking_status})})()]})}),(0,yr.jsx)("td",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-4 text-xs sm:text-sm text-gray-900 hidden md:table-cell",children:Fe(e.date_booked)}),(0,yr.jsx)("td",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-4",children:(0,yr.jsxs)("div",{className:"flex items-center space-x-0.5 sm:space-x-2",children:[(0,yr.jsx)("button",{onClick:t=>Ie(e,t),className:"p-1.5 sm:p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Book Appointment",children:(0,yr.jsx)(hs,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})}),(0,yr.jsx)("button",{onClick:t=>{t.stopPropagation(),Me(e)},className:"p-1.5 sm:p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"View Details",children:(0,yr.jsx)(Ps,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})]})})]},e.id))})]})})}),0===u.length&&!h&&(0,yr.jsxs)("div",{className:"text-center py-20",children:[(0,yr.jsx)("div",{className:"text-gray-400 mb-4",children:(0,yr.jsx)(vo,{className:"h-16 w-16 mx-auto"})}),(0,yr.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No leads found"}),(0,yr.jsx)("p",{className:"text-gray-500",children:"Try adjusting your search or filters"})]}),A>1&&(0,yr.jsxs)("div",{className:"mt-8 flex items-center justify-center space-x-2",children:[(0,yr.jsx)("button",{onClick:()=>{const e=Math.max(1,E-1);console.log("\ud83d\udd35 [Pagination] Previous clicked:",{currentPage:E,newPage:e,statusFilter:v}),P(e)},disabled:1===E,className:"px-4 py-2 bg-white border border-gray-200 rounded-xl text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:"Previous"}),(0,yr.jsx)("div",{className:"flex items-center space-x-1",children:[...Array(Math.min(5,A))].map((e,t)=>{const n=E<=3?t+1:E>=A-2?A-4+t:E-2+t;return n<1||n>A?null:(0,yr.jsx)("button",{onClick:()=>{console.log("\ud83d\udd35 [Pagination] Page number clicked:",{pageNum:n,currentPage:E,statusFilter:v}),P(n)},className:"w-10 h-10 rounded-xl font-medium transition-all duration-200 ".concat(E===n?"bg-blue-600 text-white shadow-lg":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:n},n)})}),(0,yr.jsx)("button",{onClick:()=>{const e=Math.min(A,E+1);console.log("\ud83d\udd35 [Pagination] Next clicked:",{currentPage:E,newPage:e,totalPages:A,statusFilter:v}),P(e)},disabled:E===A,className:"px-4 py-2 bg-white border border-gray-200 rounded-xl text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:"Next"})]})]}),V&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",style:{pointerEvents:"auto"},children:(0,yr.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-full max-w-md shadow-lg rounded-md bg-white",children:(0,yr.jsxs)("div",{className:"mt-3",children:[(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Lead"}),(0,yr.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=localStorage.getItem("token");await xr.post("/api/leads",Ee,{headers:e?{Authorization:"Bearer ".concat(e)}:{}}),W(!1),Pe({name:"",phone:"",email:"",postcode:"",status:"New",image_url:""}),Ae(),Te()}catch(t){console.error("Error adding lead:",t)}},className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),(0,yr.jsx)("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:Ee.name,onChange:e=>Pe(Ye(Ye({},Ee),{},{name:e.target.value}))})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),(0,yr.jsx)("input",{type:"tel",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:Ee.phone,onChange:e=>Pe(Ye(Ye({},Ee),{},{phone:e.target.value}))})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,yr.jsx)("input",{type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:Ee.email,onChange:e=>Pe(Ye(Ye({},Ee),{},{email:e.target.value}))})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Postcode"}),(0,yr.jsx)("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:Ee.postcode,onChange:e=>Pe(Ye(Ye({},Ee),{},{postcode:e.target.value}))})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,yr.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:Ee.status,onChange:e=>Pe(Ye(Ye({},Ee),{},{status:e.target.value})),children:[(0,yr.jsx)("option",{value:"New",children:"New"}),(0,yr.jsx)("option",{value:"Booked",children:"Booked"}),(0,yr.jsx)("option",{value:"Attended",children:"Attended"}),(0,yr.jsx)("option",{value:"Cancelled",children:"Cancelled"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image URL"}),(0,yr.jsx)("input",{type:"text",placeholder:"https://example.com/image.jpg",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:Ee.image_url,onChange:e=>Pe(Ye(Ye({},Ee),{},{image_url:e.target.value}))})]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,yr.jsx)("button",{type:"button",onClick:()=>W(!1),className:"btn-secondary",children:"Cancel"}),(0,yr.jsx)("button",{type:"submit",className:"btn-primary",children:"Add Lead"})]})]})]})})}),q&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",style:{pointerEvents:"auto"},children:(0,yr.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-full max-w-md shadow-lg rounded-md bg-white",children:(0,yr.jsxs)("div",{className:"mt-3",children:[(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Upload Leads"}),(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select CSV or Excel file"}),(0,yr.jsx)("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:e=>{const t=e.target.files[0];if(t){0;if(!["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type)&&!t.name.endsWith(".csv"))return void alert("Please select a CSV or Excel file");0,ue(t),fe("")}},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),de&&(0,yr.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Selected: ",de.name]})]}),(0,yr.jsxs)("div",{className:"bg-blue-50 p-3 rounded-md",children:[(0,yr.jsx)("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"How it works:"}),(0,yr.jsxs)("div",{className:"text-xs text-blue-800 space-y-0.5",children:[(0,yr.jsx)("p",{children:"1. Select your CSV or Excel file"}),(0,yr.jsxs)("p",{children:["2. Click ",(0,yr.jsx)("strong",{children:"Upload & Map"})," to detect columns"]}),(0,yr.jsx)("p",{children:"3. Review and adjust column mapping"}),(0,yr.jsx)("p",{children:"4. Confirm import"})]})]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,yr.jsx)("button",{type:"button",onClick:()=>{H(!1),ue(null),he(0),fe("")},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:"Cancel"}),(0,yr.jsx)("button",{onClick:async()=>{if(!de)return void alert("Please select a file first");const e=localStorage.getItem("token");if(!e)return void alert("Please login again to upload files");const t=new FormData;t.append("file",de);try{fe("Analyzing..."),he(30);const n=await xr.post("/api/leads/upload-preview",t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(e)},onUploadProgress:e=>{const t=Math.round(100*e.loaded/e.total);he(Math.min(t,60))}});he(100),fe(""),he(0),be(n.data),we(n.data.suggestedMapping||{}),H(!1),ue(null),xe(!0)}catch(i){var n,r,a;if(console.error("Error previewing file:",i),401===(null===(n=i.response)||void 0===n?void 0:n.status))alert("Your session has expired. Please login again.");else if(403===(null===(r=i.response)||void 0===r?void 0:r.status))alert("You need admin privileges to upload files.");else if(400===(null===(a=i.response)||void 0===a?void 0:a.status)){var s,o;alert((null===(s=i.response)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.message)||"Invalid file format.")}else alert("Upload failed. Please try again.");fe(""),he(0)}},disabled:!de||"Analyzing..."===pe,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Analyzing..."===pe?"Analyzing...":"Upload & Map"})]})]})]})})}),ge&&ye&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 overflow-y-auto h-full w-full z-50 flex items-start justify-center pt-10",style:{pointerEvents:"auto"},children:(0,yr.jsxs)("div",{className:"relative mx-4 p-6 border w-full max-w-3xl shadow-2xl rounded-2xl bg-white",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Map Columns"}),(0,yr.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[ye.totalRows," rows detected \u2014 ",ye.columns.length," columns found"]})]}),(0,yr.jsx)("button",{onClick:()=>{xe(!1),be(null),we({}),Se(null)},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:(0,yr.jsx)(ko,{className:"h-5 w-5"})})]}),(0,yr.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:ze.map(e=>(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("label",{className:"w-28 text-sm font-medium text-gray-700 flex-shrink-0",children:e.label}),(0,yr.jsxs)("select",{value:ve[e.key]||"",onChange:t=>{we(n=>Ye(Ye({},n),{},{[e.key]:t.target.value||null})),Se(null)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",children:[(0,yr.jsx)("option",{value:"",children:"(skip)"}),ye.columns.map(e=>(0,yr.jsx)("option",{value:e,children:e},e))]})]},e.key))}),(0,yr.jsxs)("div",{className:"mb-6",children:[(0,yr.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:["Preview (first ",ye.sampleRows.length," rows)"]}),(0,yr.jsxs)("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:[(0,yr.jsxs)("table",{className:"w-full text-xs",children:[(0,yr.jsx)("thead",{className:"bg-gray-50",children:(0,yr.jsx)("tr",{children:ze.filter(e=>ve[e.key]).map(e=>(0,yr.jsxs)("th",{className:"px-3 py-2 text-left font-semibold text-gray-600 whitespace-nowrap",children:[e.label,(0,yr.jsx)("span",{className:"block text-[10px] font-normal text-gray-400",children:ve[e.key]})]},e.key))})}),(0,yr.jsx)("tbody",{className:"divide-y divide-gray-100",children:ye.sampleRows.map((e,t)=>(0,yr.jsx)("tr",{className:"hover:bg-gray-50",children:ze.filter(e=>ve[e.key]).map(t=>(0,yr.jsx)("td",{className:"px-3 py-2 text-gray-700 whitespace-nowrap max-w-[160px] truncate",children:e[ve[t.key]]||(0,yr.jsx)("span",{className:"text-gray-300",children:"\u2014"})},t.key))},t))})]}),0===ze.filter(e=>ve[e.key]).length&&(0,yr.jsx)("div",{className:"text-center py-6 text-gray-400 text-sm",children:"No columns mapped yet \u2014 select columns above to see a preview"})]})]}),ke&&(0,yr.jsxs)("div",{className:"mb-6 border border-gray-200 rounded-lg overflow-hidden",children:[(0,yr.jsxs)("div",{className:"flex flex-wrap gap-3 p-4 bg-gray-50 border-b border-gray-200",children:[(0,yr.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-800",children:["Total: ",ke.totalRows]}),(0,yr.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold ".concat(ke.validRows===ke.totalRows?"bg-green-100 text-green-800":"bg-green-100 text-green-700"),children:["Valid: ",ke.validRows]}),ke.summary.willSkip>0&&(0,yr.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700",children:["Errors: ",ke.summary.willSkip]}),ke.summary.duplicatesInFile>0&&(0,yr.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-amber-100 text-amber-700",children:["In-file duplicates: ",ke.summary.duplicatesInFile]}),ke.summary.duplicatesInDB>0&&(0,yr.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-orange-100 text-orange-700",children:["Already in CRM: ",ke.summary.duplicatesInDB]}),0===ke.summary.willSkip&&0===ke.summary.duplicatesInDB&&0===ke.summary.duplicatesInFile&&0===ke.warnings.length&&(0,yr.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800",children:"All clear"})]}),ke.errors.length>0&&(0,yr.jsxs)("details",{className:"border-b border-gray-200",children:[(0,yr.jsx)("summary",{className:"px-4 py-3 cursor-pointer hover:bg-red-50 text-sm font-medium text-red-700 flex items-center justify-between",children:(0,yr.jsxs)("span",{children:["Errors \u2014 ",ke.errors.length," rows will be skipped"]})}),(0,yr.jsxs)("div",{className:"px-4 pb-3 max-h-40 overflow-y-auto",children:[ke.errors.map((e,t)=>(0,yr.jsxs)("div",{className:"text-xs text-red-600 py-1 border-b border-red-50 last:border-0",children:[(0,yr.jsxs)("span",{className:"font-medium",children:["Row ",e.row,":"]})," ",e.issue]},t)),(null===(t=ke.truncated)||void 0===t?void 0:t.errors)&&(0,yr.jsx)("div",{className:"text-xs text-gray-400 italic pt-1",children:"Showing first 50 of more errors..."})]})]}),ke.warnings.length>0&&(0,yr.jsxs)("details",{className:"border-b border-gray-200",children:[(0,yr.jsx)("summary",{className:"px-4 py-3 cursor-pointer hover:bg-amber-50 text-sm font-medium text-amber-700",children:(0,yr.jsxs)("span",{children:["Warnings \u2014 ",ke.warnings.length," rows with issues (will still import)"]})}),(0,yr.jsxs)("div",{className:"px-4 pb-3 max-h-40 overflow-y-auto",children:[ke.warnings.map((e,t)=>(0,yr.jsxs)("div",{className:"text-xs text-amber-600 py-1 border-b border-amber-50 last:border-0",children:[(0,yr.jsxs)("span",{className:"font-medium",children:["Row ",e.row,":"]})," ",e.issue]},t)),(null===(n=ke.truncated)||void 0===n?void 0:n.warnings)&&(0,yr.jsx)("div",{className:"text-xs text-gray-400 italic pt-1",children:"Showing first 50 of more warnings..."})]})]}),ke.inFileDuplicates.length>0&&(0,yr.jsxs)("details",{className:"border-b border-gray-200",children:[(0,yr.jsx)("summary",{className:"px-4 py-3 cursor-pointer hover:bg-amber-50 text-sm font-medium text-amber-700",children:(0,yr.jsxs)("span",{children:["In-file duplicates \u2014 ",ke.inFileDuplicates.length," phone numbers appear multiple times"]})}),(0,yr.jsxs)("div",{className:"px-4 pb-3 max-h-40 overflow-y-auto",children:[ke.inFileDuplicates.map((e,t)=>(0,yr.jsxs)("div",{className:"text-xs text-amber-600 py-1 border-b border-amber-50 last:border-0",children:[(0,yr.jsx)("span",{className:"font-medium",children:e.phone})," \u2014 appears ",e.count,"x (rows ",e.rows.join(", "),") \u2014 ",e.names.join(", ")]},t)),(null===(r=ke.truncated)||void 0===r?void 0:r.inFileDuplicates)&&(0,yr.jsx)("div",{className:"text-xs text-gray-400 italic pt-1",children:"Showing first 50 of more duplicates..."})]})]}),ke.dbDuplicates.length>0&&(0,yr.jsxs)("details",{className:"border-b border-gray-200 last:border-0",children:[(0,yr.jsx)("summary",{className:"px-4 py-3 cursor-pointer hover:bg-orange-50 text-sm font-medium text-orange-700",children:(0,yr.jsxs)("span",{children:["Already in CRM \u2014 ",ke.dbDuplicates.length," phone numbers already exist"]})}),(0,yr.jsxs)("div",{className:"px-4 pb-3 max-h-40 overflow-y-auto",children:[ke.dbDuplicates.map((e,t)=>(0,yr.jsxs)("div",{className:"text-xs text-orange-600 py-1 border-b border-orange-50 last:border-0",children:[(0,yr.jsx)("span",{className:"font-medium",children:e.phone})," \u2014 ",e.existingName," (",e.existingStatus,")"]},t)),(null===(a=ke.truncated)||void 0===a?void 0:a.dbDuplicates)&&(0,yr.jsx)("div",{className:"text-xs text-gray-400 italic pt-1",children:"Showing first 50 of more matches..."})]})]})]}),(0,yr.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[(0,yr.jsxs)("p",{className:"text-xs text-gray-400",children:[Object.values(ve).filter(Boolean).length," of ",ze.length," fields mapped"]}),(0,yr.jsxs)("div",{className:"flex space-x-3",children:[(0,yr.jsx)("button",{onClick:()=>{xe(!1),be(null),we({}),Se(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:"Cancel"}),(0,yr.jsx)("button",{onClick:async()=>{if(null===ye||void 0===ye||!ye.fileId)return;const e=localStorage.getItem("token");if(e){_e(!0),Se(null);try{const t=await xr.post("/api/leads/upload-analyze",{fileId:ye.fileId,columnMapping:ve},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});Se(t.data)}catch(r){var t,n;console.error("Error analyzing upload:",r),alert((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Analysis failed. Please try again.")}finally{_e(!1)}}else alert("Please login again")},disabled:Ce||!ve.name&&!ve.phone,className:"px-5 py-2 bg-amber-500 text-white rounded-lg hover:bg-amber-600 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:Ce?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,yr.jsx)("span",{children:"Analyzing..."})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(Ps,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:ke?"Re-analyze":"Analyze"})]})}),(0,yr.jsx)("button",{onClick:async()=>{if(null===ye||void 0===ye||!ye.fileId)return;const e=localStorage.getItem("token");if(e){Ne(!0);try{const t=await xr.post("/api/leads/upload-simple",{fileId:ye.fileId,columnMapping:ve},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}),{imported:n,total:r,errors:a}=t.data;let s="Done! ".concat(n," of ").concat(r," leads imported.");a&&a.length>0&&(s+=" (".concat(a.length," rows skipped)")),xe(!1),be(null),we({}),Se(null),alert(s),Ae(),Te()}catch(a){var t,n,r;if(console.error("Error importing mapped leads:",a),400===(null===(t=a.response)||void 0===t?void 0:t.status))alert((null===(n=a.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||"Import failed.");else alert("Import failed. Please try again.")}finally{Ne(!1)}}else alert("Please login again")},disabled:je||!ke||!ve.name&&!ve.phone,className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",title:ke?"":"Run analysis first before importing",children:je?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,yr.jsx)("span",{children:"Importing..."})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(gs,{className:"h-4 w-4"}),(0,yr.jsxs)("span",{children:["Import ",ke?ke.summary.willImport:ye.totalRows," Leads"]})]})})]})]})]})}),pe&&""!==pe.trim()&&(pe.includes("Analyzing")||pe.includes("Processing")||pe.includes("Uploading")||pe.includes("Auto-processing")||pe.includes("Complete"))&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 overflow-y-auto h-full w-full z-50 flex items-center justify-center",children:(0,yr.jsx)("div",{className:"relative mx-auto p-8 border w-full max-w-md shadow-2xl rounded-2xl bg-white transform transition-all duration-300",children:(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("div",{className:"mb-6",children:pe.includes("Complete")?(0,yr.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-green-500 to-emerald-600 rounded-full",children:(0,yr.jsx)("svg",{className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):(0,yr.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full animate-pulse",children:(0,yr.jsx)("svg",{className:"w-8 h-8 text-white animate-spin",fill:"none",viewBox:"0 0 24 24",children:(0,yr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),(0,yr.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:pe.includes("Complete")?"Upload Complete!":pe.includes("Analyzing")?"Analyzing File":pe.includes("Processing")?"Processing Leads":pe.includes("Auto-processing")?"Auto-Processing":"Uploading File"}),(0,yr.jsx)("p",{className:"text-gray-600 mb-6",children:pe.includes("Complete")?"Your leads have been successfully processed and are ready for review.":pe.includes("Analyzing")?"Detecting columns and mapping data...":pe.includes("Processing")?"Importing leads and checking for duplicates...":pe.includes("Auto-processing")?"Smart processing in progress...":"Please wait while we upload your file..."}),(0,yr.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-4",children:(0,yr.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-3 rounded-full transition-all duration-300",style:{width:"".concat(me,"%"),animation:me>0?"shimmer 2s ease-in-out infinite":"none"},children:(0,yr.jsx)("div",{className:"h-full bg-white opacity-30 rounded-full animate-pulse"})})}),(0,yr.jsx)("div",{className:"text-sm text-gray-500 mb-4",children:(0,yr.jsxs)("span",{children:[me,"%"]})}),pe.includes("Analyzing")&&(0,yr.jsx)("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:(0,yr.jsx)("p",{className:"text-sm text-blue-800",children:"\ud83d\udd0d Detecting column headers and data types..."})}),pe.includes("Processing")&&(0,yr.jsx)("div",{className:"bg-green-50 p-3 rounded-lg mb-4",children:(0,yr.jsx)("p",{className:"text-sm text-green-800",children:"\u26a1 Importing leads and checking for duplicates..."})}),pe.includes("Auto-processing")&&(0,yr.jsx)("div",{className:"bg-purple-50 p-3 rounded-lg mb-4",children:(0,yr.jsx)("p",{className:"text-sm text-purple-800",children:"\ud83e\udd16 Smart processing with AI assistance..."})})]})})}),X&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",style:{pointerEvents:"auto"},children:(0,yr.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-full max-w-md shadow-lg rounded-md bg-white",children:(0,yr.jsxs)("div",{className:"mt-3",children:[(0,yr.jsx)("div",{className:"flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full mb-4",children:(0,yr.jsx)(ho,{className:"h-6 w-6 text-red-600"})}),(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900 text-center mb-2",children:"Delete Selected Leads"}),(0,yr.jsxs)("p",{className:"text-sm text-gray-500 text-center mb-6",children:["Are you sure you want to delete ",(0,yr.jsx)("strong",{children:L.length})," selected leads? This action cannot be undone."]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,yr.jsx)("button",{onClick:()=>K(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:"Cancel"}),(0,yr.jsxs)("button",{onClick:async()=>{if(0!==L.length)if("admin"===(null===l||void 0===l?void 0:l.role))try{const e=localStorage.getItem("token"),t=await xr.delete("/api/leads/bulk",{data:{leadIds:L},headers:e?{Authorization:"Bearer ".concat(e)}:{}});K(!1),R([]),Ae(),Te(),alert("Successfully deleted ".concat(t.data.deletedCount||L.length," leads"))}catch(n){var e,t;console.error("Error deleting leads:",n),null!==(e=n.response)&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.message?alert("Delete failed: ".concat(n.response.data.message)):alert("Failed to delete leads. Please try again.")}else alert("Only administrators can delete leads");else alert("Please select leads to delete")},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:["Delete ",L.length," Leads"]})]})]})})}),Y&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",style:{pointerEvents:"auto"},children:(0,yr.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-full max-w-md shadow-lg rounded-md bg-white",children:(0,yr.jsxs)("div",{className:"mt-3",children:[(0,yr.jsx)("div",{className:"flex items-center justify-center w-12 h-12 mx-auto bg-purple-100 rounded-full mb-4",children:(0,yr.jsx)(bo,{className:"h-6 w-6 text-purple-600"})}),(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900 text-center mb-2",children:"Assign Selected Leads"}),(0,yr.jsxs)("p",{className:"text-sm text-gray-500 text-center mb-6",children:["Assign ",(0,yr.jsx)("strong",{children:L.length})," selected leads to a team member."]}),(0,yr.jsxs)("div",{className:"mb-6",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Team Member"}),(0,yr.jsxs)("select",{value:le,onChange:e=>ce(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[(0,yr.jsx)("option",{value:"",children:"Choose a team member..."}),oe.map(e=>(0,yr.jsxs)("option",{value:e.id,children:[e.name," (",e.leads_assigned||0," leads assigned)"]},e.id))]})]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,yr.jsx)("button",{onClick:()=>{G(!1),ce("")},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:"Cancel"}),(0,yr.jsxs)("button",{onClick:async()=>{if(0!==L.length)if(le)try{var e;const t=localStorage.getItem("token");await xr.put("/api/leads/bulk-assign",{leadIds:L,bookerId:le},{headers:t?{Authorization:"Bearer ".concat(t)}:{}}),G(!1),R([]),ce(""),Ae(),Te();const n=(null===(e=oe.find(e=>e.id===le))||void 0===e?void 0:e.name)||"Unknown";alert("Successfully assigned ".concat(L.length," leads to ").concat(n))}catch(t){console.error("Error assigning leads:",t),alert("Failed to assign leads")}else alert("Please select a team member to assign leads to");else alert("Please select leads to assign")},disabled:!le,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:["Assign ",L.length," Leads"]})]})]})})}),(0,yr.jsx)(Ql,{isOpen:Q,onClose:()=>Z(!1),selectedLeads:L,onSuccess:()=>{R([]),Ae()}}),(0,yr.jsx)(Jl,{src:U,onClose:()=>z(null)})]})},ec=e=>{let{leadId:t,lead:n,onStatusUpdate:r}=e;const[a,o]=(0,s.useState)(""),[i,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(""),[u,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)(!1),[f,g]=(0,s.useState)(""),[x,y]=(0,s.useState)(""),[b,v]=(0,s.useState)(""),[w,j]=(0,s.useState)(null),[N,k]=(0,s.useState)(!1),[S,C]=(0,s.useState)(!1),[_,E]=(0,s.useState)(!1),[P,O]=(0,s.useState)(0);(0,s.useEffect)(()=>{if(n&&n.booking_history)try{const e="string"===typeof n.booking_history?JSON.parse(n.booking_history):n.booking_history;if(Array.isArray(e)){const t=e.filter(e=>{var t;return"CALL_STATUS_UPDATE"===e.action&&(null===(t=e.details)||void 0===t?void 0:t.callStatus)&&("No answer"===e.details.callStatus||"No Answer x2"===e.details.callStatus||"No Answer x3"===e.details.callStatus)}),n=t.length>0;E(n),O(t.length)}}catch(FB){console.warn("Error parsing booking_history:",FB)}},[n]);const A=[{value:"No answer",label:"No answer",trigger:"email"},{value:"No photo",label:"No photo",trigger:"email"},{value:"Left Message",label:"Left Message",trigger:"email"},{value:"Not interested",label:"Not interested",trigger:"close"},{value:"Call back",label:"Call back",trigger:"callback"},{value:"Wrong number",label:"Wrong number",trigger:"close"},{value:"Sales/converted - purchased",label:"Sales/converted - purchased",trigger:"callback"},{value:"Not Qualified",label:"Not Qualified",trigger:"close"}],T=(0,s.useMemo)(()=>{const e=[...A];if(_){const t=e.findIndex(e=>"No answer"===e.value);-1!==t&&e.splice(t+1,0,{value:"No Answer x2",label:"No Answer x2",trigger:null},{value:"No Answer x3",label:"No Answer x3",trigger:null})}return e},[_]);(0,s.useEffect)(()=>{if(n)if(n.call_status)o(n.call_status);else if(n.custom_fields)try{const e="string"===typeof n.custom_fields?JSON.parse(n.custom_fields):n.custom_fields;e&&e.call_status&&o(e.call_status)}catch(FB){console.warn("Error parsing custom_fields:",FB)}},[n]);const D=async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";l(!0),d("");try{const s=await xr.patch("/api/leads/".concat(t,"/call-status"),{callStatus:e,callbackTime:n,callbackNote:a});if(s.data.success){o(e),r&&r(e,s.data);const t=T.find(t=>t.value===e);if(t)switch(t.trigger){case"email":case"close":break;case"callback":if(n){const e=n.includes("T")?new Date(n).toLocaleString("en-GB",{dateStyle:"medium",timeStyle:"short",timeZone:"Europe/London"}):n;alert("Callback scheduled for ".concat(e,". You'll receive a reminder notification."))}}}else d(s.data.message||"Failed to update status")}catch(BB){var s,i;console.error("Error updating call status:",BB),d((null===(s=BB.response)||void 0===s||null===(i=s.data)||void 0===i?void 0:i.message)||"Failed to update status")}finally{l(!1),p(!1),j(null),g(""),y(""),v("")}},M=()=>{const e=Pl(),t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)};(0,s.useEffect)(()=>{h&&(g(M()),y((()=>{const e=Pl(),t=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0");return"".concat(t,":").concat(n)})()))},[h]);return(0,yr.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-6 border border-purple-200 shadow-sm",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,yr.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,yr.jsx)(xs,{className:"h-5 w-5 text-purple-600"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Lead Status"}),(0,yr.jsx)("p",{className:"text-sm text-gray-600",children:"Select the status after placing a call"})]})]}),c&&(0,yr.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg",children:(0,yr.jsx)("p",{className:"text-sm text-red-700",children:c})}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsxs)("button",{onClick:()=>!i&&m(!u),disabled:i,className:"\n            w-full px-4 py-3 rounded-lg border-2 text-left font-medium\n            flex items-center justify-between\n            transition-all duration-200\n            ".concat(a?"".concat((e=>{switch(e){case"No answer":case"No Answer x2":case"No Answer x3":case"Left Message":case"No photo":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"Call back":case"Sales/converted - purchased":return"bg-blue-100 text-blue-800 border-blue-300";case"Not interested":case"Not Qualified":case"Wrong number":return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}})(a)," border-current"):"bg-white border-gray-300 text-gray-700 hover:border-purple-400","\n            ").concat(i?"opacity-50 cursor-not-allowed":"cursor-pointer hover:shadow-md","\n          "),children:[(0,yr.jsx)("span",{children:a||"Select status..."}),(0,yr.jsx)(xs,{className:"h-5 w-5 transition-transform ".concat(u?"transform rotate-180":"")})]}),u&&(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>m(!1)}),(0,yr.jsx)("div",{className:"absolute z-20 w-full mt-2 bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-y-auto",children:T.map(e=>(0,yr.jsxs)("button",{onClick:()=>(async e=>{if(!i)return m(!1),"Call back"===e?(j(e),void p(!0)):"No answer"===e?(j(e),void k(!0)):"No photo"===e?(j(e),void C(!0)):void await D(e)})(e.value),className:"\n                    w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors\n                    flex items-center justify-between\n                    ".concat(a===e.value?"bg-purple-50":"","\n                    ").concat(i?"opacity-50 cursor-not-allowed":"cursor-pointer","\n                  "),disabled:i,children:[(0,yr.jsx)("span",{className:"font-medium",children:e.label}),a===e.value&&(0,yr.jsx)(gs,{className:"h-5 w-5 text-purple-600"})]},e.value))})]})]}),a&&(0,yr.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,yr.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,yr.jsx)("strong",{children:"Current Status:"})," ",a]}),(()=>{const e=T.find(e=>e.value===a);if(e)switch(e.trigger){case"email":return(0,yr.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"An automatic email will be sent to the client."});case"close":return(0,yr.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"This lead will be closed."});case"callback":return(0,yr.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"Please call the client back."});default:return null}return null})()]}),i&&(0,yr.jsx)("div",{className:"mt-4 text-center",children:(0,yr.jsx)("p",{className:"text-sm text-gray-500",children:"Updating status..."})}),N&&(0,yr.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md mx-4",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yr.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Send No Answer Email?"}),(0,yr.jsx)("button",{onClick:()=>{k(!1),j(null)},className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-5 w-5"})})]}),(0,yr.jsxs)("p",{className:"text-sm text-gray-600 mb-6",children:['Do you want to send your "No Answer" template email to ',(0,yr.jsx)("strong",{children:null===n||void 0===n?void 0:n.name}),"?"]}),c&&(0,yr.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg",children:(0,yr.jsx)("p",{className:"text-sm text-red-700",children:c})}),(0,yr.jsxs)("div",{className:"flex space-x-3",children:[(0,yr.jsx)("button",{onClick:async()=>{await D(w),k(!1)},disabled:i,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Yes, Send Email"}),(0,yr.jsx)("button",{onClick:()=>{k(!1),j(null)},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})}),S&&(0,yr.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md mx-4",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yr.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Send No Photo Email?"}),(0,yr.jsx)("button",{onClick:()=>{C(!1),j(null)},className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-5 w-5"})})]}),(0,yr.jsxs)("p",{className:"text-sm text-gray-600 mb-6",children:['Do you want to send your "No Photo" template email to ',(0,yr.jsx)("strong",{children:null===n||void 0===n?void 0:n.name}),"?"]}),c&&(0,yr.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg",children:(0,yr.jsx)("p",{className:"text-sm text-red-700",children:c})}),(0,yr.jsxs)("div",{className:"flex space-x-3",children:[(0,yr.jsx)("button",{onClick:async()=>{await D(w),C(!1)},disabled:i,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Yes, Send Email"}),(0,yr.jsx)("button",{onClick:()=>{C(!1),j(null)},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})}),h&&(0,yr.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md mx-4",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yr.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Schedule Callback"}),(0,yr.jsx)("button",{onClick:()=>{p(!1),j(null),g(""),y(""),v("")},className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-5 w-5"})})]}),(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Callback Date"}),(0,yr.jsx)("input",{type:"date",value:f,onChange:e=>g(e.target.value),min:M(),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500",required:!0})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Callback Time (UK Time)"}),(0,yr.jsx)("input",{type:"time",value:x,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500",required:!0}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"You'll receive a notification at this date and time to call back"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note (Optional)"}),(0,yr.jsx)("textarea",{value:b,onChange:e=>v(e.target.value),placeholder:"e.g., back 5pm, discuss pricing, follow up on quote",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500",rows:"3"})]}),c&&(0,yr.jsx)("div",{className:"p-3 bg-red-100 border border-red-300 rounded-lg",children:(0,yr.jsx)("p",{className:"text-sm text-red-700",children:c})}),(0,yr.jsxs)("div",{className:"flex space-x-3",children:[(0,yr.jsxs)("button",{onClick:()=>{if(!f)return void d("Please select a callback date");if(!x)return void d("Please select a callback time");const e="".concat(f,"T").concat(x);D(w,e,b)},disabled:i||!f||!x,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[(0,yr.jsx)(ws,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Schedule Callback"})]}),(0,yr.jsx)("button",{onClick:()=>{p(!1),j(null),g(""),y(""),v("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})]})})]})},tc=e=>{let{isOpen:t,onClose:n,imageUrl:r,leadName:a}=e;const[o,i]=(0,s.useState)(!1),[l,c]=(0,s.useState)(!0),d=(0,s.useRef)(null),u=(e=>{if(!e)return"image";const t=e.toLowerCase();return t.includes(".mp4")||t.includes(".webm")||t.includes(".mov")||t.includes("video/")?"video":t.includes(".gif")?"gif":t.includes(".heic")||t.includes(".heif")?"heic":t.includes(".pdf")?"pdf":"image"})(r),m=(0,s.useCallback)(e=>{e.target===e.currentTarget&&n()},[n]),h=(0,s.useCallback)(e=>{"Escape"===e.key&&n()},[n]),p=(0,s.useCallback)(()=>{d.current&&(l?d.current.pause():d.current.play(),c(!l))},[l]),f=(0,s.useCallback)(async()=>{if(r)try{const e=await fetch(r),t=await e.blob(),n=window.URL.createObjectURL(t),s=document.createElement("a");s.href=n;const o=r.split("/"),i=o[o.length-1].split("?")[0],l=i.split(".").pop()||("video"===u?"mp4":"jpg"),c=a?"".concat(a.replace(/[^a-z0-9]/gi,"_"),".").concat(l):i;s.download=c,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(n)}catch(e){console.error("Download failed:",e),window.open(r,"_blank")}},[r,a,u]);return(0,s.useEffect)(()=>(t?(document.addEventListener("keydown",h),document.body.style.overflow="hidden",i(!1),c(!0)):(document.removeEventListener("keydown",h),document.body.style.overflow="unset"),()=>{document.removeEventListener("keydown",h),document.body.style.overflow="unset"}),[t,h]),t?(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",onClick:m,children:(0,yr.jsxs)("div",{className:"relative max-w-4xl max-h-screen p-4",children:[(0,yr.jsxs)("div",{className:"absolute top-4 right-4 z-10 flex gap-2",children:[(0,yr.jsx)("button",{onClick:f,className:"bg-black bg-opacity-50 text-white rounded-full p-2 hover:bg-opacity-70 transition-all duration-200","aria-label":"Download file",title:"Download",children:(0,yr.jsx)(ks,{className:"h-6 w-6"})}),(0,yr.jsx)("button",{onClick:n,className:"bg-black bg-opacity-50 text-white rounded-full p-2 hover:bg-opacity-70 transition-all duration-200","aria-label":"Close photo modal",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]}),(0,yr.jsxs)("div",{className:"relative",children:[o?(0,yr.jsx)("div",{className:"max-w-full max-h-[90vh] bg-gray-100 rounded-lg shadow-2xl flex items-center justify-center p-8",children:(0,yr.jsxs)("div",{className:"text-center text-gray-500",children:[(0,yr.jsx)(ko,{className:"h-16 w-16 mx-auto mb-4 text-gray-400"}),(0,yr.jsxs)("p",{className:"text-lg font-medium mb-2",children:["video"===u?"Video":"Image"," could not be loaded"]}),(0,yr.jsx)("p",{className:"text-sm",children:"The file may be missing or corrupted"})]})}):(0,yr.jsxs)(yr.Fragment,{children:["heic"===u&&(0,yr.jsx)("div",{className:"max-w-md bg-gray-100 rounded-lg shadow-2xl flex items-center justify-center p-8",children:(0,yr.jsxs)("div",{className:"text-center text-gray-600",children:[(0,yr.jsx)("span",{className:"text-6xl mb-4 block",children:"\ud83d\udcf7"}),(0,yr.jsx)("p",{className:"text-lg font-medium mb-2",children:"HEIC Format"}),(0,yr.jsx)("p",{className:"text-sm mb-4",children:"This Apple image format is not supported in browsers."}),(0,yr.jsx)("button",{onClick:f,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors",children:"Download Original File"})]})}),"pdf"===u&&(0,yr.jsx)("div",{className:"max-w-md bg-gray-100 rounded-lg shadow-2xl flex items-center justify-center p-8",children:(0,yr.jsxs)("div",{className:"text-center text-gray-600",children:[(0,yr.jsx)("span",{className:"text-6xl mb-4 block",children:"\ud83d\udcc4"}),(0,yr.jsx)("p",{className:"text-lg font-medium mb-2",children:"PDF Document"}),(0,yr.jsx)("p",{className:"text-sm mb-4",children:"Click below to view or download the PDF."}),(0,yr.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,yr.jsx)("button",{onClick:()=>window.open(r,"_blank"),className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors",children:"Open PDF"}),(0,yr.jsx)("button",{onClick:f,className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 transition-colors",children:"Download"})]})]})}),"video"===u&&(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)("video",{ref:d,src:r,className:"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl",autoPlay:!0,loop:!0,muted:!1,playsInline:!0,controls:!0,onError:()=>i(!0)}),(0,yr.jsx)("button",{onClick:p,className:"absolute bottom-20 right-4 bg-black bg-opacity-50 text-white rounded-full p-3 hover:bg-opacity-70 transition-all duration-200","aria-label":l?"Pause video":"Play video",children:l?(0,yr.jsx)(Ks,{className:"h-6 w-6"}):(0,yr.jsx)(Zs,{className:"h-6 w-6"})})]}),"gif"===u&&(0,yr.jsx)("img",{src:r,alt:a,className:"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl",onError:()=>i(!0)}),"image"===u&&(0,yr.jsx)("img",{src:r,alt:a,className:"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl",onError:()=>i(!0)})]}),(0,yr.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white p-4 rounded-b-lg",children:[(0,yr.jsxs)("p",{className:"text-lg font-medium",children:[a,"image"!==u&&(0,yr.jsx)("span",{className:"ml-2 text-xs uppercase bg-white bg-opacity-20 px-2 py-1 rounded",children:u})]}),(0,yr.jsx)("p",{className:"text-sm opacity-90",children:"Click outside or press ESC to close"})]})]})]})}):null},nc=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),rc=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},ac=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var sc={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const oc=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],ic=(0,s.forwardRef)((e,t)=>{let{color:n="currentColor",size:r=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:i="",children:l,iconNode:c}=e,d=Il(e,oc);return(0,s.createElement)("svg",Ye(Ye(Ye({ref:t},sc),{},{width:r,height:r,stroke:n,strokeWidth:o?24*Number(a)/Number(r):a,className:ac("lucide",i)},!l&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"}),d),[...c.map(e=>{let[t,n]=e;return(0,s.createElement)(t,n)}),...Array.isArray(l)?l:[l]])}),lc=["className"],cc=(e,t)=>{const n=(0,s.forwardRef)((n,r)=>{let{className:a}=n,o=Il(n,lc);return(0,s.createElement)(ic,Ye({ref:r,iconNode:t,className:ac("lucide-".concat(nc(rc(e))),"lucide-".concat(e),a)},o))});return n.displayName=rc(e),n},dc=cc("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),uc=cc("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),mc=cc("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),hc=cc("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),pc=cc("list",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]),fc=cc("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]),gc=cc("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),xc=cc("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),yc=e=>{let{isOpen:t,onClose:n,leadId:r,leadName:a,onSelectionComplete:o,maxSelection:i=null,preSelectedIds:l=[]}=e;const[c,d]=(0,s.useState)([]),[u,m]=(0,s.useState)(!0),[h,p]=(0,s.useState)(null),[f,g]=(0,s.useState)(new Set(l)),[x,y]=(0,s.useState)("grid"),[b,v]=(0,s.useState)(null),[w,j]=(0,s.useState)(!1),N=(0,s.useCallback)(async()=>{if(r){m(!0),p(null);try{const e=await fetch("/api/photos?leadId=".concat(r),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!e.ok)throw new Error("Failed to fetch photos");const t=await e.json();d(t.photos||[])}catch(BB){console.error("Error fetching photos:",BB),p(BB.message)}finally{m(!1)}}},[r]);(0,s.useEffect)(()=>{t&&r&&(j(!1),N())},[t,r,N]),(0,s.useEffect)(()=>{g(e=>{const t=Array.from(e).sort(),n=[...l].sort();return t.length===n.length&&t.every((e,t)=>e===n[t])?e:new Set(l)})},[l]);const k=e=>{g(t=>{const n=new Set(t);if(n.has(e))n.delete(e);else{if(i&&n.size>=i)return alert("You can only select up to ".concat(i," images")),t;n.add(e)}return n})},S=e=>{v(e)},C=()=>{v(null)};return t?(0,yr.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:[(0,yr.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-6xl max-h-[95vh] flex flex-col overflow-hidden",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b bg-gradient-to-r from-purple-600 to-indigo-600",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("div",{className:"p-2 bg-white bg-opacity-20 rounded-lg",children:(0,yr.jsx)(dc,{className:"w-5 h-5 text-white"})}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h2",{className:"text-xl font-semibold text-white",children:a?"".concat(a,"'s Photos"):"Client Photos"}),(0,yr.jsxs)("p",{className:"text-purple-100 text-sm",children:[c.length," photos available",i&&" \u2022 Select up to ".concat(i)]})]})]}),(0,yr.jsx)("button",{onClick:n,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-full transition-colors",children:(0,yr.jsx)(uc,{className:"w-6 h-6 text-white"})})]}),(0,yr.jsxs)("div",{className:"flex items-center justify-between px-6 py-3 bg-gray-50 border-b",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yr.jsxs)("button",{onClick:()=>{if(w)g(new Set);else if(i&&c.length>i){const e=c.slice(0,i).map(e=>e.id);g(new Set(e))}else g(new Set(c.map(e=>e.id)));j(!w)},className:"flex items-center space-x-2 px-3 py-1.5 text-sm font-medium text-gray-700 hover:bg-gray-200 rounded-lg transition-colors",children:[(0,yr.jsx)(mc,{className:"w-4 h-4 ".concat(w?"text-purple-600":"")}),(0,yr.jsx)("span",{children:w?"Deselect All":"Select All"})]}),(0,yr.jsxs)("button",{onClick:()=>{g(new Set),j(!1)},disabled:0===f.size,className:"flex items-center space-x-2 px-3 py-1.5 text-sm font-medium text-gray-700 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50",children:[(0,yr.jsx)(uc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Clear"})]})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsxs)("div",{className:"flex border rounded-lg overflow-hidden",children:[(0,yr.jsx)("button",{onClick:()=>y("grid"),className:"p-2 ".concat("grid"===x?"bg-purple-100 text-purple-600":"bg-white text-gray-600 hover:bg-gray-100"),children:(0,yr.jsx)(hc,{className:"w-4 h-4"})}),(0,yr.jsx)("button",{onClick:()=>y("list"),className:"p-2 ".concat("list"===x?"bg-purple-100 text-purple-600":"bg-white text-gray-600 hover:bg-gray-100"),children:(0,yr.jsx)(pc,{className:"w-4 h-4"})})]}),(0,yr.jsxs)("div",{className:"px-3 py-1.5 bg-purple-100 text-purple-700 rounded-lg text-sm font-medium",children:[f.size," selected"]})]})]}),(0,yr.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:u?(0,yr.jsxs)("div",{className:"flex flex-col items-center justify-center py-20",children:[(0,yr.jsx)(fc,{className:"w-10 h-10 text-purple-600 animate-spin mb-4"}),(0,yr.jsx)("p",{className:"text-gray-500",children:"Loading photos..."})]}):h?(0,yr.jsxs)("div",{className:"flex flex-col items-center justify-center py-20",children:[(0,yr.jsx)("div",{className:"p-4 bg-red-50 rounded-full mb-4",children:(0,yr.jsx)(uc,{className:"w-10 h-10 text-red-500"})}),(0,yr.jsx)("p",{className:"text-red-600 font-medium",children:h}),(0,yr.jsx)("button",{onClick:N,className:"mt-4 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Retry"})]}):0===c.length?(0,yr.jsxs)("div",{className:"flex flex-col items-center justify-center py-20",children:[(0,yr.jsx)("div",{className:"p-4 bg-gray-100 rounded-full mb-4",children:(0,yr.jsx)(dc,{className:"w-10 h-10 text-gray-400"})}),(0,yr.jsx)("p",{className:"text-gray-600 font-medium",children:"No photos available"}),(0,yr.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Photos will appear here once the photographer uploads them"})]}):"grid"===x?(0,yr.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:c.map(e=>{const t=e.cloudinary_secure_url||e.cloudinary_url,n=Hl(t,"small");return(0,yr.jsxs)("div",{className:"relative group cursor-pointer rounded-xl overflow-hidden shadow-md transition-all duration-200 ".concat(f.has(e.id)?"ring-4 ring-purple-500 ring-offset-2 transform scale-[0.98]":"hover:shadow-xl hover:scale-[1.02]"),onClick:()=>k(e.id),children:[(0,yr.jsx)("div",{className:"aspect-square bg-gray-100",children:(0,yr.jsx)("img",{src:n,alt:e.description||e.filename||"Photo",loading:"lazy",decoding:"async",className:"w-full h-full object-cover",onError:e=>{e.target.style.opacity="0.3"}})}),(0,yr.jsx)("div",{className:"absolute top-2 left-2 w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors ".concat(f.has(e.id)?"bg-purple-600 border-purple-600":"bg-white bg-opacity-80 border-gray-300 group-hover:border-purple-400"),children:f.has(e.id)&&(0,yr.jsx)(mc,{className:"w-4 h-4 text-white"})}),(0,yr.jsx)("button",{onClick:t=>{t.stopPropagation(),S(e)},className:"absolute top-2 right-2 p-1.5 bg-black bg-opacity-50 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity",children:(0,yr.jsx)(gc,{className:"w-4 h-4 text-white"})}),e.is_primary&&(0,yr.jsx)("div",{className:"absolute bottom-2 left-2 px-2 py-0.5 bg-yellow-500 text-yellow-900 text-xs font-medium rounded",children:"Primary"})]},e.id)})}):(0,yr.jsx)("div",{className:"space-y-2",children:c.map(e=>{const t=e.cloudinary_secure_url||e.cloudinary_url,n=Hl(t,"thumb");return(0,yr.jsxs)("div",{className:"flex items-center p-3 rounded-xl cursor-pointer transition-all ".concat(f.has(e.id)?"bg-purple-50 border-2 border-purple-500":"bg-gray-50 border-2 border-transparent hover:bg-gray-100"),onClick:()=>k(e.id),children:[(0,yr.jsx)("div",{className:"w-6 h-6 rounded-full border-2 flex items-center justify-center mr-4 ".concat(f.has(e.id)?"bg-purple-600 border-purple-600":"border-gray-300"),children:f.has(e.id)&&(0,yr.jsx)(mc,{className:"w-4 h-4 text-white"})}),(0,yr.jsx)("div",{className:"w-16 h-16 rounded-lg overflow-hidden bg-gray-200 mr-4 flex-shrink-0",children:(0,yr.jsx)("img",{src:n,alt:e.description||e.filename||"Photo",loading:"lazy",decoding:"async",className:"w-full h-full object-cover",onError:e=>{e.target.style.opacity="0.3"}})}),(0,yr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,yr.jsx)("p",{className:"font-medium text-gray-900 truncate",children:e.filename||"Untitled"}),e.description&&(0,yr.jsx)("p",{className:"text-sm text-gray-500 truncate",children:e.description}),(0,yr.jsxs)("p",{className:"text-xs text-gray-400",children:[e.width&&e.height&&"".concat(e.width," x ").concat(e.height),e.format&&" \u2022 ".concat(e.format.toUpperCase())]})]}),(0,yr.jsx)("button",{onClick:t=>{t.stopPropagation(),S(e)},className:"p-2 text-gray-400 hover:text-purple-600 hover:bg-purple-100 rounded-lg transition-colors",children:(0,yr.jsx)(gc,{className:"w-5 h-5"})})]},e.id)})})}),(0,yr.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-t bg-gray-50",children:[(0,yr.jsx)("p",{className:"text-sm text-gray-500",children:f.size>0?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("span",{className:"font-medium text-purple-600",children:f.size})," photos selected",i&&" of ".concat(i," max")]}):"Click on photos to select them"}),(0,yr.jsxs)("div",{className:"flex space-x-3",children:[(0,yr.jsx)("button",{onClick:n,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,yr.jsxs)("button",{onClick:()=>{const e=c.filter(e=>f.has(e.id));null===o||void 0===o||o(e,Array.from(f)),n()},disabled:0===f.size,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:["Confirm Selection (",f.size,")"]})]})]})]}),b&&(()=>{const e=b.cloudinary_secure_url||b.cloudinary_url,t=Hl(e,"large"),n=Yl(e);return(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-60",onClick:C,children:(0,yr.jsxs)("div",{className:"relative max-w-5xl max-h-[90vh] p-4",children:[(0,yr.jsx)("button",{onClick:C,className:"absolute top-4 right-4 p-2 bg-white bg-opacity-10 rounded-full hover:bg-opacity-20 transition-colors z-10",children:(0,yr.jsx)(uc,{className:"w-6 h-6 text-white"})}),n&&(0,yr.jsx)("div",{className:"absolute inset-4 rounded-lg",style:{backgroundImage:"url(".concat(n,")"),backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",filter:"blur(20px)",transform:"scale(1.05)"}}),(0,yr.jsx)("img",{src:t,alt:b.description||"Preview",className:"max-w-full max-h-[85vh] object-contain rounded-lg relative z-10",onClick:e=>e.stopPropagation()}),(0,yr.jsxs)("div",{className:"absolute bottom-4 left-4 right-4 flex justify-between items-center z-10",children:[(0,yr.jsxs)("p",{className:"text-white text-sm",children:[b.filename||"Untitled",b.width&&b.height&&" \u2022 ".concat(b.width," x ").concat(b.height)]}),(0,yr.jsxs)("a",{href:e,download:!0,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 px-3 py-1.5 bg-white bg-opacity-20 text-white rounded-lg hover:bg-opacity-30 transition-colors",onClick:e=>e.stopPropagation(),children:[(0,yr.jsx)(xc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Download"})]})]})]})})})()]}):null};var bc=n(9634);const vc=["src","alt","size","className","wrapperClassName","style","onClick","threshold","useBlur","fallback","onLoad","onError","fallbackSrc"],wc=["src","alt","onClick","selected","className"],jc=["src","alt","onClick","className"],Nc=(0,s.memo)(e=>{let{src:t,alt:n="",size:r="medium",className:a="",wrapperClassName:o="",style:i={},onClick:l,threshold:c=100,useBlur:d=!0,fallback:u=null,onLoad:m,onError:h,fallbackSrc:p}=e,f=Il(e,vc);const[g,x]=(0,s.useState)(!1),[y,b]=(0,s.useState)(()=>Ul(t)),v=t?Hl(t,r):null,w=d&&t?Yl(t):void 0;return g||!v?u||(0,yr.jsx)("div",{className:"bg-gray-200 flex items-center justify-center ".concat(a),style:i,children:(0,yr.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}):(0,yr.jsx)(bc.LazyLoadImage,Ye({src:v,alt:n,effect:d?"blur":void 0,placeholderSrc:w,threshold:c,className:a,wrapperClassName:o,style:i,onClick:l,afterLoad:()=>{b(!0),v&&Bl(v),null===m||void 0===m||m()},onError:e=>{x(!0),h&&h(e)}},f))});Nc.displayName="OptimizedImage";const kc=Nc,Sc=(0,s.memo)(e=>{let{src:t,alt:n,onClick:r,selected:a,className:s=""}=e,o=Il(e,wc);return(0,yr.jsxs)("div",{className:"relative overflow-hidden bg-gray-100 cursor-pointer ".concat(a?"ring-2 ring-purple-500":""," ").concat(s),onClick:r,children:[(0,yr.jsx)(Nc,Ye({src:t,alt:n,size:"thumb",className:"w-full h-full object-cover",threshold:200},o)),a&&(0,yr.jsx)("div",{className:"absolute top-1 right-1 w-5 h-5 bg-purple-600 rounded-full flex items-center justify-center",children:(0,yr.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,yr.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})});Sc.displayName="OptimizedThumbnail";const Cc=(0,s.memo)(e=>{let{src:t,alt:n,onClick:r,className:a=""}=e,s=Il(e,jc);return(0,yr.jsx)(Nc,Ye({src:t,alt:n,size:"medium",className:"w-full h-full object-cover ".concat(a),threshold:300,onClick:r},s))});Cc.displayName="OptimizedGalleryImage";const _c=[{id:"all",label:"Full Shoot"},{id:"headshots",label:"Headshots"},{id:"zcard",label:"Z-Card"},{id:"best-pics",label:"Best Pics"}],Ec=e=>{let{isOpen:t,onClose:n,photos:r=[],leadId:a,leadName:o,onProceedToPackage:i,initialSelectedIds:l=[],imageLimit:c=null,selectionMode:d=!1,onDeletePhoto:u=null}=e;const[m,h]=(0,s.useState)(r),[p,f]=(0,s.useState)("all"),[g,x]=(0,s.useState)(!1),[y,b]=(0,s.useState)(0),[v,w]=(0,s.useState)(null),[j,N]=(0,s.useState)(!1),[k,S]=(0,s.useState)(new Set(l)),[C,_]=(0,s.useState)(!0),[E]=(0,s.useState)(4e3),[P,O]=(0,s.useState)(!1),[A,T]=(0,s.useState)(!1),[D,M]=(0,s.useState)(!1),I=(0,s.useMemo)(()=>"all"===p?m:m.filter(e=>e.folder_path===p),[m,p]),L=(0,s.useMemo)(()=>{const e={all:m.length};return _c.forEach(t=>{"all"!==t.id&&(e[t.id]=m.filter(e=>e.folder_path===t.id).length)}),e},[m]),R=(0,s.useRef)(null),F=(0,s.useRef)(null),B=(0,s.useRef)(null),U=(0,s.useRef)(null),z=(0,s.useRef)(null);(0,s.useEffect)(()=>{t&&(b(0),w(null),S(new Set(l)),_(!0),O(!1),T(!1),f("all"),h(r))},[t,l,r]),(0,s.useEffect)(()=>{b(0),w(null),O(!1)},[p]),(0,s.useEffect)(()=>{I.length>0&&y>=I.length&&(b(I.length-1),w(null))},[I.length,y]),(0,s.useEffect)(()=>{(async()=>{if(t&&a){z.current=a,x(!0);try{const e=await xr.get("/api/photos",{params:{leadId:a,limit:500,fields:"minimal"}});if(z.current!==a)return void console.log("\ud83d\udcf8 Gallery: Ignoring stale photo response for lead:",a);if(e.data.success&&e.data.photos){const t=e.data.photos;console.log("\ud83d\udcf8 Gallery: Fetched ".concat(t.length," photos for lead ").concat(a)),h(t)}}catch(e){console.error("Error fetching all photos for gallery:",e)}finally{z.current===a&&x(!1)}}})()},[t,a]);const V=(0,s.useMemo)(()=>0!==I.length&&I.every(e=>k.has(e.id)),[I,k]),W=()=>{S(V?e=>{const t=new Set(e);return I.forEach(e=>t.delete(e.id)),t}:e=>{const t=new Set(e),n=I.map(e=>e.id);for(const r of n){if(null!==c&&t.size>=c)break;t.add(r)}return t})},q=V,H=(0,s.useCallback)(async()=>{try{document.fullscreenElement?(await document.exitFullscreen(),M(!1),T(!1)):B.current&&(await B.current.requestFullscreen(),M(!0),T(!0))}catch(BB){console.error("Fullscreen error:",BB)}},[]);(0,s.useEffect)(()=>{const e=()=>{const e=!!document.fullscreenElement;M(e),e||T(!1)};return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[]),(0,s.useEffect)(()=>{t||(document.fullscreenElement&&document.exitFullscreen().catch(()=>{}),U.current&&(clearTimeout(U.current),U.current=null))},[t]);const Y=(0,s.useCallback)(e=>{if(I[e]){const t=new Image,n=I[e].cloudinary_secure_url||I[e].cloudinary_url;t.src=Hl(n,"large")}},[I]),G=(0,s.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e===y||0===I.length)return;const n=(e%I.length+I.length)%I.length;U.current&&(clearTimeout(U.current),U.current=null),t?(b(n),w(null),N(!1),O(!1)):(N(!0),w(y),b(n),O(!1),Y((n+1)%I.length),U.current=setTimeout(()=>{w(null),N(!1)},500))},[y,I.length,Y]),X=(0,s.useCallback)(()=>{G(y+1)},[y,G]),$=(0,s.useCallback)(()=>{G(y-1)},[y,G]);(0,s.useEffect)(()=>{if(C&&t&&!(I.length<=1))return F.current=setInterval(()=>{X()},E),()=>{F.current&&clearInterval(F.current)};F.current&&(clearInterval(F.current),F.current=null)},[C,t,I.length,E,X]),(0,s.useEffect)(()=>{if(!t)return;const e=e=>{var t;switch(e.key){case"ArrowLeft":$(),_(!1);break;case"ArrowRight":X(),_(!1);break;case" ":e.preventDefault(),_(e=>!e);break;case"Escape":A?T(!1):n();break;case"Enter":K(null===(t=I[y])||void 0===t?void 0:t.id);break;case"f":case"F":H();break;case"a":case"A":(e.ctrlKey||e.metaKey)&&(e.preventDefault(),W())}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t,y,X,$,n,I,A,W,H]),(0,s.useEffect)(()=>{if(R.current&&I.length>0){const e=R.current,t=e.children[y];if(t){const n=e.offsetWidth,r=t.offsetLeft-n/2+t.offsetWidth/2;e.scrollTo({left:Math.max(0,r),behavior:0===y?"instant":"smooth"})}}},[y,I.length]),(0,s.useEffect)(()=>{t&&R.current&&setTimeout(()=>{R.current&&R.current.scrollTo({left:0,behavior:"instant"})},100)},[t]);const K=e=>{e&&S(t=>{const n=new Set(t);if(n.has(e))n.delete(e);else{if(null!==c&&n.size>=c)return t;n.add(e)}return n})},J=null!==c&&k.size>=c;if(!t)return null;if(0===m.length)return(0,yr.jsx)("div",{ref:B,className:"fixed inset-0 z-50 bg-black flex items-center justify-center",children:(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("p",{className:"text-white/60 text-lg mb-4",children:"No photos available"}),(0,yr.jsx)("button",{onClick:n,className:"text-white/80 hover:text-white",children:"Close"})]})});const Q=I[y]||I[0],Z=null!==v?I[v]:null,ee=!!Q&&k.has(Q.id);return(0,yr.jsxs)("div",{ref:B,className:"fixed inset-0 z-50 bg-black",children:[(0,yr.jsx)("div",{className:"absolute top-0 left-0 right-0 z-20 bg-gradient-to-b from-black/80 to-transparent p-4 transition-all duration-300 ".concat(A?"opacity-0 pointer-events-none":"opacity-100"),children:(0,yr.jsxs)("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yr.jsx)("h2",{className:"text-white text-xl font-light tracking-wide",children:o}),(0,yr.jsxs)("span",{className:"text-white/40 text-sm font-light",children:[y+1," / ",I.length]}),g&&(0,yr.jsx)(Bs,{className:"w-4 h-4 text-white/40 animate-spin"})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("button",{onClick:W,className:"text-white/60 hover:text-white px-3 py-2 transition-colors text-sm font-light tracking-wide",children:q?"Deselect All":"Select All"}),d&&null!==c&&(0,yr.jsxs)("span",{className:"text-sm font-light tracking-wide px-3 py-1 ".concat(J?"text-white bg-white/10":"text-white/40"),children:[k.size,"/",c]}),(!d||null===c)&&k.size>0&&(0,yr.jsxs)("span",{className:"text-white/60 text-sm font-light",children:[k.size," selected"]}),(0,yr.jsx)("button",{onClick:()=>_(!C),className:"text-white/40 hover:text-white p-2 transition-colors",children:C?(0,yr.jsx)(Ks,{className:"w-5 h-5"}):(0,yr.jsx)(Zs,{className:"w-5 h-5"})}),(0,yr.jsx)("button",{onClick:H,className:"text-white/40 hover:text-white p-2 transition-colors",children:D?(0,yr.jsx)(Gs,{className:"w-5 h-5"}):(0,yr.jsx)(qs,{className:"w-5 h-5"})}),(0,yr.jsx)("button",{onClick:n,className:"text-white/40 hover:text-white p-2 transition-colors",children:(0,yr.jsx)(ko,{className:"w-5 h-5"})})]})]})}),(0,yr.jsx)("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 z-20 transition-all duration-500 ".concat(A?"opacity-0 pointer-events-none -translate-x-full":"opacity-100"),children:(0,yr.jsx)("nav",{className:"py-4 pl-6 pr-12",children:_c.map(e=>{const t=L[e.id]||0,n=p===e.id;return"all"!==e.id&&0===t?null:(0,yr.jsxs)("button",{onClick:()=>f(e.id),className:"block w-full text-left py-2.5 transition-all duration-300 group ".concat(n?"pl-4 border-l border-white":"pl-4 border-l border-transparent hover:border-white/30"),children:[(0,yr.jsx)("span",{className:"text-sm tracking-wider transition-all duration-300 ".concat(n?"text-white font-normal":"text-white/30 group-hover:text-white/70 font-light"),children:e.label}),t>0&&(0,yr.jsx)("span",{className:"ml-2 text-xs transition-all duration-300 ".concat(n?"text-white/50":"text-white/20"),children:t})]},e.id)})})}),(0,yr.jsx)("div",{className:"absolute inset-0 flex items-center justify-center transition-all duration-300 ".concat(A?"px-4 py-4":"px-20 py-24"),children:I.length>0&&Q?(0,yr.jsxs)(yr.Fragment,{children:[Z&&(0,yr.jsx)("div",{className:"slideshow-image previous",children:(0,yr.jsx)("img",{src:Hl(Z.cloudinary_secure_url||Z.cloudinary_url,"large"),alt:"",className:"max-w-full max-h-full object-contain"})}),(0,yr.jsxs)("div",{className:"slideshow-image ".concat(P?"active":""),children:[!P&&(0,yr.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",style:{backgroundImage:"url(".concat(Yl(Q.cloudinary_secure_url||Q.cloudinary_url),")"),backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",filter:"blur(20px)",transform:"scale(1.1)"}}),(0,yr.jsx)("img",{src:Hl(Q.cloudinary_secure_url||Q.cloudinary_url,"large"),alt:Q.description||"Photo ".concat(y+1),className:"max-w-full max-h-full object-contain relative z-10",onLoad:()=>O(!0)})]}),ee&&(0,yr.jsx)("div",{className:"absolute top-28 right-24 transition-all duration-300 ".concat(A?"opacity-0":"opacity-100"),children:(0,yr.jsx)("div",{className:"w-12 h-12 rounded-full bg-purple-600 flex items-center justify-center shadow-lg animate-pulse",children:(0,yr.jsx)(gs,{className:"w-6 h-6 text-white"})})})]}):(0,yr.jsx)("p",{className:"text-white/40 font-light tracking-wide",children:"No photos in this folder"})}),I.length>1&&(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("button",{onClick:()=>{$(),_(!1)},className:"absolute top-1/2 -translate-y-1/2 z-30 text-white/20 hover:text-white p-4 transition-all hover:scale-110 ".concat(A?"opacity-30 hover:opacity-100":"opacity-100"),style:{left:"160px"},children:(0,yr.jsx)(ys,{className:"w-8 h-8"})}),(0,yr.jsx)("button",{onClick:()=>{X(),_(!1)},className:"absolute right-8 top-1/2 -translate-y-1/2 z-30 text-white/20 hover:text-white p-4 transition-all hover:scale-110 ".concat(A?"opacity-30 hover:opacity-100":"opacity-100"),children:(0,yr.jsx)(bs,{className:"w-8 h-8"})})]}),I.length>0&&Q&&(0,yr.jsx)("div",{className:"absolute bottom-36 left-1/2 -translate-x-1/2 z-20 transition-all duration-300 ".concat(A?"opacity-0 pointer-events-none":"opacity-100"),children:(0,yr.jsx)("button",{onClick:()=>K(null===Q||void 0===Q?void 0:Q.id),disabled:!ee&&J,className:"flex items-center space-x-3 px-8 py-4 rounded-full text-lg font-semibold transition-all transform shadow-xl ".concat(ee?"bg-purple-600 text-white hover:scale-105":J?"bg-gray-400 text-white cursor-not-allowed":"bg-white text-gray-900 hover:bg-purple-50 hover:scale-105"),children:ee?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(gs,{className:"w-6 h-6"}),(0,yr.jsx)("span",{children:"Selected"})]}):J?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(Is,{className:"w-6 h-6"}),(0,yr.jsx)("span",{children:"Limit Reached"})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(eo,{className:"w-6 h-6"}),(0,yr.jsx)("span",{children:"Add to Selection"})]})})}),(0,yr.jsx)("div",{className:"absolute bottom-0 left-0 right-0 z-20 transition-all duration-500 ".concat(A?"opacity-0 pointer-events-none translate-y-full":"opacity-100 translate-y-0"),children:(0,yr.jsx)("div",{className:"bg-gradient-to-t from-black via-black/80 to-transparent pt-8 pb-4 px-4",children:(0,yr.jsx)("div",{ref:R,className:"flex space-x-2 overflow-x-auto scrollbar-hide px-4",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:I.map((e,t)=>{const n=e.cloudinary_secure_url||e.cloudinary_url,r=t===y,a=k.has(e.id);return(0,yr.jsxs)("button",{onClick:()=>{G(t,!0),_(!1)},className:"group/thumb relative flex-shrink-0 w-16 h-16 overflow-hidden transition-all duration-300 ".concat(r?"ring-2 ring-white opacity-100":a?"ring-2 ring-purple-500 opacity-100":"opacity-30 hover:opacity-60"),children:[(0,yr.jsx)(kc,{src:n,alt:"".concat(t+1),size:"thumb",className:"w-full h-full object-cover",useBlur:!0,threshold:200}),a&&(0,yr.jsx)("div",{className:"absolute top-1 right-1 bg-purple-600 rounded-full p-0.5 z-10",children:(0,yr.jsx)(gs,{className:"w-3 h-3 text-white"})}),u&&(0,yr.jsx)("button",{onClick:t=>{t.stopPropagation(),(async(e,t)=>{u&&(await u(e,t),h(t=>t.filter(t=>t.id!==e)),S(t=>{const n=new Set(t);return n.delete(e),n}))})(e.id,t)},className:"absolute top-0.5 left-0.5 p-0.5 bg-red-500 text-white rounded-full opacity-0 group-hover/thumb:opacity-100 transition-opacity z-20 hover:bg-red-600",title:"Delete photo",children:(0,yr.jsx)(ho,{className:"w-2.5 h-2.5"})})]},e.id)})})})}),k.size>0&&(0,yr.jsx)("div",{className:"absolute bottom-28 right-8 z-20 transition-all duration-300 ".concat(A?"opacity-0 pointer-events-none":"opacity-100"),children:(0,yr.jsx)("button",{onClick:()=>{const e=m.filter(e=>k.has(e.id)),t=Array.from(k);i(t,e)},className:"flex items-center space-x-3 text-white px-8 py-4 rounded-full text-lg font-semibold shadow-xl hover:shadow-2xl transition-all transform hover:scale-105 ".concat(d?"bg-gradient-to-r from-green-600 to-emerald-600":"bg-gradient-to-r from-purple-600 to-indigo-600"),children:d?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(gs,{className:"w-6 h-6"}),(0,yr.jsxs)("span",{children:["Confirm Selection (",k.size,c?"/".concat(c):""," photos)"]})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(io,{className:"w-6 h-6"}),(0,yr.jsxs)("span",{children:["Select Package (",k.size," photos)"]})]})})}),C&&(0,yr.jsxs)("div",{className:"absolute bottom-28 left-8 z-20 flex items-center space-x-2 text-white/30 transition-all duration-300 ".concat(A?"opacity-0":"opacity-100"),children:[(0,yr.jsx)("div",{className:"w-1.5 h-1.5 bg-white/50 rounded-full animate-pulse"}),(0,yr.jsx)("span",{className:"text-xs font-light tracking-wider",children:"Auto"})]}),D&&(0,yr.jsx)("div",{className:"absolute top-4 right-4 z-30 text-white/20 text-xs cursor-pointer hover:text-white/60 transition-colors tracking-wider font-light",onClick:H,children:"ESC to exit"})]})},Pc=cc("presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]),Oc=()=>{var e,t,n,r,a;const{id:o}=Q(),i=J(),l=$(),{user:c}=Nr(),[d,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(!0),[p,f]=(0,s.useState)(""),[g,x]=(0,s.useState)(!1),[y,b]=(0,s.useState)({}),[v,w]=(0,s.useState)([]),[j,N]=(0,s.useState)(0),[k,S]=(0,s.useState)(!1),[C,_]=(0,s.useState)({statusFilter:"all",searchTerm:"",filteredLeads:[],dateFilter:"all",customDateStart:"",customDateEnd:"",assigned_at_start:null,assigned_at_end:null}),[E,P]=(0,s.useState)(""),[O,A]=(0,s.useState)(""),[T,D]=(0,s.useState)([]),[M,I]=(0,s.useState)([]),[L,R]=(0,s.useState)(!1),[F,B]=(0,s.useState)(!1),[U,z]=(0,s.useState)([]),[V,W]=(0,s.useState)(!1),[q,H]=(0,s.useState)([]),[Y,G]=(0,s.useState)([]),[X,K]=(0,s.useState)(null),[Z,ee]=(0,s.useState)(!1),[te,ne]=(0,s.useState)(""),[re,ae]=(0,s.useState)(""),[se,oe]=(0,s.useState)(new Set),[ie,le]=(0,s.useState)(null),[ce,de]=(0,s.useState)([]),[ue,me]=(0,s.useState)([]),[he,pe]=(0,s.useState)(!1),[fe,ge]=(0,s.useState)(!1),[xe,ye]=(0,s.useState)([]),[be,ve]=(0,s.useState)(!1),[we,je]=(0,s.useState)(""),[Ne,ke]=(0,s.useState)("sms"),Se=e=>{e&&(e.style.height="auto",e.style.height=Math.min(e.scrollHeight,500)+"px")},[Ce,_e]=(0,s.useState)(!1),[Ee,Pe]=(0,s.useState)("Duplicated"),[Oe,Ae]=(0,s.useState)(!1),[Te,De]=(0,s.useState)(!1),Me=[{_id:"welcome",name:"Welcome Message",message:"Hi [NAME], thanks for your interest! We'll contact you shortly to confirm your photoshoot booking."},{_id:"reminder",name:"Reminder Message",message:"Hi [NAME], just a reminder about your modelling photoshoot on [DATE] at [TIME]."},{_id:"followup",name:"Follow-up Message",message:"Hi [NAME], we noticed you haven't confirmed your session. Let us know if you're still interested!"}],Ie=[{_id:"welcome",name:"Welcome Email",subject:"Welcome to our Modelling Studio - [NAME]",message:"Dear [NAME],\n\nThank you for your interest in our modelling services! We're excited to work with you.\n\nWe'll be in touch shortly to confirm your photoshoot booking and discuss the details.\n\nIf you have any questions in the meantime, please don't hesitate to reach out.\n\nBest regards,\nThe Studio Team"},{_id:"reminder",name:"Reminder Email",subject:"Reminder: Your Photoshoot on [DATE]",message:"Dear [NAME],\n\nThis is a friendly reminder about your upcoming modelling photoshoot scheduled for [DATE] at [TIME].\n\nPlease ensure you arrive 15 minutes early and bring any items we discussed.\n\nLooking forward to working with you!\n\nBest regards,\nThe Studio Team"},{_id:"followup",name:"Follow-up Email",subject:"Following up on your Modelling Session - [NAME]",message:"Dear [NAME],\n\nWe noticed that you haven't confirmed your modelling session yet.\n\nWe're still very interested in working with you and would love to schedule your photoshoot.\n\nPlease let us know if you're still interested or if you have any questions.\n\nBest regards,\nThe Studio Team"},{_id:"booking_confirmation",name:"Booking Confirmation",subject:"Booking Confirmed - Your Photoshoot on [DATE]",message:"Dear [NAME],\n\nGreat news! Your photoshoot has been confirmed for [DATE] at [TIME].\n\nLocation: Our Studio\nDuration: Approximately 2 hours\n\nPlease bring:\n- A variety of outfits\n- Any specific props or accessories\n- A positive attitude!\n\nWe can't wait to work with you!\n\nBest regards,\nThe Studio Team"}],Le=e=>{const t={"No Answer Templates":["no_answer"],"Invitation Templates":["invitation_email"]},n={"No Answer Templates":[],"Invitation Templates":[]};return e.forEach(e=>{let r=!1;for(const[a,s]of Object.entries(t))if(s.includes(e.type)){n[a].push(e),r=!0;break}r||n["Invitation Templates"].push(e)}),n},Re=e=>["no_answer","invitation_email"].includes(e.type),Fe=(0,s.useCallback)(async()=>{if(v.length<=1)return;const e=j,t=[];e>0&&t.push(v[e-1]),e<v.length-1&&t.push(v[e+1]);const n=t.map(e=>e.image_url).filter(e=>e&&""!==e).map(e=>zl(e,"optimized"));if(0!==n.length)try{console.log("\ud83d\uddbc\ufe0f Preloading adjacent lead images:",n),await(async e=>{const t=e.filter(e=>e&&""!==e);if(0===t.length)return[];try{const e=await Promise.allSettled(t.map(e=>Vl(e)));return e.filter(e=>"fulfilled"===e.status).map(e=>e.value)}catch(p){return console.warn("Some images failed to preload:",p),[]}})(n),oe(e=>{const t=new Set(e);return n.forEach(e=>t.add(e)),t})}catch(p){console.warn("\u26a0\ufe0f Failed to preload some images:",p)}},[v,j]),Be=(0,s.useCallback)(async()=>{try{var e,t,n,r,a;const s=(null===(e=l.state)||void 0===e?void 0:e.statusFilter)||C.statusFilter,i=(null===(t=l.state)||void 0===t?void 0:t.searchTerm)||C.searchTerm,c=(null===(n=l.state)||void 0===n?void 0:n.assigned_at_start)||C.assigned_at_start,d=(null===(r=l.state)||void 0===r?void 0:r.assigned_at_end)||C.assigned_at_end,u={};s&&"all"!==s&&(u.status=s),i&&(u.search=i),c&&d&&(u.assigned_at_start=c,u.assigned_at_end=d);const m=[];let h=1,p=!0;const f=100;for(;p;){u.page=h,u.limit=f;const e=await xr.get("/api/leads",{params:u}),t=e.data.leads||e.data||[];if(0===t.length)p=!1;else{m.push(...t);h>=(e.data.totalPages||1)||t.length<f?p=!1:h++}}console.log("\u2705 Fetched ".concat(m.length," total leads for navigation (status: ").concat(s||"all",")"));const g=(null===(a=l.state)||void 0===a?void 0:a.filteredLeads)||C.filteredLeads,x=(null===g||void 0===g?void 0:g.length)>0?g:m;w(x),s===C.statusFilter&&i===C.searchTerm&&c===C.assigned_at_start||_(e=>Ye(Ye({},e),{},{statusFilter:s||"all",searchTerm:i||"",filteredLeads:x,assigned_at_start:c||null,assigned_at_end:d||null}));const y=x.findIndex(e=>e.id===o||e.id.toString()===o||e.id===o.toString());N(-1!==y?y:0)}catch(p){console.error("Error fetching all leads:",p),f("Failed to fetch leads. Please try again."),w([]),N(0)}},[o,C,l.state]),Ue=(0,s.useCallback)(async()=>{try{const e=await xr.get("/api/templates?bookersOnly=true"),t=e.data.map(e=>Ye(Ye({},e),{},{_id:e.id||e._id})).filter(Re);D(t.filter(e=>e.smsBody||e.sendSMS)),I(t.filter(e=>e.emailBody||e.sendEmail))}catch(p){console.error("Error fetching templates:",p),D(Me),I(Ie)}},[]),ze=(0,s.useCallback)(async()=>{if(o){console.log("\ud83d\udce5 Fetching lead data for ID:",o),h(!0);try{const e=await xr.get("/api/leads/".concat(o));console.log("\u2705 Lead data fetched:",e.data.name),u(e.data),b(e.data),f("")}catch(p){console.error("\u274c Error fetching lead:",p),f("Failed to fetch lead details. Please try again."),u(null),b({})}finally{h(!1),S(!1)}}else console.log("\u26a0\ufe0f No ID provided for fetchLead")},[o]),Ve=(0,s.useCallback)(async()=>{if(o)try{const e=await xr.get("/api/sales/by-lead/".concat(o));le(e.data)}catch(p){var e,t;404===(null===(e=p.response)||void 0===e?void 0:e.status)||200===(null===(t=p.response)||void 0===t?void 0:t.status)||console.warn("\u26a0\ufe0f Error fetching sale:",p.message),le(null)}},[o]),We=(0,s.useCallback)(async()=>{if(o)try{pe(!0);const e=await xr.get("/api/leads/".concat(o,"/history"));console.log("\ud83d\udccb Booking history fetched:",e.data.bookingHistory);const t=(e.data.bookingHistory||[]).filter(e=>!e.performedByName&&!e.performed_by_name&&!e.performedBy&&!e.performed_by);t.length>0&&console.log("\u26a0\ufe0f Entries without performer name:",t),de(e.data.bookingHistory||[])}catch(p){console.error("Error fetching booking history:",p),de([])}finally{pe(!1)}},[o]),qe=(0,s.useCallback)(async()=>{if(o)try{const e=await xr.get("/api/leads/".concat(o,"/callbacks"));me(e.data||[])}catch(p){console.error("Error fetching upcoming callbacks:",p),me([])}},[o]),He=(0,s.useCallback)(async()=>{if(o)try{const e=await xr.get("/api/photos",{params:{leadId:o,limit:50,fields:"minimal"}});e.data.success&&z(e.data.photos||[])}catch(p){console.error("Error fetching photos:",p),z([])}},[o]),Ge=(0,s.useCallback)(async()=>{if(d&&fe)try{if(ve(!0),d.booking_history){const e=("string"===typeof d.booking_history?JSON.parse(d.booking_history):d.booking_history).filter(e=>["SMS_SENT","SMS_RECEIVED","EMAIL_SENT","EMAIL_RECEIVED"].includes(e.action)).sort((e,t)=>new Date(e.timestamp)-new Date(t.timestamp));ye(e)}else ye([])}catch(p){console.error("Error fetching conversation history:",p),ye([])}finally{ve(!1)}},[d,fe]),Xe=(0,s.useRef)(!1),$e=(0,s.useRef)(null),Ke=(0,s.useRef)(!0),Je=(0,s.useRef)(null);(0,s.useEffect)(()=>{Xe.current=!1,$e.current=null,Ke.current=!0},[o]),(0,s.useEffect)(()=>()=>{Wl.clear()},[]),(0,s.useEffect)(()=>{if(v.length>0&&j>=0){if(j>0){const e=v[j-1];null!==e&&void 0!==e&&e.image_url&&ql(e.image_url,5).catch(()=>{})}if(j<v.length-1){const e=v[j+1];null!==e&&void 0!==e&&e.image_url&&ql(e.image_url,5).catch(()=>{})}}},[v,j]),(0,s.useEffect)(()=>{const e=l.pathname==="/leads/".concat(o);if(!o||!e)return void(e||(Xe.current=!1,$e.current=null,Je.current=null));const t=JSON.stringify(l.state)!==JSON.stringify($e.current);if(!Xe.current||t){if(console.log("\ud83d\udd0d LeadDetail: Component initialized",{id:o,hasState:!!l.state}),l.state){const{statusFilter:e,searchTerm:t,filteredLeads:n,dateFilter:r,customDateStart:a,customDateEnd:s,assigned_at_start:i,assigned_at_end:c}=l.state;if(console.log("\ud83d\udd0d LeadDetail: Setting up navigation context",{statusFilter:e,searchTerm:t,hasFilteredLeads:!(null===n||void 0===n||!n.length),dateFilter:r,assigned_at_start:i,assigned_at_end:c}),_({statusFilter:e||"all",searchTerm:t||"",filteredLeads:n||[],dateFilter:r||"all",customDateStart:a||"",customDateEnd:s||"",assigned_at_start:i||null,assigned_at_end:c||null}),n&&n.length>0){w(n);const e=n.findIndex(e=>e.id===o);N(-1!==e?e:0),console.log("\ud83d\udccd LeadDetail: Navigation context ready, index:",e)}}Xe.current=!0,$e.current=l.state}},[o,l.pathname,l.state,v.length,Be]),(0,s.useEffect)(()=>{0===v.length&&o&&(console.log("\ud83d\udce5 LeadDetail: Fetching leads for navigation (no state provided)"),Be())},[o,v.length,Be]),(0,s.useEffect)(()=>{const e=()=>{console.log("\ud83d\udd19 Browser navigation detected, resetting refs"),Xe.current=!1,$e.current=null};return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},[]),(0,s.useEffect)(()=>{o&&Je.current!==o&&(console.log("\ud83d\udce5 LeadDetail: Fetching initial data for lead:",o),Je.current=o,H([]),G([]),z([]),ze(),Ue(),Ve(),We(),qe(),He())},[o,ze,Ue,Ve,We,qe,He]),(0,s.useEffect)(()=>{if(o&&v.length>0){const e=v.findIndex(e=>e.id===o);-1!==e&&e!==j&&(N(e),console.log("\ud83d\udd04 LeadDetail: Updated index for existing lead:",e))}},[o,v,j]),(0,s.useEffect)(()=>{v.length>0&&Fe()},[v,j,Fe]),(0,s.useEffect)(()=>{fe&&d&&Ge()},[fe,d,Ge]),(0,s.useEffect)(()=>{we&&fe&&setTimeout(()=>{const e=document.querySelector('textarea[placeholder*="reply"]');Se(e)},0)},[we,Ne,fe]);const Qe=e=>{const{name:t,value:n}=e.target;b(e=>Ye(Ye({},e),{},{[t]:n}))},Ze=()=>j>0&&v.length>0,et=()=>j<v.length-1&&v.length>0,tt=e=>{const t=new Date(d.dateBooked).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"}),n=new Date(d.dateBooked).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return e.replace(/\[NAME\]/g,d.name).replace(/\[DATE\]/g,t).replace(/\[TIME\]/g,n)},nt=async(e,t)=>{try{await xr.post("/api/leads/".concat(o,"/history"),{action:e,details:t,timestamp:(new Date).toISOString()}),We()}catch(p){console.error("Error adding history entry:",p)}},rt=e=>{let{leadId:t,lead:n,onStatusUpdate:r}=e;const[a,o]=(0,s.useState)(""),[c,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(""),[h,p]=(0,s.useState)(!1),[f,g]=(0,s.useState)(!1),[x,y]=(0,s.useState)(""),[b,v]=(0,s.useState)(""),[w,j]=(0,s.useState)(null),[N,k]=(0,s.useState)(!1),[S,C]=(0,s.useState)(!1),[_,E]=(0,s.useState)(0);(0,s.useEffect)(()=>{if(n&&n.booking_history)try{const e="string"===typeof n.booking_history?JSON.parse(n.booking_history):n.booking_history;if(Array.isArray(e)){const t=e.filter(e=>{var t;return"CALL_STATUS_UPDATE"===e.action&&(null===(t=e.details)||void 0===t?void 0:t.callStatus)&&("No answer"===e.details.callStatus||"No Answer x2"===e.details.callStatus||"No Answer x3"===e.details.callStatus)}),n=t.length>0;C(n),E(t.length)}}catch(FB){console.warn("Error parsing booking_history:",FB)}},[n]);const P=[{value:"No answer",label:"No answer",trigger:"email"},{value:"Left Message",label:"Left Message",trigger:"email"},{value:"Not interested",label:"Not interested",trigger:"close"},{value:"Call back",label:"Call back",trigger:"callback"},{value:"Wrong number",label:"Wrong number",trigger:"close"},{value:"Sales/converted - purchased",label:"Sales/converted - purchased",trigger:"callback"},{value:"Not Qualified",label:"Not Qualified",trigger:"close"}],O=(0,s.useMemo)(()=>{const e=[...P];if(S){const t=e.findIndex(e=>"No answer"===e.value);-1!==t&&e.splice(t+1,0,{value:"No Answer x2",label:"No Answer x2",trigger:null},{value:"No Answer x3",label:"No Answer x3",trigger:null})}return e},[S]);(0,s.useEffect)(()=>{if(n){let e=null;if(n.custom_fields)try{const t="string"===typeof n.custom_fields?JSON.parse(n.custom_fields):n.custom_fields;e=(null===t||void 0===t?void 0:t.call_status)||null}catch(FB){console.warn("Error parsing custom_fields for call_status:",FB)}n.call_status&&(e=n.call_status),e||"Wrong number"!==n.status||(e="Wrong number"),o(e||"")}},[n]);const A=async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";d(!0),m("");try{const s=await xr.patch("/api/leads/".concat(t,"/call-status"),{callStatus:e,callbackTime:n,callbackNote:a});if(s.data.success){o(e),r&&r(e,s.data);const t={"No answer":"No answer","No Answer x2":"No answer","No Answer x3":"No answer","Left Message":"Left Message","Not interested":"Not interested","Call back":"Call back","Wrong number":"Wrong Number","Sales/converted - purchased":"Sales/converted - purchased","Not Qualified":"Not Qualified"}[e]||"all",a=O.find(t=>t.value===e);if(a)switch(a.trigger){case"email":alert("Status updated. An automatic email will be sent to the client. Redirecting to leads page...");break;case"close":alert("Status updated. This lead will be closed. Redirecting to leads page...");break;case"callback":n&&alert("Status updated. Callback scheduled for ".concat(n,". You'll receive a reminder notification. Redirecting to leads page..."))}setTimeout(()=>{var e;const n=(null===(e=l.state)||void 0===e?void 0:e.currentPage)||parseInt(sessionStorage.getItem("leadsPage")||"1",10);sessionStorage.setItem("leadsPage",n.toString()),i("/leads",{state:{statusFilter:t,currentPage:n},replace:!1})},500)}else m(s.data.message||"Failed to update status")}catch(BB){var s,c;console.error("Error updating call status:",BB),m((null===(s=BB.response)||void 0===s||null===(c=s.data)||void 0===c?void 0:c.message)||"Failed to update status")}finally{d(!1),g(!1),j(null),y(""),v("")}},T=()=>{const e=Pl(),t=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0");return"".concat(t,":").concat(n)};(0,s.useEffect)(()=>{f&&!x&&y(T())},[f]);return(0,yr.jsxs)("div",{className:"mt-4 bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-6 border border-purple-200 shadow-sm",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,yr.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,yr.jsx)(xs,{className:"h-5 w-5 text-purple-600"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Lead Status"}),(0,yr.jsx)("p",{className:"text-sm text-gray-600",children:"Select the status after placing a call"})]})]}),u&&(0,yr.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg",children:(0,yr.jsx)("p",{className:"text-sm text-red-700",children:u})}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsxs)("button",{onClick:()=>!c&&p(!h),disabled:c,className:"\n              w-full px-4 py-3 rounded-lg border-2 text-left font-medium\n              flex items-center justify-between\n              transition-all duration-200\n              ".concat(a?"".concat((e=>{switch(e){case"No answer":case"No Answer x2":case"No Answer x3":case"Left Message":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"Call back":case"Sales/converted - purchased":return"bg-blue-100 text-blue-800 border-blue-300";case"Not interested":case"Not Qualified":case"Wrong number":return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}})(a)," border-current"):"bg-white border-gray-300 text-gray-700 hover:border-purple-400","\n              ").concat(c?"opacity-50 cursor-not-allowed":"cursor-pointer hover:shadow-md","\n            "),children:[(0,yr.jsx)("span",{children:a||"Select status..."}),(0,yr.jsx)(xs,{className:"h-5 w-5 transition-transform ".concat(h?"transform rotate-180":"")})]}),h&&(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>p(!1)}),(0,yr.jsx)("div",{className:"absolute z-20 w-full mt-2 bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-y-auto",children:O.map(e=>(0,yr.jsxs)("button",{onClick:()=>(async e=>{if(!c)return p(!1),"Call back"===e?(j(e),void g(!0)):"No answer"===e?(j(e),void k(!0)):void await A(e)})(e.value),className:"\n                      w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors\n                      flex items-center justify-between\n                      ".concat(a===e.value?"bg-purple-50":"","\n                      ").concat(c?"opacity-50 cursor-not-allowed":"cursor-pointer","\n                    "),disabled:c,children:[(0,yr.jsx)("span",{className:"font-medium",children:e.label}),a===e.value&&(0,yr.jsx)(gs,{className:"h-5 w-5 text-purple-600"})]},e.value))})]})]}),a&&(0,yr.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,yr.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,yr.jsx)("strong",{children:"Current Status:"})," ",a]}),(()=>{const e=O.find(e=>e.value===a);if(e)switch(e.trigger){case"email":return(0,yr.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"An automatic email will be sent to the client."});case"close":return(0,yr.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"This lead will be closed."});case"callback":return(0,yr.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"Please call the client back."});default:return null}return null})()]}),c&&(0,yr.jsx)("div",{className:"mt-4 text-center",children:(0,yr.jsx)("p",{className:"text-sm text-gray-500",children:"Updating status..."})}),N&&(0,yr.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md mx-4",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yr.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Send No Answer Email?"}),(0,yr.jsx)("button",{onClick:()=>{k(!1),j(null)},className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-5 w-5"})})]}),(0,yr.jsxs)("p",{className:"text-sm text-gray-600 mb-6",children:['Do you want to send your "No Answer" template email to ',(0,yr.jsx)("strong",{children:null===n||void 0===n?void 0:n.name}),"?"]}),u&&(0,yr.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg",children:(0,yr.jsx)("p",{className:"text-sm text-red-700",children:u})}),(0,yr.jsxs)("div",{className:"flex space-x-3",children:[(0,yr.jsx)("button",{onClick:async()=>{await A(w),k(!1)},disabled:c,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Yes, Send Email"}),(0,yr.jsx)("button",{onClick:()=>{k(!1),j(null)},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})}),f&&(0,yr.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md mx-4",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yr.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Schedule Callback"}),(0,yr.jsx)("button",{onClick:()=>{g(!1),j(null),y(""),v("")},className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-5 w-5"})})]}),(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Callback Time (UK Time)"}),(0,yr.jsx)("input",{type:"time",value:x||T(),onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500",required:!0}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"You'll receive a notification at this time to call back"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note (Optional)"}),(0,yr.jsx)("textarea",{value:b,onChange:e=>v(e.target.value),placeholder:"e.g., back 5pm, discuss pricing, follow up on quote",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500",rows:"3"})]}),u&&(0,yr.jsx)("div",{className:"p-3 bg-red-100 border border-red-300 rounded-lg",children:(0,yr.jsx)("p",{className:"text-sm text-red-700",children:u})}),(0,yr.jsxs)("div",{className:"flex space-x-3",children:[(0,yr.jsxs)("button",{onClick:()=>{x?A(w,x,b):m("Please select a callback time")},disabled:c||!x,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[(0,yr.jsx)(ws,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Schedule Callback"})]}),(0,yr.jsx)("button",{onClick:()=>{g(!1),j(null),y(""),v("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})]})})]})};return m||k?(0,yr.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,yr.jsx)("p",{className:"text-gray-600",children:k?"Loading next lead...":"Loading lead details..."})]})}):p?(0,yr.jsxs)("div",{className:"text-center py-12",children:[(0,yr.jsx)("p",{className:"text-red-500 mb-4",children:p}),(0,yr.jsx)("button",{onClick:()=>{f(""),ze()},className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Retry"})]}):d?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsxs)("div",{className:"relative min-h-screen bg-gray-50",children:[ie&&void 0!==ie.saleAmount&&(0,yr.jsx)("div",{className:"w-full flex justify-center items-center py-4",children:(0,yr.jsxs)("div",{className:"bg-green-100 border border-green-300 rounded-lg px-6 py-3 shadow text-2xl font-bold text-green-800",children:["Amount Spent: \xa3",Number(ie.saleAmount).toFixed(2)]})}),(0,yr.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yr.jsx)("button",{onClick:()=>{var e;const t=(null===(e=l.state)||void 0===e?void 0:e.currentPage)||parseInt(sessionStorage.getItem("leadsPage")||"1",10);sessionStorage.setItem("leadsPage",t.toString()),i("/leads",{state:{statusFilter:C.statusFilter,searchTerm:C.searchTerm,currentPage:t}})},className:"p-2 rounded-md text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ls,{className:"h-5 w-5"})}),(0,yr.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Lead Details"}),v.length>0&&(0,yr.jsxs)("span",{className:"text-sm text-gray-500",children:[j+1," of ",v.length,(0,yr.jsxs)("span",{className:"ml-2 text-xs text-gray-400",children:["(filter: ",C.statusFilter,', search: "',C.searchTerm,'")']})]})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("button",{onClick:()=>{if(j>0&&v.length>0){var e;const t=v[j-1];console.log("\u2b05\ufe0f Navigating to previous lead:",t.name,"ID:",t.id),S(!0),u(null),i("/leads/".concat(t.id),{replace:!0,state:{statusFilter:C.statusFilter,searchTerm:C.searchTerm,dateFilter:C.dateFilter,customDateStart:C.customDateStart,customDateEnd:C.customDateEnd,assigned_at_start:C.assigned_at_start,assigned_at_end:C.assigned_at_end,currentPage:(null===(e=l.state)||void 0===e?void 0:e.currentPage)||1,filteredLeads:v}})}},disabled:!Ze()||k,className:"p-2 rounded-md transition-colors relative ".concat(Ze()&&!k?"text-gray-600 hover:text-gray-800 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"),title:"Previous Lead ".concat(Ze()?"(".concat(null===(e=v[j-1])||void 0===e?void 0:e.name,")"):"(none)"),children:k&&j>0?(0,yr.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-600"}):(0,yr.jsx)(ys,{className:"h-5 w-5"})}),(0,yr.jsx)("button",{onClick:()=>{if(j<v.length-1&&v.length>0){var e;const t=v[j+1];console.log("\u27a1\ufe0f Navigating to next lead:",t.name,"ID:",t.id),S(!0),u(null),i("/leads/".concat(t.id),{replace:!0,state:{statusFilter:C.statusFilter,searchTerm:C.searchTerm,dateFilter:C.dateFilter,customDateStart:C.customDateStart,customDateEnd:C.customDateEnd,assigned_at_start:C.assigned_at_start,assigned_at_end:C.assigned_at_end,currentPage:(null===(e=l.state)||void 0===e?void 0:e.currentPage)||1,filteredLeads:v}})}},disabled:!et()||k,className:"p-2 rounded-md transition-colors relative ".concat(et()&&!k?"text-gray-600 hover:text-gray-800 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"),title:"Next Lead ".concat(et()?"(".concat(null===(t=v[j+1])||void 0===t?void 0:t.name,")"):"(none)"),children:k&&j<v.length-1?(0,yr.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-600"}):(0,yr.jsx)(bs,{className:"h-5 w-5"})})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[!g&&(0,yr.jsxs)("button",{onClick:()=>(localStorage.setItem("bookingLead",JSON.stringify({id:d.id,name:d.name,phone:d.phone,email:d.email,postcode:d.postcode,notes:d.notes,image_url:d.image_url,currentStatus:d.status})),void i("/calendar")),className:"btn-secondary flex items-center space-x-2",children:[(0,yr.jsx)(hs,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"booked"===(null===(n=d.status)||void 0===n?void 0:n.toLowerCase())?"Reschedule":"Book Appointment"})]}),g?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("button",{onClick:()=>{x(!1),b(d)},className:"btn-secondary",children:"Cancel"}),(0,yr.jsxs)("button",{onClick:async()=>{try{const e=d.notes||"",t=y.notes||"",n=await xr.put("/api/leads/".concat(o),y),r=n.data.lead||n.data;u(r),b(r),x(!1),e!==t&&(await nt("NOTES_UPDATED",{oldNotes:e,newNotes:t}),localStorage.setItem("calendarRefreshTrigger","true"))}catch(p){console.error("Error updating lead:",p),alert("Failed to save changes. Please try again.")}},className:"btn-primary flex items-center space-x-2",children:[(0,yr.jsx)(no,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Save"})]})]}):(0,yr.jsxs)("button",{onClick:()=>x(!0),className:"btn-primary flex items-center space-x-2",children:[(0,yr.jsx)(Cs,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Edit"})]})]})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,yr.jsxs)("div",{className:"lg:col-span-3 space-y-6",children:[(0,yr.jsxs)("div",{className:"card",children:[(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Basic Information"}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,yr.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4",children:(0,yr.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,yr.jsx)("div",{className:"w-12 h-12 rounded-xl bg-blue-500 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(vo,{className:"h-6 w-6 text-white"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-blue-600 uppercase tracking-wide",children:"Full Name"}),g?(0,yr.jsx)("input",{type:"text",name:"name",value:y.name,onChange:Qe,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg font-bold text-gray-900"}):(0,yr.jsx)("p",{className:"text-lg font-bold text-gray-900 mt-1",children:d.name})]})]})}),(0,yr.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-4",children:(0,yr.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,yr.jsx)("div",{className:"w-12 h-12 rounded-xl bg-green-500 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(vo,{className:"h-6 w-6 text-white"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-green-600 uppercase tracking-wide",children:"Age"}),g?(0,yr.jsx)("input",{type:"number",name:"age",value:y.age||"",onChange:Qe,min:"1",max:"120",placeholder:"Enter age",className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500 text-lg font-bold text-gray-900"}):(0,yr.jsx)("p",{className:"text-lg font-bold text-gray-900 mt-1",children:d.age?"".concat(d.age," years old"):"N/A"})]})]})}),(0,yr.jsx)("div",{className:"bg-gradient-to-r from-indigo-50 to-blue-50 rounded-xl p-4",children:(0,yr.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,yr.jsx)("div",{className:"w-12 h-12 rounded-xl bg-indigo-500 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(vo,{className:"h-6 w-6 text-white"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-indigo-600 uppercase tracking-wide",children:"Gender"}),g?(0,yr.jsxs)("select",{name:"gender",value:y.gender||"",onChange:Qe,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-lg font-bold text-gray-900",children:[(0,yr.jsx)("option",{value:"",children:"Select gender"}),(0,yr.jsx)("option",{value:"Female",children:"Female"}),(0,yr.jsx)("option",{value:"Male",children:"Male"})]}):(0,yr.jsx)("p",{className:"text-lg font-bold text-gray-900 mt-1",children:d.gender||"N/A"})]})]})}),(0,yr.jsx)("div",{className:"bg-gradient-to-r from-amber-50 to-yellow-50 rounded-xl p-4",children:(0,yr.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,yr.jsx)("div",{className:"w-12 h-12 rounded-xl bg-amber-500 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(hs,{className:"h-6 w-6 text-white"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-amber-600 uppercase tracking-wide",children:"Entry Date"}),(0,yr.jsx)("p",{className:"text-lg font-bold text-gray-900 mt-1",children:d.entry_date?new Date(d.entry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]})]})})]})]}),(0,yr.jsxs)("div",{className:"card",children:[(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Contact Information"}),(0,yr.jsxs)("div",{className:"space-y-6",children:[(0,yr.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4",children:(0,yr.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,yr.jsx)("div",{className:"w-12 h-12 rounded-xl bg-purple-500 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(Js,{className:"h-6 w-6 text-white"})}),(0,yr.jsx)("div",{className:"flex-1",children:(0,yr.jsxs)("div",{className:"flex ".concat(d.parent_phone||g?"gap-6":""),children:[(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-purple-600 uppercase tracking-wide",children:"Phone Number"}),g?(0,yr.jsx)("input",{type:"tel",name:"phone",value:y.phone,onChange:Qe,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-lg font-bold text-gray-900"}):(0,yr.jsx)("p",{className:"text-lg font-bold text-gray-900 mt-1",children:d.phone}),!g&&(0,yr.jsx)("a",{href:"tel:".concat(d.phone),className:"text-sm text-purple-600 hover:text-purple-800 transition-colors",children:"Click to call \u2192"})]}),(d.parent_phone||g)&&(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-purple-600 uppercase tracking-wide",children:"Parent Phone"}),g?(0,yr.jsx)("input",{type:"tel",name:"parent_phone",value:y.parent_phone||"",onChange:Qe,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-lg font-bold text-gray-900",placeholder:"Optional"}):(0,yr.jsx)("p",{className:"text-lg font-bold text-gray-900 mt-1",children:d.parent_phone}),!g&&d.parent_phone&&(0,yr.jsx)("a",{href:"tel:".concat(d.parent_phone),className:"text-sm text-purple-600 hover:text-purple-800 transition-colors",children:"Click to call \u2192"})]})]})})]})}),(0,yr.jsx)("div",{className:"bg-gradient-to-r from-pink-50 to-rose-50 rounded-xl p-4",children:(0,yr.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,yr.jsx)("div",{className:"w-12 h-12 rounded-xl bg-pink-500 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(Vs,{className:"h-6 w-6 text-white"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-pink-600 uppercase tracking-wide",children:"Email Address"}),g?(0,yr.jsx)("input",{type:"email",name:"email",value:y.email||"",onChange:Qe,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-pink-500 focus:border-pink-500 text-lg font-bold text-gray-900"}):(0,yr.jsx)("p",{className:"text-lg font-bold text-gray-900 mt-1 break-all",children:d.email||"N/A"}),!g&&d.email&&(0,yr.jsx)("a",{href:"mailto:".concat(d.email),className:"text-sm text-pink-600 hover:text-pink-800 transition-colors",children:"Send email \u2192"})]})]})}),(0,yr.jsx)("div",{className:"bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl p-4",children:(0,yr.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,yr.jsx)("div",{className:"w-12 h-12 rounded-xl bg-orange-500 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(Ws,{className:"h-6 w-6 text-white"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-orange-600 uppercase tracking-wide",children:"Postcode"}),g?(0,yr.jsx)("input",{type:"text",name:"postcode",value:y.postcode,onChange:Qe,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-lg font-bold text-gray-900"}):(0,yr.jsx)("p",{className:"text-lg font-bold text-gray-900 mt-1",children:d.postcode}),!g&&(0,yr.jsx)("a",{href:"https://maps.google.com/maps?q=".concat(d.postcode),target:"_blank",rel:"noopener noreferrer",className:"text-sm text-orange-600 hover:text-orange-800 transition-colors",children:"View on map \u2192"})]})]})})]})]}),!g&&(0,yr.jsx)(ec,{leadId:d.id,lead:d,onStatusUpdate:(e,t)=>{var n,r;let a={};try{d.custom_fields&&(a="string"===typeof d.custom_fields?JSON.parse(d.custom_fields):d.custom_fields)}catch(FB){a={}}a.call_status=e,u(Ye(Ye({},d),{},{custom_fields:JSON.stringify(a),call_status:e})),null!==t&&void 0!==t&&null!==(n=t.workflowResult)&&void 0!==n&&n.emailSent?alert('Status updated to "'.concat(e,'". ').concat(t.workflowResult.emailMessage||"Automatic email sent to client.")):null!==t&&void 0!==t&&null!==(r=t.workflowResult)&&void 0!==r&&r.emailMessage&&!t.workflowResult.emailSent&&console.warn("Email workflow:",t.workflowResult.emailMessage)}}),(0,yr.jsxs)("div",{className:"card",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Notes"}),!g&&(0,yr.jsxs)("button",{onClick:()=>{b(e=>Ye(Ye({},e),{},{notes:(null===d||void 0===d?void 0:d.notes)||""})),x(!0)},className:"text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center space-x-1 hover:bg-blue-50 px-2 py-1 rounded transition-colors",children:[(0,yr.jsx)(Cs,{className:"h-3 w-3"}),(0,yr.jsx)("span",{children:"Edit Notes"})]})]}),g?(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)("textarea",{name:"notes",rows:"6",value:y.notes||"",onChange:Qe,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none break-words",placeholder:"Add detailed notes about this lead...",autoFocus:!0}),(0,yr.jsxs)("div",{className:"absolute bottom-2 right-2 text-xs text-gray-400",children:[(y.notes||"").length," characters"]})]}),(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsx)("div",{className:"text-xs text-gray-500",children:"All users can edit notes \u2022 Changes appear in booking history"}),(0,yr.jsxs)("div",{className:"flex space-x-2",children:[(0,yr.jsxs)("button",{onClick:async()=>{try{const e=d.notes||"",t=y.notes||"",n=await xr.patch("/api/leads/".concat(o,"/notes"),{notes:t,oldNotes:e}),r=n.data.lead||n.data;u(r),b(e=>Ye(Ye({},e),{},{notes:r.notes||""})),x(!1),localStorage.setItem("calendarRefreshTrigger","true")}catch(p){var e,t;console.error("Error updating notes:",p);const r=(null===(e=p.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to save notes. Please try again.";alert(r)}},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm font-medium flex items-center space-x-1",children:[(0,yr.jsx)(gs,{className:"h-3 w-3"}),(0,yr.jsx)("span",{children:"Save Notes"})]}),(0,yr.jsx)("button",{onClick:()=>{b(e=>Ye(Ye({},e),{},{notes:(null===d||void 0===d?void 0:d.notes)||""})),x(!1)},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 text-sm font-medium",children:"Cancel"})]})]})]}):(0,yr.jsx)("div",{children:d.notes?(0,yr.jsxs)("div",{children:[(0,yr.jsx)("div",{className:"max-h-96 overflow-y-auto",children:(0,yr.jsx)("p",{className:"text-gray-900 whitespace-pre-wrap leading-relaxed break-words",children:d.notes})}),(0,yr.jsx)("div",{className:"mt-2 text-xs text-gray-500",children:'Click "Edit Notes" to modify'})]}):(0,yr.jsxs)("div",{className:"text-center py-4",children:[(0,yr.jsx)("p",{className:"text-gray-500 italic",children:"No notes available"}),(0,yr.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:'Click "Edit Notes" to add notes'})]})})]}),!g&&(0,yr.jsxs)("div",{className:"card",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsxs)("button",{onClick:()=>ge(!fe),className:"flex items-center space-x-2 flex-1 text-left hover:bg-gray-50 p-2 -m-2 rounded-md transition-colors",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)(Ys,{className:"h-5 w-5 text-indigo-500"}),(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"\ud83d\udce8 Messages"}),xe.length>0&&(0,yr.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:[xe.length," messages"]})]}),fe?(0,yr.jsx)(vs,{className:"h-5 w-5 text-gray-400"}):(0,yr.jsx)(xs,{className:"h-5 w-5 text-gray-400"})]}),(0,yr.jsxs)("button",{onClick:()=>i("/bookers-templates"),className:"ml-3 px-3 py-2 text-sm bg-indigo-100 hover:bg-indigo-200 text-indigo-700 rounded-md flex items-center space-x-1 transition-colors border border-indigo-200",title:"Manage Bookers Templates - Create & edit templates for Lead Details",children:[(0,yr.jsx)(so,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Manage Templates"})]})]}),fe&&(0,yr.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,yr.jsx)("div",{className:"max-h-80 overflow-y-auto bg-gray-50 rounded-lg p-4 mb-4",children:be?(0,yr.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-indigo-600"}),(0,yr.jsx)("span",{className:"ml-2 text-gray-500",children:"Loading conversation..."})]}):0===xe.length?(0,yr.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,yr.jsx)(Ys,{className:"mx-auto h-8 w-8 mb-2 text-gray-300"}),(0,yr.jsx)("p",{children:"No conversation history"}),(0,yr.jsx)("p",{className:"text-sm mt-1",children:"Messages will appear here when sent or received"})]}):(0,yr.jsx)("div",{className:"space-y-3",children:xe.map((e,t)=>{var n,r,a,s,o,i,l,c,d,u,m;return(0,yr.jsx)("div",{className:"flex ".concat(["SMS_SENT","EMAIL_SENT"].includes(e.action)?"justify-end":"justify-start"),children:(0,yr.jsxs)("div",{className:"max-w-xs lg:max-w-md px-4 py-2 rounded-lg shadow-sm overflow-hidden ".concat(["SMS_SENT","EMAIL_SENT"].includes(e.action)?"bg-blue-500 text-white":"bg-white border text-gray-900"),children:[e.action.includes("EMAIL")&&(null===(n=e.details)||void 0===n?void 0:n.subject)&&(0,yr.jsx)("p",{className:"text-sm font-semibold mb-1 ".concat(["SMS_SENT","EMAIL_SENT"].includes(e.action)?"text-white":"text-gray-900"),children:e.details.subject}),e.action.includes("EMAIL")&&(null!==(r=e.details)&&void 0!==r&&r.email_body||null!==(a=e.details)&&void 0!==a&&a.html_content)?(0,yr.jsx)("div",{className:"max-h-64 overflow-y-auto ".concat(["SMS_SENT","EMAIL_SENT"].includes(e.action)?"email-sent":"email-received"),children:(0,yr.jsx)(Do,{htmlContent:(null===(s=e.details)||void 0===s?void 0:s.email_body)||(null===(o=e.details)||void 0===o?void 0:o.html_content),textContent:(null===(i=e.details)||void 0===i?void 0:i.body)||(null===(l=e.details)||void 0===l?void 0:l.message),attachments:(null===(c=e.details)||void 0===c?void 0:c.attachments)||[],embeddedImages:(null===(d=e.details)||void 0===d?void 0:d.embedded_images)||[]})}):(0,yr.jsx)("p",{className:"text-sm whitespace-pre-wrap break-words leading-relaxed",children:(null===(u=e.details)||void 0===u?void 0:u.body)||(null===(m=e.details)||void 0===m?void 0:m.message)||"No content available"}),(0,yr.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,yr.jsxs)("p",{className:"text-xs ".concat(["SMS_SENT","EMAIL_SENT"].includes(e.action)?"text-blue-100":"text-gray-500"),children:[(()=>{try{const t=new Date(e.timestamp);if(isNaN(t.getTime()))return"Unknown time";const n=new Date-t,r=n/36e5;if(r<1){const e=Math.floor(n/6e4);return e<=0?"Just now":"".concat(e,"m ago")}return r<24?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}):t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})}catch(p){return"Unknown time"}})()," \u2022 ",e.action.includes("SMS")?"SMS":"Email"]}),["SMS_SENT","EMAIL_SENT"].includes(e.action)&&(0,yr.jsx)(gs,{className:"h-3 w-3 text-blue-100"})]})]})},"".concat(e.timestamp,"-").concat(t))})})}),(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Reply via:"}),(0,yr.jsxs)("div",{className:"flex space-x-2",children:[(0,yr.jsx)("button",{onClick:()=>ke("sms"),className:"px-3 py-1 rounded-md text-sm font-medium transition-colors ".concat("sms"===Ne?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"SMS"}),(0,yr.jsx)("button",{onClick:()=>ke("email"),className:"px-3 py-1 rounded-md text-sm font-medium transition-colors ".concat("email"===Ne?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),disabled:!d.email,children:"Email"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Choose Template (Optional)"}),(0,yr.jsxs)("select",{value:"sms"===Ne?E:O,onChange:e=>{const t=e.target.value;if("sms"===Ne){if(P(t),t){const e=T.find(e=>e._id===t);if(e){const t=e.smsBody||e.message||"",n=tt(t);je(n),setTimeout(()=>{const e=document.querySelector('textarea[placeholder*="reply"]');Se(e)},0)}}}else if(A(t),t){const e=M.find(e=>e._id===t);if(e){const t=e.subject||"",n=e.emailBody||e.message||"",r=tt(t)+"\n\n"+tt(n);je(r),setTimeout(()=>{const e=document.querySelector('textarea[placeholder*="reply"]');Se(e)},0)}}},className:"w-full px-4 py-3 text-base border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",style:{minHeight:"48px"},children:[(0,yr.jsx)("option",{value:"",children:"Select a template..."}),"sms"===Ne?Object.entries(Le(T)).map(e=>{let[t,n]=e;return n.length>0&&(0,yr.jsx)("optgroup",{label:t,children:n.map(e=>(0,yr.jsx)("option",{value:e._id,children:e.name},e._id))},t)}):Object.entries(Le(M)).map(e=>{let[t,n]=e;return n.length>0&&(0,yr.jsx)("optgroup",{label:t,children:n.map(e=>(0,yr.jsx)("option",{value:e._id,children:e.name},e._id))},t)})]})]}),"email"===Ne&&(()=>{const e=M.find(e=>"invitation_email"===e.type);return e&&(0,yr.jsx)("div",{className:"flex justify-end mb-2",children:(0,yr.jsxs)("button",{type:"button",onClick:()=>{const t=e.subject||"",n=e.emailBody||e.message||"",r=tt(t)+"\n\n"+tt(n);je(r),A(e._id),setTimeout(()=>{const e=document.querySelector('textarea[placeholder*="reply"]');Se(e)},0)},className:"px-4 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg hover:from-purple-700 hover:to-indigo-700 transition-all flex items-center gap-2 shadow-md text-sm",children:[(0,yr.jsx)(Vs,{className:"h-4 w-4"}),"Quick: Send Invitation Email"]})})})(),(0,yr.jsxs)("div",{className:"flex space-x-2",children:[(0,yr.jsx)("textarea",{value:we,onChange:e=>{je(e.target.value),Se(e.target)},placeholder:"Type your ".concat("sms"===Ne?"SMS":"email"," reply..."),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none overflow-hidden",style:{minHeight:"60px"},maxLength:"sms"===Ne?160:5e3}),(0,yr.jsxs)("button",{onClick:async()=>{if(we.trim())try{if("sms"===Ne){if(!d.phone)return void alert("This lead does not have a phone number.");const e=await xr.post("/api/leads/".concat(d.id,"/send-sms"),{message:we,type:"custom"});e.data.success?(alert("SMS sent successfully to ".concat(d.phone,"!")),await nt("SMS_SENT",{recipient:d.phone,message:we,template:"Quick reply"}),je(""),setTimeout(()=>Ge(),1e3)):alert("Failed to send SMS: ".concat(e.data.message))}else{if(!d.email)return void alert("This lead does not have an email address.");let e="Reply",t=we;if(we.includes("\n\n")){const n=we.split("\n\n");n[0].length<100&&(e=n[0],t=n.slice(1).join("\n\n"))}const n=await xr.post("/api/leads/".concat(d.id,"/send-email"),{subject:e,body:t});n.data.success?(alert("Email sent successfully to ".concat(d.email,"!")),je(""),setTimeout(()=>Ge(),1e3)):alert("Failed to send email: ".concat(n.data.message))}}catch(p){var e,t;console.error("Error sending reply:",p),alert("Error sending reply: ".concat((null===(e=p.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||p.message))}else alert("Please enter a reply message.")},disabled:!we.trim(),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[(0,yr.jsx)(ao,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Send"})]})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500",children:"sms"===Ne?"Send to: ".concat(d.phone," (").concat(we.length,"/160 characters)"):"Send to: ".concat(d.email||"No email address")})]})]})]}),ue.length>0&&(0,yr.jsxs)("div",{className:"card border-l-4 border-purple-500",children:[(0,yr.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,yr.jsxs)("h3",{className:"text-lg font-medium text-gray-900 flex items-center space-x-2",children:[(0,yr.jsx)(ws,{className:"h-5 w-5 text-purple-600"}),(0,yr.jsx)("span",{children:"\u23f0 Upcoming Callbacks"})]})}),(0,yr.jsx)("div",{className:"space-y-3",children:ue.map(e=>{const t=new Date(e.callback_time),n=new Date,r=t<n,a=t.toDateString()===n.toDateString();return(0,yr.jsx)("div",{className:"p-4 rounded-lg border-2 ".concat(r?"bg-red-50 border-red-200":a?"bg-yellow-50 border-yellow-200":"bg-purple-50 border-purple-200"),children:(0,yr.jsx)("div",{className:"flex items-start justify-between",children:(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,yr.jsx)(ws,{className:"h-4 w-4 ".concat(r?"text-red-600":a?"text-yellow-600":"text-purple-600")}),(0,yr.jsx)("span",{className:"font-semibold text-gray-900",children:t.toLocaleString("en-GB",{weekday:"short",day:"numeric",month:"short",hour:"2-digit",minute:"2-digit",timeZone:"Europe/London"})}),r&&(0,yr.jsx)("span",{className:"text-xs bg-red-100 text-red-700 px-2 py-1 rounded",children:"Overdue"}),a&&!r&&(0,yr.jsx)("span",{className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-1 rounded",children:"Today"})]}),e.callback_note&&(0,yr.jsxs)("p",{className:"text-sm text-gray-700 mb-2",children:["\ud83d\udcdd ",e.callback_note]}),(0,yr.jsxs)("div",{className:"text-xs text-gray-500",children:["Status: ",(0,yr.jsx)("span",{className:"font-medium capitalize",children:e.status})]})]})})},e.id)})})]}),(0,yr.jsxs)("div",{className:"card",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"\ud83d\udccb Booking History"}),he&&(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})]}),ce.length>0||ue.length>0?(0,yr.jsx)("div",{className:"space-y-4",children:ue.filter(e=>"pending"===e.status).map(e=>{const t=new Date(e.callback_time);return{action:"CALLBACK_SCHEDULED",performedByName:"System",timestamp:e.created_at,details:{callbackTime:t.toLocaleString("en-GB",{weekday:"long",day:"numeric",month:"long",hour:"2-digit",minute:"2-digit",timeZone:"Europe/London"}),note:e.callback_note||"No note",status:e.status},isCallback:!0}}).concat(ce.filter(e=>e.action&&""!==e.action.trim()&&(e.performedByName||e.performed_by_name||e.performedBy||e.performed_by||e.timestamp))).sort((e,t)=>{const n=new Date(e.timestamp||0).getTime();return new Date(t.timestamp||0).getTime()-n}).map((e,t)=>{var n;return(0,yr.jsx)("div",{className:"border-l-4 pl-4 py-3 rounded-r-lg ".concat(e.isCallback?"border-purple-500 bg-purple-50":"border-blue-500 bg-gray-50"),children:(0,yr.jsxs)("div",{className:"flex items-start justify-between",children:[(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[e.isCallback&&(0,yr.jsx)(ws,{className:"h-4 w-4 text-purple-600"}),(0,yr.jsx)("span",{className:"font-semibold text-gray-900",children:e.isCallback?"\ud83d\udcde Callback Scheduled":e.action}),(0,yr.jsx)("span",{className:"text-sm text-gray-500",children:e.isCallback?"":((t,n,r,a,s,o,i,l)=>{const c=e.performedByName||e.performed_by_name||e.performedBy||e.performed_by||(null===(t=e.details)||void 0===t?void 0:t.performedByName)||(null===(n=e.details)||void 0===n?void 0:n.performed_by_name)||(null===(r=e.details)||void 0===r?void 0:r.sent_by_name)||(null===(a=e.details)||void 0===a?void 0:a.sentByName)||(null===(s=e.leadSnapshot)||void 0===s?void 0:s.performedByName)||(null===(o=e.leadSnapshot)||void 0===o?void 0:o.performed_by_name)||(null===(i=e.details)||void 0===i?void 0:i.updatedBy)&&(null===(l=e.action)||void 0===l?void 0:l.includes("STATUS"));return c?"by ".concat(c):""})()})]}),e.details&&Object.keys(e.details).length>0&&(0,yr.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:e.isCallback?(0,yr.jsxs)("div",{className:"bg-purple-100 p-3 rounded-lg",children:[(0,yr.jsxs)("div",{className:"font-medium text-purple-800 mb-1",children:["Scheduled for: ",e.details.callbackTime]}),(0,yr.jsxs)("div",{className:"text-sm text-purple-700",children:["Note: ",e.details.note]}),(0,yr.jsxs)("div",{className:"text-xs text-purple-600 mt-1",children:["Status: ",e.details.status]})]}):"NOTES_UPDATED"===e.action?(0,yr.jsx)("div",{className:"space-y-2",children:(0,yr.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,yr.jsxs)("div",{className:"font-medium text-blue-800 mb-1 flex items-center justify-between",children:[(0,yr.jsxs)("span",{children:["Notes ","added"===e.details.changeType?"Added":"Modified"]}),(0,yr.jsxs)("span",{className:"text-xs font-normal text-blue-600",children:["by ",e.details.updatedBy||e.performedByName||e.performed_by_name||e.performedBy||e.performed_by||"Unknown"]})]}),e.details.oldNotes&&(0,yr.jsxs)("div",{className:"text-xs text-gray-600 mb-1",children:[(0,yr.jsx)("span",{className:"font-medium",children:"Previous:"})," ",e.details.oldNotes]}),(0,yr.jsxs)("div",{className:"text-sm text-gray-800",children:[(0,yr.jsx)("span",{className:"font-medium",children:"New:"})," ",e.details.newNotes]}),(0,yr.jsxs)("div",{className:"text-xs text-gray-500 mt-1 flex items-center justify-between",children:[(0,yr.jsxs)("span",{children:[e.details.characterCount," characters"]}),e.timestamp&&(0,yr.jsx)("span",{children:new Date(e.timestamp).toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})}):Object.entries(e.details).map(e=>{let[t,n]=e;return(0,yr.jsxs)("div",{className:"mb-1",children:[(0,yr.jsxs)("span",{className:"font-medium",children:[t,":"]})," ","object"===typeof n&&null!==n?JSON.stringify(n):n]},t)})}),e.leadSnapshot&&Object.keys(e.leadSnapshot).length>0&&(0,yr.jsxs)("div",{className:"text-xs text-gray-500 bg-white p-2 rounded border",children:[(0,yr.jsx)("div",{className:"font-medium mb-1",children:"Lead State:"}),Object.entries(e.leadSnapshot).map(e=>{let[t,n]=e;return(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("span",{className:"font-medium",children:[t,":"]})," ","object"===typeof n&&null!==n?JSON.stringify(n):n||"N/A"]},t)})]})]}),(0,yr.jsx)("div",{className:"text-xs text-gray-400 ml-4",children:(()=>{try{if(!e.timestamp)return"Unknown time";let t;if(t="string"===typeof e.timestamp?new Date(e.timestamp):"number"===typeof e.timestamp?new Date(e.timestamp>1e12?e.timestamp:1e3*e.timestamp):new Date(e.timestamp),isNaN(t.getTime()))return"Invalid date";const n=new Date-t,r=n/36e5,a=n/864e5;if(r<1){const e=Math.floor(n/6e4);return e<=0?"Just now":"".concat(e," min ago")}if(r<24)return t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0});if(a<7){const e=Math.floor(a);return"".concat(e," day").concat(1===e?"":"s"," ago")}return t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})}catch(p){return console.error("Error formatting timestamp:",p,"Timestamp:",e.timestamp),"Unknown time"}})()})]})},e.isCallback?"callback-".concat(null===(n=e.details)||void 0===n?void 0:n.callbackTime):t)})}):(0,yr.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,yr.jsx)("div",{className:"text-4xl mb-2",children:"\ud83d\udccb"}),(0,yr.jsx)("p",{children:"No booking history available"}),(0,yr.jsx)("p",{className:"text-sm",children:"History will appear here when actions are taken on this lead"})]})]})]}),(0,yr.jsxs)("div",{className:"space-y-6",children:[(0,yr.jsxs)("div",{className:"card",children:[(0,yr.jsxs)("div",{className:"mb-4",children:[(0,yr.jsx)("div",{className:"mx-auto w-full max-w-xs aspect-square bg-gray-300 flex items-center justify-center rounded-lg overflow-hidden shadow-lg hover:shadow-xl transition-shadow duration-300 relative",children:d.image_url?(0,yr.jsxs)(yr.Fragment,{children:[d.image_url.toLowerCase().includes(".heic")||d.image_url.toLowerCase().includes(".heif")?(0,yr.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gradient-to-br from-gray-200 to-gray-300 cursor-pointer",onClick:()=>R(!0),title:"HEIC format - click to try viewing",children:[(0,yr.jsx)("span",{className:"text-4xl mb-2",children:"\ud83d\udcf7"}),(0,yr.jsx)("span",{className:"text-xs text-gray-500",children:"HEIC Format"})]}):d.image_url.toLowerCase().includes(".pdf")?(0,yr.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gradient-to-br from-gray-200 to-gray-300 cursor-pointer",onClick:()=>window.open(d.image_url,"_blank"),title:"PDF file - click to open",children:[(0,yr.jsx)("span",{className:"text-4xl mb-2",children:"\ud83d\udcc4"}),(0,yr.jsx)("span",{className:"text-xs text-gray-500",children:"PDF File"})]}):d.image_url.toLowerCase().includes(".mp4")||d.image_url.toLowerCase().includes(".webm")||d.image_url.toLowerCase().includes(".mov")?(0,yr.jsx)("video",{src:d.image_url,className:"w-full h-full object-cover cursor-pointer",muted:!0,loop:!0,playsInline:!0,autoPlay:!0,preload:"auto",onClick:()=>R(!0)}):(0,yr.jsx)(Kl,{src:d.image_url,alt:d.name,className:"w-full h-full object-cover cursor-pointer hover:scale-105 transition-transform duration-300",lazy:!1,enableFadeIn:!0,showBlurPlaceholder:!0,onClick:()=>R(!0)}),(d.image_url.toLowerCase().includes(".gif")||d.image_url.toLowerCase().includes(".mp4")||d.image_url.toLowerCase().includes(".webm"))&&(0,yr.jsx)("span",{className:"absolute top-2 right-2 bg-black bg-opacity-60 text-white text-xs px-2 py-1 rounded uppercase font-medium",children:d.image_url.toLowerCase().includes(".gif")?"GIF":"VIDEO"})]}):(0,yr.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-200 to-gray-300",children:(0,yr.jsx)("span",{className:"text-6xl font-medium text-gray-600",children:d.name.charAt(0).toUpperCase()})})}),d.image_url&&(0,yr.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Click ",d.image_url.toLowerCase().includes(".mp4")||d.image_url.toLowerCase().includes(".webm")?"video":"photo"," to view full screen"]})]}),(0,yr.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:d.name}),(0,yr.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[d.age&&(0,yr.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,yr.jsx)(vo,{className:"h-4 w-4"}),(0,yr.jsxs)("span",{children:[d.age," years old"]})]}),d.gender&&(0,yr.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,yr.jsx)(vo,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:d.gender})]}),(0,yr.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,yr.jsx)(Js,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:d.phone})]}),d.email&&(0,yr.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,yr.jsx)(Vs,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:d.email})]})]}),(0,yr.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Lead Information"}),(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{className:"text-sm text-gray-600",children:"Status:"}),(0,yr.jsx)("span",{className:(e=>{if(!e)return"status-badge status-new";switch(e.toLowerCase()){case"new":default:return"status-badge status-new";case"assigned":return"status-badge status-assigned";case"contacted":return"status-badge status-contacted";case"booked":return"status-badge status-booked";case"confirmed":return"status-badge status-confirmed";case"attended":return"status-badge status-attended";case"cancelled":return"status-badge status-cancelled";case"no answer":case"noanswer":return"status-badge status-no-answer";case"not interested":case"notinterested":return"status-badge status-not-interested";case"sale":case"sales/converted - purchased":return"status-badge status-sale";case"rejected":return"status-badge status-rejected";case"call back":case"callback":return"status-badge status-call-back";case"left message":case"leftmessage":return"status-badge status-left-message";case"not qualified":case"notqualified":return"status-badge status-not-qualified";case"reschedule":return"status-badge status-reschedule";case"no show":case"noshow":return"status-badge status-no-show";case"wrong number":case"wrongnumber":return"status-badge status-wrong-number"}})(d.status),children:d.status})]}),(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{className:"text-sm text-gray-600",children:"Assigned to:"}),(0,yr.jsx)("span",{className:"text-sm font-medium text-gray-900",children:(null===(r=d.booker)||void 0===r?void 0:r.name)||"N/A"})]}),(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{className:"text-sm text-gray-600",children:"Date Added:"}),(0,yr.jsx)("span",{className:"text-sm font-medium text-gray-900",children:(e=>{if(!e)return"Not set";const t=new Date(e);return isNaN(t.getTime())?"Invalid date":t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})(d.created_at)})]}),(()=>{const e=d.custom_fields?"string"===typeof d.custom_fields?JSON.parse(d.custom_fields):d.custom_fields:null;return null!==e&&void 0!==e&&e.lead_code?(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsx)("span",{className:"text-sm text-gray-600",children:"Lead Code:"}),(0,yr.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold bg-indigo-100 text-indigo-800",children:e.lead_code})]}):null})(),d.lead_source&&(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsx)("span",{className:"text-sm text-gray-600",children:"Lead Source:"}),(0,yr.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold bg-teal-100 text-teal-800",children:d.lead_source})]})]})]})]}),!g&&"admin"===(null===c||void 0===c?void 0:c.role)&&(0,yr.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,yr.jsxs)("button",{onClick:()=>{ee(!1),W(!0)},className:"w-full flex items-center justify-center px-4 py-2.5 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg hover:from-purple-700 hover:to-indigo-700 transition-all shadow-md",children:[(0,yr.jsx)(Pc,{className:"w-4 h-4 mr-2"}),(0,yr.jsx)("span",{children:"View Gallery"}),U.length>0&&(0,yr.jsx)("span",{className:"ml-2 bg-white/20 px-2 py-0.5 rounded-full text-xs",children:U.length})]}),(0,yr.jsxs)("button",{onClick:()=>B(!0),className:"w-full flex items-center justify-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all text-sm",children:[(0,yr.jsx)(dc,{className:"w-4 h-4 mr-2"}),(0,yr.jsx)("span",{children:"Quick View Images"})]})]}),!g&&"Rejected"!==d.status&&(0,yr.jsx)("button",{className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",onClick:()=>_e(!0),children:"Reject Lead"}),!g&&"booker"===(null===c||void 0===c?void 0:c.role)&&(0,yr.jsx)(rt,{leadId:d.id,lead:d,onStatusUpdate:(e,t)=>{let n={};try{d.custom_fields&&(n="string"===typeof d.custom_fields?JSON.parse(d.custom_fields):d.custom_fields)}catch(FB){n={}}n.call_status=e;let r=d.status;("Wrong number"===e||["Not interested","Not Qualified"].includes(e))&&(r="Rejected"),u(Ye(Ye({},d),{},{custom_fields:JSON.stringify(n),call_status:e,status:r})),ze()}}),!g&&d.phone&&"Booked"===d.status&&(0,yr.jsx)("button",{className:"mt-4 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",onClick:async()=>{if(d.dateBooked)try{const e=await xr.post("/api/leads/".concat(d.id,"/send-booking-confirmation"),{appointmentDate:d.dateBooked});e.data.success?alert("Booking confirmation SMS sent successfully to ".concat(d.phone,"!")):alert("Failed to send booking confirmation: ".concat(e.data.message))}catch(p){var e,t;console.error("Booking confirmation error:",p),alert("Error sending booking confirmation: ".concat((null===(e=p.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||p.message))}else alert("This lead does not have a booked date.")},children:"Send Booking Confirmation SMS"})]})]})]})]}),(0,yr.jsx)(tc,{isOpen:L,onClose:()=>R(!1),imageUrl:null!==d&&void 0!==d&&d.image_url?zl(d.image_url,"original"):null,leadName:null===d||void 0===d?void 0:d.name}),Ce&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-96",children:[(0,yr.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Reject Lead"}),(0,yr.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["This lead will be rejected as ",(0,yr.jsx)("span",{className:"font-semibold",children:"Duplicated"}),"."]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,yr.jsx)("button",{className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",onClick:()=>_e(!1),children:"Cancel"}),(0,yr.jsx)("button",{className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:Oe,onClick:async()=>{Ae(!0);try{await xr.patch("/api/leads/".concat(d.id,"/reject"),{reason:Ee}),u(Ye(Ye({},d),{},{status:"Rejected",reject_reason:Ee})),_e(!1)}catch(BB){alert("Failed to reject lead.")}Ae(!1)},children:"Confirm Reject"})]})]})}),(0,yr.jsx)(Ec,{isOpen:V,onClose:()=>W(!1),photos:U,leadId:null===d||void 0===d?void 0:d.id,leadName:(null===d||void 0===d?void 0:d.name)||"Client",initialSelectedIds:q,imageLimit:null!==(a=null===X||void 0===X?void 0:X.imageCount)&&void 0!==a?a:null===X||void 0===X?void 0:X.image_count,selectionMode:Z,onProceedToPackage:(e,t)=>{H(e),G(t),W(!1),ee(!1)}}),(0,yr.jsx)(yc,{isOpen:F,onClose:()=>B(!1),leadId:null===d||void 0===d?void 0:d.id,leadName:null===d||void 0===d?void 0:d.name,onSelectionComplete:(e,t)=>{z(e),H(t),G(e),console.log("Selected photos:",t)}})]}):(0,yr.jsxs)("div",{className:"text-center py-12",children:[(0,yr.jsx)("p",{className:"text-gray-500",children:"Lead not found"}),(0,yr.jsx)("button",{onClick:()=>{var e;return i("/leads",{state:{statusFilter:C.statusFilter,searchTerm:C.searchTerm,currentPage:(null===(e=l.state)||void 0===e?void 0:e.currentPage)||1}})},className:"mt-4 btn-primary",children:"Back to Leads"})]})},Ac=()=>{const{user:e}=Nr(),[t,n]=(0,s.useState)([]),[r,a]=(0,s.useState)(!0),[o,i]=(0,s.useState)(""),[l,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(!1),[m,h]=(0,s.useState)(!1),[p,f]=(0,s.useState)({name:"",email:"",password:"",role:"booker",assigned_email_account_id:""}),[g,x]=(0,s.useState)({}),[y,b]=(0,s.useState)(!1),[v,w]=(0,s.useState)(null),[j,N]=(0,s.useState)(!1),[k,S]=(0,s.useState)(!1),[C,_]=(0,s.useState)(null),[E,P]=(0,s.useState)(!1);(0,s.useEffect)(()=>{"admin"===(null===e||void 0===e?void 0:e.role)&&(A(),O())},[e]);const O=async()=>{try{const e=await xr.get("/api/email-accounts/dropdown");c(e.data)}catch(e){console.error("Error fetching email accounts:",e)}},A=async()=>{try{const e=await xr.get("/api/users");n(e.data)}catch(e){console.error("Error fetching users:",e),n([{id:"1",name:"Alice Smith",email:"alice.smith@studio.com",role:"booker",leadsAssigned:3,bookingsMade:4,showUps:2,isActive:!0,createdAt:"2024-01-15T00:00:00.000Z"},{id:"2",name:"John Doe",email:"john.doe@studio.com",role:"admin",leadsAssigned:2,bookingsMade:2,showUps:2,isActive:!0,createdAt:"2024-02-01T00:00:00.000Z"},{id:"3",name:"Mike Jones",email:"mike.jones@studio.com",role:"booker",leadsAssigned:3,bookingsMade:3,showUps:3,isActive:!0,createdAt:"2024-01-20T00:00:00.000Z"},{id:"4",name:"Ethan Brown",email:"ethan.brown@studio.com",role:"booker",leadsAssigned:2,bookingsMade:4,showUps:2,isActive:!0,createdAt:"2024-03-01T00:00:00.000Z"}])}a(!1)},T=e=>{const{name:t,value:n}=e.target;f(e=>Ye(Ye({},e),{},{[t]:n})),g[t]&&x(e=>Ye(Ye({},e),{},{[t]:""}))},D=()=>{u(!1),f({name:"",email:"",password:"",role:"booker",assigned_email_account_id:""}),x({})},M=t.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())||e.email.toLowerCase().includes(o.toLowerCase()));return"admin"!==(null===e||void 0===e?void 0:e.role)?(0,yr.jsx)("div",{className:"text-center py-12",children:(0,yr.jsx)("p",{className:"text-gray-500",children:"Access denied. Admin privileges required."})}):r?(0,yr.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yr.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):(0,yr.jsxs)("div",{className:"space-y-6",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Users"}),(0,yr.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Manage team members and their permissions"})]}),(0,yr.jsxs)("button",{onClick:()=>u(!0),className:"btn-primary flex items-center space-x-2",children:[(0,yr.jsx)(eo,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Add User"})]})]}),(0,yr.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,yr.jsxs)("div",{className:"relative flex-1",children:[(0,yr.jsx)(ro,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),(0,yr.jsx)("input",{type:"text",placeholder:"Search users...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md w-full focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:o,onChange:e=>i(e.target.value)})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)(As,{className:"h-5 w-5 text-gray-400"}),(0,yr.jsxs)("select",{className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,yr.jsx)("option",{value:"all",children:"All Roles"}),(0,yr.jsx)("option",{value:"photographer",children:"Photographer"}),(0,yr.jsx)("option",{value:"admin",children:"Admin"}),(0,yr.jsx)("option",{value:"sales",children:"Sales"}),(0,yr.jsx)("option",{value:"viewer",children:"Viewer"})]})]})]}),(0,yr.jsxs)("div",{className:"card",children:[(0,yr.jsx)("div",{className:"overflow-x-auto",children:(0,yr.jsxs)("table",{className:"min-w-full",children:[(0,yr.jsx)("thead",{children:(0,yr.jsxs)("tr",{className:"table-header",children:[(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Leads Assigned"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bookings Made"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Show Ups"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,yr.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map(e=>{return(0,yr.jsxs)("tr",{className:"table-row",children:[(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center",children:(0,yr.jsx)("span",{className:"text-sm font-medium text-white",children:e.name.charAt(0).toUpperCase()})}),(0,yr.jsxs)("div",{className:"ml-3",children:[(0,yr.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,yr.jsxs)("div",{className:"text-sm text-gray-500",children:["Joined ",(n=e.createdAt,new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))]})]})]})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("div",{className:"text-sm text-gray-900",children:e.email})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("span",{className:(t=e.role,"admin"===t?"status-badge bg-purple-100 text-purple-800":"viewer"===t?"status-badge bg-green-100 text-green-800":"status-badge bg-blue-100 text-blue-800"),children:e.role})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("div",{className:"text-sm text-gray-900",children:e.leadsAssigned})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("div",{className:"text-sm text-gray-900",children:e.bookingsMade})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("div",{className:"text-sm text-gray-900",children:e.showUps})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("button",{onClick:()=>(e=>{w({id:e.id,name:e.name,email:e.email,role:e.role,password:"",assigned_email_account_id:e.assigned_email_account_id||""}),b(!0)})(e),className:"text-blue-600 hover:text-blue-900",children:(0,yr.jsx)(Cs,{className:"h-4 w-4"})}),(0,yr.jsx)("button",{onClick:()=>{return t=e.id,_(t),void S(!0);var t},className:"text-red-600 hover:text-red-900",children:(0,yr.jsx)(ho,{className:"h-4 w-4"})})]})})]},e.id);var t,n})})]})}),0===M.length&&(0,yr.jsx)("div",{className:"text-center py-12",children:(0,yr.jsx)("p",{className:"text-gray-500",children:"No users found"})})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,yr.jsx)("div",{className:"card",children:(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("div",{className:"text-2xl font-semibold text-gray-900",children:t.length}),(0,yr.jsx)("div",{className:"text-sm text-gray-500",children:"Total Users"})]})}),(0,yr.jsx)("div",{className:"card",children:(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("div",{className:"text-2xl font-semibold text-gray-900",children:t.filter(e=>"admin"===e.role).length}),(0,yr.jsx)("div",{className:"text-sm text-gray-500",children:"Admins"})]})}),(0,yr.jsx)("div",{className:"card",children:(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("div",{className:"text-2xl font-semibold text-gray-900",children:t.filter(e=>"booker"===e.role).length}),(0,yr.jsx)("div",{className:"text-sm text-gray-500",children:"Bookers"})]})}),(0,yr.jsx)("div",{className:"card",children:(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("div",{className:"text-2xl font-semibold text-gray-900",children:t.filter(e=>"viewer"===e.role).length}),(0,yr.jsx)("div",{className:"text-sm text-gray-500",children:"Viewers"})]})}),(0,yr.jsx)("div",{className:"card",children:(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("div",{className:"text-2xl font-semibold text-gray-900",children:t.reduce((e,t)=>e+(t.leadsAssigned||0),0)}),(0,yr.jsx)("div",{className:"text-sm text-gray-500",children:"Total Leads"})]})}),(0,yr.jsx)("div",{className:"card",children:(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("div",{className:"text-2xl font-semibold text-gray-900",children:t.filter(e=>"viewer"===e.role).length}),(0,yr.jsx)("div",{className:"text-sm text-gray-500",children:"Sales Viewers"})]})})]}),d&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yr.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Create New User"}),(0,yr.jsx)("button",{onClick:D,className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]}),(0,yr.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=(()=>{const e={};return p.name.trim()||(e.name="Name is required"),p.email.trim()?/\S+@\S+\.\S+/.test(p.email)||(e.email="Email is invalid"):e.email="Email is required",p.password?p.password.length<6&&(e.password="Password must be at least 6 characters"):e.password="Password is required",e})();if(Object.keys(t).length>0)x(t);else{h(!0),x({});try{const e=await xr.post("/api/users",p);n(t=>[e.data.user,...t]),f({name:"",email:"",password:"",role:"booker",assigned_email_account_id:""}),u(!1),alert("User created successfully!")}catch(s){var r,a;console.error("Error creating user:",s);const e=(null===(r=s.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||"Failed to create user";x({submit:e})}h(!1)}},className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(vo,{className:"inline h-4 w-4 mr-2"}),"Full Name"]}),(0,yr.jsx)("input",{type:"text",name:"name",value:p.name,onChange:T,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ".concat(g.name?"border-red-500":"border-gray-300"),placeholder:"Enter full name"}),g.name&&(0,yr.jsx)("p",{className:"text-red-500 text-xs mt-1",children:g.name})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(Vs,{className:"inline h-4 w-4 mr-2"}),"Email Address"]}),(0,yr.jsx)("input",{type:"email",name:"email",value:p.email,onChange:T,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ".concat(g.email?"border-red-500":"border-gray-300"),placeholder:"Enter email address"}),g.email&&(0,yr.jsx)("p",{className:"text-red-500 text-xs mt-1",children:g.email})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(Us,{className:"inline h-4 w-4 mr-2"}),"Password"]}),(0,yr.jsx)("input",{type:"password",name:"password",value:p.password,onChange:T,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ".concat(g.password?"border-red-500":"border-gray-300"),placeholder:"Enter password (minimum 6 characters)"}),g.password&&(0,yr.jsx)("p",{className:"text-red-500 text-xs mt-1",children:g.password})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(oo,{className:"inline h-4 w-4 mr-2"}),"Role"]}),(0,yr.jsxs)("select",{name:"role",value:p.role,onChange:T,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,yr.jsx)("option",{value:"booker",children:"Booker"}),(0,yr.jsx)("option",{value:"viewer",children:"Viewer"}),(0,yr.jsx)("option",{value:"photographer",children:"Photographer"}),(0,yr.jsx)("option",{value:"admin",children:"Administrator"})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"admin"===p.role?"Full access to all features and user management":"viewer"===p.role?"Read-only access to view data only":"photographer"===p.role?"Access to upload and manage photos for leads":"Access to leads management and bookings"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(Vs,{className:"inline h-4 w-4 mr-2"}),"Email Account"]}),(0,yr.jsxs)("select",{name:"assigned_email_account_id",value:p.assigned_email_account_id,onChange:T,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,yr.jsx)("option",{value:"",children:"System Default"}),l.map(e=>(0,yr.jsxs)("option",{value:e.id,children:[e.name," (",e.email,")",e.is_default?" - Default":""]},e.id))]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Email account used for sending messages from this user"})]}),g.submit&&(0,yr.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,yr.jsx)("p",{className:"text-red-600 text-sm",children:g.submit})}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,yr.jsx)("button",{type:"button",onClick:D,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,yr.jsx)("button",{type:"submit",disabled:m,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:m?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,yr.jsx)("span",{children:"Creating..."})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(eo,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Create User"})]})})]})]})]})}),y&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yr.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit User"}),(0,yr.jsx)("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]}),(0,yr.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),v.password&&v.password.length<6)alert("Password must be at least 6 characters long");else{N(!0);try{const e=Ye({},v);e.password||delete e.password;const t=await xr.put("/api/users/".concat(v.id),e);n(e=>e.map(e=>e.id===v.id?Ye(Ye({},e),t.data.user):e)),b(!1),w(null),alert(e.password?"User updated successfully! Password has been changed.":"User updated successfully!")}catch(a){var t,r;console.error("Error updating user:",a),alert((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||"Failed to update user")}N(!1)}},className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(vo,{className:"inline h-4 w-4 mr-2"}),"Full Name"]}),(0,yr.jsx)("input",{type:"text",name:"name",value:v.name,onChange:e=>w(t=>Ye(Ye({},t),{},{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter full name"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(Vs,{className:"inline h-4 w-4 mr-2"}),"Email Address"]}),(0,yr.jsx)("input",{type:"email",name:"email",value:v.email,onChange:e=>w(t=>Ye(Ye({},t),{},{email:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email address"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(Us,{className:"inline h-4 w-4 mr-2"}),"New Password"]}),(0,yr.jsx)("input",{type:"password",name:"password",value:v.password,onChange:e=>w(t=>Ye(Ye({},t),{},{password:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Leave blank to keep current password"}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to keep current password. Must be at least 6 characters if changing."})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(oo,{className:"inline h-4 w-4 mr-2"}),"Role"]}),(0,yr.jsxs)("select",{name:"role",value:v.role,onChange:e=>w(t=>Ye(Ye({},t),{},{role:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,yr.jsx)("option",{value:"booker",children:"Booker"}),(0,yr.jsx)("option",{value:"viewer",children:"Viewer"}),(0,yr.jsx)("option",{value:"photographer",children:"Photographer"}),(0,yr.jsx)("option",{value:"admin",children:"Administrator"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(Vs,{className:"inline h-4 w-4 mr-2"}),"Email Account"]}),(0,yr.jsxs)("select",{name:"assigned_email_account_id",value:v.assigned_email_account_id||"",onChange:e=>w(t=>Ye(Ye({},t),{},{assigned_email_account_id:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,yr.jsx)("option",{value:"",children:"System Default"}),l.map(e=>(0,yr.jsxs)("option",{value:e.id,children:[e.name," (",e.email,")",e.is_default?" - Default":""]},e.id))]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Email account used for sending messages from this user"})]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,yr.jsx)("button",{type:"button",onClick:()=>b(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,yr.jsx)("button",{type:"submit",disabled:j,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:j?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,yr.jsx)("span",{children:"Updating..."})]}):(0,yr.jsx)("span",{children:"Update User"})})]})]})]})}),k&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:(0,yr.jsx)(ho,{className:"h-6 w-6 text-red-600"})}),(0,yr.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mt-4",children:"Delete User"}),(0,yr.jsx)("div",{className:"mt-2 px-7 py-3",children:(0,yr.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this user? This action cannot be undone."})})]}),(0,yr.jsxs)("div",{className:"mt-5 sm:mt-6 flex justify-center space-x-4",children:[(0,yr.jsx)("button",{type:"button",onClick:()=>S(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,yr.jsx)("button",{type:"button",onClick:async()=>{if(C){P(!0);try{await xr.delete("/api/users/".concat(C)),n(e=>e.filter(e=>e.id!==C)),S(!1),_(null),alert("User deleted successfully!")}catch(r){var e,t;console.error("Error deleting user:",r),alert((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to delete user")}P(!1)}},disabled:E,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:E?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,yr.jsx)("span",{children:"Deleting..."})]}):(0,yr.jsx)("span",{children:"Delete User"})})]})]})})]})},Tc=cc("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Dc=cc("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Mc=cc("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),Ic=cc("message-square",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),Lc=e=>{let{isOpen:t,onClose:n,lead:r,existingSale:a,onSaveSuccess:o}=e;const[i,l]=(0,s.useState)({saleAmount:a&&a.saleAmount?a.saleAmount.toString():"",paymentMethod:(null===a||void 0===a?void 0:a.paymentMethod)||"cash",paymentType:(null===a||void 0===a?void 0:a.paymentType)||"full_payment",financeAmount:"",financeFrequency:"monthly",financeStartDate:(new Date).toISOString().split("T")[0],notes:(null===a||void 0===a?void 0:a.notes)||"",images:[],emailReceipt:!1,smsReceipt:!1,customEmail:"",customPhone:""}),[c,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)([]),[f,g]=(0,s.useState)("");(0,s.useEffect)(()=>{t&&(async()=>{try{const e=await fetch("/api/templates?isActive=true",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(e.ok){const t=await e.json(),n=t.filter(e=>{const t=(e.type||"").toLowerCase(),n=(e.category||"").toLowerCase();return t.includes("receipt")||t.includes("sale_notification")||n.includes("receipt")||n.includes("sale")||n.includes("payment")}),r=n.length>0?n:t;if(p(r),r.length>0){const e=r[0]._id;g(e),console.log("\ud83d\udccb Default template selected:",{id:e,name:r[0].name,email_account:r[0].email_account,allTemplates:r.map(e=>"".concat(e.name," (").concat(e.email_account,")"))})}}}catch(e){console.error("Error fetching templates:",e)}})()},[t]),(0,s.useEffect)(()=>{l(a?{saleAmount:a.saleAmount?a.saleAmount.toString():"",paymentMethod:a.paymentMethod||"cash",paymentType:a.paymentType||"full_payment",financeAmount:"",financeFrequency:"monthly",financeStartDate:(new Date).toISOString().split("T")[0],notes:a.notes||"",images:[],emailReceipt:!1,smsReceipt:!1,customEmail:"",customPhone:""}:{saleAmount:"",paymentMethod:"cash",paymentType:"full_payment",financeAmount:"",financeFrequency:"monthly",financeStartDate:(new Date).toISOString().split("T")[0],notes:"",images:[],emailReceipt:!1,smsReceipt:!1,customEmail:"",customPhone:""})},[a]);const x=e=>{const{name:t,value:n,type:r,checked:a}=e.target;l(e=>Ye(Ye({},e),{},{[t]:"checkbox"===r?a:n}))},y=async e=>{try{const t={leadId:r.id,totalAmount:parseFloat(i.saleAmount),paymentAmount:parseFloat(i.financeAmount),frequency:i.financeFrequency,startDate:i.financeStartDate,notes:"Finance agreement created from sale ".concat(e)};if(!(await fetch("/api/finance",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(t)})).ok)throw new Error("Failed to create finance agreement")}catch(t){console.error("Error creating finance agreement:",t),alert("Sale saved but failed to create finance agreement. Please create it manually.")}},b=async e=>{m(!0);try{const t=[],n=h.find(e=>e._id===f);console.log("\ud83d\udce7 FRONTEND: Sending receipt with template:",{selectedTemplateId:f,selectedTemplateIdType:typeof f,templateId:f,templateName:null===n||void 0===n?void 0:n.name,emailAccount:(null===n||void 0===n?void 0:n.email_account)||"primary",allTemplates:h.map(e=>({id:e._id,name:e.name,email_account:e.email_account}))}),i.emailReceipt&&t.push(fetch("/api/sales/".concat(e,"/send-receipt/email"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({email:i.customEmail||r.email,templateId:f})}).then(async e=>{if(!e.ok){const t=await e.json().catch(()=>({error:"Unknown error"}));throw new Error("Email receipt failed: ".concat(e.status," - ").concat(t.error||t.message||"Unknown error"))}return e.json()})),i.smsReceipt&&t.push(fetch("/api/sales/".concat(e,"/send-receipt/sms"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({phone:i.customPhone||r.phone,templateId:f})}).then(async e=>{if(!e.ok){const t=await e.json().catch(()=>({error:"Unknown error"}));throw new Error("SMS receipt failed: ".concat(e.status," - ").concat(t.error||t.message||"Unknown error"))}return e.json()}));const a=await Promise.allSettled(t);a.forEach((e,t)=>{const n=0===t&&i.emailReceipt?"email":"SMS";"fulfilled"===e.status?console.log("\u2705 ".concat(n," receipt sent successfully")):console.error("\u274c ".concat(n," receipt failed:"),e.reason)});const s=a.filter(e=>"rejected"===e.status);s.length>0?(console.error("\u274c ".concat(s.length," receipt(s) failed to send")),alert("Sale saved but ".concat(s.length," receipt(s) failed to send. Check console for details."))):console.log("\u2705 All receipts sent successfully")}catch(t){console.error("Error sending receipts:",t),alert("Sale saved but failed to send receipts. You can send them manually later.")}finally{m(!1)}};if(!t)return null;const v=0===h.length;return(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[98vh] flex flex-col overflow-hidden",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between p-6 border-b bg-white sticky top-0 z-10",children:[(0,yr.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:a?"Edit Sale":"Record Sale"}),(0,yr.jsx)("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-full",children:(0,yr.jsx)(uc,{className:"w-5 h-5"})})]}),(0,yr.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),d(!0);try{const e={saleAmount:parseFloat(i.saleAmount),paymentMethod:i.paymentMethod,paymentType:i.paymentType,notes:i.notes,sendReceipt:i.emailReceipt||i.smsReceipt,customEmail:i.customEmail||r.email,customPhone:i.customPhone||r.phone};let t;if(a?t=await fetch("/api/sales/".concat(a.id),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)}):(e.leadId=r.id,t=await fetch("/api/sales",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)})),!t.ok){const e=await t.json();throw new Error(e.error||"Failed to save sale")}{const e=await t.json();console.log("\u2705 Sale completed successfully:",e),"finance"!==i.paymentType||a||await y(e.id),(i.emailReceipt||i.smsReceipt)&&e.id&&await b(e.id),null===o||void 0===o||o(),n()}}catch(t){console.error("Error saving sale:",t),alert("Failed to save sale: "+t.message)}finally{d(!1)}},className:"p-6 space-y-6 overflow-y-auto flex-1",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sale Amount (\xa3)"}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)(Tc,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),(0,yr.jsx)("input",{type:"number",name:"saleAmount",value:i.saleAmount,onChange:x,step:"0.01",min:"0",required:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]}),(0,yr.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,yr.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Customer Information"}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"font-medium",children:"Name:"})," ",r.name]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"font-medium",children:"Email:"})," ",r.email]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"font-medium",children:"Phone:"})," ",r.phone]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"font-medium",children:"Booking Date:"})," ",new Date(r.dateBooked).toLocaleDateString()]})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Type"}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yr.jsxs)("label",{className:"flex items-center p-3 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50",children:[(0,yr.jsx)("input",{type:"radio",name:"paymentType",value:"full_payment",checked:"full_payment"===i.paymentType,onChange:x,className:"mr-2"}),(0,yr.jsx)("span",{className:"text-sm font-medium",children:"Full Payment"})]}),(0,yr.jsxs)("label",{className:"flex items-center p-3 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50",children:[(0,yr.jsx)("input",{type:"radio",name:"paymentType",value:"finance",checked:"finance"===i.paymentType,onChange:x,className:"mr-2"}),(0,yr.jsx)("span",{className:"text-sm font-medium",children:"Finance Agreement"})]})]})]}),"finance"===i.paymentType&&(0,yr.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg space-y-4",children:[(0,yr.jsx)("h3",{className:"font-medium text-gray-900",children:"Finance Agreement Details"}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["weekly"===i.financeFrequency?"Weekly":"Monthly"," Payment Amount (\xa3)"]}),(0,yr.jsx)("input",{type:"number",name:"financeAmount",value:i.financeAmount,onChange:x,step:"0.01",min:"0",required:"finance"===i.paymentType,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter custom payment amount"}),(0,yr.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Set how much the customer will pay each ","weekly"===i.financeFrequency?"week":"month"]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Frequency"}),(0,yr.jsxs)("select",{name:"financeFrequency",value:i.financeFrequency,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,yr.jsx)("option",{value:"weekly",children:"Weekly"}),(0,yr.jsx)("option",{value:"monthly",children:"Monthly"})]})]})]}),i.saleAmount&&i.financeAmount&&(0,yr.jsxs)("div",{className:"bg-white p-3 rounded-md border border-blue-200",children:[(0,yr.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Payment Summary"}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-600",children:"Total Amount:"}),(0,yr.jsxs)("span",{className:"font-medium ml-2",children:["\xa3",parseFloat(i.saleAmount).toFixed(2)]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("span",{className:"text-gray-600",children:["weekly"===i.financeFrequency?"Weekly":"Monthly"," Payment:"]}),(0,yr.jsxs)("span",{className:"font-medium ml-2",children:["\xa3",parseFloat(i.financeAmount||0).toFixed(2)]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-600",children:"Number of Payments:"}),(0,yr.jsx)("span",{className:"font-medium ml-2",children:i.financeAmount>0?Math.ceil(parseFloat(i.saleAmount)/parseFloat(i.financeAmount)):0})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-600",children:"Duration:"}),(0,yr.jsx)("span",{className:"font-medium ml-2",children:i.financeAmount>0?"weekly"===i.financeFrequency?"".concat(Math.ceil(parseFloat(i.saleAmount)/parseFloat(i.financeAmount))," weeks"):"".concat(Math.ceil(parseFloat(i.saleAmount)/parseFloat(i.financeAmount))," months"):"0 months"})]})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),(0,yr.jsx)("input",{type:"date",name:"financeStartDate",value:i.financeStartDate,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)(Dc,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),(0,yr.jsxs)("select",{name:"paymentMethod",value:i.paymentMethod,onChange:x,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,yr.jsx)("option",{value:"cash",children:"Cash"}),(0,yr.jsx)("option",{value:"card",children:"Card"}),(0,yr.jsx)("option",{value:"bank_transfer",children:"Bank Transfer"}),(0,yr.jsx)("option",{value:"other",children:"Other"})]})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),(0,yr.jsx)("textarea",{name:"notes",value:i.notes,onChange:x,rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Any additional notes about the sale..."})]}),(0,yr.jsxs)("div",{className:"bg-gray-100 p-4 rounded-lg",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Images (Coming Soon)"}),(0,yr.jsx)("p",{className:"text-sm text-gray-500",children:"Image upload feature will be available in the next update."})]}),(0,yr.jsxs)("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[(0,yr.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"Send Receipt"}),(0,yr.jsxs)("div",{className:"space-y-4",children:[h.length>0?(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Receipt Template"}),(0,yr.jsx)("select",{value:f,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:h.map(e=>(0,yr.jsxs)("option",{value:e._id,children:[e.name," ","secondary"===e.email_account?"(Diary@edgetalent.co.uk)":"(Primary)"]},e._id))}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Emails sent via Gmail API from the template's configured account."})]}):(0,yr.jsx)("div",{className:"text-sm text-gray-600 bg-white border border-gray-200 rounded-md p-3",children:"No receipt templates available. Add one in Templates to send automated receipts."}),(0,yr.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,yr.jsxs)("label",{className:"flex items-center ".concat(v?"opacity-60 cursor-not-allowed":""),children:[(0,yr.jsx)("input",{type:"checkbox",id:"emailReceipt",name:"emailReceipt",checked:i.emailReceipt,onChange:x,disabled:v,className:"w-4 h-4 text-blue-500 border-gray-300 rounded focus:ring-blue-500 disabled:opacity-60 disabled:cursor-not-allowed"}),(0,yr.jsxs)("span",{className:"ml-2 text-sm text-gray-700 flex items-center",children:[(0,yr.jsx)(Mc,{className:"w-4 h-4 mr-1"}),"Send Email Receipt"]})]}),i.emailReceipt&&(0,yr.jsxs)("div",{className:"pl-6 space-y-2",children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600",children:"Recipient Email"}),(0,yr.jsx)("input",{type:"email",name:"customEmail",value:i.customEmail,onChange:x,placeholder:r.email||"customer@example.com",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,yr.jsxs)("p",{className:"text-xs text-gray-500",children:["Leave blank to use ",r.email||"the lead email on file","."]})]}),(0,yr.jsxs)("label",{className:"flex items-center ".concat(v?"opacity-60 cursor-not-allowed":""),children:[(0,yr.jsx)("input",{type:"checkbox",id:"smsReceipt",name:"smsReceipt",checked:i.smsReceipt,onChange:x,disabled:v,className:"w-4 h-4 text-blue-500 border-gray-300 rounded focus:ring-blue-500 disabled:opacity-60 disabled:cursor-not-allowed"}),(0,yr.jsxs)("span",{className:"ml-2 text-sm text-gray-700 flex items-center",children:[(0,yr.jsx)(Ic,{className:"w-4 h-4 mr-1"}),"Send SMS Receipt"]})]}),i.smsReceipt&&(0,yr.jsxs)("div",{className:"pl-6 space-y-2",children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600",children:"Recipient Phone"}),(0,yr.jsx)("input",{type:"tel",name:"customPhone",value:i.customPhone,onChange:x,placeholder:r.phone||"+44 1234 567890",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,yr.jsxs)("p",{className:"text-xs text-gray-500",children:["Leave blank to use ",r.phone||"the lead phone number on file","."]})]})]}),v?(0,yr.jsx)("div",{className:"text-xs text-orange-700 bg-orange-100 rounded-md p-3",children:"Add receipt templates in Templates to enable automatic receipt sending."}):(0,yr.jsx)("div",{className:"text-xs text-blue-700 bg-blue-100 rounded-md p-3",children:"Receipts are sent immediately after saving the sale when selected above. You can choose email, SMS, or both."})]})]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,yr.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),(0,yr.jsx)("button",{type:"submit",disabled:c||u,className:"px-6 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:c?"Saving...":u?"Sending Receipts...":a?"Update Sale":"Save Sale"})]})]})]})})},Rc=cc("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),Fc=cc("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Bc=cc("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),Uc=cc("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),zc=cc("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Vc=cc("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Wc=cc("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),qc=cc("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Hc=cc("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),Yc=e=>{var t,n;return e&&null!==(t=null!==(n=e.imageCount)&&void 0!==n?n:e.image_count)&&void 0!==t?t:null},Gc=e=>{let{isOpen:t,onClose:n,lead:r,onPackagesSelected:a,onSendContract:o,onPackageSelected:i,onChangeImages:l,selectedPhotoCount:c=0,selectedPhotoIds:d=[],onTrimSelection:u,initialPackage:m=null}=e;const[h,p]=(0,s.useState)({main:[],individual:[]}),[f,g]=(0,s.useState)(!0),[x,y]=(0,s.useState)(null),[b,v]=(0,s.useState)(null),[w,j]=(0,s.useState)({}),[N,k]=(0,s.useState)(null),[S,C]=(0,s.useState)(!1),[_,E]=(0,s.useState)({subtotal:0,vatAmount:0,total:0,items:[]}),P=(0,s.useCallback)(async()=>{g(!0),y(null);try{const e=await fetch("/api/packages",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!e.ok)throw new Error("Failed to fetch packages");const t=await e.json();p({main:t.mainPackages||[],individual:t.individualPackages||[]})}catch(BB){console.error("Error fetching packages:",BB),y(BB.message)}finally{g(!1)}},[]);(0,s.useEffect)(()=>{t&&(P(),m||(v(null),j({}),E({subtotal:0,vatAmount:0,total:0,items:[]})))},[t,P,m]),(0,s.useEffect)(()=>{if(t&&m&&h.main.length>0){const e=h.main.find(e=>e.id===m.id);e&&v(e)}},[t,m,h.main]),(0,s.useEffect)(()=>{O()},[b,w]);const O=async()=>{const e=[];if(b&&e.push({packageId:b.id,quantity:1}),Object.entries(w).forEach(t=>{let[n,r]=t;r>0&&e.push({packageId:n,quantity:r})}),0!==e.length){C(!0);try{const t=await fetch("/api/packages/calculate-total",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({items:e})});if(t.ok){const e=await t.json();E({subtotal:e.calculation.subtotal,vatAmount:e.calculation.vatAmount,total:e.calculation.total,items:e.calculation.items})}}catch(BB){console.error("Error calculating totals:",BB)}finally{C(!1)}}else E({subtotal:0,vatAmount:0,total:0,items:[]})},A=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;j(n=>{const r=n[e.id]||0,a=Math.max(0,r+t);if(0===a){const t=e.id,{[t]:r}=n;return Il(n,[t].map(We))}return Ye(Ye({},n),{},{[e.id]:a})})},T=e=>"\xa3".concat(parseFloat(e).toFixed(2)),D=(0,s.useMemo)(()=>{if(!b)return{valid:!0,message:null,excess:0};const e=Yc(b);if(null===e||void 0===e)return{valid:!0,message:c>0?"".concat(c," photos selected (unlimited included)"):"Full shoot - unlimited images included",excess:0};if(c<=e)return{valid:!0,message:"".concat(c," of ").concat(e," photos selected"),excess:0};const t=c-e;return{valid:!0,message:"".concat(c," of ").concat(e," photos selected (+").concat(t," extra)"),excess:t,hasExcess:!0}},[b,c]),M=e=>{switch(e){case"platinum":return(0,yr.jsx)(Rc,{className:"w-5 h-5 text-purple-500"});case"gold":return(0,yr.jsx)(Fc,{className:"w-5 h-5 text-yellow-500"});case"silver":return(0,yr.jsx)(Fc,{className:"w-5 h-5 text-gray-400"});default:return(0,yr.jsx)(Bc,{className:"w-5 h-5 text-blue-500"})}},I=e=>{switch(e){case"platinum":return"from-purple-500 to-indigo-600";case"gold":return"from-yellow-500 to-amber-600";case"silver":return"from-gray-400 to-gray-600";case"intro":return"from-blue-500 to-cyan-600";default:return"from-gray-500 to-gray-700"}};if(!t)return null;b||Object.values(w).some(e=>e>0);return(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-5xl max-h-[95vh] flex flex-col overflow-hidden",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b bg-gradient-to-r from-green-600 to-emerald-600",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("div",{className:"p-2 bg-white bg-opacity-20 rounded-lg",children:(0,yr.jsx)(Bc,{className:"w-5 h-5 text-white"})}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Select Package"}),(0,yr.jsx)("p",{className:"text-green-100 text-sm",children:null!==r&&void 0!==r&&r.name?"For ".concat(r.name):"Choose a package for this client"})]})]}),(0,yr.jsx)("button",{onClick:n,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-full transition-colors",children:(0,yr.jsx)(uc,{className:"w-6 h-6 text-white"})})]}),(0,yr.jsx)("div",{className:"flex-1 overflow-y-auto",children:f?(0,yr.jsxs)("div",{className:"flex flex-col items-center justify-center py-20",children:[(0,yr.jsx)(fc,{className:"w-10 h-10 text-green-600 animate-spin mb-4"}),(0,yr.jsx)("p",{className:"text-gray-500",children:"Loading packages..."})]}):x?(0,yr.jsxs)("div",{className:"flex flex-col items-center justify-center py-20",children:[(0,yr.jsx)("p",{className:"text-red-600 font-medium",children:x}),(0,yr.jsx)("button",{onClick:P,className:"mt-4 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Retry"})]}):(0,yr.jsxs)("div",{className:"p-6 space-y-8",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,yr.jsx)(Bc,{className:"w-5 h-5 mr-2 text-green-600"}),"Main Packages (VAT Inclusive)"]}),(0,yr.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:h.main.map(e=>(0,yr.jsxs)("div",{onClick:()=>(e=>{(null===b||void 0===b?void 0:b.id)===e.id?v(null):v(e)})(e),className:"relative cursor-pointer rounded-xl overflow-hidden transition-all duration-200 ".concat((null===b||void 0===b?void 0:b.id)===e.id?"ring-4 ring-green-500 ring-offset-2 transform scale-[1.02]":"hover:shadow-xl hover:scale-[1.01]"),children:[(0,yr.jsxs)("div",{className:"p-4 bg-gradient-to-br ".concat(I(e.code)," text-white"),children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[M(e.code),(null===b||void 0===b?void 0:b.id)===e.id&&(0,yr.jsx)("div",{className:"w-6 h-6 bg-white rounded-full flex items-center justify-center",children:(0,yr.jsx)(mc,{className:"w-4 h-4 text-green-600"})})]}),(0,yr.jsx)("h4",{className:"text-xl font-bold",children:e.name}),e.totalValue&&(0,yr.jsxs)("p",{className:"text-sm opacity-80 line-through",children:["Value: ",T(e.totalValue)]}),(0,yr.jsx)("p",{className:"text-2xl font-bold mt-1",children:T(e.price)})]}),(0,yr.jsxs)("div",{className:"p-4 bg-white border border-gray-200 border-t-0 rounded-b-xl",children:[(()=>{const t=Yc(e),n=null===t||c<=(t||0);return(0,yr.jsxs)("div",{className:"flex items-center justify-between py-2 px-3 rounded-lg mb-3 ".concat((null===b||void 0===b?void 0:b.id)===e.id?n?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200":"bg-gray-50"),children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)(dc,{className:"w-4 h-4 ".concat((null===b||void 0===b?void 0:b.id)===e.id?n?"text-green-600":"text-red-500":"text-gray-500")}),(0,yr.jsx)("span",{className:"text-sm font-medium ".concat((null===b||void 0===b?void 0:b.id)===e.id?n?"text-green-700":"text-red-700":"text-gray-700"),children:null===t?"Full Shoot":"".concat(t," images")})]}),(null===b||void 0===b?void 0:b.id)===e.id&&c>0&&(0,yr.jsx)("span",{className:"text-xs font-medium ".concat(n?"text-green-600":"text-red-600"),children:null===t?"".concat(c," selected"):"".concat(c,"/").concat(t)})]})})(),(0,yr.jsxs)("button",{onClick:t=>{t.stopPropagation(),k(N===e.id?null:e.id)},className:"flex items-center justify-between w-full text-sm text-gray-600 hover:text-gray-900",children:[(0,yr.jsx)("span",{children:"What's included"}),N===e.id?(0,yr.jsx)(Uc,{className:"w-4 h-4"}):(0,yr.jsx)(zc,{className:"w-4 h-4"})]}),N===e.id&&e.includes&&(0,yr.jsx)("ul",{className:"mt-3 space-y-1.5",children:e.includes.map((e,t)=>(0,yr.jsxs)("li",{className:"flex items-start text-sm text-gray-600",children:[(0,yr.jsx)(mc,{className:"w-4 h-4 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),(0,yr.jsx)("span",{children:e})]},t))})]})]},e.id))})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,yr.jsx)(Vc,{className:"w-5 h-5 mr-2 text-green-600"}),"Individual Items (+VAT)"]}),(0,yr.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:h.individual.map(e=>{const t=w[e.id]||0,n=1.2*(parseFloat(e.price)||0);return(0,yr.jsxs)("div",{className:"p-4 rounded-xl border-2 transition-all ".concat(t>0?"border-green-500 bg-green-50":"border-gray-200 bg-white hover:border-gray-300"),children:[(0,yr.jsxs)("div",{className:"flex items-start justify-between",children:[(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,yr.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:e.description}),(0,yr.jsxs)("p",{className:"text-lg font-semibold text-gray-900 mt-2",children:[T(e.price),(0,yr.jsx)("span",{className:"text-sm font-normal text-gray-500",children:" +VAT"})]}),(0,yr.jsxs)("p",{className:"text-xs text-gray-400",children:["(",T(n)," inc. VAT)"]})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,yr.jsx)("button",{onClick:()=>A(e,-1),disabled:0===t,className:"p-1.5 rounded-lg border border-gray-300 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,yr.jsx)(Wc,{className:"w-4 h-4"})}),(0,yr.jsx)("span",{className:"w-8 text-center font-medium",children:t}),(0,yr.jsx)("button",{onClick:()=>A(e,1),className:"p-1.5 rounded-lg border border-green-500 bg-green-500 text-white hover:bg-green-600",children:(0,yr.jsx)(Vc,{className:"w-4 h-4"})})]})]}),e.includes&&e.includes.length>0&&(0,yr.jsx)("ul",{className:"mt-3 space-y-1",children:e.includes.slice(0,2).map((e,t)=>(0,yr.jsxs)("li",{className:"flex items-center text-xs text-gray-500",children:[(0,yr.jsx)(mc,{className:"w-3 h-3 text-green-500 mr-1.5"}),e]},t))})]},e.id)})})]})]})}),(0,yr.jsx)("div",{className:"border-t bg-gray-50 p-6",children:(0,yr.jsxs)("div",{className:"flex items-start justify-between",children:[(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Order Summary"}),_.items.length>0?(0,yr.jsxs)("div",{className:"space-y-1 text-sm",children:[_.items.map((e,t)=>(0,yr.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,yr.jsxs)("span",{children:[e.name,e.quantity>1&&" x".concat(e.quantity)]}),(0,yr.jsx)("span",{children:T(e.lineTotal)})]},t)),(0,yr.jsxs)("div",{className:"pt-2 border-t mt-2 space-y-1",children:[(0,yr.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,yr.jsx)("span",{children:"Subtotal"}),(0,yr.jsx)("span",{children:T(_.subtotal)})]}),(0,yr.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,yr.jsx)("span",{children:"VAT (20%)"}),(0,yr.jsx)("span",{children:T(_.vatAmount)})]})]})]}):(0,yr.jsx)("p",{className:"text-sm text-gray-500",children:"No items selected"})]}),(0,yr.jsxs)("div",{className:"ml-8 text-right",children:[(0,yr.jsxs)("div",{className:"mb-4",children:[(0,yr.jsx)("p",{className:"text-sm text-gray-500",children:"Total"}),(0,yr.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:S?(0,yr.jsx)(fc,{className:"w-6 h-6 animate-spin inline"}):T(_.total)}),c>0&&b&&(0,yr.jsxs)("div",{className:"mt-2 text-sm flex items-center justify-end space-x-1 ".concat(D.hasExcess?"text-amber-600":"text-green-600"),children:[(0,yr.jsx)(dc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:D.message})]})]}),D.hasExcess&&(0,yr.jsx)("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg text-left",children:(0,yr.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,yr.jsx)(qc,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),(0,yr.jsx)("div",{children:(0,yr.jsxs)("p",{className:"text-sm font-medium text-amber-800",children:[D.excess," extra photo",D.excess>1?"s":""," beyond package limit - you can adjust pricing on next screen"]})})]})}),(0,yr.jsxs)("div",{className:"flex space-x-3",children:[(0,yr.jsx)("button",{onClick:n,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),i&&b&&0===c&&(0,yr.jsxs)("button",{onClick:()=>i(b),className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center space-x-2",children:[(0,yr.jsx)(dc,{className:"w-4 h-4"}),(0,yr.jsxs)("span",{children:["Select Images",Yc(b)?" (".concat(Yc(b)," max)"):" (Unlimited)"]})]}),b&&c>0&&(l||i)&&(0,yr.jsxs)("button",{onClick:()=>(l||i)(b),className:"px-4 py-2 bg-purple-100 text-purple-700 border border-purple-300 rounded-lg hover:bg-purple-200 transition-colors flex items-center space-x-2",children:[(0,yr.jsx)(dc,{className:"w-4 h-4"}),(0,yr.jsxs)("span",{children:["Change Images (",c,")"]})]}),o&&b&&(0,yr.jsxs)("button",{onClick:()=>o({leadId:r.id,package:b,items:_.items,totals:_}),disabled:S,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:[(0,yr.jsx)(Hc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Generate Invoice"})]}),!b&&Object.values(w).some(e=>e>0)&&(0,yr.jsx)(yr.Fragment,{children:o&&(0,yr.jsxs)("button",{onClick:()=>{const e=Object.entries(w).filter(e=>{let[t,n]=e;return n>0}).map(e=>{let[t,n]=e;const r=h.individual.find(e=>e.id===t);return r?Ye(Ye({},r),{},{quantity:n}):null}).filter(Boolean),t=e.map(e=>(e.name||"").toLowerCase()+" "+(e.code||"").toLowerCase()).join(" "),n={id:"individual-items",name:e.map(e=>"".concat(e.name).concat(e.quantity>1?" x".concat(e.quantity):"")).join(", "),code:"individual",price:_.subtotal,vatInclusive:!1,vatRate:20,includes:e.flatMap(e=>e.includes||[]),hasZCard:t.includes("z-card")||t.includes("zcard"),hasEfolio:t.includes("efolio")||t.includes("e-folio"),hasProjectInfluencer:t.includes("influencer"),has3Lance:t.includes("3lance")||t.includes("casting"),hasAgencyList:t.includes("agency")||t.includes("agency list")};o({leadId:r.id,package:n,items:_.items,totals:_})},disabled:S,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:[(0,yr.jsx)(Hc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Generate Invoice"})]})})]})]})]})})]})})},Xc=cc("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),$c=cc("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Kc=cc("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Jc=cc("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),Qc=cc("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Zc=e=>{let{onSave:t,onCancel:n,saving:r=!1,width:a=500,height:o=200,penColor:i="#1a1a2e",backgroundColor:l="#ffffff"}=e;const c=(0,s.useRef)(null),[d,u]=(0,s.useState)(!1),[m,h]=(0,s.useState)(!1),[p,f]=(0,s.useState)(null);(0,s.useEffect)(()=>{const e=c.current;if(!e)return;const t=e.getContext("2d"),n=window.devicePixelRatio||1;e.width=a*n,e.height=o*n,e.style.width="".concat(a,"px"),e.style.height="".concat(o,"px"),t.scale(n,n),t.fillStyle=l,t.fillRect(0,0,a,o),t.strokeStyle=i,t.lineWidth=2,t.lineCap="round",t.lineJoin="round",f(t)},[a,o,i,l]);const g=(0,s.useCallback)(e=>{const t=c.current.getBoundingClientRect();return e.touches?{x:e.touches[0].clientX-t.left,y:e.touches[0].clientY-t.top}:{x:e.clientX-t.left,y:e.clientY-t.top}},[]),x=(0,s.useCallback)(e=>{if(!p)return;e.preventDefault();const t=g(e);p.beginPath(),p.moveTo(t.x,t.y),u(!0),h(!0)},[p,g]),y=(0,s.useCallback)(e=>{if(!d||!p)return;e.preventDefault();const t=g(e);p.lineTo(t.x,t.y),p.stroke()},[d,p,g]),b=(0,s.useCallback)(()=>{p&&(p.closePath(),u(!1))},[p]),v=(0,s.useCallback)(()=>{p&&(p.fillStyle=l,p.fillRect(0,0,a,o),h(!1))},[p,a,o,l]),w=(0,s.useCallback)(()=>{const e=c.current;return e?e.toDataURL("image/png"):null},[]),j=(0,s.useCallback)(()=>{if(!m)return void alert("Please sign in the box above");const e=w();e&&(null===t||void 0===t||t(e))},[m,w,t]);return(0,s.useEffect)(()=>{const e=c.current;if(e)return e.addEventListener("mousedown",x),e.addEventListener("mousemove",y),e.addEventListener("mouseup",b),e.addEventListener("mouseout",b),e.addEventListener("touchstart",x,{passive:!1}),e.addEventListener("touchmove",y,{passive:!1}),e.addEventListener("touchend",b),()=>{e.removeEventListener("mousedown",x),e.removeEventListener("mousemove",y),e.removeEventListener("mouseup",b),e.removeEventListener("mouseout",b),e.removeEventListener("touchstart",x),e.removeEventListener("touchmove",y),e.removeEventListener("touchend",b)}},[x,y,b]),(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,yr.jsx)("p",{className:"text-sm text-blue-800",children:"Please sign in the box below using your mouse or finger (on touch devices). Your signature confirms acceptance of the invoice terms."})}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsxs)("div",{className:"border-2 border-gray-300 rounded-lg overflow-hidden bg-white",children:[(0,yr.jsx)("canvas",{ref:c,className:"cursor-crosshair touch-none",style:{display:"block"}}),(0,yr.jsx)("div",{className:"absolute bottom-8 left-8 right-8 border-b border-gray-300",style:{pointerEvents:"none"}}),(0,yr.jsx)("div",{className:"absolute bottom-2 left-8 text-xs text-gray-400",style:{pointerEvents:"none"},children:"Sign above this line"})]}),!m&&(0,yr.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",style:{opacity:.3},children:(0,yr.jsx)("p",{className:"text-gray-400 text-lg italic",children:"Sign here"})})]}),(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsxs)("button",{onClick:v,className:"flex items-center space-x-2 px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:[(0,yr.jsx)(Qc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Clear"})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsxs)("button",{onClick:n,className:"flex items-center space-x-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,yr.jsx)(uc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Cancel"})]}),(0,yr.jsxs)("button",{onClick:j,disabled:!m||r,className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[r?(0,yr.jsx)(fc,{className:"w-4 h-4 animate-spin"}):(0,yr.jsx)(mc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:r?"Saving...":"Accept & Sign"})]})]})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"By signing above, I confirm that I have read and agree to the terms of this invoice. I authorise the charges as listed."})]})},ed=e=>{let{isOpen:t,onClose:n,invoice:r,lead:a,onPaymentRecorded:o,onSignatureSaved:i,onComplete:l,onSendSignatureEmail:c}=e;const[d,u]=(0,s.useState)((null===r||void 0===r?void 0:r.paymentMethod)||"pdq"),[m,h]=(0,s.useState)((null===r||void 0===r?void 0:r.authCode)||""),[p,f]=(0,s.useState)(""),[g,x]=(0,s.useState)(!1),[y,b]=(0,s.useState)(!1),[v,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)(!1),[k,S]=(0,s.useState)((null===r||void 0===r?void 0:r.clientSignatureData)||null),[C,_]=(0,s.useState)(null),[E,P]=(0,s.useState)(null);(0,s.useEffect)(()=>{r&&(u(r.paymentMethod||"pdq"),h(r.authCode||""),S(r.clientSignatureData||null))},[r]);const O=e=>"\xa3".concat(parseFloat(e||0).toFixed(2)),A=(e,t)=>{var n,r;const a={payment:{pending:{color:"bg-yellow-100 text-yellow-800",icon:Xc,text:"Pending"},paid:{color:"bg-green-100 text-green-800",icon:$c,text:"Paid"},partial:{color:"bg-blue-100 text-blue-800",icon:Xc,text:"Partial"},refunded:{color:"bg-red-100 text-red-800",icon:Kc,text:"Refunded"}},signature:{pending:{color:"bg-yellow-100 text-yellow-800",icon:Xc,text:"Pending"},sent:{color:"bg-blue-100 text-blue-800",icon:Jc,text:"Sent"},signed:{color:"bg-green-100 text-green-800",icon:$c,text:"Signed"},declined:{color:"bg-red-100 text-red-800",icon:Kc,text:"Declined"}}},s=(null===(n=a[t])||void 0===n?void 0:n[e])||(null===(r=a[t])||void 0===r?void 0:r.pending),o=s.icon;return(0,yr.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(s.color),children:[(0,yr.jsx)(o,{className:"w-3 h-3 mr-1"}),s.text]})};if(!t||!r)return null;const T="paid"===r.paymentStatus,D="signed"===r.signatureStatus||k,M=T&&D;return(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[95vh] flex flex-col overflow-hidden",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b bg-gradient-to-r from-blue-600 to-indigo-600",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("div",{className:"p-2 bg-white bg-opacity-20 rounded-lg",children:(0,yr.jsx)(Hc,{className:"w-5 h-5 text-white"})}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("h2",{className:"text-xl font-semibold text-white",children:["Invoice ",r.invoiceNumber]}),(0,yr.jsx)("p",{className:"text-blue-100 text-sm",children:r.clientName||(null===a||void 0===a?void 0:a.name)})]})]}),(0,yr.jsx)("button",{onClick:n,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-full transition-colors",children:(0,yr.jsx)(uc,{className:"w-6 h-6 text-white"})})]}),(C||E)&&(0,yr.jsxs)("div",{className:"mx-6 mt-4 p-4 rounded-lg flex items-start space-x-3 ".concat(C?"bg-red-50 text-red-800":"bg-green-50 text-green-800"),children:[C?(0,yr.jsx)(Kc,{className:"w-5 h-5 flex-shrink-0"}):(0,yr.jsx)($c,{className:"w-5 h-5 flex-shrink-0"}),(0,yr.jsx)("span",{className:"text-sm",children:C||E}),(0,yr.jsx)("button",{onClick:()=>{_(null),P(null)},className:"ml-auto",children:(0,yr.jsx)(uc,{className:"w-4 h-4"})})]}),(0,yr.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,yr.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,yr.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,yr.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,yr.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"Client Information"}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Name:"}),(0,yr.jsx)("p",{className:"font-medium",children:r.clientName||(null===a||void 0===a?void 0:a.name)})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Email:"}),(0,yr.jsx)("p",{className:"font-medium",children:r.clientEmail||(null===a||void 0===a?void 0:a.email)||"-"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Phone:"}),(0,yr.jsx)("p",{className:"font-medium",children:r.clientPhone||(null===a||void 0===a?void 0:a.phone)||"-"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Date:"}),(0,yr.jsx)("p",{className:"font-medium",children:(e=>e?new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-")(r.createdAt)})]})]})]}),(0,yr.jsx)("div",{className:"bg-white border rounded-xl overflow-hidden",children:(0,yr.jsxs)("table",{className:"w-full",children:[(0,yr.jsx)("thead",{className:"bg-gray-50",children:(0,yr.jsxs)("tr",{children:[(0,yr.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),(0,yr.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Qty"}),(0,yr.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Price"}),(0,yr.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total"})]})}),(0,yr.jsx)("tbody",{className:"divide-y divide-gray-100",children:(r.items||[]).map((e,t)=>(0,yr.jsxs)("tr",{children:[(0,yr.jsxs)("td",{className:"px-4 py-3",children:[(0,yr.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),e.includes&&e.includes.length>0&&(0,yr.jsxs)("ul",{className:"mt-1 space-y-0.5",children:[e.includes.slice(0,3).map((e,t)=>(0,yr.jsxs)("li",{className:"text-xs text-gray-500 flex items-center",children:[(0,yr.jsx)(mc,{className:"w-3 h-3 text-green-500 mr-1"}),e]},t)),e.includes.length>3&&(0,yr.jsxs)("li",{className:"text-xs text-gray-400",children:["+",e.includes.length-3," more"]})]})]}),(0,yr.jsx)("td",{className:"px-4 py-3 text-center text-gray-600",children:e.quantity||1}),(0,yr.jsx)("td",{className:"px-4 py-3 text-right text-gray-600",children:O(e.unitPrice)}),(0,yr.jsx)("td",{className:"px-4 py-3 text-right font-medium text-gray-900",children:O(e.lineTotal)})]},t))}),(0,yr.jsxs)("tfoot",{className:"bg-gray-50",children:[(0,yr.jsxs)("tr",{children:[(0,yr.jsx)("td",{colSpan:"3",className:"px-4 py-2 text-right text-sm text-gray-600",children:"Subtotal"}),(0,yr.jsx)("td",{className:"px-4 py-2 text-right text-sm font-medium",children:O(r.subtotal)})]}),(0,yr.jsxs)("tr",{children:[(0,yr.jsx)("td",{colSpan:"3",className:"px-4 py-2 text-right text-sm text-gray-600",children:"VAT (20%)"}),(0,yr.jsx)("td",{className:"px-4 py-2 text-right text-sm font-medium",children:O(r.vatAmount)})]}),(0,yr.jsxs)("tr",{className:"border-t-2 border-gray-200",children:[(0,yr.jsx)("td",{colSpan:"3",className:"px-4 py-3 text-right text-lg font-semibold",children:"Total"}),(0,yr.jsx)("td",{className:"px-4 py-3 text-right text-xl font-bold text-gray-900",children:O(r.totalAmount)})]})]})]})}),j?(0,yr.jsxs)("div",{className:"bg-white border rounded-xl p-4",children:[(0,yr.jsx)("h3",{className:"font-medium text-gray-900 mb-4",children:"Client Signature"}),(0,yr.jsx)(Zc,{onSave:async e=>{x(!0),_(null);try{const t=await fetch("/api/invoices/".concat(r.id,"/save-signature"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({signatureData:e})});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to save signature")}const n=await t.json();S(e),N(!1),P("Signature saved successfully"),null===i||void 0===i||i(n.invoice),setTimeout(()=>P(null),3e3)}catch(BB){console.error("Error saving signature:",BB),_(BB.message)}finally{x(!1)}},onCancel:()=>N(!1),saving:g})]}):k?(0,yr.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,yr.jsxs)("h3",{className:"font-medium text-green-900 flex items-center",children:[(0,yr.jsx)($c,{className:"w-5 h-5 mr-2"}),"Signature Collected"]}),(0,yr.jsx)("button",{onClick:()=>N(!0),className:"text-sm text-green-700 hover:text-green-900",children:"Re-sign"})]}),(0,yr.jsx)("div",{className:"bg-white rounded-lg p-2 border",children:(0,yr.jsx)("img",{src:k,alt:"Client signature",className:"max-h-24 mx-auto"})})]}):null]}),(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4 space-y-4",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsx)("span",{className:"text-sm text-gray-600",children:"Payment"}),A(r.paymentStatus,"payment")]}),(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsx)("span",{className:"text-sm text-gray-600",children:"Signature"}),A(k?"signed":r.signatureStatus,"signature")]})]}),!T&&(0,yr.jsxs)("div",{className:"bg-white border rounded-xl p-4",children:[(0,yr.jsxs)("h3",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[(0,yr.jsx)(Dc,{className:"w-4 h-4 mr-2"}),"Record Payment"]}),(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),(0,yr.jsxs)("select",{value:d,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,yr.jsx)("option",{value:"pdq",children:"PDQ Machine (Card)"}),(0,yr.jsx)("option",{value:"cash",children:"Cash"}),(0,yr.jsx)("option",{value:"bank_transfer",children:"Bank Transfer"}),(0,yr.jsx)("option",{value:"other",children:"Other"})]})]}),"pdq"===d&&(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Authorisation Code *"}),(0,yr.jsx)("input",{type:"text",value:m,onChange:e=>h(e.target.value),placeholder:"Enter auth code",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference (Optional)"}),(0,yr.jsx)("input",{type:"text",value:p,onChange:e=>f(e.target.value),placeholder:"Transaction reference",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("button",{onClick:async()=>{if(m||"pdq"!==d){x(!0),_(null);try{const e=await fetch("/api/invoices/".concat(r.id,"/record-payment"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({paymentMethod:d,authCode:m||null,paymentReference:p||null})});if(!e.ok){const t=await e.json();throw new Error(t.message||"Failed to record payment")}const t=await e.json();P("Payment recorded successfully"),null===o||void 0===o||o(t.invoice),setTimeout(()=>P(null),3e3)}catch(BB){console.error("Error recording payment:",BB),_(BB.message)}finally{x(!1)}}else _("Please enter the PDQ authorisation code")},disabled:g,className:"w-full py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center justify-center space-x-2",children:[g?(0,yr.jsx)(fc,{className:"w-4 h-4 animate-spin"}):(0,yr.jsx)(mc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Record Payment"})]})]})]}),T&&!D&&(0,yr.jsxs)("div",{className:"bg-white border rounded-xl p-4",children:[(0,yr.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"Collect Signature"}),(0,yr.jsxs)("div",{className:"space-y-2",children:[(0,yr.jsxs)("button",{onClick:()=>N(!0),className:"w-full py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center space-x-2",children:[(0,yr.jsx)(Hc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Sign Here"})]}),(0,yr.jsxs)("button",{onClick:async()=>{b(!0),_(null);try{const e=await fetch("/api/signature/send-email",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({invoiceId:r.id,email:(null===a||void 0===a?void 0:a.email)||r.clientEmail})});if(!e.ok){const t=await e.json();throw new Error(t.message||"Failed to send signature email")}const t=await e.json();P("Signature request sent to ".concat(t.sentTo)),null===c||void 0===c||c(t),setTimeout(()=>P(null),5e3)}catch(BB){console.error("Error sending signature email:",BB),_(BB.message)}finally{b(!1)}},disabled:y||!r.clientEmail,className:"w-full py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:opacity-50 flex items-center justify-center space-x-2",children:[y?(0,yr.jsx)(fc,{className:"w-4 h-4 animate-spin"}):(0,yr.jsx)(Mc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Email Signature Link"})]})]})]}),(0,yr.jsxs)("button",{onClick:async()=>{if("paid"===r.paymentStatus)if("signed"===r.signatureStatus||k){w(!0),_(null);try{const e=await fetch("/api/invoices/".concat(r.id,"/complete"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({createSale:!0})});if(!e.ok){const t=await e.json();throw new Error(t.message||"Failed to complete invoice")}const t=await e.json();P("Invoice completed! Delivery emails will be sent."),null===l||void 0===l||l(t.invoice),setTimeout(()=>{n()},2e3)}catch(BB){console.error("Error completing invoice:",BB),_(BB.message)}finally{w(!1)}}else _("Please collect signature before completing");else _("Please record payment before completing")},disabled:!M||v,className:"w-full py-3 rounded-xl font-medium flex items-center justify-center space-x-2 transition-colors ".concat(M?"bg-gradient-to-r from-green-600 to-emerald-600 text-white hover:from-green-700 hover:to-emerald-700":"bg-gray-200 text-gray-500 cursor-not-allowed"),children:[v?(0,yr.jsx)(fc,{className:"w-5 h-5 animate-spin"}):(0,yr.jsx)($c,{className:"w-5 h-5"}),(0,yr.jsx)("span",{children:"Complete Sale"})]}),!M&&(0,yr.jsx)("p",{className:"text-xs text-center text-gray-500",children:T?"Collect signature to complete":"Record payment first"}),r.pdfUrl&&(0,yr.jsxs)("a",{href:r.pdfUrl,target:"_blank",rel:"noopener noreferrer",className:"w-full py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 flex items-center justify-center space-x-2",children:[(0,yr.jsx)(xc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Download Invoice PDF"})]})]})]})})]})})},td=cc("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),nd=cc("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),rd=cc("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),ad=cc("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),sd=cc("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),od=cc("pound-sterling",[["path",{d:"M18 7c0-5.333-8-5.333-8 0",key:"1prm2n"}],["path",{d:"M10 7v14",key:"18tmcs"}],["path",{d:"M6 21h12",key:"4dkmi1"}],["path",{d:"M6 13h10",key:"ybwr4a"}]]),id=cc("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ld=cc("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),cd=cc("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),dd=cc("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),ud=cc("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),md=e=>{let{isOpen:t,onClose:n,lead:r,packageData:a,invoiceData:o,selectedPhotoIds:i=[],onContractSent:l,onBackToPackages:c,onBackToPhotos:d}=e;const[u,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)(!1),[f,g]=(0,s.useState)(null),[x,y]=(0,s.useState)(null),[b,v]=(0,s.useState)(!1),[w,j]=(0,s.useState)(null),[N,k]=(0,s.useState)(!1),[S,C]=(0,s.useState)("draft"),[_,E]=(0,s.useState)(!1),[P,O]=(0,s.useState)(null),[A,T]=(0,s.useState)(null),[D,M]=(0,s.useState)(""),[I,L]=(0,s.useState)(null),[R,F]=(0,s.useState)(0),[B,U]=(0,s.useState)(0),[z,V]=(0,s.useState)(0),[W,q]=(0,s.useState)(!1),[H,Y]=(0,s.useState)(!1),[G,X]=(0,s.useState)(!1),[$,K]=(0,s.useState)(""),[J,Q]=(0,s.useState)(!1),[Z,ee]=(0,s.useState)(null),[te,ne]=(0,s.useState)(!1),[re,ae]=(0,s.useState)([]),[se,oe]=(0,s.useState)(!1),[ie,le]=(0,s.useState)("edit"),ce=e=>"contract_draft_".concat(e),de=e=>{e&&(localStorage.removeItem(ce(e)),console.log("\ud83d\uddd1\ufe0f Cleared saved contract state for lead ".concat(e)))},ue=()=>{Z&&(fe(Z.contractDetails),le(Z.step),Z.contract&&y(Z.contract),Z.emailSent&&v(Z.emailSent),Z.contractStatus&&C(Z.contractStatus),console.log("\u2705 Resumed contract state from step: ".concat(Z.step))),Q(!1),ee(null)},me=()=>{null!==r&&void 0!==r&&r.id&&de(r.id),Q(!1),ee(null)},he=()=>{Q(!1),ee(null),n()},[pe,fe]=(0,s.useState)({customerName:"",clientNameIfDifferent:"",address:"",postcode:"",phone:"",email:"",isVip:!1,studioNumber:"",photographer:"",invoiceNumber:"",digitalImages:!0,digitalImagesQty:"",digitalZCard:!1,efolio:!1,efolioUrl:"",projectInfluencer:!1,influencerLogin:"",influencerPassword:"",allowImageUse:!0,notes:"",subtotal:0,vatAmount:0,total:0,paymentMethod:"card",authCode:"",depositAmount:0,financeAmount:0,financeFrequency:"monthly",financeStartDate:"",financeDueDay:1,financeDuration:12});(0,s.useEffect)(()=>{if(t&&r){var e,n,s,i,l;const t=(e=>{if(!e)return null;try{const t=localStorage.getItem(ce(e));if(t){const n=JSON.parse(t);if((Date.now()-n.timestamp)/36e5<24)return n;localStorage.removeItem(ce(e))}}catch(BB){console.error("Error loading saved contract state:",BB)}return null})(r.id);if(t&&!J)return ee(t),void Q(!0);if(J)return;const c=(null===a||void 0===a?void 0:a.price)||0,d=(null===a||void 0===a?void 0:a.vatRate)||20;let u,m,h;if(void 0!==(null===o||void 0===o?void 0:o.subtotal))u=o.subtotal,m=o.vatAmount||0,h=o.total||u+m;else if(null!==a&&void 0!==a&&a.vatInclusive){u=c/(1+d/100),m=c-u,h=c}else u=c,m=c*(d/100),h=c+m;const p=async()=>{try{const e=await fetch("/api/contracts/next-invoice-number",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(e.ok){const t=await e.json();t.invoiceNumber&&(fe(e=>Ye(Ye({},e),{},{invoiceNumber:t.invoiceNumber})),console.log("\ud83d\udccb Invoice number set: ".concat(t.invoiceNumber)))}}catch(BB){console.error("Error fetching invoice number:",BB)}};fe({customerName:r.name||"",clientNameIfDifferent:r.parent_name||"",address:r.address||"",postcode:r.postcode||"",phone:r.phone||"",email:r.email||"",isVip:r.is_vip||!1,studioNumber:(null===o||void 0===o?void 0:o.studioNumber)||"",photographer:(null===o||void 0===o?void 0:o.photographer)||"",invoiceNumber:"",digitalImages:!0,digitalImagesQty:(null===a||void 0===a?void 0:a.imageCount)||(null===a||void 0===a?void 0:a.image_count)||"All",digitalZCard:void 0!==(null===a||void 0===a?void 0:a.hasZCard)?a.hasZCard:(null===a||void 0===a||null===(e=a.includes)||void 0===e?void 0:e.some(e=>e.toLowerCase().includes("z-card")))||!1,efolio:void 0!==(null===a||void 0===a?void 0:a.hasEfolio)?a.hasEfolio:(null===a||void 0===a||null===(n=a.includes)||void 0===n?void 0:n.some(e=>e.toLowerCase().includes("efolio")||e.toLowerCase().includes("e-folio")))||!1,efolioUrl:"",projectInfluencer:void 0!==(null===a||void 0===a?void 0:a.hasProjectInfluencer)?a.hasProjectInfluencer:(null===a||void 0===a||null===(s=a.includes)||void 0===s?void 0:s.some(e=>e.toLowerCase().includes("influencer")))||!1,influencerLogin:"",influencerPassword:"",threeLanceCastings:void 0!==(null===a||void 0===a?void 0:a.has3Lance)?a.has3Lance:(null===a||void 0===a||null===(i=a.includes)||void 0===i?void 0:i.some(e=>e.toLowerCase().includes("3lance")||e.toLowerCase().includes("casting")))||!1,recommendedAgencyList:void 0!==(null===a||void 0===a?void 0:a.hasAgencyList)?a.hasAgencyList:(null===a||void 0===a||null===(l=a.includes)||void 0===l?void 0:l.some(e=>e.toLowerCase().includes("agency")))||!1,allowImageUse:!0,notes:"Package: ".concat((null===a||void 0===a?void 0:a.name)||"Standard Package"),subtotal:u,vatRate:(null===a||void 0===a?void 0:a.vatRate)||20,vatAmount:m,total:h,paymentMethod:(null===o||void 0===o?void 0:o.paymentMethod)||"card",authCode:(null===o||void 0===o?void 0:o.authCode)||"",financeFrequency:("finance"===(null===o||void 0===o?void 0:o.paymentMethod)||"payl8r"===(null===o||void 0===o?void 0:o.paymentMethod))&&(null===o||void 0===o?void 0:o.financeFrequency)||"monthly",financeStartDate:"finance"===(null===o||void 0===o?void 0:o.paymentMethod)||"payl8r"===(null===o||void 0===o?void 0:o.paymentMethod)?(null===o||void 0===o?void 0:o.financeStartDate)||new Date(Date.now()+2592e6).toISOString().split("T")[0]:"",financeDueDay:("finance"===(null===o||void 0===o?void 0:o.paymentMethod)||"payl8r"===(null===o||void 0===o?void 0:o.paymentMethod))&&(null===o||void 0===o?void 0:o.financeDueDay)||1,financeDuration:("finance"===(null===o||void 0===o?void 0:o.paymentMethod)||"payl8r"===(null===o||void 0===o?void 0:o.paymentMethod))&&(null===o||void 0===o?void 0:o.financeDuration)||12}),p(),y(null),v(!1),g(null),k(!1),le("edit")}},[t,r,a,o,J]),(0,s.useEffect)(()=>{if(t&&null!==r&&void 0!==r&&r.id&&!J&&pe.customerName){if("signed"===S)return void de(r.id);((e,t)=>{if(!e)return;const n={contractDetails:t.contractDetails,step:t.step,contract:t.contract,emailSent:t.emailSent,contractStatus:t.contractStatus,timestamp:Date.now(),leadId:e};localStorage.setItem(ce(e),JSON.stringify(n)),console.log("\ud83d\udcbe Contract state saved for lead ".concat(e))})(r.id,{contractDetails:pe,step:ie,contract:x,emailSent:b,contractStatus:S})}},[pe,ie,x,b,S,t,null===r||void 0===r?void 0:r.id,J]);const ge=(e,t)=>{fe(n=>Ye(Ye({},n),{},{[e]:t}))};(0,s.useEffect)(()=>{if(null===x||void 0===x||!x.id||"send"!==ie)return;if("signed"===S&&null!==P)return;const e=setInterval(()=>{(async()=>{if(null!==x&&void 0!==x&&x.id){E(!0);try{const t=await fetch("/api/contracts/".concat(x.id),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(t.ok){var e;const n=await t.json(),r=(null===(e=n.contract)||void 0===e?void 0:e.status)||n.status||"draft";if(C(r),n.contract){y(e=>Ye(Ye({},e),n.contract));const e=n.contract.data||{};void 0!==n.contract.deliveryEmailSent?(O(n.contract.deliveryEmailSent),T(n.contract.deliveryEmailTime),M(n.contract.deliveryEmailTo||e.email),L(n.contract.deliveryEmailError||null),F(n.contract.deliveryAttachmentCount||0),U(n.contract.deliveryPhotoCount||0)):void 0!==e.delivery_email_sent&&(O(e.delivery_email_sent),T(e.delivery_email_time),M(e.delivery_email_to||e.email),L(e.delivery_email_error||null),F(e.delivery_attachment_count||0),U(e.delivery_photo_count||0)),n.contract.selectedPhotoCount&&V(n.contract.selectedPhotoCount),(n.contract.authCode||e.authCode)&&(K(n.contract.authCode||e.authCode),X(!0))}}}catch(BB){console.error("Error checking contract status:",BB)}finally{E(!1)}}})()},1e3);return()=>clearInterval(e)},[null===x||void 0===x?void 0:x.id,S,ie,P]);const xe=async()=>{if(null!==x&&void 0!==x&&x.id){q(!0),g(null);try{const e=await fetch("/api/contracts/".concat(x.id,"/resend-delivery"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({email:pe.email})}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to resend delivery email");O(!0),T((new Date).toISOString()),M(t.sentTo),L(null),F(t.attachments||0),U(t.photoCount||0)}catch(BB){g(BB.message)}finally{q(!1)}}},ye=e=>"\xa3".concat(parseFloat(e||0).toFixed(2));if(!t)return null;if(J&&Z){var be,ve;const e=Z.step,t=(new Date(Z.timestamp),Math.round((Date.now()-Z.timestamp)/6e4)),n=t<60?"".concat(t," minutes ago"):"".concat(Math.round(t/60)," hours ago");return(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,yr.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",children:[(0,yr.jsx)("div",{className:"px-6 py-4 border-b bg-gradient-to-r from-amber-500 to-orange-500",children:(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("div",{className:"p-2 bg-white bg-opacity-20 rounded-lg",children:(0,yr.jsx)(td,{className:"w-5 h-5 text-white"})}),(0,yr.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Resume Contract?"})]})}),(0,yr.jsxs)("div",{className:"p-6",children:[(0,yr.jsxs)("p",{className:"text-gray-700 mb-4",children:["You have an unfinished contract for ",(0,yr.jsx)("strong",{children:(null===(be=Z.contractDetails)||void 0===be?void 0:be.customerName)||(null===r||void 0===r?void 0:r.name)}),"."]}),(0,yr.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between text-sm mb-2",children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Saved:"}),(0,yr.jsx)("span",{className:"text-gray-700",children:n})]}),(0,yr.jsxs)("div",{className:"flex items-center justify-between text-sm mb-2",children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Step:"}),(0,yr.jsx)("span",{className:"text-gray-700 capitalize",children:"edit"===e?"Edit Details":"review"===e?"Review":"Send"})]}),(0,yr.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Invoice:"}),(0,yr.jsx)("span",{className:"text-gray-700 font-mono",children:(null===(ve=Z.contractDetails)||void 0===ve?void 0:ve.invoiceNumber)||"-"})]})]}),(0,yr.jsxs)("div",{className:"flex space-x-3",children:[(0,yr.jsx)("button",{onClick:me,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Start New"}),(0,yr.jsx)("button",{onClick:ue,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Resume"})]})]})]})})}return(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,yr.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b bg-gradient-to-r from-blue-600 to-indigo-600 flex-shrink-0",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("div",{className:"p-2 bg-white bg-opacity-20 rounded-lg",children:(0,yr.jsx)(Hc,{className:"w-5 h-5 text-white"})}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("h2",{className:"text-lg font-semibold text-white",children:["edit"===ie&&"Edit Invoice Details","review"===ie&&"Review Invoice","send"===ie&&"Send Invoice"]}),(0,yr.jsxs)("p",{className:"text-blue-100 text-sm",children:[(null===r||void 0===r?void 0:r.name)||"Customer"," \u2022 ",(null===a||void 0===a?void 0:a.name)||"Package"]})]})]}),(0,yr.jsx)("button",{onClick:he,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-full transition-colors",children:(0,yr.jsx)(uc,{className:"w-5 h-5 text-white"})})]}),(0,yr.jsxs)("div",{className:"px-6 py-3 bg-gray-50 border-b flex items-center justify-center space-x-4 flex-shrink-0",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 ".concat("edit"===ie?"text-blue-600 font-medium":"text-gray-400"),children:[(0,yr.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs ".concat("edit"===ie?"bg-blue-600 text-white":"bg-gray-300 text-gray-600"),children:"1"}),(0,yr.jsx)("span",{className:"text-sm",children:"Edit Details"})]}),(0,yr.jsx)(nd,{className:"w-4 h-4 text-gray-400"}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2 ".concat("review"===ie?"text-blue-600 font-medium":"text-gray-400"),children:[(0,yr.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs ".concat("review"===ie?"bg-blue-600 text-white":"bg-gray-300 text-gray-600"),children:"2"}),(0,yr.jsx)("span",{className:"text-sm",children:"Review"})]}),(0,yr.jsx)(nd,{className:"w-4 h-4 text-gray-400"}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2 ".concat("send"===ie?"text-blue-600 font-medium":"text-gray-400"),children:[(0,yr.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs ".concat("send"===ie?"bg-blue-600 text-white":"bg-gray-300 text-gray-600"),children:"3"}),(0,yr.jsx)("span",{className:"text-sm",children:"Send"})]})]}),(0,yr.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[f&&(0,yr.jsxs)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-start space-x-2",children:[(0,yr.jsx)(qc,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"text-red-800 font-medium",children:"Error"}),(0,yr.jsx)("p",{className:"text-red-600 text-sm",children:f})]})]}),"edit"===ie&&(0,yr.jsxs)("div",{className:"space-y-6",children:[(c||d)&&(0,yr.jsxs)("div",{className:"flex items-center space-x-2 pb-4 border-b border-gray-200",children:[(0,yr.jsx)(rd,{className:"w-4 h-4 text-gray-400"}),(0,yr.jsx)("span",{className:"text-sm text-gray-500",children:"Go back to:"}),d&&(0,yr.jsxs)("button",{onClick:d,className:"px-3 py-1.5 text-sm bg-purple-50 text-purple-700 border border-purple-200 rounded-lg hover:bg-purple-100 transition-colors flex items-center space-x-1",children:[(0,yr.jsx)(dc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Photo Selection"})]}),c&&(0,yr.jsxs)("button",{onClick:c,className:"px-3 py-1.5 text-sm bg-green-50 text-green-700 border border-green-200 rounded-lg hover:bg-green-100 transition-colors flex items-center space-x-1",children:[(0,yr.jsx)(Bc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Package Selection"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("h3",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,yr.jsx)(ad,{className:"w-4 h-4 mr-2 text-blue-500"}),"CUSTOMER DETAILS"]}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yr.jsxs)("div",{className:"col-span-2",children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Name (as in diary)"}),(0,yr.jsx)("input",{type:"text",value:pe.customerName,onChange:e=>ge("customerName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("div",{className:"col-span-2",children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Client Name (if different)"}),(0,yr.jsx)("input",{type:"text",value:pe.clientNameIfDifferent,onChange:e=>ge("clientNameIfDifferent",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Postcode"}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)("input",{type:"text",value:pe.postcode,onChange:e=>ge("postcode",e.target.value),onBlur:e=>(async e=>{if(!e||e.length<5)return;const t=e.trim().toUpperCase().replace(/\s+/g,"");if(/^[A-Z]{1,2}\d[A-Z\d]?\s*\d[A-Z]{2}$/i.test(t)){ne(!0),ae([]),oe(!1);try{const e=await fetch("/api/postcode/lookup/".concat(encodeURIComponent(t))),n=await e.json();n.addresses&&n.addresses.length>0&&(ae(n.addresses),oe(!0))}catch(BB){console.error("Postcode lookup failed:",BB)}finally{ne(!1)}}})(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g. SW1A 1AA"}),te&&(0,yr.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:(0,yr.jsx)(fc,{className:"w-4 h-4 animate-spin text-blue-500"})})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Select Address"}),(0,yr.jsx)("div",{className:"relative",children:(0,yr.jsxs)("select",{value:"",onChange:e=>{const t=re.find(t=>t.full===e.target.value||t.display===e.target.value);var n;t&&(ge("address",(n=t).full||n.display),oe(!1),ae([]))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:0===re.length,children:[(0,yr.jsx)("option",{value:"",children:0===re.length?"Enter postcode first":"Select from ".concat(re.length," addresses")}),re.map((e,t)=>(0,yr.jsx)("option",{value:e.full||e.display,children:e.display},t))]})})]}),(0,yr.jsxs)("div",{className:"col-span-2",children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Full Address"}),(0,yr.jsx)("input",{type:"text",value:pe.address,onChange:e=>ge("address",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Select address from dropdown above"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Phone / Mobile"}),(0,yr.jsx)("input",{type:"tel",value:pe.phone,onChange:e=>ge("phone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("div",{className:"col-span-2",children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Email"}),(0,yr.jsx)("input",{type:"email",value:pe.email,onChange:e=>ge("email",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("div",{className:"col-span-2 flex items-center",children:[(0,yr.jsx)("input",{type:"checkbox",id:"isVip",checked:pe.isVip,onChange:e=>ge("isVip",e.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,yr.jsx)("label",{htmlFor:"isVip",className:"ml-2 text-sm text-gray-700",children:"VIP Customer"})]})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("h3",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,yr.jsx)(sd,{className:"w-4 h-4 mr-2 text-purple-500"}),"STUDIO INFO"]}),(0,yr.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Studio No."}),(0,yr.jsx)("input",{type:"text",value:pe.studioNumber,onChange:e=>ge("studioNumber",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Photographer"}),(0,yr.jsx)("input",{type:"text",value:pe.photographer,onChange:e=>ge("photographer",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Invoice No."}),(0,yr.jsx)("input",{type:"text",value:pe.invoiceNumber,onChange:e=>ge("invoiceNumber",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("h3",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,yr.jsx)(Bc,{className:"w-4 h-4 mr-2 text-green-500"}),"ORDER DETAILS"]}),(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("input",{type:"checkbox",id:"digitalImages",checked:pe.digitalImages,onChange:e=>ge("digitalImages",e.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,yr.jsx)("label",{htmlFor:"digitalImages",className:"ml-2 text-sm text-gray-700",children:"Digital Images"})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("label",{className:"text-xs text-gray-500",children:"Qty:"}),(0,yr.jsx)("input",{type:"text",value:pe.digitalImagesQty,onChange:e=>ge("digitalImagesQty",e.target.value),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm",placeholder:"All"})]})]}),(0,yr.jsxs)("div",{className:"flex items-center bg-gray-50 p-3 rounded-lg",children:[(0,yr.jsx)("input",{type:"checkbox",id:"digitalZCard",checked:pe.digitalZCard,onChange:e=>ge("digitalZCard",e.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,yr.jsx)("label",{htmlFor:"digitalZCard",className:"ml-2 text-sm text-gray-700",children:"Digital Z-Card"})]}),(0,yr.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,yr.jsxs)("div",{className:"flex items-center mb-2",children:[(0,yr.jsx)("input",{type:"checkbox",id:"efolio",checked:pe.efolio,onChange:e=>ge("efolio",e.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,yr.jsx)("label",{htmlFor:"efolio",className:"ml-2 text-sm text-gray-700",children:"E-Folio"})]}),pe.efolio&&(0,yr.jsx)("input",{type:"text",value:pe.efolioUrl,onChange:e=>ge("efolioUrl",e.target.value),placeholder:"E-Folio URL",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),(0,yr.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,yr.jsxs)("div",{className:"flex items-center mb-2",children:[(0,yr.jsx)("input",{type:"checkbox",id:"projectInfluencer",checked:pe.projectInfluencer,onChange:e=>ge("projectInfluencer",e.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,yr.jsx)("label",{htmlFor:"projectInfluencer",className:"ml-2 text-sm text-gray-700",children:"Project Influencer"})]}),pe.projectInfluencer&&(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,yr.jsx)("input",{type:"text",value:pe.influencerLogin,onChange:e=>ge("influencerLogin",e.target.value),placeholder:"Login",className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),(0,yr.jsx)("input",{type:"text",value:pe.influencerPassword,onChange:e=>ge("influencerPassword",e.target.value),placeholder:"Password",className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"})]})]}),(0,yr.jsxs)("div",{className:"flex items-center bg-gray-50 p-3 rounded-lg",children:[(0,yr.jsx)("input",{type:"checkbox",id:"allowImageUse",checked:pe.allowImageUse,onChange:e=>ge("allowImageUse",e.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,yr.jsx)("label",{htmlFor:"allowImageUse",className:"ml-2 text-sm text-gray-700",children:"Allow image use for marketing"})]})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Notes"}),(0,yr.jsx)("textarea",{value:pe.notes,onChange:e=>ge("notes",e.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Additional notes for the contract..."})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("h3",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,yr.jsx)(od,{className:"w-4 h-4 mr-2 text-yellow-500"}),"PAYMENT DETAILS"]}),(0,yr.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg space-y-3",children:[(0,yr.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Subtotal (excl VAT)"}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"\xa3"}),(0,yr.jsx)("input",{type:"number",step:"0.01",value:pe.subtotal,onChange:e=>(e=>{const t=parseFloat(e)||0,n=(null===a||void 0===a?void 0:a.vatRate)||20,r=t*(n/100),s=t+r;fe(e=>Ye(Ye({},e),{},{subtotal:t,vatAmount:r,total:s}))})(e.target.value),className:"w-full pl-7 pr-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["VAT (",pe.vatRate||20,"%)"]}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"\xa3"}),(0,yr.jsx)("input",{type:"text",value:pe.vatAmount.toFixed(2),readOnly:!0,className:"w-full pl-7 pr-3 py-2 border border-gray-200 rounded-lg text-sm bg-gray-100 text-gray-600"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Total"}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"\xa3"}),(0,yr.jsx)("input",{type:"text",value:pe.total.toFixed(2),readOnly:!0,className:"w-full pl-7 pr-3 py-2 border border-gray-200 rounded-lg text-sm bg-gray-100 font-semibold text-gray-800"})]})]})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Payment Method"}),(0,yr.jsxs)("select",{value:pe.paymentMethod,onChange:e=>{const t=e.target.value;if(ge("paymentMethod",t),("finance"===t||"payl8r"===t)&&"finance"!==pe.paymentMethod&&"payl8r"!==pe.paymentMethod){const e=new Date;e.setDate(e.getDate()+30),ge("financeStartDate",e.toISOString().split("T")[0]),ge("financeFrequency","monthly"),ge("financeDueDay",1),ge("financeDuration",12)}"finance"!==t&&"payl8r"!==t&&(ge("depositAmount",0),ge("financeAmount",0),ge("financeStartDate",""),ge("financeFrequency","monthly"),ge("financeDueDay",1),ge("financeDuration",12))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,yr.jsx)("option",{value:"card",children:"Card"}),(0,yr.jsx)("option",{value:"cash",children:"Cash"}),(0,yr.jsx)("option",{value:"finance",children:"Finance"}),(0,yr.jsx)("option",{value:"payl8r",children:"Payl8er"})]})]}),"finance"!==pe.paymentMethod&&"payl8r"!==pe.paymentMethod&&(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Auth Code (if applicable)"}),(0,yr.jsx)("input",{type:"text",value:pe.authCode,onChange:e=>ge("authCode",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Card auth code"})]})]}),("finance"===pe.paymentMethod||"payl8r"===pe.paymentMethod)&&(0,yr.jsxs)("div",{className:"mt-3 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[(0,yr.jsxs)("h4",{className:"text-xs font-semibold text-amber-800 mb-3 flex items-center",children:[(0,yr.jsx)(od,{className:"w-3 h-3 mr-1"}),"payl8r"===pe.paymentMethod?"PAYL8R BREAKDOWN":"FINANCE BREAKDOWN"]}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-amber-700 mb-1",children:"Deposit Amount"}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-amber-600",children:"\xa3"}),(0,yr.jsx)("input",{type:"number",step:"0.01",min:"0",value:pe.depositAmount||"",onChange:e=>{const t=parseFloat(e.target.value)||0;ge("depositAmount",t);const n=Math.max(0,pe.total-t);ge("financeAmount",n)},className:"w-full pl-7 pr-3 py-2 border border-amber-300 rounded-lg text-sm focus:ring-2 focus:ring-amber-500 focus:border-amber-500 bg-white",placeholder:"0.00"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-amber-700 mb-1",children:"Finance Amount (Remaining)"}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-amber-600",children:"\xa3"}),(0,yr.jsx)("input",{type:"text",value:(pe.financeAmount||0).toFixed(2),readOnly:!0,className:"w-full pl-7 pr-3 py-2 border border-amber-200 rounded-lg text-sm bg-amber-100 text-amber-800 font-semibold"})]}),(0,yr.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:"Auto-calculated: Total - Deposit"})]})]}),"finance"===pe.paymentMethod&&(0,yr.jsxs)("div",{className:"border-t border-amber-200 pt-3 mt-3",children:[(0,yr.jsx)("h5",{className:"text-xs font-semibold text-amber-800 mb-2",children:"Finance Agreement Settings"}),(0,yr.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-amber-700 mb-1",children:"Payment Frequency"}),(0,yr.jsxs)("select",{value:pe.financeFrequency||"monthly",onChange:e=>ge("financeFrequency",e.target.value),className:"w-full px-2 py-2 border border-amber-300 rounded-lg text-sm focus:ring-2 focus:ring-amber-500 bg-white",children:[(0,yr.jsx)("option",{value:"weekly",children:"Weekly"}),(0,yr.jsx)("option",{value:"bi-weekly",children:"Bi-weekly"}),(0,yr.jsx)("option",{value:"monthly",children:"Monthly"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-amber-700 mb-1",children:"First Payment Date"}),(0,yr.jsx)("input",{type:"date",value:pe.financeStartDate||"",onChange:e=>ge("financeStartDate",e.target.value),className:"w-full px-2 py-2 border border-amber-300 rounded-lg text-sm focus:ring-2 focus:ring-amber-500 bg-white"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-amber-700 mb-1",children:"Start Day"}),(0,yr.jsx)("input",{type:"number",min:"1",max:"31",value:pe.financeDueDay||1,onChange:e=>ge("financeDueDay",parseInt(e.target.value)||1),className:"w-full px-2 py-2 border border-amber-300 rounded-lg text-sm focus:ring-2 focus:ring-amber-500 bg-white"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-amber-700 mb-1",children:"Duration (# of payments)"}),(0,yr.jsx)("input",{type:"number",min:"1",max:"60",value:pe.financeDuration||12,onChange:e=>{const t=parseInt(e.target.value)||12;ge("financeDuration",t)},className:"w-full px-2 py-2 border border-amber-300 rounded-lg text-sm focus:ring-2 focus:ring-amber-500 bg-white"}),(0,yr.jsxs)("p",{className:"text-xs text-amber-600 mt-1",children:[pe.financeDuration||12," ","weekly"===pe.financeFrequency?"weekly":"bi-weekly"===pe.financeFrequency?"bi-weekly":"monthly"," payments of ",ye((pe.financeAmount||0)/(pe.financeDuration||12))]})]})]})]})]})]})]})]}),"review"===ie&&(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 text-blue-700 mb-2",children:[(0,yr.jsx)(id,{className:"w-5 h-5"}),(0,yr.jsx)("span",{className:"font-medium",children:"Review Contract Details"})]}),(0,yr.jsx)("p",{className:"text-sm text-blue-600",children:"Please review the contract details below before creating. Once created, these details will be overlaid on the PDF contract."})]}),(0,yr.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,yr.jsxs)("h4",{className:"font-medium text-gray-700 mb-2 flex items-center",children:[(0,yr.jsx)(ad,{className:"w-4 h-4 mr-2"}),"Customer Details"]}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Name:"})," ",(0,yr.jsx)("span",{className:"font-medium",children:pe.customerName})]}),pe.clientNameIfDifferent&&(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Client:"})," ",(0,yr.jsx)("span",{className:"font-medium",children:pe.clientNameIfDifferent})]}),(0,yr.jsxs)("div",{className:"col-span-2",children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Address:"})," ",(0,yr.jsx)("span",{className:"font-medium",children:pe.address})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Postcode:"})," ",(0,yr.jsx)("span",{className:"font-medium",children:pe.postcode})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Phone:"})," ",(0,yr.jsx)("span",{className:"font-medium",children:pe.phone})]}),(0,yr.jsxs)("div",{className:"col-span-2",children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Email:"})," ",(0,yr.jsx)("span",{className:"font-medium",children:pe.email})]}),pe.isVip&&(0,yr.jsx)("div",{className:"col-span-2",children:(0,yr.jsx)("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded text-xs",children:"VIP"})})]})]}),(0,yr.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,yr.jsxs)("h4",{className:"font-medium text-gray-700 mb-2 flex items-center",children:[(0,yr.jsx)(Bc,{className:"w-4 h-4 mr-2"}),"Order Details"]}),(0,yr.jsxs)("div",{className:"text-sm space-y-1",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[pe.digitalImages?(0,yr.jsx)(mc,{className:"w-4 h-4 text-green-500"}):(0,yr.jsx)(uc,{className:"w-4 h-4 text-gray-300"}),(0,yr.jsxs)("span",{children:["Digital Images: ",pe.digitalImagesQty]})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[pe.digitalZCard?(0,yr.jsx)(mc,{className:"w-4 h-4 text-green-500"}):(0,yr.jsx)(uc,{className:"w-4 h-4 text-gray-300"}),(0,yr.jsx)("span",{children:"Digital Z-Card"})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[pe.efolio?(0,yr.jsx)(mc,{className:"w-4 h-4 text-green-500"}):(0,yr.jsx)(uc,{className:"w-4 h-4 text-gray-300"}),(0,yr.jsxs)("span",{children:["E-Folio ",pe.efolioUrl&&"(".concat(pe.efolioUrl,")")]})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[pe.projectInfluencer?(0,yr.jsx)(mc,{className:"w-4 h-4 text-green-500"}):(0,yr.jsx)(uc,{className:"w-4 h-4 text-gray-300"}),(0,yr.jsx)("span",{children:"Project Influencer"})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[pe.allowImageUse?(0,yr.jsx)(mc,{className:"w-4 h-4 text-green-500"}):(0,yr.jsx)(uc,{className:"w-4 h-4 text-gray-300"}),(0,yr.jsx)("span",{children:"Permission for image use"})]})]}),pe.notes&&(0,yr.jsxs)("div",{className:"mt-2 pt-2 border-t text-sm",children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Notes:"})," ",(0,yr.jsx)("span",{children:pe.notes})]})]}),(0,yr.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,yr.jsxs)("h4",{className:"font-medium text-gray-700 mb-2 flex items-center",children:[(0,yr.jsx)(Dc,{className:"w-4 h-4 mr-2"}),"Payment Details"]}),(0,yr.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Subtotal:"}),(0,yr.jsx)("span",{children:ye(pe.subtotal)})]}),(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsxs)("span",{className:"text-gray-500",children:["VAT (",pe.vatRate||20,"%):"]}),(0,yr.jsx)("span",{children:ye(pe.vatAmount)})]}),(0,yr.jsxs)("div",{className:"flex justify-between font-semibold text-base border-t pt-1 mt-1",children:[(0,yr.jsx)("span",{children:"Total:"}),(0,yr.jsx)("span",{children:ye(pe.total)})]}),(0,yr.jsxs)("div",{className:"pt-2",children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Payment Method:"})," ",(0,yr.jsx)("span",{className:"capitalize",children:pe.paymentMethod}),pe.authCode&&(0,yr.jsxs)("span",{className:"text-gray-400 ml-2",children:["(Auth: ",pe.authCode,")"]})]}),("finance"===pe.paymentMethod||"payl8r"===pe.paymentMethod)&&(0,yr.jsxs)("div",{className:"mt-3 p-2 bg-amber-50 border border-amber-200 rounded-lg",children:[(0,yr.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,yr.jsx)("span",{className:"text-amber-700",children:"Deposit Paid:"}),(0,yr.jsx)("span",{className:"font-medium text-amber-800",children:ye(pe.depositAmount)})]}),(0,yr.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,yr.jsxs)("span",{className:"text-amber-700",children:["payl8r"===pe.paymentMethod?"Payl8r Amount":"Finance Amount",":"]}),(0,yr.jsx)("span",{className:"font-semibold text-amber-800",children:ye(pe.financeAmount)})]}),"finance"===pe.paymentMethod&&(0,yr.jsxs)("div",{className:"mt-2 pt-2 border-t border-amber-200 text-xs text-amber-700",children:[(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{children:"Payment Frequency:"}),(0,yr.jsx)("span",{className:"capitalize font-medium",children:pe.financeFrequency||"monthly"})]}),(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{children:"Duration:"}),(0,yr.jsxs)("span",{className:"font-medium",children:[pe.financeDuration||12," ","weekly"===pe.financeFrequency?"weekly":"bi-weekly"===pe.financeFrequency?"bi-weekly":"monthly"," payments"]})]}),(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{children:"Payment Amount:"}),(0,yr.jsx)("span",{className:"font-medium",children:ye((pe.financeAmount||0)/(pe.financeDuration||12))})]}),(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{children:"First Payment:"}),(0,yr.jsx)("span",{className:"font-medium",children:pe.financeStartDate?new Date(pe.financeStartDate).toLocaleDateString("en-GB"):"Not set"})]}),(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{children:"Start Day:"}),(0,yr.jsx)("span",{className:"font-medium",children:pe.financeDueDay||1})]})]})]})]})]})]}),"send"===ie&&(0,yr.jsx)("div",{children:x?(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,yr.jsx)(Mc,{className:"w-5 h-5 text-blue-600"}),(0,yr.jsx)("h3",{className:"font-semibold text-gray-800",children:"Send Contract"})]}),(0,yr.jsx)("div",{className:"mb-3",children:(0,yr.jsx)("input",{type:"email",value:pe.email,onChange:e=>ge("email",e.target.value),placeholder:"customer@email.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),b?(0,yr.jsxs)("div",{className:"flex items-center space-x-2 text-green-600 bg-green-50 rounded-lg px-3 py-2",children:[(0,yr.jsx)($c,{className:"w-4 h-4"}),(0,yr.jsxs)("span",{className:"text-sm",children:["Sent ",w&&new Date(w).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})]})]}):(0,yr.jsx)("button",{onClick:async()=>{if(x&&pe.email){p(!0),g(null);try{const e=await fetch("/api/contracts/send/".concat(x.id),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({email:pe.email})}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to send contract");v(!0),j((new Date).toISOString()),C("sent"),null===l||void 0===l||l(x)}catch(BB){g(BB.message)}finally{p(!1)}}},disabled:h||!pe.email,className:"w-full py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2 text-sm font-medium",children:h?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(fc,{className:"w-4 h-4 animate-spin"}),(0,yr.jsx)("span",{children:"Sending..."})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(Jc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Send Email"})]})}),(0,yr.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("button",{onClick:async()=>{if(null!==x&&void 0!==x&&x.signingUrl)try{await navigator.clipboard.writeText(x.signingUrl),k(!0),setTimeout(()=>k(!1),2e3)}catch(BB){const t=document.createElement("textarea");t.value=x.signingUrl,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),k(!0),setTimeout(()=>k(!1),2e3)}},className:"flex-1 py-2 px-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center space-x-1 text-sm",children:N?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(mc,{className:"w-4 h-4 text-green-600"}),(0,yr.jsx)("span",{className:"text-green-600",children:"Copied!"})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(ld,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Copy Link"})]})}),(0,yr.jsxs)("a",{href:null===x||void 0===x?void 0:x.signingUrl,target:"_blank",rel:"noopener noreferrer",className:"flex-1 py-2 px-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center space-x-1 text-sm",children:[(0,yr.jsx)(id,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Preview"})]})]}),(0,yr.jsxs)("p",{className:"text-xs text-gray-400 mt-2 flex items-center space-x-1",children:[(0,yr.jsx)(Xc,{className:"w-3 h-3"}),(0,yr.jsx)("span",{children:"Link expires in 7 days"})]})]})]}),"signed"===S&&(0,yr.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,yr.jsx)(Dc,{className:"w-5 h-5 text-purple-600"}),(0,yr.jsx)("h3",{className:"font-semibold text-gray-800",children:"Auth Code"}),(0,yr.jsx)("span",{className:"text-xs text-gray-400",children:"(internal)"})]}),(0,yr.jsxs)("div",{className:"flex space-x-2",children:[(0,yr.jsx)("input",{type:"text",value:$,onChange:e=>{K(e.target.value),X(!1)},placeholder:"Enter auth code",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500"}),(0,yr.jsx)("button",{onClick:async()=>{if(null!==x&&void 0!==x&&x.id&&$.trim()){Y(!0),g(null);try{const e=await fetch("/api/contracts/".concat(x.id,"/auth-code"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({authCode:$.trim()})}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to save auth code");X(!0),setTimeout(()=>X(!1),3e3)}catch(BB){g(BB.message)}finally{Y(!1)}}},disabled:H||!$.trim(),className:"px-4 py-2 rounded-lg text-sm font-medium flex items-center space-x-1 transition-colors ".concat(G?"bg-green-100 text-green-700":"bg-purple-600 text-white hover:bg-purple-700 disabled:opacity-50"),children:H?(0,yr.jsx)(fc,{className:"w-4 h-4 animate-spin"}):G?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(mc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Saved"})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(cd,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Save"})]})})]})]})]}),(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("signed"===S?"bg-green-500":"bg-amber-500 animate-pulse")}),(0,yr.jsx)("h3",{className:"font-semibold text-gray-800",children:"Status"})]}),"signed"!==S&&(0,yr.jsxs)("span",{className:"text-xs text-gray-400 flex items-center space-x-1",children:[(0,yr.jsx)(td,{className:"w-3 h-3 ".concat(_?"animate-spin":"")}),(0,yr.jsx)("span",{children:"Live"})]})]}),"signed"===S?(0,yr.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)($c,{className:"w-7 h-7 text-green-600"})}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"font-semibold text-green-800",children:"Signed"}),(0,yr.jsx)("p",{className:"text-sm text-green-600",children:(null===x||void 0===x?void 0:x.signedAt)&&new Date(x.signedAt).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),((null===x||void 0===x?void 0:x.signed_pdf_url)||(null===x||void 0===x?void 0:x.pdfUrl))&&(0,yr.jsxs)("a",{href:x.signed_pdf_url||x.pdfUrl,target:"_blank",rel:"noopener noreferrer",className:"mt-3 w-full py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-2 text-sm font-medium",children:[(0,yr.jsx)(xc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Download PDF"})]})]}):(0,yr.jsx)("div",{className:"bg-amber-50 rounded-lg p-4",children:(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("div",{className:"w-12 h-12 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(Xc,{className:"w-7 h-7 text-amber-600"})}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"font-semibold text-amber-800",children:"Awaiting Signature"}),(0,yr.jsx)("p",{className:"text-sm text-amber-600",children:w?"Sent ".concat(Math.floor((Date.now()-new Date(w).getTime())/6e4)," mins ago"):"Waiting for customer"})]})]})})]}),"signed"===S&&(0,yr.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,yr.jsx)(Mc,{className:"w-5 h-5 ".concat(I?"text-red-600":P?"text-green-600":"text-gray-400")}),(0,yr.jsx)("h3",{className:"font-semibold text-gray-800",children:"Delivery Email"})]}),!0!==P||I?I?(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 text-red-700",children:[(0,yr.jsx)(qc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{className:"text-sm font-medium",children:"Failed to Send"})]}),(0,yr.jsx)("p",{className:"text-sm text-red-600 mt-1",children:I}),A&&(0,yr.jsxs)("p",{className:"text-xs text-red-400 mt-1",children:["Attempted: ",new Date(A).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),(0,yr.jsx)("button",{onClick:xe,disabled:W,className:"w-full py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors flex items-center justify-center space-x-2 text-sm font-medium",children:W?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(fc,{className:"w-4 h-4 animate-spin"}),(0,yr.jsx)("span",{children:"Retrying..."})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(td,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Retry Sending"})]})})]}):(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 text-blue-700",children:[(0,yr.jsx)(fc,{className:"w-4 h-4 animate-spin"}),(0,yr.jsx)("span",{className:"text-sm font-medium",children:"Processing..."})]}),(0,yr.jsx)("p",{className:"text-sm text-blue-600 mt-1",children:"Delivery email is being sent automatically. This may take a moment."})]}),(0,yr.jsx)("button",{onClick:xe,disabled:W,className:"w-full py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center space-x-2 text-sm",children:W?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(fc,{className:"w-4 h-4 animate-spin"}),(0,yr.jsx)("span",{children:"Sending..."})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(td,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Send Manually"})]})})]}):(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{className:"bg-green-50 rounded-lg p-3",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 text-green-700",children:[(0,yr.jsx)($c,{className:"w-4 h-4"}),(0,yr.jsx)("span",{className:"text-sm font-medium",children:"Sent Successfully"})]}),(0,yr.jsxs)("p",{className:"text-sm text-green-600 mt-1",children:["To: ",D]}),(0,yr.jsx)("p",{className:"text-xs text-green-500 mt-1",children:A&&new Date(A).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,yr.jsxs)("p",{className:"text-xs text-green-500 mt-1",children:["PDF + ",B||z||(null===i||void 0===i?void 0:i.length)||0," images attached"]})]}),(0,yr.jsx)("button",{onClick:xe,disabled:W,className:"w-full py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center space-x-2 text-sm",children:W?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(fc,{className:"w-4 h-4 animate-spin"}),(0,yr.jsx)("span",{children:"Resending..."})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(td,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Resend Delivery"})]})})]})]})]})]}):(0,yr.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 text-yellow-700 mb-2",children:[(0,yr.jsx)(qc,{className:"w-5 h-5"}),(0,yr.jsx)("span",{className:"font-medium",children:"Contract Data Missing"})]}),(0,yr.jsx)("p",{className:"text-sm text-yellow-600",children:"The contract was created but data is missing. Please check the console for details."})]})})]}),(0,yr.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-t flex justify-between flex-shrink-0",children:[(0,yr.jsxs)("div",{children:["edit"!==ie&&"send"!==ie&&(0,yr.jsxs)("button",{onClick:()=>le("review"===ie?"edit":"review"),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center space-x-1",children:[(0,yr.jsx)(dd,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Back"})]}),"send"===ie&&!b&&(0,yr.jsxs)("button",{onClick:()=>le("edit"),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center space-x-1",children:[(0,yr.jsx)(ud,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Edit Details"})]})]}),(0,yr.jsxs)("div",{className:"flex space-x-3",children:[(0,yr.jsx)("button",{onClick:he,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:b?"Done":"Cancel"}),"edit"===ie&&(0,yr.jsxs)("button",{onClick:()=>le("review"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-1",children:[(0,yr.jsx)("span",{children:"Review"}),(0,yr.jsx)(nd,{className:"w-4 h-4"})]}),"review"===ie&&(0,yr.jsx)("button",{onClick:async()=>{m(!0),g(null);try{const e=await fetch("/api/contracts/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({leadId:r.id,packageId:null===a||void 0===a?void 0:a.id,packageData:a,invoiceData:Ye(Ye({},o),pe),contractDetails:pe,selectedPhotoIds:i})}),t=await e.json();if(!e.ok)throw console.error("Contract creation error:",t),new Error(t.message||t.error||"Failed to create contract");const n=t.contract||t.success&&t.contract;if(console.log("Contract creation response:",{data:t,contractData:n}),!n)throw console.error("No contract returned from API:",t),new Error("Contract was not created - no contract data returned. Check console for details.");if(!n.id||!n.signingUrl)throw console.error("Contract data missing required fields:",n),new Error("Contract created but missing required fields (id or signingUrl)");y(n),le("send"),console.log("Contract created successfully, moving to send step")}catch(BB){console.error("Error creating contract:",BB),g(BB.message||"Failed to create contract. Please check the console for details.")}finally{m(!1)}},disabled:u,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:u?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(fc,{className:"w-4 h-4 animate-spin"}),(0,yr.jsx)("span",{children:"Creating..."})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(Hc,{className:"w-4 h-4"}),(0,yr.jsx)("span",{children:"Create Contract"})]})})]})]})]})})},hd=e=>{var t;let{isOpen:n,onClose:r,lead:a,initialChannel:o="sms"}=e;const[i,l]=(0,s.useState)(o),[c,d]=(0,s.useState)([]),[u,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)(""),[f,g]=(0,s.useState)(!1),[x,y]=(0,s.useState)({}),[b,v]=(0,s.useState)(!1),{socket:w}=Xa(),j=(0,s.useCallback)(async()=>{if(null===a||void 0===a||!a.id)return void console.error("\u274c No lead ID provided");m(!0);const e={steps:[],errors:[],apiMessages:0,filteredMessages:0};try{const l=localStorage.getItem("token");e.steps.push("Starting fetch for lead: "+a.id);let c=[];try{var t;e.steps.push("Calling /api/leads/".concat(a.id,"/messages..."));const n=(null===(t=(await xr.get("/api/leads/".concat(a.id,"/messages"),{headers:l?{Authorization:"Bearer ".concat(l)}:{}})).data)||void 0===t?void 0:t.messages)||[];e.apiMessages=n.length,e.steps.push("API returned ".concat(n.length," messages for lead")),c=n.filter(e=>{var t,n;const r=null===(t=e.action)||void 0===t?void 0:t.startsWith("EMAIL"),a=null===(n=e.action)||void 0===n?void 0:n.startsWith("SMS");return"email"===i?r:a}).map((e,t)=>{var n,r,s,o,i,l,c,d,u;return{id:e.id||"".concat(e.action,"_").concat(e.timestamp,"_").concat(t),leadId:a.id,type:null!==(n=e.action)&&void 0!==n&&n.startsWith("EMAIL")?"email":"sms",direction:(null===(r=e.details)||void 0===r?void 0:r.direction)||(null!==(s=e.action)&&void 0!==s&&s.includes("SENT")?"sent":"received"),content:(null===(o=e.details)||void 0===o?void 0:o.body)||(null===(i=e.details)||void 0===i?void 0:i.message)||"",subject:null===(l=e.details)||void 0===l?void 0:l.subject,email_body:(null===(c=e.details)||void 0===c?void 0:c.email_body)||(null===(d=e.details)||void 0===d?void 0:d.html_content),timestamp:e.timestamp,attachments:(null===(u=e.details)||void 0===u?void 0:u.attachments)||[],action:e.action}}),e.filteredMessages=c.length,e.steps.push("Filtered to ".concat(c.length," ").concat(i," messages"))}catch(r){e.errors.push("Lead messages API error: "+r.message),e.steps.push("API failed, trying booking history fallback...")}if(0===c.length)try{var n;e.steps.push("Trying booking history fallback...");const t=await xr.get("/api/leads/".concat(a.id),{headers:l?{Authorization:"Bearer ".concat(l)}:{}}),r=(null===(n=t.data)||void 0===n?void 0:n.lead)||t.data;let o=(null===r||void 0===r?void 0:r.bookingHistory)||(null===r||void 0===r?void 0:r.booking_history)||[];if("string"===typeof o)try{o=JSON.parse(o)}catch(s){o=[]}Array.isArray(o)||(o=[]);const d=o.filter(e=>["SMS_SENT","SMS_RECEIVED","EMAIL_SENT","EMAIL_RECEIVED"].includes(e.action)).map((e,t)=>{var n,r,s,o,i,l,c,d;return{id:"".concat(e.action,"_").concat(e.timestamp,"_").concat(t),leadId:a.id,type:null!==(n=e.action)&&void 0!==n&&n.startsWith("EMAIL")?"email":"sms",direction:null!==(r=e.action)&&void 0!==r&&r.includes("SENT")?"sent":"received",content:(null===(s=e.details)||void 0===s?void 0:s.body)||(null===(o=e.details)||void 0===o?void 0:o.message)||"",subject:null===(i=e.details)||void 0===i?void 0:i.subject,email_body:(null===(l=e.details)||void 0===l?void 0:l.email_body)||(null===(c=e.details)||void 0===c?void 0:c.html_content),timestamp:e.timestamp||e.created_at,attachments:(null===(d=e.details)||void 0===d?void 0:d.attachments)||[],action:e.action}}).filter(e=>"email"===i?"email"===e.type:"sms"===e.type);d.length>0&&(c=d,e.steps.push("Found ".concat(d.length," messages in booking history")))}catch(o){e.errors.push("Booking history fallback error: "+o.message)}const u=c.map(e=>{var t,n,r;return Ye(Ye({},e),{},{direction:e.direction||(e.isOutgoing||e.outgoing||e.sent||null!==(t=e.action)&&void 0!==t&&t.includes("SENT")?"sent":"received"),content:e.content||e.body||e.message||e.text||(null===(n=e.details)||void 0===n?void 0:n.body)||"",timestamp:e.timestamp||e.created_at||e.createdAt||e.date,email_body:e.email_body||e.htmlContent||e.html||null,subject:e.subject||(null===(r=e.details)||void 0===r?void 0:r.subject)})});u.sort((e,t)=>new Date(e.timestamp||0)-new Date(t.timestamp||0)),e.steps.push("Final message count: ".concat(u.length)),console.log("\u2705 Final: ".concat(u.length," messages to display")),d(u)}catch(l){e.errors.push("Fatal error: "+l.message),console.error("\u274c Error fetching messages:",l),d([])}finally{y(e),m(!1),console.log("\ud83d\udce8 Message Fetch Debug:",e)}},[null===a||void 0===a?void 0:a.id,i]);(0,s.useEffect)(()=>{n&&(console.log("\ud83d\udcf1 Modal opened, fetching messages..."),j())},[n,i,j]),(0,s.useEffect)(()=>{if(!w||!n||null===a||void 0===a||!a.id)return;const e=e=>{console.log("\ud83d\udce8 Real-time message received:",e),(null===e||void 0===e?void 0:e.leadId)!==a.id&&(null===e||void 0===e?void 0:e.lead_id)!==a.id||j()};return w.on("message_received",e),w.on("sms_received",e),w.on("email_received",e),()=>{w.off("message_received",e),w.off("sms_received",e),w.off("email_received",e)}},[w,n,null===a||void 0===a?void 0:a.id,j]),(0,s.useEffect)(()=>{c.length>0&&!u&&setTimeout(()=>{const e=document.getElementById("msg-scroll-container");e&&(e.scrollTop=e.scrollHeight)},100)},[c,u]);const N=async()=>{if(h.trim()&&!f){g(!0),v(!1);try{if("email"===i){const e=c.find(e=>"received"===e.direction||"sent"===e.direction),t=(null===e||void 0===e?void 0:e.subject)||"",n=t&&!t.startsWith("Re:")?"Re: ".concat(t):t||"Re: Your email";console.log("\ud83d\udce7 Sending email to:",a.email);const r=await xr.post("/api/leads/".concat(a.id,"/send-email"),{subject:n,body:h.trim()});r.data.success?(p(""),v(!0),setTimeout(()=>v(!1),3e3),j()):alert("Failed to send email: "+(r.data.message||"Unknown error"))}else{console.log("\ud83d\udcf1 Sending SMS to:",a.phone);const e=await xr.post("/api/leads/".concat(a.id,"/send-sms"),{message:h.trim(),type:"custom"});e.data.success?(p(""),v(!0),setTimeout(()=>v(!1),3e3),j()):alert("Failed to send SMS: "+(e.data.message||"Unknown error"))}}catch(n){var e,t;console.error("\u274c Error sending reply:",n),alert("Error sending message: "+((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||n.message))}finally{g(!1)}}},k=e=>{if(!e)return"";try{const t=new Date(e);if(isNaN(t.getTime()))return"";const n=new Date-t,r=n/864e5;if(n/36e5<1){const e=Math.floor(n/6e4);return e<=0?"Just now":"".concat(e,"m ago")}return r<1?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}):r<7?t.toLocaleDateString([],{weekday:"short"})+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString([],{month:"short",day:"numeric"})}catch(t){return""}},S=e=>{if(!e)return"";try{const t=new Date(e);if(isNaN(t.getTime()))return"";const n=new Date,r=t.toDateString()===n.toDateString(),a=new Date(n-864e5).toDateString()===t.toDateString();return r?"Today":a?"Yesterday":t.toLocaleDateString([],{weekday:"long",month:"short",day:"numeric"})}catch(t){return""}};if(!n||!a)return null;const C=!!a.email,_=!!a.phone;return(0,yr.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[100] p-4",children:(0,yr.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[85vh] flex flex-col overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[(0,yr.jsxs)("div",{className:"px-5 py-4 border-b flex items-center justify-between ".concat("email"===i?"bg-gradient-to-r from-indigo-500 to-purple-600":"bg-gradient-to-r from-blue-500 to-cyan-500"),children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("div",{className:"w-10 h-10 rounded-full bg-white/20 flex items-center justify-center",children:"email"===i?(0,yr.jsx)(Vs,{className:"w-5 h-5 text-white"}):(0,yr.jsx)(Ys,{className:"w-5 h-5 text-white"})}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("h3",{className:"text-white font-semibold text-lg leading-tight",children:["email"===i?"Email":"SMS"," with ",a.name]}),(0,yr.jsx)("p",{className:"text-white/70 text-xs",children:"email"===i?a.email:a.phone})]})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[C&&_&&(0,yr.jsxs)("div",{className:"flex bg-white/20 rounded-lg p-0.5 mr-2",children:[(0,yr.jsx)("button",{onClick:()=>l("sms"),className:"px-3 py-1.5 rounded-md text-xs font-medium transition-all ".concat("sms"===i?"bg-white text-blue-600 shadow-sm":"text-white hover:bg-white/10"),children:"SMS"}),(0,yr.jsx)("button",{onClick:()=>l("email"),className:"px-3 py-1.5 rounded-md text-xs font-medium transition-all ".concat("email"===i?"bg-white text-indigo-600 shadow-sm":"text-white hover:bg-white/10"),children:"Email"})]}),(0,yr.jsx)("button",{onClick:r,className:"p-2 hover:bg-white/20 rounded-full transition-colors",children:(0,yr.jsx)(ko,{className:"w-5 h-5 text-white"})})]})]}),(0,yr.jsx)("div",{id:"msg-scroll-container",className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50",children:u?(0,yr.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,yr.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):0===c.length?(0,yr.jsxs)("div",{className:"text-center py-12",children:["email"===i?(0,yr.jsx)(Vs,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}):(0,yr.jsx)(Ys,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,yr.jsxs)("p",{className:"text-sm text-gray-500",children:["No ",i," messages found"]}),x.steps&&(0,yr.jsxs)("div",{className:"mt-4 mx-4 p-3 bg-gray-100 rounded-lg text-left",children:[(0,yr.jsx)("p",{className:"text-xs font-semibold text-gray-600 mb-2",children:"Debug Info:"}),(0,yr.jsx)("ul",{className:"text-[10px] text-gray-500 space-y-1 max-h-32 overflow-y-auto",children:x.steps.map((e,t)=>(0,yr.jsx)("li",{className:"truncate",children:e},t))}),(null===(t=x.errors)||void 0===t?void 0:t.length)>0&&(0,yr.jsx)("div",{className:"mt-2 text-[10px] text-red-500",children:x.errors.map((e,t)=>(0,yr.jsx)("p",{children:e},t))})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-400 mt-3",children:"email"!==i||C?"sms"!==i||_?"Start the conversation below":"No phone number for this lead":"No email address for this lead"})]}):c.map((e,t)=>{var n;const r="sent"===e.direction,o=e.timestamp,l=c[t-1],d=null===l||void 0===l?void 0:l.timestamp,u=0===t||o&&d&&new Date(o).toDateString()!==new Date(d).toDateString();return(0,yr.jsxs)(s.Fragment,{children:[u&&(0,yr.jsx)("div",{className:"flex items-center justify-center my-4",children:(0,yr.jsx)("div",{className:"bg-gray-200 px-3 py-1 rounded-full text-xs text-gray-500",children:S(o)})}),(0,yr.jsx)("div",{className:"flex ".concat(r?"justify-end":"justify-start"),children:(0,yr.jsxs)("div",{className:"max-w-[85%] rounded-2xl shadow-sm overflow-hidden ".concat(r?"email"===i?"bg-indigo-500 text-white rounded-br-md":"bg-blue-500 text-white rounded-br-md":"bg-white border border-gray-200 text-gray-800 rounded-bl-md"),children:[(0,yr.jsxs)("div",{className:"px-4 py-2 text-xs font-medium flex items-center space-x-2 ".concat(r?"bg-black/10 text-white/80":"bg-gray-100 text-gray-600 border-b border-gray-200"),children:[(0,yr.jsx)(vo,{className:"w-3 h-3"}),(0,yr.jsx)("span",{children:r?"You":a.name}),e.subject&&(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("span",{className:"opacity-50",children:"\u2022"}),(0,yr.jsx)("span",{className:"truncate max-w-[150px]",children:e.subject})]})]}),(0,yr.jsxs)("div",{className:"px-4 py-3",children:["email"===i&&(e.email_body||e.htmlContent)?(0,yr.jsx)("div",{className:"max-h-64 overflow-y-auto bg-white rounded ".concat(""),children:(0,yr.jsx)(Do,{htmlContent:e.email_body||e.htmlContent||e.content,textContent:e.content,attachments:e.attachments||[],embeddedImages:e.embedded_images||[]})}):(0,yr.jsx)("p",{className:"text-sm whitespace-pre-wrap leading-relaxed ".concat(r?"text-white":"text-gray-800"),children:Oo(e.content||"No content")}),(null===(n=e.attachments)||void 0===n?void 0:n.length)>0&&(0,yr.jsxs)("div",{className:"mt-2 flex items-center space-x-1 text-xs ".concat(r?"text-white/70":"text-gray-500"),children:[(0,yr.jsx)($s,{className:"w-3 h-3"}),(0,yr.jsxs)("span",{children:[e.attachments.length," attachment",e.attachments.length>1?"s":""]})]})]}),(0,yr.jsxs)("div",{className:"px-4 py-1.5 flex items-center justify-end space-x-2 ".concat(r?"bg-black/10 text-white/60":"bg-gray-50 text-gray-400 border-t border-gray-100"),children:[(0,yr.jsx)(ws,{className:"w-3 h-3"}),(0,yr.jsx)("span",{className:"text-xs",children:k(o)}),r&&(0,yr.jsx)(gs,{className:"w-3 h-3"})]})]})})]},e.id||t)})}),(0,yr.jsx)("div",{className:"border-t border-gray-200 bg-white p-4",children:("email"===i?C:_)?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsxs)("div",{className:"flex items-end space-x-3",children:[(0,yr.jsxs)("div",{className:"flex-1 relative",children:[(0,yr.jsx)("textarea",{value:h,onChange:e=>p(e.target.value),placeholder:"Type your ".concat(i,"..."),rows:h.includes("\n")?3:1,className:"w-full px-4 py-3 pr-12 bg-gray-100 border-0 rounded-xl resize-none focus:ring-2 focus:ring-blue-500 focus:bg-white transition-all text-sm",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),N())}}),h.length>0&&(0,yr.jsx)("div",{className:"absolute right-3 bottom-3 text-xs text-gray-400",children:h.length})]}),(0,yr.jsx)("button",{onClick:N,disabled:!h.trim()||f,className:"p-3 rounded-xl transition-all ".concat(h.trim()&&!f?"email"===i?"bg-indigo-500 hover:bg-indigo-600 text-white shadow-lg shadow-indigo-200":"bg-blue-500 hover:bg-blue-600 text-white shadow-lg shadow-blue-200":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:f?(0,yr.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-current"}):(0,yr.jsx)(ao,{className:"w-5 h-5"})})]}),(0,yr.jsxs)("div",{className:"mt-2 flex items-center justify-between text-xs",children:[(0,yr.jsx)("span",{className:"text-gray-400",children:"Press Enter to send, Shift+Enter for new line"}),b?(0,yr.jsxs)("span",{className:"text-green-600 font-medium flex items-center",children:[(0,yr.jsx)(gs,{className:"w-3 h-3 mr-1"})," Sent!"]}):(0,yr.jsxs)("span",{className:"text-gray-400",children:["Replying to ","email"===i?a.email:a.phone]})]})]}):(0,yr.jsxs)("div",{className:"text-center py-3 text-amber-600 bg-amber-50 rounded-lg",children:[(0,yr.jsx)(os,{className:"w-4 h-4 inline mr-1"}),(0,yr.jsxs)("span",{className:"text-sm",children:["Cannot send ",i," - no ","email"===i?"email address":"phone number"," for this lead"]})]})})]})})},pd=[{time:"10:00",slot1Type:"child-male",slot1Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot1BorderColor:"border-yellow-300",slot1Label:"Child/Male",slot2Type:"female",slot2Color:"bg-pink-100",slot2BorderColor:"border-pink-200",slot2Label:"Female",slot3Type:"female",slot3Color:"bg-pink-100",slot3BorderColor:"border-pink-200",slot3Label:"Female"},{time:"10:30",slot1Type:"child-male",slot1Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot1BorderColor:"border-yellow-300",slot1Label:"Child/Male",slot2Type:"child-male",slot2Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot2BorderColor:"border-yellow-300",slot2Label:"Child/Male",slot3Type:"child-male",slot3Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot3BorderColor:"border-yellow-300",slot3Label:"Child/Male"},{time:"11:00",slot1Type:"female",slot1Color:"bg-pink-100",slot1BorderColor:"border-pink-200",slot1Label:"Female",slot2Type:"child-male",slot2Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot2BorderColor:"border-yellow-300",slot2Label:"Child/Male",slot3Type:"child-male",slot3Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot3BorderColor:"border-yellow-300",slot3Label:"Child/Male"},{time:"11:30",slot1Type:"female",slot1Color:"bg-pink-100",slot1BorderColor:"border-pink-200",slot1Label:"Female",slot2Type:"female",slot2Color:"bg-pink-100",slot2BorderColor:"border-pink-200",slot2Label:"Female",slot3Type:"female",slot3Color:"bg-pink-100",slot3BorderColor:"border-pink-200",slot3Label:"Female"},{time:"12:00",slot1Type:"child-male",slot1Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot1BorderColor:"border-yellow-300",slot1Label:"Child/Male",slot2Type:"male",slot2Color:"bg-blue-100",slot2BorderColor:"border-blue-200",slot2Label:"Male",slot3Type:"male",slot3Color:"bg-blue-100",slot3BorderColor:"border-blue-200",slot3Label:"Male"},{time:"12:30",slot1Type:"female",slot1Color:"bg-pink-100",slot1BorderColor:"border-pink-200",slot1Label:"Female",slot2Type:"female",slot2Color:"bg-pink-100",slot2BorderColor:"border-pink-200",slot2Label:"Female",slot3Type:"female",slot3Color:"bg-pink-100",slot3BorderColor:"border-pink-200",slot3Label:"Female"},{time:"13:00",slot1Type:"female",slot1Color:"bg-pink-100",slot1BorderColor:"border-pink-200",slot1Label:"Female",slot2Type:"male",slot2Color:"bg-blue-100",slot2BorderColor:"border-blue-200",slot2Label:"Male",slot3Type:"male",slot3Color:"bg-blue-100",slot3BorderColor:"border-blue-200",slot3Label:"Male"},{time:"13:30",slot1Type:"female",slot1Color:"bg-pink-100",slot1BorderColor:"border-pink-200",slot1Label:"Female",slot2Type:"child-male",slot2Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot2BorderColor:"border-yellow-300",slot2Label:"Male/Child",slot3Type:"child-male",slot3Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot3BorderColor:"border-yellow-300",slot3Label:"Male/Child"},{time:"14:00",slot1Type:"child-male",slot1Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot1BorderColor:"border-yellow-300",slot1Label:"Male/Child",slot2Type:"child-male",slot2Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot2BorderColor:"border-yellow-300",slot2Label:"Male/Child",slot3Type:"child-male",slot3Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot3BorderColor:"border-yellow-300",slot3Label:"Male/Child"},{time:"14:30",slot1Type:"female",slot1Color:"bg-pink-100",slot1BorderColor:"border-pink-200",slot1Label:"Female",slot2Type:"child-male",slot2Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot2BorderColor:"border-yellow-300",slot2Label:"Male/Child",slot3Type:"child-male",slot3Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot3BorderColor:"border-yellow-300",slot3Label:"Male/Child"},{time:"15:00",slot1Type:"female",slot1Color:"bg-pink-100",slot1BorderColor:"border-pink-200",slot1Label:"Female",slot2Type:"female",slot2Color:"bg-pink-100",slot2BorderColor:"border-pink-200",slot2Label:"Female",slot3Type:"female",slot3Color:"bg-pink-100",slot3BorderColor:"border-pink-200",slot3Label:"Female"},{time:"15:30",slot1Type:"child-male",slot1Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot1BorderColor:"border-yellow-300",slot1Label:"Male/Child",slot2Type:"child-male",slot2Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot2BorderColor:"border-yellow-300",slot2Label:"Male/Child",slot3Type:"child-male",slot3Color:"bg-gradient-to-r from-yellow-100 to-blue-100",slot3BorderColor:"border-yellow-300",slot3Label:"Male/Child"},{time:"16:00",slot1Type:"male",slot1Color:"bg-blue-100",slot1BorderColor:"border-blue-200",slot1Label:"Male",slot2Type:"male",slot2Color:"bg-blue-100",slot2BorderColor:"border-blue-200",slot2Label:"Male",slot3Type:"male",slot3Color:"bg-blue-100",slot3BorderColor:"border-blue-200",slot3Label:"Male"},{time:"16:30",slot1Type:"male",slot1Color:"bg-blue-100",slot1BorderColor:"border-blue-200",slot1Label:"Male",slot2Type:"male",slot2Color:"bg-blue-100",slot2BorderColor:"border-blue-200",slot2Label:"Male",slot3Type:"male",slot3Color:"bg-blue-100",slot3BorderColor:"border-blue-200",slot3Label:"Male"}],fd=e=>{let{selectedDate:t,events:n,blockedSlots:r=[],onSlotClick:a,onEventClick:o}=e;const[i,l]=(0,s.useState)(null),c=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!i)return;const e=e=>{c.current&&!c.current.contains(e.target)&&l(null)},t=e=>{"Escape"===e.key&&l(null)};return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}},[i]);const d=(0,s.useMemo)(()=>{if(!n||0===n.length)return new Map;const e=t.toISOString().split("T")[0],r=new Map;return n.forEach(t=>{if(!t.date_booked)return;if(new Date(t.date_booked).toISOString().split("T")[0]!==e)return;const n="".concat(t.time_booked||"","_").concat(t.booking_slot||1);r.has(n)||r.set(n,[]),r.get(n).push(t)}),r},[n,t]),u=(0,s.useMemo)(()=>{if(!r||0===r.length)return new Map;const e=new Map;return r.forEach(t=>{const n=new Date(t.date).toISOString().split("T")[0];e.has(n)||e.set(n,[]),e.get(n).push(t)}),e},[r]),m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=t.toISOString().split("T")[0],a=u.get(r)||[];return 0!==a.length&&a.some(t=>{if(!t.time_slot){if(n&&t.slot_number)return parseInt(t.slot_number)===parseInt(n);if(!t.slot_number)return!0}if(e&&t.time_slot===e){if(n&&t.slot_number)return parseInt(t.slot_number)===parseInt(n);if(!t.slot_number)return!0}return!1})},h=(e,t)=>{const n="".concat(e,"_").concat(t);return d.get(n)||[]},p=(e,t)=>{const n=h(e,t);return n.length>0?n[0]:null},f=e=>e?"Arrived"===e.booking_status?(0,yr.jsx)("span",{className:"inline-block w-3 h-3 rounded-full mr-2 shadow-sm",style:{backgroundColor:"#2563eb"}}):"Left"===e.booking_status?(0,yr.jsx)("span",{className:"inline-block w-3 h-3 rounded-full mr-2 shadow-sm",style:{backgroundColor:"#1f2937"}}):"No Show"===e.booking_status?(0,yr.jsx)("span",{className:"inline-block w-3 h-3 rounded-full mr-2 shadow-sm",style:{backgroundColor:"#ef4444"}}):"No Sale"===e.booking_status?(0,yr.jsx)("span",{className:"inline-block w-3 h-3 rounded-full mr-2 shadow-sm",style:{backgroundColor:"#b91c1c"}}):"Review"===e.booking_status?(0,yr.jsx)("span",{className:"inline-block w-3 h-3 rounded-full mr-2 shadow-sm",style:{backgroundColor:"#8b5cf6"}}):1==e.is_double_confirmed?(0,yr.jsx)("span",{className:"inline-block text-green-700 font-black text-sm mr-1",children:"\u2713\u2713"}):1==e.is_confirmed?(0,yr.jsx)(fs,{className:"inline-block w-5 h-5 text-green-500 mr-1"}):(0,yr.jsx)(ws,{className:"inline-block w-5 h-5 text-orange-400 mr-1"}):null,g=(e,t,n,r)=>{if(m(n,r))return"bg-gray-300 opacity-60";const a=1===r?e.slot1Color:2===r?e.slot2Color:e.slot3Color;return t?t.has_sale||"Arrived"===t.booking_status?"bg-blue-300":"Left"===t.booking_status?"bg-gray-400":"No Show"===t.booking_status?"bg-red-300":"No Sale"===t.booking_status?"bg-red-200":"Review"===t.booking_status?"bg-purple-300":1==t.is_double_confirmed?"bg-green-400":1==t.is_confirmed?"bg-green-300":"bg-orange-200":a};return(0,yr.jsxs)("div",{className:"slot-calendar-container",children:[(0,yr.jsxs)("div",{className:"mb-4",children:[(0,yr.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:t.toLocaleDateString("en-GB",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),(0,yr.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm",children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-4 h-4 bg-blue-100 border border-blue-200 rounded mr-2"}),(0,yr.jsx)("span",{children:"Male"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-4 h-4 bg-pink-100 border border-pink-200 rounded mr-2"}),(0,yr.jsx)("span",{children:"Female"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-4 h-4 bg-gradient-to-r from-yellow-100 to-blue-100 border border-yellow-300 rounded mr-2"}),(0,yr.jsx)("span",{children:"Child/Male"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-4 h-4 bg-gray-50 border border-gray-300 rounded mr-2"}),(0,yr.jsx)("span",{children:"Unavailable"})]})]}),(0,yr.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs mt-2 pt-2 border-t border-gray-200",children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 rounded-full mr-1 shadow-sm",style:{backgroundColor:"#fb923c"}}),(0,yr.jsx)("span",{className:"font-medium",children:"Unconfirmed"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 rounded-full mr-1 shadow-sm",style:{backgroundColor:"#22c55e"}}),(0,yr.jsx)("span",{className:"font-medium",children:"Confirmed"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 rounded-full mr-1 shadow-sm",style:{backgroundColor:"#15803d"}}),(0,yr.jsx)("span",{className:"font-medium",children:"Double Confirmed"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 rounded-full mr-1 shadow-sm",style:{backgroundColor:"#2563eb"}}),(0,yr.jsx)("span",{className:"font-medium",children:"Arrived"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 rounded-full mr-1 shadow-sm",style:{backgroundColor:"#1f2937"}}),(0,yr.jsx)("span",{className:"font-medium",children:"Left"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 rounded-full mr-1 shadow-sm",style:{backgroundColor:"#ef4444"}}),(0,yr.jsx)("span",{className:"font-medium",children:"No Show"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 rounded-full mr-1 shadow-sm",style:{backgroundColor:"#8b5cf6"}}),(0,yr.jsx)("span",{className:"font-medium",children:"Review"})]})]})]}),(0,yr.jsxs)("div",{className:"slot-calendar-grid border border-gray-300 rounded-lg overflow-hidden shadow-sm",children:[(0,yr.jsxs)("div",{className:"grid grid-cols-4 bg-gray-50 border-b border-gray-300",children:[(0,yr.jsx)("div",{className:"p-3 font-semibold text-center border-r border-gray-300",children:"TIME"}),(0,yr.jsx)("div",{className:"p-3 font-semibold text-center border-r border-gray-300",children:"SLOT 1"}),(0,yr.jsx)("div",{className:"p-3 font-semibold text-center border-r border-gray-300",children:"SLOT 2"}),(0,yr.jsx)("div",{className:"p-3 font-semibold text-center",children:"SLOT 3"})]}),pd.map((e,t)=>{const n=p(e.time,1),r=p(e.time,2),s=p(e.time,3),d=h(e.time,1),u=h(e.time,2),x=h(e.time,3),y=d.length>1?d.slice(1):[],b=u.length>1?u.slice(1):[],v=x.length>1?x.slice(1):[];return(0,yr.jsxs)("div",{className:"grid grid-cols-4 border-b border-gray-200 ".concat(t===pd.length-1?"border-b-0":""),children:[(0,yr.jsx)("div",{className:"p-4 font-medium text-center border-r border-gray-300 bg-gray-50 flex items-center justify-center",children:e.time}),(0,yr.jsxs)("div",{className:"p-4 border-r border-gray-300 ".concat(g(e,n,e.time,1)," ").concat(e.slot1BorderColor," ").concat(m(e.time,1)||"blank"===e.slot1Type?"cursor-not-allowed":"cursor-pointer hover:opacity-80"," transition-opacity min-h-[80px] flex items-center justify-center relative"),onClick:()=>{m(e.time,1)||"blank"===e.slot1Type||(n?o(n):a(e.time,1,e))},children:[m(e.time,1)?(0,yr.jsx)("div",{className:"text-center w-full",children:(0,yr.jsx)("div",{className:"font-semibold text-gray-600 flex items-center justify-center",children:(0,yr.jsx)("span",{className:"text-xs",children:"\ud83d\udd12 Blocked"})})}):"blank"===e.slot1Type?(0,yr.jsx)("div",{className:"text-center w-full",children:(0,yr.jsx)("div",{className:"font-semibold text-gray-500 flex items-center justify-center",children:(0,yr.jsx)("span",{className:"text-xs",children:"Unavailable"})})}):n?(0,yr.jsxs)("div",{className:"text-center w-full",children:[(0,yr.jsxs)("div",{className:"font-semibold text-gray-800 flex items-center justify-center",children:[f(n),(0,yr.jsx)("span",{className:"truncate",children:n.name}),n.hasUnreadSms||n.hasUnreadEmail?(0,yr.jsxs)("span",{className:"relative ml-1.5 flex-shrink-0 animate-pulse",children:[n.hasUnreadSms?(0,yr.jsx)(Ys,{className:"inline-block w-4 h-4 text-green-500"}):(0,yr.jsx)(Vs,{className:"inline-block w-4 h-4 text-blue-500"}),(0,yr.jsx)("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full border border-white animate-ping",style:{animationDuration:"1.5s"}}),(0,yr.jsx)("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full border border-white"})]}):n.hasReceivedSms||n.hasReceivedEmail?(0,yr.jsx)("span",{className:"ml-1.5 flex-shrink-0",children:n.hasReceivedSms?(0,yr.jsx)(Ys,{className:"inline-block w-3.5 h-3.5 text-gray-400"}):(0,yr.jsx)(Vs,{className:"inline-block w-3.5 h-3.5 text-gray-400"})}):null]}),n.phone&&(0,yr.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:n.phone})]}):(0,yr.jsx)("div",{className:"text-gray-400 text-sm text-center",children:"Click to Book"}),y.length>0&&(0,yr.jsxs)("div",{className:"absolute top-1 right-1",ref:(null===i||void 0===i?void 0:i.time)===e.time&&1===(null===i||void 0===i?void 0:i.slot)?c:null,children:[(0,yr.jsxs)("button",{className:"bg-red-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center shadow-md hover:bg-red-600 transition-colors",onClick:t=>{t.stopPropagation(),l((null===i||void 0===i?void 0:i.time)===e.time&&1===(null===i||void 0===i?void 0:i.slot)?null:{time:e.time,slot:1})},title:"".concat(y.length," more booking(s)"),children:["+",y.length]}),(null===i||void 0===i?void 0:i.time)===e.time&&1===(null===i||void 0===i?void 0:i.slot)&&(0,yr.jsxs)("div",{className:"absolute top-7 right-0 bg-white border border-gray-300 rounded-lg shadow-lg z-50 min-w-[180px] py-1",children:[(0,yr.jsxs)("div",{className:"px-3 py-1 text-xs font-semibold text-gray-500 border-b border-gray-200",children:["+",y.length," more booking",y.length>1?"s":""]}),y.map((e,t)=>(0,yr.jsxs)("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 flex items-center gap-2 transition-colors",onClick:t=>{t.stopPropagation(),l(null),o(e)},children:[f(e),(0,yr.jsx)("span",{className:"truncate font-medium",children:e.name})]},e.id||t))]})]})]}),(0,yr.jsxs)("div",{className:"p-4 ".concat(g(e,r,e.time,2)," ").concat(e.slot2BorderColor," ").concat(m(e.time,2)||"blank"===e.slot2Type?"cursor-not-allowed":"cursor-pointer hover:opacity-80"," transition-opacity min-h-[80px] flex items-center justify-center relative"),onClick:()=>{m(e.time,2)||"blank"===e.slot2Type||(r?o(r):a(e.time,2,e))},children:[m(e.time,2)?(0,yr.jsx)("div",{className:"text-center w-full",children:(0,yr.jsx)("div",{className:"font-semibold text-gray-600 flex items-center justify-center",children:(0,yr.jsx)("span",{className:"text-xs",children:"\ud83d\udd12 Blocked"})})}):"blank"===e.slot2Type?(0,yr.jsx)("div",{className:"text-center w-full",children:(0,yr.jsx)("div",{className:"font-semibold text-gray-500 flex items-center justify-center",children:(0,yr.jsx)("span",{className:"text-xs",children:"Unavailable"})})}):r?(0,yr.jsxs)("div",{className:"text-center w-full",children:[(0,yr.jsxs)("div",{className:"font-semibold text-gray-800 flex items-center justify-center",children:[f(r),(0,yr.jsx)("span",{className:"truncate",children:r.name}),r.hasUnreadSms||r.hasUnreadEmail?(0,yr.jsxs)("span",{className:"relative ml-1.5 flex-shrink-0 animate-pulse",children:[r.hasUnreadSms?(0,yr.jsx)(Ys,{className:"inline-block w-4 h-4 text-green-500"}):(0,yr.jsx)(Vs,{className:"inline-block w-4 h-4 text-blue-500"}),(0,yr.jsx)("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full border border-white animate-ping",style:{animationDuration:"1.5s"}}),(0,yr.jsx)("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full border border-white"})]}):r.hasReceivedSms||r.hasReceivedEmail?(0,yr.jsx)("span",{className:"ml-1.5 flex-shrink-0",children:r.hasReceivedSms?(0,yr.jsx)(Ys,{className:"inline-block w-3.5 h-3.5 text-gray-400"}):(0,yr.jsx)(Vs,{className:"inline-block w-3.5 h-3.5 text-gray-400"})}):null]}),r.phone&&(0,yr.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:r.phone})]}):(0,yr.jsx)("div",{className:"text-gray-400 text-sm text-center",children:"Click to Book"}),b.length>0&&(0,yr.jsxs)("div",{className:"absolute top-1 right-1",ref:(null===i||void 0===i?void 0:i.time)===e.time&&2===(null===i||void 0===i?void 0:i.slot)?c:null,children:[(0,yr.jsxs)("button",{className:"bg-red-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center shadow-md hover:bg-red-600 transition-colors",onClick:t=>{t.stopPropagation(),l((null===i||void 0===i?void 0:i.time)===e.time&&2===(null===i||void 0===i?void 0:i.slot)?null:{time:e.time,slot:2})},title:"".concat(b.length," more booking(s)"),children:["+",b.length]}),(null===i||void 0===i?void 0:i.time)===e.time&&2===(null===i||void 0===i?void 0:i.slot)&&(0,yr.jsxs)("div",{className:"absolute top-7 right-0 bg-white border border-gray-300 rounded-lg shadow-lg z-50 min-w-[180px] py-1",children:[(0,yr.jsxs)("div",{className:"px-3 py-1 text-xs font-semibold text-gray-500 border-b border-gray-200",children:["+",b.length," more booking",b.length>1?"s":""]}),b.map((e,t)=>(0,yr.jsxs)("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 flex items-center gap-2 transition-colors",onClick:t=>{t.stopPropagation(),l(null),o(e)},children:[f(e),(0,yr.jsx)("span",{className:"truncate font-medium",children:e.name})]},e.id||t))]})]})]}),(0,yr.jsxs)("div",{className:"p-4 ".concat(g(e,s,e.time,3)," ").concat(e.slot3BorderColor," ").concat(m(e.time,3)||"blank"===e.slot3Type?"cursor-not-allowed":"cursor-pointer hover:opacity-80"," transition-opacity min-h-[80px] flex items-center justify-center relative"),onClick:()=>{m(e.time,3)||"blank"===e.slot3Type||(s?o(s):a(e.time,3,e))},children:[m(e.time,3)?(0,yr.jsx)("div",{className:"text-center w-full",children:(0,yr.jsx)("div",{className:"font-semibold text-gray-600 flex items-center justify-center",children:(0,yr.jsx)("span",{className:"text-xs",children:"\ud83d\udd12 Blocked"})})}):"blank"===e.slot3Type?(0,yr.jsx)("div",{className:"text-center w-full",children:(0,yr.jsx)("div",{className:"font-semibold text-gray-500 flex items-center justify-center",children:(0,yr.jsx)("span",{className:"text-xs",children:"Unavailable"})})}):s?(0,yr.jsxs)("div",{className:"text-center w-full",children:[(0,yr.jsxs)("div",{className:"font-semibold text-gray-800 flex items-center justify-center",children:[f(s),(0,yr.jsx)("span",{className:"truncate",children:s.name}),s.hasUnreadSms||s.hasUnreadEmail?(0,yr.jsxs)("span",{className:"relative ml-1.5 flex-shrink-0 animate-pulse",children:[s.hasUnreadSms?(0,yr.jsx)(Ys,{className:"inline-block w-4 h-4 text-green-500"}):(0,yr.jsx)(Vs,{className:"inline-block w-4 h-4 text-blue-500"}),(0,yr.jsx)("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full border border-white animate-ping",style:{animationDuration:"1.5s"}}),(0,yr.jsx)("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full border border-white"})]}):s.hasReceivedSms||s.hasReceivedEmail?(0,yr.jsx)("span",{className:"ml-1.5 flex-shrink-0",children:s.hasReceivedSms?(0,yr.jsx)(Ys,{className:"inline-block w-3.5 h-3.5 text-gray-400"}):(0,yr.jsx)(Vs,{className:"inline-block w-3.5 h-3.5 text-gray-400"})}):null]}),s.phone&&(0,yr.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:s.phone})]}):(0,yr.jsx)("div",{className:"text-gray-400 text-sm text-center",children:"Click to Book"}),v.length>0&&(0,yr.jsxs)("div",{className:"absolute top-1 right-1",ref:(null===i||void 0===i?void 0:i.time)===e.time&&3===(null===i||void 0===i?void 0:i.slot)?c:null,children:[(0,yr.jsxs)("button",{className:"bg-red-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center shadow-md hover:bg-red-600 transition-colors",onClick:t=>{t.stopPropagation(),l((null===i||void 0===i?void 0:i.time)===e.time&&3===(null===i||void 0===i?void 0:i.slot)?null:{time:e.time,slot:3})},title:"".concat(v.length," more booking(s)"),children:["+",v.length]}),(null===i||void 0===i?void 0:i.time)===e.time&&3===(null===i||void 0===i?void 0:i.slot)&&(0,yr.jsxs)("div",{className:"absolute top-7 right-0 bg-white border border-gray-300 rounded-lg shadow-lg z-50 min-w-[180px] py-1",children:[(0,yr.jsxs)("div",{className:"px-3 py-1 text-xs font-semibold text-gray-500 border-b border-gray-200",children:["+",v.length," more booking",v.length>1?"s":""]}),v.map((e,t)=>(0,yr.jsxs)("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 flex items-center gap-2 transition-colors",onClick:t=>{t.stopPropagation(),l(null),o(e)},children:[f(e),(0,yr.jsx)("span",{className:"truncate font-medium",children:e.name})]},e.id||t))]})]})]})]},e.time)})]})]})},gd=[{time:"10:00",slot1Type:"child-male",slot1Emoji:"\ud83d\udc9b\ud83d\udd35",slot2Type:"female",slot2Emoji:"\ud83e\ude77",slot3Type:"female",slot3Emoji:"\ud83e\ude77"},{time:"10:30",slot1Type:"child-male",slot1Emoji:"\ud83d\udc9b\ud83d\udd35",slot2Type:"child-male",slot2Emoji:"\ud83d\udc9b\ud83d\udd35",slot3Type:"child-male",slot3Emoji:"\ud83d\udc9b\ud83d\udd35"},{time:"11:00",slot1Type:"female",slot1Emoji:"\ud83e\ude77",slot2Type:"child-male",slot2Emoji:"\ud83d\udc9b\ud83d\udd35",slot3Type:"child-male",slot3Emoji:"\ud83d\udc9b\ud83d\udd35"},{time:"11:30",slot1Type:"female",slot1Emoji:"\ud83e\ude77",slot2Type:"female",slot2Emoji:"\ud83e\ude77",slot3Type:"female",slot3Emoji:"\ud83e\ude77"},{time:"12:00",slot1Type:"child-male",slot1Emoji:"\ud83d\udc9b\ud83d\udd35",slot2Type:"male",slot2Emoji:"\ud83d\udd35",slot3Type:"male",slot3Emoji:"\ud83d\udd35"},{time:"12:30",slot1Type:"female",slot1Emoji:"\ud83e\ude77",slot2Type:"female",slot2Emoji:"\ud83e\ude77",slot3Type:"female",slot3Emoji:"\ud83e\ude77"},{time:"13:00",slot1Type:"female",slot1Emoji:"\ud83e\ude77",slot2Type:"male",slot2Emoji:"\ud83d\udd35",slot3Type:"male",slot3Emoji:"\ud83d\udd35"},{time:"13:30",slot1Type:"female",slot1Emoji:"\ud83e\ude77",slot2Type:"child-male",slot2Emoji:"\ud83d\udc9b\ud83d\udd35",slot3Type:"child-male",slot3Emoji:"\ud83d\udc9b\ud83d\udd35"},{time:"14:00",slot1Type:"child-male",slot1Emoji:"\ud83d\udc9b\ud83d\udd35",slot2Type:"child-male",slot2Emoji:"\ud83d\udc9b\ud83d\udd35",slot3Type:"child-male",slot3Emoji:"\ud83d\udc9b\ud83d\udd35"},{time:"14:30",slot1Type:"female",slot1Emoji:"\ud83e\ude77",slot2Type:"child-male",slot2Emoji:"\ud83d\udc9b\ud83d\udd35",slot3Type:"child-male",slot3Emoji:"\ud83d\udc9b\ud83d\udd35"},{time:"15:00",slot1Type:"female",slot1Emoji:"\ud83e\ude77",slot2Type:"female",slot2Emoji:"\ud83e\ude77",slot3Type:"female",slot3Emoji:"\ud83e\ude77"},{time:"15:30",slot1Type:"child-male",slot1Emoji:"\ud83d\udc9b\ud83d\udd35",slot2Type:"child-male",slot2Emoji:"\ud83d\udc9b\ud83d\udd35",slot3Type:"child-male",slot3Emoji:"\ud83d\udc9b\ud83d\udd35"},{time:"16:00",slot1Type:"male",slot1Emoji:"\ud83d\udd35",slot2Type:"male",slot2Emoji:"\ud83d\udd35",slot3Type:"male",slot3Emoji:"\ud83d\udd35"},{time:"16:30",slot1Type:"male",slot1Emoji:"\ud83d\udd35",slot2Type:"male",slot2Emoji:"\ud83d\udd35",slot3Type:"male",slot3Emoji:"\ud83d\udd35"}],xd=e=>{let{weekStart:t,events:n,blockedSlots:r=[],onDayClick:a,onEventClick:o}=e;const[i,l]=(0,s.useState)(null),c=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!i)return;const e=e=>{c.current&&!c.current.contains(e.target)&&l(null)},t=e=>{"Escape"===e.key&&l(null)};return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}},[i]);const d=(()=>{const e=[],n=new Date(t);for(let t=0;t<7;t++){const r=new Date(n);r.setDate(n.getDate()+t),e.push(r)}return e})(),u=(0,s.useMemo)(()=>{if(!n||0===n.length)return new Map;const e=new Map;return n.forEach(t=>{if(!t.date_booked)return;const n=new Date(t.date_booked).toISOString().split("T")[0],r="".concat(n,"_").concat(t.time_booked||"","_").concat(t.booking_slot||1);e.has(r)||e.set(r,[]),e.get(r).push(t)}),e},[n]),m=(0,s.useMemo)(()=>{if(!r||0===r.length)return new Map;const e=new Map;return r.forEach(t=>{const n=new Date(t.date).toISOString().split("T")[0];e.has(n)||e.set(n,[]),e.get(n).push(t)}),e},[r]),h=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=e.toISOString().split("T")[0],a=m.get(r)||[];return 0!==a.length&&a.some(e=>{if(!e.time_slot){if(n&&e.slot_number)return parseInt(e.slot_number)===parseInt(n);if(!e.slot_number)return!0}if(t&&e.time_slot===t){if(n&&e.slot_number)return parseInt(e.slot_number)===parseInt(n);if(!e.slot_number)return!0}return!1})},p=(e,t,n)=>{const r=e.toISOString().split("T")[0],a="".concat(r,"_").concat(t,"_").concat(n);return u.get(a)||[]},f=(e,t,n)=>{const r=p(e,t,n);return r.length>0?r[0]:null},g=e=>e?(0,yr.jsxs)("div",{className:"text-xs font-medium truncate flex items-center",title:e.name,children:[e.is_confirmed?(0,yr.jsx)(fs,{className:"inline-block w-3 h-3 text-green-600"}):(0,yr.jsx)(ws,{className:"inline-block w-3 h-3 text-orange-500"}),e.hasUnreadSms||e.hasUnreadEmail?(0,yr.jsxs)("span",{className:"relative ml-0.5 flex-shrink-0 animate-pulse",children:[e.hasUnreadSms?(0,yr.jsx)(Ys,{className:"inline-block w-3 h-3 text-green-500"}):(0,yr.jsx)(Vs,{className:"inline-block w-3 h-3 text-blue-500"}),(0,yr.jsx)("span",{className:"absolute -top-0.5 -right-0.5 w-1.5 h-1.5 bg-red-500 rounded-full"})]}):e.hasReceivedSms||e.hasReceivedEmail?(0,yr.jsx)("span",{className:"ml-0.5 flex-shrink-0",children:e.hasReceivedSms?(0,yr.jsx)(Ys,{className:"inline-block w-3 h-3 text-gray-400"}):(0,yr.jsx)(Vs,{className:"inline-block w-3 h-3 text-gray-400"})}):null]}):null,x=(e,t,n,r)=>h(t,n,r)?"bg-gray-300 opacity-60":e?e.has_sale?"bg-blue-400":e.is_confirmed?"bg-green-400":"Arrived"===e.booking_status?"bg-red-400":"Left"===e.booking_status?"bg-gray-400":"bg-orange-400":"bg-white";return(0,yr.jsxs)("div",{className:"weekly-slot-calendar-container",children:[(0,yr.jsx)("div",{className:"mb-4",children:(0,yr.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:["Week of ",t.toLocaleDateString("en-GB",{month:"long",day:"numeric",year:"numeric"})]})}),(0,yr.jsx)("div",{className:"overflow-x-auto",children:(0,yr.jsxs)("div",{className:"min-w-[1200px]",children:[(0,yr.jsxs)("div",{className:"grid grid-cols-[100px_repeat(7,1fr)] gap-0 border border-gray-300 rounded-lg overflow-hidden bg-white",children:[(0,yr.jsx)("div",{className:"bg-gray-50 border-r border-b border-gray-300 p-2 font-semibold text-center text-sm",children:"TIME"}),d.map((e,t)=>{const n=e.toDateString()===(new Date).toDateString(),s=r&&r.some(t=>{const n=e.toISOString().split("T")[0];return new Date(t.date).toISOString().split("T")[0]===n&&!t.time_slot&&!t.slot_number});return(0,yr.jsxs)("div",{className:"bg-gray-50 border-r border-b border-gray-300 p-2 text-center ".concat(s?"bg-gray-300 opacity-60 cursor-not-allowed":"cursor-pointer hover:bg-gray-100"," transition-colors ").concat(6===t?"border-r-0":""," ").concat(n&&!s?"bg-blue-50 font-bold":""),onClick:()=>{s?alert("This day is blocked and cannot be viewed"):a(e)},children:[(0,yr.jsx)("div",{className:"text-xs font-semibold",children:e.toLocaleDateString("en-GB",{weekday:"short"}).toUpperCase()}),(0,yr.jsx)("div",{className:"text-lg ".concat(n?"text-blue-600":""),children:e.getDate()}),(0,yr.jsx)("div",{className:"text-xs text-gray-500 flex justify-center gap-1 items-center",children:s?(0,yr.jsx)("span",{children:"\ud83d\udd12 Blocked"}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("span",{children:"S1"}),(0,yr.jsx)("span",{children:"S2"}),(0,yr.jsx)("span",{children:"S3"})]})})]},t)}),gd.map((e,t)=>(0,yr.jsxs)(s.Fragment,{children:[(0,yr.jsx)("div",{className:"bg-gray-50 border-r border-gray-300 p-2 text-center text-sm font-medium flex items-center justify-center ".concat(t===gd.length-1?"":"border-b"),children:e.time}),d.map((n,r)=>{const s=f(n,e.time,1),d=f(n,e.time,2),u=f(n,e.time,3),m=p(n,e.time,1),y=p(n,e.time,2),b=p(n,e.time,3),v=m.length>1?m.slice(1):[],w=y.length>1?y.slice(1):[],j=b.length>1?b.slice(1):[],N=n.toISOString().split("T")[0];return(0,yr.jsx)("div",{className:"border-r border-gray-300 p-1 ".concat(t===gd.length-1?"":"border-b"," ").concat(6===r?"border-r-0":""),children:(0,yr.jsxs)("div",{className:"grid grid-cols-3 gap-1 h-full",children:[(0,yr.jsxs)("div",{className:"compact-cell ".concat(x(s,n,e.time,1)," rounded ").concat(h(n,e.time,1)||"blank"===e.slot1Type?"cursor-not-allowed":"cursor-pointer hover:opacity-80"," transition-opacity flex items-center justify-center border border-gray-200 relative"),onClick:t=>{t.stopPropagation(),h(n,e.time,1)||"blank"===e.slot1Type||(s?o(s):a(n,e.time,1))},title:h(n,e.time,1)?"Blocked":"blank"===e.slot1Type?"Unavailable":s?"".concat(s.name," - Slot 1").concat(v.length?" (+".concat(v.length," more)"):""):"Book ".concat(e.time," Slot 1 (").concat(e.slot1Type,")"),children:[h(n,e.time,1)?(0,yr.jsx)("span",{className:"text-xs",children:"\ud83d\udd12"}):s?g(s):e.slot1Emoji&&(0,yr.jsx)("span",{className:"text-xs",children:e.slot1Emoji}),v.length>0&&(0,yr.jsxs)("div",{className:"absolute -top-1 -right-1",ref:(null===i||void 0===i?void 0:i.dateStr)===N&&(null===i||void 0===i?void 0:i.time)===e.time&&1===(null===i||void 0===i?void 0:i.slot)?c:null,children:[(0,yr.jsxs)("button",{className:"bg-red-500 text-white font-bold rounded-full flex items-center justify-center shadow-md hover:bg-red-600 transition-colors",style:{fontSize:"9px",width:"16px",height:"16px",lineHeight:"16px"},onClick:t=>{t.stopPropagation(),l((null===i||void 0===i?void 0:i.dateStr)===N&&(null===i||void 0===i?void 0:i.time)===e.time&&1===(null===i||void 0===i?void 0:i.slot)?null:{dateStr:N,time:e.time,slot:1})},title:"".concat(v.length," more booking(s)"),children:["+",v.length]}),(null===i||void 0===i?void 0:i.dateStr)===N&&(null===i||void 0===i?void 0:i.time)===e.time&&1===(null===i||void 0===i?void 0:i.slot)&&(0,yr.jsxs)("div",{className:"absolute top-5 right-0 bg-white border border-gray-300 rounded-lg shadow-lg z-50 min-w-[160px] py-1",children:[(0,yr.jsxs)("div",{className:"px-2 py-1 text-xs font-semibold text-gray-500 border-b border-gray-200",children:["+",v.length," more"]}),v.map((e,t)=>(0,yr.jsx)("button",{className:"w-full text-left px-2 py-1.5 text-xs hover:bg-gray-100 truncate transition-colors",onClick:t=>{t.stopPropagation(),l(null),o(e)},children:e.name},e.id||t))]})]})]}),(0,yr.jsxs)("div",{className:"compact-cell ".concat(x(d,n,e.time,2)," rounded ").concat(h(n,e.time,2)||"blank"===e.slot2Type?"cursor-not-allowed":"cursor-pointer hover:opacity-80"," transition-opacity flex items-center justify-center border border-gray-200 relative"),onClick:t=>{t.stopPropagation(),h(n,e.time,2)||"blank"===e.slot2Type||(d?o(d):a(n,e.time,2))},title:h(n,e.time,2)?"Blocked":"blank"===e.slot2Type?"Unavailable":d?"".concat(d.name," - Slot 2").concat(w.length?" (+".concat(w.length," more)"):""):"Book ".concat(e.time," Slot 2 (").concat(e.slot2Type,")"),children:[h(n,e.time,2)?(0,yr.jsx)("span",{className:"text-xs",children:"\ud83d\udd12"}):d?g(d):e.slot2Emoji&&(0,yr.jsx)("span",{className:"text-xs",children:e.slot2Emoji}),w.length>0&&(0,yr.jsxs)("div",{className:"absolute -top-1 -right-1",ref:(null===i||void 0===i?void 0:i.dateStr)===N&&(null===i||void 0===i?void 0:i.time)===e.time&&2===(null===i||void 0===i?void 0:i.slot)?c:null,children:[(0,yr.jsxs)("button",{className:"bg-red-500 text-white font-bold rounded-full flex items-center justify-center shadow-md hover:bg-red-600 transition-colors",style:{fontSize:"9px",width:"16px",height:"16px",lineHeight:"16px"},onClick:t=>{t.stopPropagation(),l((null===i||void 0===i?void 0:i.dateStr)===N&&(null===i||void 0===i?void 0:i.time)===e.time&&2===(null===i||void 0===i?void 0:i.slot)?null:{dateStr:N,time:e.time,slot:2})},title:"".concat(w.length," more booking(s)"),children:["+",w.length]}),(null===i||void 0===i?void 0:i.dateStr)===N&&(null===i||void 0===i?void 0:i.time)===e.time&&2===(null===i||void 0===i?void 0:i.slot)&&(0,yr.jsxs)("div",{className:"absolute top-5 right-0 bg-white border border-gray-300 rounded-lg shadow-lg z-50 min-w-[160px] py-1",children:[(0,yr.jsxs)("div",{className:"px-2 py-1 text-xs font-semibold text-gray-500 border-b border-gray-200",children:["+",w.length," more"]}),w.map((e,t)=>(0,yr.jsx)("button",{className:"w-full text-left px-2 py-1.5 text-xs hover:bg-gray-100 truncate transition-colors",onClick:t=>{t.stopPropagation(),l(null),o(e)},children:e.name},e.id||t))]})]})]}),(0,yr.jsxs)("div",{className:"compact-cell ".concat(x(u,n,e.time,3)," rounded ").concat(h(n,e.time,3)||"blank"===e.slot3Type?"cursor-not-allowed":"cursor-pointer hover:opacity-80"," transition-opacity flex items-center justify-center border border-gray-200 relative"),onClick:t=>{t.stopPropagation(),h(n,e.time,3)||"blank"===e.slot3Type||(u?o(u):a(n,e.time,3))},title:h(n,e.time,3)?"Blocked":"blank"===e.slot3Type?"Unavailable":u?"".concat(u.name," - Slot 3").concat(j.length?" (+".concat(j.length," more)"):""):"Book ".concat(e.time," Slot 3 (").concat(e.slot3Type,")"),children:[h(n,e.time,3)?(0,yr.jsx)("span",{className:"text-xs",children:"\ud83d\udd12"}):u?g(u):e.slot3Emoji&&(0,yr.jsx)("span",{className:"text-xs",children:e.slot3Emoji}),j.length>0&&(0,yr.jsxs)("div",{className:"absolute -top-1 -right-1",ref:(null===i||void 0===i?void 0:i.dateStr)===N&&(null===i||void 0===i?void 0:i.time)===e.time&&3===(null===i||void 0===i?void 0:i.slot)?c:null,children:[(0,yr.jsxs)("button",{className:"bg-red-500 text-white font-bold rounded-full flex items-center justify-center shadow-md hover:bg-red-600 transition-colors",style:{fontSize:"9px",width:"16px",height:"16px",lineHeight:"16px"},onClick:t=>{t.stopPropagation(),l((null===i||void 0===i?void 0:i.dateStr)===N&&(null===i||void 0===i?void 0:i.time)===e.time&&3===(null===i||void 0===i?void 0:i.slot)?null:{dateStr:N,time:e.time,slot:3})},title:"".concat(j.length," more booking(s)"),children:["+",j.length]}),(null===i||void 0===i?void 0:i.dateStr)===N&&(null===i||void 0===i?void 0:i.time)===e.time&&3===(null===i||void 0===i?void 0:i.slot)&&(0,yr.jsxs)("div",{className:"absolute top-5 right-0 bg-white border border-gray-300 rounded-lg shadow-lg z-50 min-w-[160px] py-1",children:[(0,yr.jsxs)("div",{className:"px-2 py-1 text-xs font-semibold text-gray-500 border-b border-gray-200",children:["+",j.length," more"]}),j.map((e,t)=>(0,yr.jsx)("button",{className:"w-full text-left px-2 py-1.5 text-xs hover:bg-gray-100 truncate transition-colors",onClick:t=>{t.stopPropagation(),l(null),o(e)},children:e.name},e.id||t))]})]})]})]})},"".concat(n.toISOString(),"-").concat(e.time))})]},e.time))]}),(0,yr.jsxs)("div",{className:"mt-4 flex flex-wrap gap-4 text-xs",children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("span",{className:"mr-2",children:"\ud83d\udd35"}),(0,yr.jsx)("span",{children:"Male"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("span",{className:"mr-2",children:"\ud83e\ude77"}),(0,yr.jsx)("span",{children:"Female"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("span",{className:"mr-2",children:"\ud83d\udc9b"}),(0,yr.jsx)("span",{children:"Family"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 bg-green-400 rounded mr-2"}),(0,yr.jsx)("span",{children:"Confirmed"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 bg-orange-400 rounded mr-2"}),(0,yr.jsx)("span",{children:"Unconfirmed"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 bg-blue-400 rounded mr-2"}),(0,yr.jsx)("span",{children:"Sale"})]})]})]})})]})},yd=e=>e.has_sale?"bg-blue-300":"Arrived"===e.booking_status?"bg-blue-400":"Left"===e.booking_status?"bg-gray-400":"No Show"===e.booking_status?"bg-red-400":"No Sale"===e.booking_status?"bg-red-300":"Review"===e.booking_status?"bg-purple-400":"Reschedule"===e.booking_status?"bg-yellow-400":1==e.is_double_confirmed?"bg-green-500":1==e.is_confirmed?"bg-green-400":"bg-orange-300",bd=e=>{const t=yd(e);return t.includes("500")||t.includes("400")?"text-white":"text-gray-800"},vd=e=>{let{currentDate:t,events:n,blockedSlots:r=[],onDayClick:a,onEventClick:o}=e;const i=(0,s.useMemo)(()=>{if(!n||0===n.length)return new Map;const e=new Map;return n.forEach(t=>{if(!t.date_booked)return;const n=new Date(t.date_booked).toISOString().split("T")[0];e.has(n)||e.set(n,[]),e.get(n).push(t)}),e},[n]),l=e=>{if(!e)return{slot1:[],slot2:[],slot3:[]};const t=e.toISOString().split("T")[0],n=i.get(t)||[];return{slot1:n.filter(e=>1===e.booking_slot),slot2:n.filter(e=>2===e.booking_slot),slot3:n.filter(e=>3===e.booking_slot)}},c=(()=>{const e=t.getFullYear(),n=t.getMonth(),r=new Date(e,n,1),a=new Date(e,n+1,0),s=r.getDay(),o=0===s?6:s-1,i=a.getDate(),l=[];for(let t=0;t<o;t++)l.push(null);for(let t=1;t<=i;t++)l.push(new Date(e,n,t));return l})(),d=t.toLocaleDateString("en-GB",{month:"long",year:"numeric"}),u=new Date;return u.setHours(0,0,0,0),(0,yr.jsxs)("div",{className:"monthly-slot-calendar-container",children:[(0,yr.jsxs)("div",{className:"mb-4",children:[(0,yr.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:d}),(0,yr.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs",children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 bg-orange-300 rounded mr-1"}),(0,yr.jsx)("span",{children:"Unconfirmed"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 bg-green-400 rounded mr-1"}),(0,yr.jsx)("span",{children:"Confirmed"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded mr-1"}),(0,yr.jsx)("span",{children:"Double \u2713\u2713"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 bg-blue-400 rounded mr-1"}),(0,yr.jsx)("span",{children:"Arrived"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 bg-red-400 rounded mr-1"}),(0,yr.jsx)("span",{children:"No Show"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 bg-purple-400 rounded mr-1"}),(0,yr.jsx)("span",{children:"Review"})]})]})]}),(0,yr.jsxs)("div",{className:"bg-white border border-gray-300 rounded-lg overflow-hidden shadow-sm",children:[(0,yr.jsx)("div",{className:"grid grid-cols-7 bg-gray-50 border-b border-gray-300",children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(e=>(0,yr.jsx)("div",{className:"p-2 text-center font-semibold text-sm text-gray-700 border-r border-gray-200 last:border-r-0",children:e},e))}),(0,yr.jsx)("div",{className:"grid grid-cols-7",children:c.map((e,t)=>{if(!e)return(0,yr.jsx)("div",{className:"min-h-[100px] border-r border-b border-gray-200 bg-gray-50"},"empty-".concat(t));const{total:n,confirmed:s,slot1Count:i,slot2Count:c,slot3Count:d,unreadSms:m,unreadEmail:h,readSms:p,readEmail:f}=(e=>{const{slot1:t,slot2:n,slot3:r}=l(e),a=[...t,...n,...r],s=a.length,o=a.filter(e=>e.is_confirmed).length,i=a.filter(e=>e.hasUnreadSms).length,c=a.filter(e=>e.hasUnreadEmail).length,d=a.filter(e=>e.hasReceivedSms&&!e.hasUnreadSms).length,u=a.filter(e=>e.hasReceivedEmail&&!e.hasUnreadEmail).length;return{total:s,confirmed:o,slot1Count:t.length,slot2Count:n.length,slot3Count:r.length,unreadSms:i,unreadEmail:c,readSms:d,readEmail:u}})(e),g=e.toDateString()===u.toDateString(),x=e<u,{slot1:y,slot2:b,slot3:v}=l(e),w=(e=>{if(!e||!r||0===r.length)return!1;const t=e.toISOString().split("T")[0];return r.some(e=>new Date(e.date).toISOString().split("T")[0]===t&&!e.time_slot&&!e.slot_number)})(e);return(0,yr.jsxs)("div",{className:"min-h-[100px] border-r border-b border-gray-200 p-2 ".concat(w?"bg-gray-300 opacity-60 cursor-not-allowed":"cursor-pointer hover:bg-gray-50"," transition-colors ").concat(g&&!w?"bg-blue-50 border-2 border-blue-500":""," ").concat(x&&!w?"bg-gray-50":""),onClick:()=>{w?alert("This day is blocked and cannot be viewed"):a(e)},children:[(0,yr.jsxs)("div",{className:"text-sm font-semibold mb-2 flex items-center justify-between ".concat(w?"text-gray-600":g?"text-blue-600":x?"text-gray-400":"text-gray-700"),children:[(0,yr.jsx)("span",{children:e.getDate()}),w&&(0,yr.jsx)("span",{className:"text-xs",children:"\ud83d\udd12"})]}),n>0&&(0,yr.jsxs)("div",{className:"space-y-1",children:[i>0&&(0,yr.jsxs)("div",{className:"flex items-center gap-1",children:[(0,yr.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,yr.jsxs)("span",{className:"text-xs text-gray-600",children:["S1: ",i]})]}),c>0&&(0,yr.jsxs)("div",{className:"flex items-center gap-1",children:[(0,yr.jsx)("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),(0,yr.jsxs)("span",{className:"text-xs text-gray-600",children:["S2: ",c]})]}),d>0&&(0,yr.jsxs)("div",{className:"flex items-center gap-1",children:[(0,yr.jsx)("div",{className:"w-2 h-2 bg-teal-500 rounded-full"}),(0,yr.jsxs)("span",{className:"text-xs text-gray-600",children:["S3: ",d]})]}),s>0&&(0,yr.jsxs)("div",{className:"flex items-center gap-1",children:[(0,yr.jsx)(fs,{className:"w-3 h-3 text-green-600"}),(0,yr.jsx)("span",{className:"text-xs text-green-600",children:s})]}),(0,yr.jsxs)("div",{className:"mt-1 space-y-0.5",children:[[...y,...b,...v].slice(0,3).map((e,t)=>{var n;return(0,yr.jsxs)("div",{className:"text-xs truncate px-1.5 py-0.5 rounded cursor-pointer transition-all hover:opacity-80 ".concat(yd(e)," ").concat(bd(e)),onClick:t=>{t.stopPropagation(),o(e)},title:"".concat(e.name," - ").concat(e.booking_status||(1==e.is_double_confirmed?"Double Confirmed":1==e.is_confirmed?"Confirmed":"Unconfirmed")),children:[e.time_booked?"".concat(e.time_booked.slice(0,5)," "):"",null===(n=e.name)||void 0===n?void 0:n.split(" ")[0],e.hasUnreadSms?(0,yr.jsx)(Ys,{className:"inline-block w-2.5 h-2.5 text-green-500 ml-0.5 animate-pulse"}):e.hasUnreadEmail?(0,yr.jsx)(Vs,{className:"inline-block w-2.5 h-2.5 text-blue-500 ml-0.5 animate-pulse"}):e.hasReceivedSms?(0,yr.jsx)(Ys,{className:"inline-block w-2.5 h-2.5 text-gray-400 ml-0.5"}):e.hasReceivedEmail?(0,yr.jsx)(Vs,{className:"inline-block w-2.5 h-2.5 text-gray-400 ml-0.5"}):null]},e.id)}),(n>3||m>0||h>0||p>0||f>0)&&(0,yr.jsxs)("div",{className:"flex flex-wrap md:flex-nowrap items-center gap-1 md:gap-1.5 mt-0.5",children:[n>3&&(0,yr.jsxs)("span",{className:"text-xs text-gray-500 font-medium mr-auto",children:["+",n-3," more"]}),m>0&&(0,yr.jsxs)("span",{className:"inline-flex items-center gap-0.5 text-[10px] font-semibold text-green-700 bg-green-100 px-1 py-0.5 rounded animate-pulse",title:"".concat(m," unread SMS"),children:[(0,yr.jsx)(Ys,{className:"w-2.5 h-2.5"}),m]}),h>0&&(0,yr.jsxs)("span",{className:"inline-flex items-center gap-0.5 text-[10px] font-semibold text-blue-700 bg-blue-100 px-1 py-0.5 rounded animate-pulse",title:"".concat(h," unread emails"),children:[(0,yr.jsx)(Vs,{className:"w-2.5 h-2.5"}),h]}),p>0&&(0,yr.jsxs)("span",{className:"inline-flex items-center gap-0.5 text-[10px] text-gray-500 bg-gray-100 px-1 py-0.5 rounded",title:"".concat(p," read SMS"),children:[(0,yr.jsx)(Ys,{className:"w-2.5 h-2.5"}),p]}),f>0&&(0,yr.jsxs)("span",{className:"inline-flex items-center gap-0.5 text-[10px] text-gray-500 bg-gray-100 px-1 py-0.5 rounded",title:"".concat(f," read emails"),children:[(0,yr.jsx)(Vs,{className:"w-2.5 h-2.5"}),f]})]})]})]})]},e.toISOString())})})]})]})},wd=["_id"],jd=["has_received_email","has_received_sms","has_unread_email","has_unread_sms","hasReceivedEmail","hasReceivedSms","hasUnreadEmail","hasUnreadSms"],Nd=["has_received_email","has_received_sms","has_unread_email","has_unread_sms","hasReceivedEmail","hasReceivedSms","hasUnreadEmail","hasUnreadSms"],kd=()=>{var e,t,n,r,a,o,i,l,c,d,u,m,h,p,f,g,x,y,b,v,w,j,N,k,S,C,_,E,P,O,A,T,D,M,I,L,R,F,B,U,z,V,W,q,H,Y,G,X,$,K,Q,Z,ee,te,ne,re,ae,se,oe,ie,le,ce,de,ue,me,he,pe,fe;const{user:ge}=Nr(),xe=J(),[ye,be]=Ae(),[ve,we]=(0,s.useState)([]),[je,Ne]=(0,s.useState)(0),[ke,Se]=(0,s.useState)(null),[Ce,_e]=(0,s.useState)(!1),[Ee,Pe]=(0,s.useState)(!1),[Oe,Te]=(0,s.useState)(!1),[De,Me]=(0,s.useState)("sms"),[Ie,Le]=(0,s.useState)(!1),[Re,Fe]=(0,s.useState)(!1),[Be,Ue]=(0,s.useState)(!1),[ze,Ve]=(0,s.useState)("sms"),[We,qe]=(0,s.useState)(!1),[He,Ge]=(0,s.useState)(""),[Xe,$e]=(0,s.useState)(""),[Ke,Je]=(0,s.useState)([]),[Qe,Ze]=(0,s.useState)(!1),[et,tt]=(0,s.useState)(!1),[nt,rt]=(0,s.useState)(!1),[at,st]=(0,s.useState)({date_of_birth:"",height_inches:"",chest_inches:"",waist_inches:"",hips_inches:"",eye_color:"",hair_color:"",hair_length:""}),ot=[{time:"10:00",label:"10:00 AM"},{time:"10:30",label:"10:30 AM"},{time:"11:00",label:"11:00 AM"},{time:"11:30",label:"11:30 AM"},{time:"12:00",label:"12:00 PM"},{time:"12:30",label:"12:30 PM"},{time:"13:00",label:"1:00 PM"},{time:"13:30",label:"1:30 PM"},{time:"14:00",label:"2:00 PM"},{time:"14:30",label:"2:30 PM"},{time:"15:00",label:"3:00 PM"},{time:"15:30",label:"3:30 PM"},{time:"16:00",label:"4:00 PM"},{time:"16:30",label:"4:30 PM"}],it=(0,s.useCallback)(async e=>{if(e){Ze(!0);try{const t=(await xr.get("/api/blocked-slots",{params:{start_date:e,end_date:e}})).data||[],n=(new Date(e),ve.filter(t=>{if(!t.date_booked)return!1;return new Date(t.date_booked).toISOString().split("T")[0]===e})),r=[];ot.forEach(e=>{const a=t.some(t=>(!t.time_slot||t.time_slot===e.time)&&(!t.slot_number||1===parseInt(t.slot_number))),s=n.some(t=>t.time_booked===e.time&&1===parseInt(t.booking_slot)),o=t.some(t=>(!t.time_slot||t.time_slot===e.time)&&(!t.slot_number||2===parseInt(t.slot_number))),i=n.some(t=>t.time_booked===e.time&&2===parseInt(t.booking_slot)),l=t.some(t=>(!t.time_slot||t.time_slot===e.time)&&(!t.slot_number||3===parseInt(t.slot_number))),c=n.some(t=>t.time_booked===e.time&&3===parseInt(t.booking_slot));a||s||r.push({time:e.time,slot:1,label:"".concat(e.label," - Slot 1")}),o||i||r.push({time:e.time,slot:2,label:"".concat(e.label," - Slot 2")}),l||c||r.push({time:e.time,slot:3,label:"".concat(e.label," - Slot 3")})}),Je(r)}catch(t){console.error("Error fetching available slots:",t);const e=[];ot.forEach(t=>{e.push({time:t.time,slot:1,label:"".concat(t.label," - Slot 1")}),e.push({time:t.time,slot:2,label:"".concat(t.label," - Slot 2")}),e.push({time:t.time,slot:3,label:"".concat(t.label," - Slot 3")})}),Je(e)}finally{Ze(!1)}}else Je([])},[ve]),lt=(0,s.useRef)(new Set),[ct,dt]=(0,s.useState)(new Set),[ut,mt]=(0,s.useState)(!1),[ht,pt]=(0,s.useState)(()=>{const e=Pl();return{dateStr:e.toISOString(),date:e}}),[ft,gt]=(0,s.useState)(new Date),xt=(0,s.useRef)(null),yt=(0,s.useRef)(new Set),bt=(0,s.useRef)(!0),vt=(0,s.useRef)(0),wt=(0,s.useRef)(null),{socket:jt,subscribeToCalendarUpdates:Nt,subscribeToLeadUpdates:kt,isConnected:St,emitCalendarUpdate:Ct}=Xa(),[_t,Et]=(0,s.useState)({_id:"",name:"",phone:"",email:"",postcode:"",status:"New",notes:"",image_url:"",isReschedule:!1,booking_slot:1,time_booked:""}),[Pt,Ot]=(0,s.useState)(!1),[At,Tt]=(0,s.useState)(!1),[Dt,Mt]=(0,s.useState)(!1),[It,Lt]=(0,s.useState)(null),[Rt,Ft]=(0,s.useState)(!1),[Bt,Ut]=(0,s.useState)(null),[zt,Vt]=(0,s.useState)(null),[Wt,qt]=(0,s.useState)(!1),[Ht,Yt]=(0,s.useState)([]),[Gt,Xt]=(0,s.useState)([]),[$t,Kt]=(0,s.useState)(null),[Jt,Qt]=(0,s.useState)(!1),[Zt,en]=(0,s.useState)(null),[tn,nn]=(0,s.useState)(!1),[rn,an]=(0,s.useState)(""),[sn,on]=(0,s.useState)(!0),[ln,cn]=(0,s.useState)(!0),[dn,un]=(0,s.useState)(null),[mn,hn]=(0,s.useState)([]),[pn,fn]=(0,s.useState)(null),[gn,xn]=(0,s.useState)([]),[yn,bn]=(0,s.useState)(!1),[vn,wn]=(0,s.useState)("primary"),jn=(0,s.useMemo)(()=>dn&&mn.length?mn.find(e=>e._id===dn)||mn[0]:null,[dn,mn]),Nn=!1!==(null===jn||void 0===jn?void 0:jn.sendEmail),kn=!1!==(null===jn||void 0===jn?void 0:jn.sendSMS),[Sn,Cn]=(0,s.useState)(!1),[_n,En]=(0,s.useState)(!1),[Pn,On]=(0,s.useState)(""),[An,Tn]=(0,s.useState)(()=>localStorage.getItem("calendarView")||"monthly"),[Dn,Mn]=(0,s.useState)(()=>{const e=localStorage.getItem("calendarDate");if(e)try{const t=new Date(e);if(!isNaN(t.getTime()))return t}catch(FB){}return Pl()}),[In,Ln]=(0,s.useState)(1),[Rn,Fn]=(0,s.useState)(""),[Bn,Un]=(0,s.useState)([]),[zn,Vn]=(0,s.useState)(!1),[Wn,qn]=(0,s.useState)("Duplicate"),[Hn,Yn]=(0,s.useState)(!1),[Gn,Xn]=(0,s.useState)(null),[$n,Kn]=(0,s.useState)([]),[Jn,Qn]=(0,s.useState)(0),[Zn,er]=(0,s.useState)(!1),[tr,nr]=(0,s.useState)(!1),[rr,ar]=(0,s.useState)(null),[sr,or]=(0,s.useState)(!1),ir=(0,s.useRef)(null),[lr,cr]=(0,s.useState)(!1),[dr,ur]=(0,s.useState)(!1),[mr,hr]=(0,s.useState)(0),[pr,fr]=(0,s.useState)({current:0,total:0,currentFileName:""}),[gr,br]=(0,s.useState)(!1),vr=(0,s.useRef)(null),[wr,jr]=(0,s.useState)(null),[kr,Sr]=(0,s.useState)("all"),Cr=[{id:"headshots",label:"Headshots",icon:"\ud83d\udc64"},{id:"zcard",label:"Z-Card",icon:"\ud83d\udcc7"},{id:"best-pics",label:"Best Pics",icon:"\u2b50"}],[_r,Er]=(0,s.useState)(!1),[Pr,Or]=(0,s.useState)(0),Ar=(0,s.useRef)(null),Tr=(0,s.useCallback)(()=>{_e(!1),be({},{replace:!0}),Yt([]),Xt([]),Kn([]),Qn(0),setTimeout(()=>{wt.current&&wt.current(!0)},100)},[be]),Dr=(0,s.useCallback)(function(e,t){if(t&&"attended"===(null===e||void 0===e?void 0:e.toLowerCase()))return"#2563eb";if(t)return"#2563eb";switch(null===e||void 0===e?void 0:e.toLowerCase()){case"new":case"rescheduled":case"reschedule":return"#f97316";case"unconfirmed":return"#fb923c";case"double confirmed":return"#15803d";case"confirmed":return"#22c55e";case"unassigned":default:return"#6b7280";case"booked":return"#3b82f6";case"arrived":case"attended":case"complete":return"#2563eb";case"left":return"#1f2937";case"on show":return"#f59e0b";case"no sale":return"#b91c1c";case"cancelled":return"#f43f5e";case"no show":case"not interested":return"#ef4444";case"review":case"assigned":case"callback":return"#8b5cf6";case"contacted":return"#06b6d4";case"interested":return"#10b981"}},[]),Mr=(0,s.useCallback)(async()=>{try{var e;let t,n;if("daily"===An){const e=Dn.toISOString().split("T")[0];t=e,n=e}else if("weekly"===An){const e=new Date(Dn),r=e.getDay(),a=e.getDate()-r+(0===r?-6:1);e.setDate(a),t=e.toISOString().split("T")[0];const s=new Date(e);s.setDate(e.getDate()+6),n=s.toISOString().split("T")[0]}else{const e=new Date(Dn.getFullYear(),Dn.getMonth(),1),r=new Date(Dn.getFullYear(),Dn.getMonth()+1,0);t=e.toISOString().split("T")[0],n=r.toISOString().split("T")[0]}const r=await xr.get("/api/blocked-slots",{params:{start_date:t,end_date:n}});Un(r.data||[]),console.log("\ud83d\udd12 Fetched ".concat((null===(e=r.data)||void 0===e?void 0:e.length)||0," blocked slots for ").concat(t," to ").concat(n))}catch(t){console.error("Error fetching blocked slots:",t),Un([])}},[Dn,An]),Ir=(0,s.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e&&(console.log("\ud83d\udcc5 Force refresh: Clearing calendar cache"),lt.current=new Set,dt(new Set),we([])),_r&&!e)return void console.log("\ud83d\udcc5 Calendar: Fetch already in progress, skipping...");const t=Date.now();if(!e&&t-vt.current<3e3)console.log("\ud83d\udcc5 Calendar: Fetch debounced, too soon since last fetch");else{Ar.current&&(clearTimeout(Ar.current),Ar.current=null),Er(!0),vt.current=t;try{console.log("\ud83d\udcc5 Fetching calendar events...");const t=new Date,n=new Date(t);n.setFullYear(n.getFullYear()-5),n.setMonth(0),n.setDate(1),n.setHours(0,0,0,0);const r=new Date(t);r.setFullYear(r.getFullYear()+5),r.setMonth(11),r.setDate(31),r.setHours(23,59,59,999);const a="ALL_BOOKINGS";if(!e&&lt.current.has(a))return console.log("\ud83d\udcc5 All bookings already loaded, skipping fetch"),void Er(!1);const s="&start=".concat(n.toISOString(),"&end=").concat(r.toISOString());console.log("\ud83d\udcc5 Fetching ALL bookings from ".concat(n.toLocaleDateString()," to ").concat(r.toLocaleDateString()," (10 year range)"));const o=e?"?t=".concat(Date.now()).concat(s,"&limit=10000"):"".concat(s,"&limit=10000"),i=await xr.get("/api/leads/calendar".concat(o),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},timeout:15e3}),l=i.data.leads||[];console.log("\ud83d\udcc5 Received ".concat(l.length," leads from server")),0===l.length?console.log("\ud83d\udcc5 No leads received from server. Full response:",i.data):console.log("\ud83d\udcc5 Leads received:",l.map(e=>({name:e.name,status:e.status,date_booked:e.date_booked,time_booked:e.time_booked,booking_slot:e.booking_slot})));const c=l.filter(e=>e?!!e.id||(console.warn("\u26a0\ufe0f Lead missing ID:",e),!1):(console.warn("\u26a0\ufe0f Skipping null/undefined lead"),!1)),d=c.filter(e=>e.image_url&&""!==e.image_url);console.log("\ud83d\udcf8 Calendar: ".concat(d.length," out of ").concat(c.length," leads have image_url")),d.length>0&&console.log("\ud83d\udcf8 Sample leads with images:",d.slice(0,3).map(e=>{var t;return{name:e.name,image_url:e.image_url,hasImageUrl:!!e.image_url,imageUrlLength:null===(t=e.image_url)||void 0===t?void 0:t.length}}));const u=c.filter(e=>"image_url"in e);console.log("\ud83d\udcf8 Leads with image_url property: ".concat(u.length,"/").concat(c.length));const m=c.filter(e=>{const t=e.date_booked&&null!==e.date_booked&&"null"!==e.date_booked,n="Booked"===e.status&&!e.date_booked,r=!e.deleted_at,a="Cancelled"!==e.status&&"Rejected"!==e.status;return(t||n)&&r&&a}).map(e=>{var t;let n;if(e.date_booked&&null!==e.date_booked&&"null"!==e.date_booked){if(n=new Date(e.date_booked),isNaN(n.getTime()))return console.warn("Invalid date for lead ".concat(e.name,": ").concat(e.date_booked)),null}else{if("Booked"!==e.status)return null;e.updated_at?n=new Date(e.updated_at):(n=new Date,n.setHours(9,0,0,0))}const r=new Date(n);r.setMinutes(r.getMinutes()+30);let a,s=e.booking_history||[];if(!Array.isArray(s))try{s="string"===typeof s?JSON.parse(s):[]}catch(FB){console.warn("Failed to parse bookingHistory:",FB),s=[]}const o=e.date_booked&&null!==e.date_booked&&"null"!==e.date_booked;a=e.booking_status?e.booking_status:"Booked"===e.status?!o&&e.updated_at?"Booked":o?e.is_confirmed?"Confirmed":"Unconfirmed":"Unassigned":e.status;const i=e.is_double_confirmed||!1;i&&"Confirmed"===a&&(a="Double Confirmed");return{id:e.id,title:"".concat(e.name," - ").concat(a||e.status),start:n.toISOString(),end:r.toISOString(),allDay:!1,backgroundColor:Dr(a,e.hasSale,e.is_confirmed,i),borderColor:Dr(a,e.hasSale,e.is_confirmed,i),name:e.name,phone:e.phone,email:e.email,date_booked:e.date_booked,time_booked:e.time_booked,booking_slot:e.booking_slot,is_confirmed:e.is_confirmed,is_double_confirmed:i,booking_status:e.booking_status,has_sale:e.hasSale,hasUnreadSms:e.has_unread_sms||!1,hasUnreadEmail:e.has_unread_email||!1,hasReceivedSms:e.has_received_sms||!1,hasReceivedEmail:e.has_received_email||!1,extendedProps:{lead:Ye(Ye({},e),{},{bookingHistory:s}),phone:e.phone,status:e.status,displayStatus:a,booker:(null===(t=e.booker)||void 0===t?void 0:t.name)||e.booker_name||"N/A",isConfirmed:e.is_confirmed||!1,isDoubleConfirmed:i}}}).filter(e=>null!==e);console.log("\ud83d\udcc5 Calendar: Created ".concat(m.length," server events")),m.length>0&&console.log("\ud83d\udcc5 Sample event structure:",{id:m[0].id,name:m[0].name,date_booked:m[0].date_booked,time_booked:m[0].time_booked,booking_slot:m[0].booking_slot,start:m[0].start});const h=new Set,p=m.filter(e=>h.has(e.id)?(console.warn("\ud83d\udcc5 Duplicate event found for lead: ".concat(e.title)),!1):(h.add(e.id),!0));console.log("\ud83d\udcc5 Calendar: Final events array has ".concat(p.length," unique events")),lt.current.add(a),dt(new Set(lt.current)),console.log("\ud83d\udcc5 Marked all bookings as loaded (".concat(p.length," events)")),we(e=>{const t=new Set(e.map(e=>e.id)),n=p.filter(e=>!t.has(e.id)),r=[...e,...n];return console.log("\ud83d\udcc5 Merging ".concat(n.length," new events with ").concat(e.length," existing events = ").concat(r.length," total events")),r}),setTimeout(()=>{qr(p)},50)}catch(n){if(console.group("\u274c Calendar Events Fetch Error"),console.error("Detailed Error:",n),n.response)switch(console.error("Response Status:",n.response.status),console.error("Response Data:",n.response.data),console.error("Response Headers:",n.response.headers),n.response.status){case 401:console.error("Authentication failed. Token may be expired.");break;case 403:console.error("Access denied. Check user permissions.");break;case 404:console.error("Calendar endpoint not found.");break;case 500:console.error("Server-side error occurred.");break;default:console.error("Unexpected status code: ".concat(n.response.status))}else n.request?console.error("No response received:",n.request):console.error("Error setting up request:",n.message);console.groupEnd(),we(e=>0===e.length?(console.warn("\ud83d\udcc5 No events could be loaded. Check your connection or permissions."),[]):e)}finally{Er(!1)}}},[Dr,_r]);(0,s.useEffect)(()=>{(async()=>{try{var e;console.log("\ud83d\udccb Fetching booking confirmation templates...");const t=await xr.get("/api/templates?type=booking_confirmation&isActive=true",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});console.log("\ud83d\udccb Templates response:",t.data),console.log("\ud83d\udccb Number of templates:",(null===(e=t.data)||void 0===e?void 0:e.length)||0),hn(t.data||[]),t.data&&t.data.length>0?(un(t.data[0]._id),console.log("\ud83d\udccb Default template selected:",t.data[0].name,t.data[0]._id)):console.warn("\u26a0\ufe0f No active booking confirmation templates found")}catch(t){console.error("\u274c Error fetching booking templates:",t),hn([])}})()},[]),(0,s.useEffect)(()=>{(async()=>{try{const e=await xr.get("/api/templates?type=secondary_confirmation&isActive=true",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});xn(e.data||[])}catch(e){console.error("Error fetching secondary templates:",e),xn([])}})()},[]);const Lr=(0,s.useRef)(!1);(0,s.useEffect)(()=>{const e=ye.get("eventId");if(e){if(e&&ve.length>0&&!Lr.current){const t=ve.find(t=>t.id===e);t?(Se(t),_e(!0),Lr.current=!0):be({},{replace:!0})}}else Lr.current=!1},[ye,ve,be]);const Rr=(0,s.useRef)(!1);(0,s.useEffect)(()=>{if(Rr.current)return;const e=setTimeout(()=>{console.log("\ud83d\udcc5 Initial calendar data fetch"),Ir(!0),Rr.current=!0},100),t=localStorage.getItem("bookingLead");if(t){bn(!1);try{const e=JSON.parse(t),n=e.id;yt.current.has(n)?(Et({_id:n,name:e.name||"",phone:e.phone||"",email:e.email||"",postcode:e.postcode||"",status:"Booked",notes:e.notes||"",image_url:e.image_url||"",isReschedule:e.isReschedule||!1,original_booker_id:e.booker_id||null}),localStorage.removeItem("bookingLead")):(console.log("\ud83d\udcca Loading booking data from localStorage:",e),Et({_id:n,name:e.name||"",phone:e.phone||"",email:e.email||"",postcode:e.postcode||"",status:"Booked",notes:e.notes||"",image_url:e.image_url||"",isReschedule:e.isReschedule||!1,original_booker_id:e.booker_id||null}),console.log("\ud83d\udcca Set leadForm with ID:",n),yt.current.add(n),localStorage.removeItem("bookingLead"),setTimeout(()=>{var t;const n=e.isReschedule||"booked"===(null===(t=e.currentStatus)||void 0===t?void 0:t.toLowerCase())?"reschedule":"book",r="Lead data for ".concat(e.name," has been loaded. Click on a time slot to ").concat(n," the appointment.");alert(r)},500))}catch(n){console.error("Error parsing lead data:",n),localStorage.removeItem("bookingLead")}}return localStorage.getItem("calendarRefreshTrigger")&&(console.log("\ud83d\udcc5 Calendar: Refresh trigger detected, refreshing events"),Ir(),localStorage.removeItem("calendarRefreshTrigger")),()=>{clearTimeout(e)}},[]),(0,s.useEffect)(()=>{Mr()},[Dn,An,Mr]),(0,s.useEffect)(()=>{if("daily"===An&&Bn.length>0){const e=Dn.toISOString().split("T")[0];Bn.some(t=>new Date(t.date).toISOString().split("T")[0]===e&&!t.time_slot&&!t.slot_number)&&(bt.current||alert("This day is blocked and cannot be viewed"),Tn("monthly"))}bt.current&&Bn.length>0&&(bt.current=!1)},[An,Dn,Bn]),(0,s.useEffect)(()=>{localStorage.setItem("calendarView",An),localStorage.setItem("calendarDate",Dn.toISOString())},[An,Dn]),(0,s.useEffect)(()=>{wt.current=Ir},[Ir]),(0,s.useEffect)(()=>{let e=null,t=null,n=null,r=null;const a=()=>{e&&clearTimeout(e),e=setTimeout(()=>{wt.current()},5e3)};return Nt&&(n=Nt(e=>{var t,n,r,s;if(console.log("\ud83d\udcc5 Calendar: Real-time calendar update received",e),gt(new Date),"status_changed"===(null===(t=e.data)||void 0===t?void 0:t.type)&&null!==(n=e.data)&&void 0!==n&&n.event){const t=e.data.event,n=e.data.lead;we(e=>e.map(e=>{var r,a;return e.id===t.id||n&&(null===(r=e.extendedProps)||void 0===r||null===(a=r.lead)||void 0===a?void 0:a.id)===n.id?Ye(Ye(Ye({},e),t),{},{extendedProps:Ye(Ye(Ye({},e.extendedProps),t.extendedProps),{},{lead:n||e.extendedProps.lead})}):e})),Se(e=>{var r,a;return e&&(e.id===t.id||n&&(null===(r=e.extendedProps)||void 0===r||null===(a=r.lead)||void 0===a?void 0:a.id)===n.id)?Ye(Ye(Ye({},e),t),{},{extendedProps:Ye(Ye(Ye({},e.extendedProps),t.extendedProps),{},{lead:n||e.extendedProps.lead})}):e}),console.log("\ud83d\udcc5 Calendar: Status updated in real-time")}else if("status_changed"===(null===(r=e.data)||void 0===r?void 0:r.type)&&null===(null===(s=e.data)||void 0===s?void 0:s.event)){const t=e.data.lead;t&&(we(e=>e.filter(e=>{var n,r;return e.id!==t.id&&(null===(n=e.extendedProps)||void 0===n||null===(r=n.lead)||void 0===r?void 0:r.id)!==t.id})),Se(e=>{var n,r;return!e||e.id!==t.id&&(null===(n=e.extendedProps)||void 0===n||null===(r=n.lead)||void 0===r?void 0:r.id)!==t.id?e:(Tr(),null)}),console.log("\ud83d\udcc5 Calendar: Event cancelled in real-time"))}else a()})),kt&&(r=kt(e=>{var t;switch(console.log("\ud83d\udcc5 Calendar: Real-time lead update received",e),gt(new Date),e.type){case"LEAD_CREATED":case"LEAD_DELETED":console.log("\ud83d\udcc5 Calendar: Refreshing events due to",e.type),a();break;case"LEAD_UPDATED":const n=null===(t=e.data)||void 0===t?void 0:t.lead;n&&n.date_booked&&(console.log("\ud83d\udcc5 Calendar: Refreshing events due to booking-related update"),a());break;case"LEAD_ASSIGNED":case"NOTES_UPDATED":case"messages_read":console.log("\ud83d\udcc5 Calendar: Skipping refresh for",e.type)}})),t=setInterval(()=>{a()},3e5),()=>{n&&n(),r&&r(),t&&clearInterval(t),e&&clearTimeout(e)}},[Nt,kt,Tr]);const Fr=(0,s.useCallback)(()=>{Ar.current&&clearTimeout(Ar.current),Ar.current=setTimeout(()=>{Ir()},3e3)},[Ir]);(0,s.useEffect)(()=>{if(!jt)return;const e=e=>{try{var t,n;if(!e||!e.leadId)return;const r="email"===e.channel||"EMAIL_RECEIVED"===e.type;if(we(t=>t.map(t=>t.id===e.leadId?Ye(Ye({},t),{},r?{hasUnreadEmail:!0,hasReceivedEmail:!0}:{hasUnreadSms:!0,hasReceivedSms:!0}):t)),Ne(e=>e+1),!ke)return;const a=null===(t=ke.extendedProps)||void 0===t||null===(n=t.lead)||void 0===n?void 0:n.id;if(a&&e.leadId===a){const t=ke.extendedProps.lead.bookingHistory||ke.extendedProps.lead.booking_history||[],n=r?"EMAIL_RECEIVED":"SMS_RECEIVED";if(!t.some(t=>{try{var n,r;return t&&("SMS_RECEIVED"===t.action||"EMAIL_RECEIVED"===t.action)&&((null===(n=t.details)||void 0===n?void 0:n.body)||(null===(r=t.details)||void 0===r?void 0:r.message))===e.content&&new Date(t.timestamp).getTime()===new Date(e.timestamp).getTime()}catch(a){return!1}})){const a={action:n,timestamp:e.timestamp,details:{body:e.content,subject:e.subject||"",sender:e.phone||e.email,direction:"received",channel:r?"email":"sms",status:"received",read:!1}},s=[...t,a],o=Ye(Ye({},ke.extendedProps.lead),{},{bookingHistory:s});Se(e=>e?Ye(Ye(Ye({},e),r?{hasUnreadEmail:!0}:{hasUnreadSms:!0}),{},{extendedProps:Ye(Ye({},e.extendedProps),{},{lead:o})}):e)}}}catch(r){}},t=e=>{if(console.log("\ud83d\udce7 ========== MESSAGE SENT NOTIFICATION =========="),console.log("\ud83d\udce7 Status:",e.status),console.log("\ud83d\udce7 Type:",e.type),console.log("\ud83d\udce7 Lead ID:",e.leadId),console.log("\ud83d\udce7 Channels:",e.channels),"success"===e.status?(console.log("\ud83d\udce7 Email Account:",e.emailAccountName),console.log("\ud83d\udce7 Email Account Key:",e.emailAccount),console.log("\ud83d\udce7 SMS Provider:",e.smsProvider)):console.log("\ud83d\udce7 Error:",e.error),console.log("\ud83d\udce7 =============================================="),"success"===e.status){const t=[];e.channels.email&&t.push("Email via ".concat(e.emailAccountName||"email")),e.channels.sms&&t.push("SMS via ".concat(e.smsProvider||"SMS"));const n="\u2705 ".concat(e.message||"Booking confirmation sent: "+t.join(" and "));alert(n)}else"error"===e.status&&alert("\u274c ".concat(e.message||"Failed to send booking confirmation"))};return jt.on("sms_received",e),jt.on("message_received",e),jt.on("message_sent",t),()=>{jt.off("sms_received",e),jt.off("message_received",e),jt.off("message_sent",t)}},[jt,ke]),(0,s.useEffect)(()=>{var e,t;if(!Ce||!ke)return;const n=(null===(e=ke.extendedProps)||void 0===e||null===(t=e.lead)||void 0===t?void 0:t.id)||ke.id;if(!n)return;(async()=>{try{var e,t;const r=(null===(e=(await xr.get("/api/leads/".concat(n,"/messages"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},timeout:5e3})).data)||void 0===e?void 0:e.messages)||[];Se(e=>{var t,n;return e?Ye(Ye({},e),{},{hasUnreadSms:!1,hasUnreadEmail:!1,extendedProps:Ye(Ye({},e.extendedProps),{},{lead:Ye(Ye({},e.extendedProps.lead),{},{bookingHistory:r.length>0?r:(null===(t=e.extendedProps)||void 0===t||null===(n=t.lead)||void 0===n?void 0:n.bookingHistory)||[]})})}):e}),we(e=>e.map(e=>e.id===n?Ye(Ye({},e),{},{hasUnreadSms:!1,hasUnreadEmail:!1}):e));const a=null===ke||void 0===ke||null===(t=ke.extendedProps)||void 0===t?void 0:t.lead;null!==a&&void 0!==a&&a.phone?Me("sms"):null!==a&&void 0!==a&&a.email&&Me("email")}catch(FB){}})()},[Ce,null===ke||void 0===ke?void 0:ke.id]);const Br=(0,s.useCallback)(async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!e)return Kn([]),void Qn(0);if("admin"===(null===ge||void 0===ge?void 0:ge.role)||"viewer"===(null===ge||void 0===ge?void 0:ge.role)||"photographer"===(null===ge||void 0===ge?void 0:ge.role)){ir.current=e,t?er(!0):or(!0);try{const s={leadId:e,limit:20,cursor:n||void 0,fields:"minimal"};r&&"all"!==r&&(s.folderPath=r);const o={leadId:e};r&&"all"!==r&&(o.folderPath=r);const[i,l]=await Promise.all([xr.get("/api/photos",{params:s}),t?xr.get("/api/photos/count",{params:o}):Promise.resolve(null)]);if(ir.current!==e)return void console.log("\ud83d\udcf8 Ignoring stale photo response for lead:",e);if(i.data.success){const e=i.data.photos||[];var a;if(t)Kn(e),void 0!==(null===l||void 0===l||null===(a=l.data)||void 0===a?void 0:a.count)&&Qn(l.data.count);else Kn(t=>[...t,...e]);nr(i.data.hasMore||!1),ar(i.data.nextCursor||null)}}catch(s){console.error("Error fetching photos:",s),ir.current===e&&t&&(Kn([]),Qn(0))}finally{ir.current===e&&(er(!1),or(!1))}}},[null===ge||void 0===ge?void 0:ge.role]),Ur=(0,s.useCallback)(()=>{var e,t;null!==(e=ke.extendedProps)&&void 0!==e&&null!==(t=e.lead)&&void 0!==t&&t.id&&tr&&!sr&&rr&&Br(ke.extendedProps.lead.id,!1,rr,kr)},[ke,tr,sr,rr,Br,kr]),zr=async e=>{var t,n;if(!e||0===e.length)return;if(null===ke||void 0===ke||null===(t=ke.extendedProps)||void 0===t||null===(n=t.lead)||void 0===n||!n.id)return void alert("No lead selected for photo upload");if(!wr)return void alert("Please select a folder first");const r=ke.extendedProps.lead.id,a=Array.from(e),s=a.length;ur(!0),hr(0),fr({current:0,total:s,currentFileName:""});let o=0,i=0;for(let c=0;c<a.length;c++){const e=a[c];fr({current:c+1,total:s,currentFileName:e.name.length>25?e.name.substring(0,22)+"...":e.name});try{const t=new FormData;t.append("photo",e),t.append("leadId",r),t.append("folderPath",wr),await xr.post("/api/photos/upload",t),o++}catch(l){console.error("Error uploading ".concat(e.name,":"),l),i++}hr(Math.round((c+1)/s*100))}ur(!1),hr(0),fr({current:0,total:0,currentFileName:""}),cr(!1),jr(null),Br(r,!0,null,kr),i>0?alert("Uploaded ".concat(o," of ").concat(s," photos. ").concat(i," failed.")):o>0&&alert("Successfully uploaded ".concat(o," photo").concat(o>1?"s":"","!"))},Vr=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?br(!0):"dragleave"===e.type&&br(!1)},Wr=async(e,t)=>{if(t.stopPropagation(),window.confirm("Are you sure you want to delete this photo? This cannot be undone."))try{const t=await xr.delete("/api/photos/".concat(e));t.data.success?(Kn(t=>t.filter(t=>t.id!==e)),Qn(e=>Math.max(0,e-1))):alert("Failed to delete photo: "+(t.data.message||"Unknown error"))}catch(a){var n,r;console.error("Error deleting photo:",a),alert("Error deleting photo: "+((null===(n=a.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||a.message))}};(0,s.useEffect)(()=>{var e,t;Ce&&null!==ke&&void 0!==ke&&null!==(e=ke.extendedProps)&&void 0!==e&&null!==(t=e.lead)&&void 0!==t&&t.id?(nr(!1),ar(null),Sr("all"),jr(null),Br(ke.extendedProps.lead.id,!0,null,"all")):(Kn([]),Qn(0),nr(!1),ar(null),Sr("all"))},[Ce,ke,Br]),(0,s.useEffect)(()=>{var e,t;Ce&&null!==ke&&void 0!==ke&&null!==(e=ke.extendedProps)&&void 0!==e&&null!==(t=e.lead)&&void 0!==t&&t.id&&(nr(!1),ar(null),Br(ke.extendedProps.lead.id,!0,null,kr))},[kr]);const qr=e=>{const t=localStorage.getItem("highlightBooking");if(t)try{const n=JSON.parse(t),r=e.find(e=>{var t,r;return e.id===n.leadId||(null===(t=e.extendedProps)||void 0===t||null===(r=t.lead)||void 0===r?void 0:r.name)===n.leadName});setTimeout(()=>{var e;const t=null===(e=xt.current)||void 0===e?void 0:e.getApi();t&&(t.gotoDate(n.date),r&&setTimeout(()=>{Se(r),_e(!0)},500)),alert("Navigated to ".concat(n.leadName,"'s booking on ").concat(new Date(n.date).toLocaleDateString()))},1e3),localStorage.removeItem("highlightBooking")}catch(n){console.error("Error parsing highlight booking data:",n),localStorage.removeItem("highlightBooking")}},Hr=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"new":default:return"status-badge status-new";case"confirmed":case"booked":return"status-badge status-booked";case"attended":case"complete":return"status-badge status-attended";case"cancelled":case"no show":return"status-badge status-cancelled";case"reschedule":return"status-badge status-reschedule"}},Yr=e=>e?{id:e.id,title:e.title,start:e.start?new Date(e.start):null,end:e.end?new Date(e.end):null,allDay:!!e.allDay,backgroundColor:e.backgroundColor,borderColor:e.borderColor,extendedProps:Ye({},e.extendedProps||{})}:null,Gr=e=>{const{name:t,value:n}=e.target;Et(e=>Ye(Ye({},e),{},{[t]:n}))},Xr=async()=>{const e=ve.filter(e=>{var t;return null===(t=e.extendedProps)||void 0===t?void 0:t.isPending});for(const n of e)try{const e=Ye(Ye({},n.extendedProps.lead),{},{date_booked:n.start.toISOString(),status:"Booked"}),t=await xr.post("/api/leads",e);if(t.data.success||t.data.lead){const e=t.data.lead||t.data;we(t=>t.map(t=>t.id===n.id?Ye(Ye({},t),{},{id:e.id,title:t.title.replace(" (Pending)",""),backgroundColor:Dr("Booked",e.hasSale),borderColor:Dr("Booked",e.hasSale),extendedProps:Ye(Ye({},t.extendedProps),{},{lead:e,isPending:!1,isConfirmed:!0})}):t))}}catch(t){console.log("Failed to sync pending booking for ".concat(n.extendedProps.lead.name))}},$r=async e=>{var t;if(!ke||null===(t=ke.extendedProps)||void 0===t||!t.lead)return void alert("No lead data available for this event.");if("admin"!==(null===ge||void 0===ge?void 0:ge.role)&&"booker"!==(null===ge||void 0===ge?void 0:ge.role)&&"viewer"!==(null===ge||void 0===ge?void 0:ge.role))return void alert("Access denied. You do not have permission to change booking status.");if("booker"===(null===ge||void 0===ge?void 0:ge.role)){var n,r;const t="Confirmed"===e||"Unconfirmed"===e,a="Cancelled"===e,s=(null===(n=ke.extendedProps)||void 0===n||null===(r=n.lead)||void 0===r?void 0:r.booker)===ge.id;if(!t&&!a&&!s)return void alert("Access denied. You can only change Confirmed/Unconfirmed/Cancelled status on any booking, or other statuses on leads assigned to you.")}const a=ke.extendedProps.lead.name||ke.title.split(" - ")[0],s=ke.extendedProps.status;if("Cancelled"===e){const e="Are you sure you want to cancel ".concat(a,"'s appointment?\n\n")+'This will:\n\u2022 Remove the booking from the calendar\n\u2022 Clear all booking information (date, time, slot)\n\u2022 Move the lead status to "Cancelled"\n\u2022 Save the booking details to history for tracking\n\u2022 Allow the lead to be reassigned later\n\nThis action cannot be undone.';if(!window.confirm(e))return}else if("Confirmed"===e){if(!window.confirm("Are you sure you want to confirm ".concat(a,"'s appointment?\n\nThis will mark the booking as confirmed but keep it on the calendar.")))return}else if("Unconfirmed"===e){if(!window.confirm("Set ".concat(a,"'s appointment to Unconfirmed?")))return}else if(!window.confirm("Are you sure you want to change ".concat(a,"'s status to \"").concat(e,'"?')))return;const o=Ye({},ke),i=[...ve],l=ke.extendedProps.lead,{has_received_email:c,has_received_sms:d,has_unread_email:u,has_unread_sms:m,hasReceivedEmail:h,hasReceivedSms:p,hasUnreadEmail:f,hasUnreadSms:g}=l;let x=Ye({},Il(l,jd));if(x=Ye(Ye({},x),{},"Cancelled"===e?{status:"Cancelled",cancellation_reason:"Appointment cancelled via calendar",date_booked:null,time_booked:null,booking_slot:null,is_confirmed:null,booking_status:null}:"Double Confirmed"===e?{status:"Booked",is_confirmed:1,is_double_confirmed:1,booking_status:null}:"Confirmed"===e?{status:"Booked",is_confirmed:1,is_double_confirmed:0,booking_status:null}:"Unconfirmed"===e?{status:"Booked",is_confirmed:0,is_double_confirmed:0,booking_status:null}:"Reschedule"===e||"Arrived"===e||"Left"===e||"No Show"===e||"No Sale"===e||"Review"===e?{status:"Booked",booking_status:e,is_confirmed:"Reschedule"===e?0:"Review"===e?x.is_confirmed:null}:{status:e,booking_status:null}),"Cancelled"===e)we(e=>e.filter(e=>e.id!==ke.id)),Tr(),Ct({type:"status_changed",lead:Ye(Ye({},ke.extendedProps.lead),x),event:null,oldStatus:s,newStatus:"Cancelled",timestamp:new Date});else{var y;const t="Double Confirmed"===e?"".concat(a," - Booked (Double Confirmed)"):"Confirmed"===e?"".concat(a," - Booked (Confirmed)"):"Unconfirmed"===e?"".concat(a," - Booked (Unconfirmed)"):"".concat(a," - ").concat(e),n=Ye(Ye({},ke.extendedProps.lead),x),r="Confirmed"===e||"Double Confirmed"===e?1:"Unconfirmed"===e?0:ke.is_confirmed,o="Double Confirmed"===e?1:0,i="Reschedule"===e||"Arrived"===e||"Left"===e||"No Show"===e||"No Sale"===e||"Review"===e?e:null,l=Ye(Ye({},ke),{},{title:t,backgroundColor:Dr(e,n.hasSale,"Confirmed"===e||"Double Confirmed"===e,"Double Confirmed"===e),borderColor:Dr(e,n.hasSale,"Confirmed"===e||"Double Confirmed"===e,"Double Confirmed"===e),is_confirmed:r,is_double_confirmed:o,booking_status:i,has_sale:n.has_sale||ke.has_sale||!1,name:n.name||ke.name,time_booked:n.time_booked||ke.time_booked,date_booked:n.date_booked||ke.date_booked,booking_slot:n.booking_slot||ke.booking_slot,extendedProps:Ye(Ye({},ke.extendedProps),{},{status:"Double Confirmed"===e||"Confirmed"===e||"Unconfirmed"===e||"Reschedule"===e||"Arrived"===e||"Left"===e||"No Show"===e||"No Sale"===e||"Review"===e?"Booked":e,displayStatus:e,isConfirmed:"Confirmed"===e||"Double Confirmed"===e||"Unconfirmed"!==e&&((null===(y=ke.extendedProps)||void 0===y?void 0:y.isConfirmed)||!1),isDoubleConfirmed:"Double Confirmed"===e,bookingStatus:i,lead:n})});we(e=>e.map(e=>e.id===ke.id?l:e)),Se(l),Ne(e=>e+1),Ct({type:"status_changed",lead:n,event:l,oldStatus:s,newStatus:"Cancelled"===e?"Cancelled":"Confirmed"===e?"Booked":e,timestamp:new Date})}(async()=>{try{const n=await xr.put("/api/leads/".concat(ke.id),x);if(n.data.success||n.data.lead){const r=n.data.lead||n.data;if("Cancelled"!==e){var t;const n="Confirmed"===e?"".concat(a," - Booked (Confirmed)"):"Unconfirmed"===e?"".concat(a," - Booked (Unconfirmed)"):"".concat(a," - ").concat(e),s=Ye(Ye({},ke),{},{title:n,backgroundColor:Dr("Confirmed"===e?"Booked":"Unconfirmed"===e?"Unconfirmed":e,r.hasSale,"Confirmed"===e),borderColor:Dr("Confirmed"===e?"Booked":"Unconfirmed"===e?"Unconfirmed":e,r.hasSale,"Confirmed"===e),date_booked:r.date_booked||ke.date_booked,time_booked:r.time_booked||ke.time_booked,booking_slot:r.booking_slot||ke.booking_slot,is_confirmed:r.is_confirmed,is_double_confirmed:r.is_double_confirmed||0,booking_status:r.booking_status||null,name:r.name||ke.name,phone:r.phone||ke.phone,email:r.email||ke.email,extendedProps:Ye(Ye({},ke.extendedProps),{},{status:"Confirmed"===e||"Unconfirmed"===e||"Reschedule"===e||"Arrived"===e||"Left"===e||"No Show"===e||"No Sale"===e?"Booked":e,displayStatus:e,isConfirmed:"Confirmed"===e||"Unconfirmed"!==e&&("Reschedule"===e||"Arrived"===e||"Left"===e||"No Show"===e||"No Sale"===e?"Reschedule"===e?0:null:(null===(t=ke.extendedProps)||void 0===t?void 0:t.isConfirmed)||!1),bookingStatus:"Reschedule"===e||"Arrived"===e||"Left"===e||"No Show"===e||"No Sale"===e?e:void 0,lead:r})});we(e=>e.map(e=>e.id===ke.id?s:e)),Se(s),Ne(e=>e+1)}setTimeout(()=>{Fr()},2e3)}}catch(r){console.error("Error updating event status:",r),we(i),Se(o),Ne(e=>e+1);let e="Failed to update status. Changes have been reverted. Please try again.";var n;if(r.response)e="Server error: ".concat((null===(n=r.response.data)||void 0===n?void 0:n.message)||r.response.statusText,". Changes have been reverted.");else e=r.request?"Network error: Could not reach server. Changes have been reverted.":"Error: ".concat(r.message,". Changes have been reverted.");alert(e)}})()},Kr=()=>{if(null===ke||void 0===ke||!ke.start)return[];const e=new Date(ke.start),t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=new Date(t);return n.setDate(n.getDate()+1),ve.filter(e=>{const r=new Date(e.start);return r>=t&&r<n}).sort((e,t)=>new Date(e.start)-new Date(t.start))},Jr=()=>{const e=Kr(),t=e.findIndex(e=>e.id===ke.id);if(t>0){var n,r;const a=e[t-1];console.log("\ud83d\udcf8 Navigating to previous event:",a.title,"Image URL:",null===(n=a.extendedProps)||void 0===n||null===(r=n.lead)||void 0===r?void 0:r.image_url),Se(Yr(a))}},Qr=()=>{const e=Kr(),t=e.findIndex(e=>e.id===ke.id);if(t<e.length-1){var n,r;const a=e[t+1];console.log("\ud83d\udcf8 Navigating to next event:",a.title,"Image URL:",null===(n=a.extendedProps)||void 0===n||null===(r=n.lead)||void 0===r?void 0:r.image_url),Se(Yr(a))}};(0,s.useEffect)(()=>{var e;if(null!==ke&&void 0!==ke&&null!==(e=ke.extendedProps)&&void 0!==e&&e.lead){const e=ke.extendedProps.lead;st({date_of_birth:e.date_of_birth?e.date_of_birth.split("T")[0]:"",height_inches:e.height_inches||"",chest_inches:e.chest_inches||"",waist_inches:e.waist_inches||"",hips_inches:e.hips_inches||"",eye_color:e.eye_color||"",hair_color:e.hair_color||"",hair_length:e.hair_length||""}),tt(!1)}},[ke]);const Zr=()=>{if(!ht)return null;const e=ht.date,t=new Date(e);return t.setHours(t.getHours()+1),{date:e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),time:"".concat(e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})," - ").concat(t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}))}};return(0,yr.jsxs)("div",{className:"space-y-3 sm:space-y-4 lg:space-y-6",children:[(0,yr.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 sm:gap-4",children:[(0,yr.jsx)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4 w-full sm:w-auto",children:(0,yr.jsxs)("div",{className:"w-full sm:w-auto",children:[(0,yr.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[(0,yr.jsx)("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Calendar"}),(0,yr.jsxs)("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[(0,yr.jsx)("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 rounded-full ".concat(St?"bg-green-500 animate-pulse":"bg-red-500")}),(0,yr.jsx)("span",{className:"text-xs ".concat(St?"text-green-600":"text-red-600"),children:St?"Live":"Offline"})]}),(0,yr.jsx)("div",{className:"hidden sm:flex items-center space-x-2 sm:space-x-3 text-xs text-gray-500",children:(0,yr.jsxs)("span",{children:["\ud83d\udcc5 ",ve.length]})})]}),(0,yr.jsxs)("p",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:[ve.length," events \u2022 Updated ",ft.toLocaleTimeString()]})]})}),(0,yr.jsx)("div",{className:"flex items-center space-x-2 sm:space-x-4 w-full sm:w-auto overflow-x-auto",children:(0,yr.jsxs)("div",{className:"flex items-center space-x-2 text-xs sm:text-sm text-gray-600 whitespace-nowrap",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,yr.jsx)("div",{className:"w-2 h-2 sm:w-3 sm:h-3 bg-blue-500 rounded"}),(0,yr.jsx)("span",{className:"hidden sm:inline",children:"New"})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,yr.jsx)("div",{className:"w-2 h-2 sm:w-3 sm:h-3 bg-green-500 rounded"}),(0,yr.jsx)("span",{className:"hidden sm:inline",children:"Booked"})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,yr.jsx)("div",{className:"w-2 h-2 sm:w-3 sm:h-3 bg-purple-500 rounded"}),(0,yr.jsx)("span",{className:"hidden sm:inline",children:"Attended"})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,yr.jsx)("div",{className:"w-2 h-2 sm:w-3 sm:h-3 bg-red-500 rounded"}),(0,yr.jsx)("span",{className:"hidden sm:inline",children:"Cancelled"})]})]})})]}),(0,yr.jsxs)("div",{className:"mb-3 sm:mb-4 flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between",children:[(0,yr.jsxs)("div",{className:"relative w-full sm:max-w-md",children:[(0,yr.jsx)("div",{className:"absolute inset-y-0 left-0 pl-2 sm:pl-3 flex items-center pointer-events-none",children:(0,yr.jsx)(ro,{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-400"})}),(0,yr.jsx)("input",{type:"text",value:Pn,onChange:e=>On(e.target.value),placeholder:"Search leads...",className:"block w-full pl-8 sm:pl-10 pr-8 sm:pr-10 py-2 border border-gray-300 rounded-md text-sm bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),Pn&&(0,yr.jsx)("div",{className:"absolute inset-y-0 right-0 pr-2 sm:pr-3 flex items-center",children:(0,yr.jsx)("button",{onClick:()=>On(""),className:"text-gray-400 hover:text-gray-600 focus:outline-none touch-target",children:(0,yr.jsx)(ko,{className:"h-4 w-4 sm:h-5 sm:w-5"})})}),Pn&&(0,yr.jsxs)("p",{className:"mt-2 text-xs sm:text-sm text-gray-600",children:["Found ",ve.filter(e=>{var t,n,r,a,s;const o=Pn.toLowerCase(),i=(null===(t=e.extendedProps)||void 0===t||null===(n=t.lead)||void 0===n?void 0:n.name)||e.title||"",l=(null===(r=e.extendedProps)||void 0===r?void 0:r.phone)||"",c=(null===(a=e.extendedProps)||void 0===a||null===(s=a.lead)||void 0===s?void 0:s.email)||"";return i.toLowerCase().includes(o)||l.includes(o)||c.toLowerCase().includes(o)}).length," results"]})]}),"timeGridDay"===An&&(0,yr.jsxs)("button",{onClick:async()=>{try{const e=xt.current.getApi().getDate(),t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),a="".concat(t,"-").concat(n,"-").concat(r);console.log("\ud83d\udce5 Exporting calendar for ".concat(a,"...")),console.log("\ud83d\udcc5 View date:",e),console.log("\ud83d\udcc5 Formatted date string:",a);const s=await xr.get("/api/leads/calendar/export-csv?date=".concat(a),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},responseType:"blob"}),o=window.URL.createObjectURL(new Blob([s.data])),i=document.createElement("a");i.href=o,i.setAttribute("download","calendar_".concat(a,".csv")),document.body.appendChild(i),i.click(),i.remove(),window.URL.revokeObjectURL(o),console.log("\u2705 Calendar exported successfully for ".concat(a))}catch(e){console.error("Error exporting calendar:",e),alert("Failed to export calendar. Please try again.")}},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors whitespace-nowrap",children:[(0,yr.jsx)(ks,{className:"h-4 w-4"}),(0,yr.jsx)("span",{className:"text-sm font-medium",children:"Export Day to CSV"})]})]}),(0,yr.jsx)("div",{className:"mobile-card mb-4",children:(0,yr.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,yr.jsxs)("div",{className:"flex gap-2",children:[(0,yr.jsx)("button",{onClick:()=>Tn("monthly"),className:"px-4 py-2 rounded-md font-medium transition-colors ".concat("monthly"===An?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Monthly"}),(0,yr.jsx)("button",{onClick:()=>Tn("weekly"),className:"px-4 py-2 rounded-md font-medium transition-colors ".concat("weekly"===An?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Weekly"}),(0,yr.jsx)("button",{onClick:()=>Tn("daily"),className:"px-4 py-2 rounded-md font-medium transition-colors ".concat("daily"===An?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Daily"})]}),(0,yr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,yr.jsx)("button",{onClick:()=>{const e=new Date(Dn);if("daily"===An){e.setDate(e.getDate()-1);const t=30;let n=0;for(;n<t;){const t=e.toISOString().split("T")[0];if(!Bn.some(e=>new Date(e.date).toISOString().split("T")[0]===t&&!e.time_slot&&!e.slot_number))break;e.setDate(e.getDate()-1),n++}}else"weekly"===An?e.setDate(e.getDate()-7):e.setMonth(e.getMonth()-1);Mn(e),Ir(!0)},className:"p-2 rounded-md bg-gray-200 hover:bg-gray-300 transition-colors",children:(0,yr.jsx)(ys,{className:"h-5 w-5"})}),(0,yr.jsx)("button",{onClick:()=>{Mn(Pl()),Ir(!0)},className:"px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300 transition-colors font-medium",children:"Today"}),(0,yr.jsx)("button",{onClick:()=>{const e=new Date(Dn);if("daily"===An){e.setDate(e.getDate()+1);const t=30;let n=0;for(;n<t;){const t=e.toISOString().split("T")[0];if(!Bn.some(e=>new Date(e.date).toISOString().split("T")[0]===t&&!e.time_slot&&!e.slot_number))break;e.setDate(e.getDate()+1),n++}}else"weekly"===An?e.setDate(e.getDate()+7):e.setMonth(e.getMonth()+1);Mn(e),Ir(!0)},className:"p-2 rounded-md bg-gray-200 hover:bg-gray-300 transition-colors",children:(0,yr.jsx)(bs,{className:"h-5 w-5"})})]})]})}),(0,yr.jsx)("div",{className:"mobile-card overflow-x-auto",children:"monthly"===An?(0,yr.jsx)(vd,{currentDate:Dn,blockedSlots:Bn,events:ve.filter(e=>{if(!e.date_booked)return!1;if(Pn){const t=Pn.toLowerCase(),n=e.name||"",r=e.phone||"",a=e.email||"";return n.toLowerCase().includes(t)||r.includes(t)||a.toLowerCase().includes(t)}return!0}),onDayClick:e=>{const t=e.toISOString().split("T")[0];Bn.some(e=>new Date(e.date).toISOString().split("T")[0]===t&&!e.time_slot&&!e.slot_number)?alert("This day is blocked and cannot be viewed"):(console.log("Day clicked:",e),Mn(e),Tn("daily"))},onEventClick:e=>{console.log("Event clicked:",e);const t=ve.find(t=>t.id===e.id);t?(Se(t),_e(!0),Lr.current=!0,be({eventId:e.id},{replace:!0})):console.error("Could not find full event data for:",e.id)}},"monthly-calendar-".concat(je)):"daily"===An?(0,yr.jsx)(fd,{selectedDate:Dn,blockedSlots:Bn,events:ve.filter(e=>{if(!e.date_booked)return!1;const t=new Date(e.date_booked),n=Dn.toISOString().split("T")[0],r=t.toISOString().split("T")[0];if(Pn){const t=Pn.toLowerCase(),a=e.name||"",s=e.phone||"",o=e.email||"",i=a.toLowerCase().includes(t)||s.includes(t)||o.toLowerCase().includes(t);return r===n&&i}return r===n}),onSlotClick:(e,t,n)=>{console.log("Slot clicked:",e,t,n),Fn(e),Ln(t);const r=e.split(":"),a=r.length>0?parseInt(r[0],10):0,s=r.length>1?parseInt(r[1],10):0,o=new Date(Dn);o.setHours(a,s,0,0),pt({dateStr:o.toISOString(),date:o}),Et(Ye(Ye({},_t),{},{time_booked:e,booking_slot:t,date_booked:Dn.toISOString().split("T")[0]})),bn(!_t._id),mt(!0)},onEventClick:e=>{console.log("Event clicked:",e);const t=ve.find(t=>t.id===e.id);t?(Se(t),_e(!0),Lr.current=!0,be({eventId:e.id},{replace:!0})):console.error("Could not find full event data for:",e.id)}},"slot-calendar-".concat(je)):(0,yr.jsx)(xd,{weekStart:(()=>{const e=new Date(Dn),t=e.getDay(),n=e.getDate()-t+(0===t?-6:1);return new Date(e.setDate(n))})(),blockedSlots:Bn,events:ve.filter(e=>{if(!e.date_booked)return!1;if(Pn){const t=Pn.toLowerCase(),n=e.name||"",r=e.phone||"",a=e.email||"";return n.toLowerCase().includes(t)||r.includes(t)||a.toLowerCase().includes(t)}return!0}),onDayClick:(e,t,n)=>{if(console.log("Day/slot clicked:",e,t,n),t&&n){Fn(t),Ln(n);const r=t.split(":"),a=r.length>0?parseInt(r[0],10):0,s=r.length>1?parseInt(r[1],10):0,o=new Date(e);o.setHours(a,s,0,0),pt({dateStr:o.toISOString(),date:o}),Mn(e),Et(Ye(Ye({},_t),{},{time_booked:t,booking_slot:n,date_booked:e.toISOString().split("T")[0]})),bn(!_t._id),mt(!0)}else{const t=e.toISOString().split("T")[0];if(Bn.some(e=>new Date(e.date).toISOString().split("T")[0]===t&&!e.time_slot&&!e.slot_number))return void alert("This day is blocked and cannot be viewed");Mn(e),Tn("daily")}},onEventClick:e=>{console.log("Event clicked:",e);const t=ve.find(t=>t.id===e.id);t?(Se(t),_e(!0),Lr.current=!0,be({eventId:e.id},{replace:!0})):console.error("Could not find full event data for:",e.id)}})}),ut&&ht&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 h-full w-full z-50 flex items-center justify-center p-2 sm:p-4",children:(0,yr.jsxs)("div",{className:"relative mx-auto p-6 border w-full max-w-5xl shadow-lg rounded-lg bg-white calendar-modal-scroll max-h-[95vh] overflow-y-auto",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:_t._id?_t.isReschedule?"Reschedule Appointment":"Book Existing Lead":"Create New Booking"}),(0,yr.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:_t._id?_t.isReschedule?"Choose a new date and time for the appointment":"Schedule appointment for existing lead":"Fill in the lead information for the booking"})]}),(0,yr.jsx)("button",{onClick:()=>mt(!1),className:"text-gray-400 hover:text-gray-600 p-1",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,yr.jsxs)("div",{className:"space-y-6",children:[(0,yr.jsx)("h4",{className:"text-md font-medium text-gray-900 border-b pb-2",children:"Lead Information"}),(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Name ",(0,yr.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)(vo,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,yr.jsx)("input",{type:"text",name:"name",value:_t.name,onChange:Gr,className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter full name",required:!0})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phone ",(0,yr.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)(Js,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,yr.jsx)("input",{type:"tel",name:"phone",value:_t.phone,onChange:Gr,className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter phone number",required:!0})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)(Vs,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,yr.jsx)("input",{type:"email",name:"email",value:_t.email,onChange:Gr,className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter email address"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Postcode"}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)(Ws,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,yr.jsx)("input",{type:"text",name:"postcode",value:_t.postcode,onChange:Gr,className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter postcode"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,yr.jsxs)("select",{name:"status",value:_t.status,onChange:Gr,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,yr.jsx)("option",{value:"New",children:"New"}),(0,yr.jsx)("option",{value:"Contacted",children:"Contacted"}),(0,yr.jsx)("option",{value:"Booked",children:"Booked"}),(0,yr.jsx)("option",{value:"Attended",children:"Attended"}),(0,yr.jsx)("option",{value:"Cancelled",children:"Cancelled"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)(Os,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,yr.jsx)("textarea",{name:"notes",value:_t.notes,onChange:Gr,rows:"3",className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Additional notes..."})]})]})]})]}),(0,yr.jsxs)("div",{className:"space-y-6",children:[(0,yr.jsx)("h4",{className:"text-md font-medium text-gray-900 border-b pb-2",children:"Booking Preview"}),(0,yr.jsxs)("div",{className:"bg-white border rounded-lg p-4",children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Send booking confirmation via"}),(0,yr.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,yr.jsxs)("label",{className:"inline-flex items-center space-x-2",children:[(0,yr.jsx)("input",{type:"checkbox",className:"h-4 w-4 text-indigo-600 border-gray-300 rounded",checked:sn,onChange:e=>on(e.target.checked)}),(0,yr.jsx)("span",{className:"text-sm text-gray-700",children:"Email"})]}),(0,yr.jsxs)("label",{className:"inline-flex items-center space-x-2",children:[(0,yr.jsx)("input",{type:"checkbox",className:"h-4 w-4 text-indigo-600 border-gray-300 rounded",checked:ln,onChange:e=>cn(e.target.checked)}),(0,yr.jsx)("span",{className:"text-sm text-gray-700",children:"Text (SMS)"})]})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Both are checked by default. Uncheck to prevent sending."}),(sn||ln)&&(0,yr.jsxs)("div",{className:"mt-3",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Template"}),mn.length>0?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("select",{value:dn||"",onChange:e=>un(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:mn.map(e=>(0,yr.jsxs)("option",{value:e._id,children:[e.name," ","secondary"===e.emailAccount?"(Diary@edgetalent.co.uk)":"(Primary)"]},e._id))}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Emails sent via Gmail API"}),sn&&!Nn&&(0,yr.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:"\u26a0\ufe0f This template has email disabled - email will not be sent"}),ln&&!kn&&(0,yr.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:"\u26a0\ufe0f This template has SMS disabled - SMS will not be sent"})]}):(0,yr.jsx)("div",{className:"text-sm text-amber-600 bg-amber-50 border border-amber-200 rounded-md p-3",children:"\u26a0\ufe0f No active booking confirmation templates found. Please create one in the Templates page."})]})]}),(0,yr.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Date"}),(0,yr.jsx)("input",{type:"date",value:ht?ht.dateStr?ht.dateStr.slice(0,10):ht instanceof Date?ht.toISOString().slice(0,10):"":"",onChange:e=>{if(e.target.value){const t=new Date(e.target.value+"T12:00:00");pt({dateStr:t.toISOString(),date:t})}},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Time"}),(0,yr.jsx)("select",{value:_t.time_booked||(ht&&ht.date?"".concat(String(ht.date.getHours()).padStart(2,"0"),":").concat(String(ht.date.getMinutes()).padStart(2,"0")):"10:00"),onChange:e=>{const t=e.target.value,[n,r]=t.split(":").map(Number);if(ht){const e=ht.date||ht,t=new Date(e);t.setHours(n,r,0,0),pt({dateStr:t.toISOString(),date:t})}Et(Ye(Ye({},_t),{},{time_booked:t}))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:["10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30"].map(e=>{const[t,n]=e.split(":").map(Number),r=t>=12?"PM":"AM",a="".concat(0===t?12:t>12?t-12:t,":").concat(String(n).padStart(2,"0")," ").concat(r);return(0,yr.jsx)("option",{value:e,children:a},e)})}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Only times available on the calendar are shown"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Booking Slot"}),(0,yr.jsxs)("select",{value:_t.booking_slot||1,onChange:e=>{Et(Ye(Ye({},_t),{},{booking_slot:parseInt(e.target.value)})),Ln(parseInt(e.target.value))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,yr.jsx)("option",{value:1,children:"Slot 1"}),(0,yr.jsx)("option",{value:2,children:"Slot 2"}),(0,yr.jsx)("option",{value:3,children:"Slot 3"})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Select which slot column to book the appointment in"})]})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)(hs,{className:"h-5 w-5 text-blue-500"}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"font-medium text-gray-900",children:"Date & Time"}),(0,yr.jsx)("p",{className:"text-sm text-gray-600",children:null===(e=Zr())||void 0===e?void 0:e.date}),(0,yr.jsx)("p",{className:"text-sm text-gray-600",children:null===(t=Zr())||void 0===t?void 0:t.time})]})]}),_t.name&&(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)(vo,{className:"h-5 w-5 text-green-500"}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"font-medium text-gray-900",children:"Client"}),(0,yr.jsx)("p",{className:"text-sm text-gray-600",children:_t.name})]})]}),_t.phone&&(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)(Js,{className:"h-5 w-5 text-purple-500"}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"font-medium text-gray-900",children:"Phone"}),(0,yr.jsx)("p",{className:"text-sm text-gray-600",children:_t.phone})]})]}),_t.email&&(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)(Vs,{className:"h-5 w-5 text-orange-500"}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"font-medium text-gray-900",children:"Email"}),(0,yr.jsx)("p",{className:"text-sm text-gray-600",children:_t.email})]})]}),_t.postcode&&(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)(Ws,{className:"h-5 w-5 text-red-500"}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"font-medium text-gray-900",children:"Postcode"}),(0,yr.jsx)("p",{className:"text-sm text-gray-600",children:_t.postcode})]})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("div",{className:"w-5 h-5 rounded ".concat(Dr(_t.status,_t.hasSale)),style:{backgroundColor:Dr(_t.status,_t.hasSale)}}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"font-medium text-gray-900",children:"Status"}),(0,yr.jsx)("span",{className:Hr(_t.status),children:_t.status})]})]}),_t.notes&&(0,yr.jsxs)("div",{className:"pt-2 border-t border-gray-200",children:[(0,yr.jsx)("p",{className:"font-medium text-gray-900 mb-1",children:"Notes"}),(0,yr.jsx)("p",{className:"text-sm text-gray-600",children:_t.notes})]})]})]})]}),(0,yr.jsxs)("div",{className:"mt-8 flex justify-end space-x-3 pt-6 border-t",children:[(0,yr.jsx)("button",{onClick:()=>mt(!1),className:"btn-secondary",children:"Cancel"}),(0,yr.jsx)("button",{onClick:async()=>{if(_n)return void console.log("\ud83d\udcca Booking already in progress, ignoring duplicate request");if(!_t.name||!_t.phone)return void alert("Please fill in required fields (Name and Phone)");console.log("\ud83d\udcc5 ========== SAVE BOOKING START =========="),console.log("\ud83d\udcc5 Lead Form:",_t),console.log("\ud83d\udcc5 Is Reschedule:",_t.isReschedule),console.log("\ud83d\udcc5 Send Email:",sn),console.log("\ud83d\udcc5 Send SMS:",ln),console.log("\ud83d\udcc5 Selected Template ID:",dn),console.log("\ud83d\udcc5 Available Templates:",mn.map(e=>({id:e._id,name:e.name}))),console.log("\ud83d\udcc5 ========================================"),En(!0);const e=ht.date||new Date(ht.dateStr),t=new Date(e);t.setMinutes(t.getMinutes()+30);const n=e.getFullYear(),r=e.getMonth(),a=e.getDate(),s=e.getHours(),o=e.getMinutes(),i=new Date(n,r,a,s,o,0,0),l=new Date(n,r,a,s,o+30,0,0),c="".concat(n,"-").concat(String(r+1).padStart(2,"0"),"-").concat(String(a).padStart(2,"0"),"T").concat(String(s).padStart(2,"0"),":").concat(String(o).padStart(2,"0"),":00.000Z");console.log("\ud83d\udd50 Time Debug:",{originalSelectedDate:ht,selectedDateTime:e.toISOString(),selectedDateTimeLocal:e.toLocaleString(),selectedDateTimeUTC:e.toUTCString(),localDateTime:i.toISOString(),localDateTimeLocal:i.toLocaleString(),endDateTime:t.toISOString(),endDateTimeLocal:t.toLocaleString(),timezoneOffset:e.getTimezoneOffset(),hour:e.getHours(),minute:e.getMinutes(),localHour:i.getHours(),localMinute:i.getMinutes()});const d="temp_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));try{const e=JSON.parse(localStorage.getItem("user"))||{};console.log("\ud83d\udcca Booking Debug Info:",{leadFormId:_t._id,leadFormIdType:typeof _t._id,leadFormIdLength:_t._id?_t._id.length:0,isExistingLead:_t._id&&""!==_t._id,leadForm:_t,selectedDateTime:i.toISOString()});const{_id:t}=_t,n=Ye(Ye(Ye({},Il(_t,wd)),{},{date_booked:c,time_booked:_t.time_booked||"".concat(String(s).padStart(2,"0"),":").concat(String(o).padStart(2,"0")),booking_slot:_t.booking_slot||In||1},t&&""!==t?{_id:t}:{}),{},{status:"Booked",is_confirmed:(_t.isReschedule,0),booker:_t.isReschedule&&_t.original_booker_id?_t.original_booker_id:e._id||e.id||"507f1f77bcf86cd799439012"},_t.isReschedule&&{booking_status:"Reschedule",rescheduleReason:"Appointment rescheduled via calendar to ".concat(i.toLocaleString())});console.log("\ud83d\udcca Creating/updating lead with data:",{hasExistingId:!!t,finalData:n}),console.log("\ud83d\udce4 Sending booking request with:",Ye(Ye({},n),{},{sendEmail:sn,sendSms:ln,templateId:dn}));const r=await xr.post("/api/leads",Ye(Ye({},n),{},{sendEmail:sn,sendSms:ln,templateId:dn,secondaryTemplateId:yn?pn:null}));if(console.log("\u2705 Booking API response:",r.data),r.data.success||r.data.lead||r.data){const t=r.data.lead||r.data,n=r.data.isExistingLead||!1,a=t.is_confirmed?"Confirmed":"Unconfirmed",s={id:t.id||d,name:_t.name,title:"".concat(_t.name," - ").concat(a),phone:_t.phone,email:_t.email,date_booked:t.date_booked||c,time_booked:t.time_booked||_t.time_booked,booking_slot:t.booking_slot||_t.booking_slot||1,status:"Booked",is_confirmed:t.is_confirmed||!1,booking_status:t.booking_status,has_sale:t.has_sale||t.hasSale||0,image_url:t.image_url,notes:t.notes,postcode:t.postcode,start:i,end:l,backgroundColor:Dr(a,t.hasSale,t.is_confirmed),borderColor:Dr(a,t.hasSale,t.is_confirmed),extendedProps:{lead:Ye(Ye({},t),{},{bookingHistory:Array.isArray(t.bookingHistory)?t.bookingHistory:t.booking_history||[]}),phone:_t.phone,status:"Booked",displayStatus:a,booker:e.name||"Current User",isConfirmed:t.is_confirmed||!1}};we(e=>{const r=e.filter(e=>e.id!==d);return[...n?r.filter(e=>e.id!==t.id):r,s]}),Ct({type:"booking_created",lead:t,event:s,timestamp:new Date});const o=n?"\u2705 Appointment updated successfully for ".concat(_t.name,"!"):"\u2705 Appointment booked successfully for ".concat(_t.name,"!");alert(o),console.log("\ud83d\udcc5 Booking action: ".concat(n?"Updated existing lead":"Created new lead"," for ").concat(_t.name)),setTimeout(()=>{console.log("\ud83d\udcc5 Refreshing calendar after booking to ensure consistency"),Ir()},2e3),setTimeout(()=>{console.log("\ud83d\udcc5 Second refresh to catch any delayed updates"),Ir()},5e3)}}catch(f){var u,m,h,p;if(console.error("Error creating booking:",f),console.error("Error details:",{status:null===(u=f.response)||void 0===u?void 0:u.status,message:null===(m=f.response)||void 0===m||null===(h=m.data)||void 0===h?void 0:h.message,data:null===(p=f.response)||void 0===p?void 0:p.data,formData:_t}),f.response&&400===f.response.status)return void alert("\u274c Booking failed: ".concat(f.response.data.message||"Invalid data provided"));if(f.response&&401===f.response.status)return void alert("\u274c Authentication required. Please log in again.");if(f.response&&403===f.response.status)return void alert("\u274c Access denied. You don't have permission to create bookings.");const e={id:d,title:"".concat(_t.name," - Booked (Pending)"),start:i,end:l,backgroundColor:"#FFA500",borderColor:"#FFA500",extendedProps:{lead:_t,phone:_t.phone,status:"Booked",booker:"Current User",isPending:!0}};we(t=>[...t,e]),"NETWORK_ERROR"!==f.code&&navigator.onLine?alert("\u26a0\ufe0f Booking created locally for ".concat(_t.name,". Please check your connection.")):alert("\ud83d\udcf1 Booking saved locally for ".concat(_t.name,". Will sync when connection is restored.")),setTimeout(()=>{Xr()},5e3)}finally{En(!1)}Et({_id:"",name:"",phone:"",email:"",postcode:"",status:"New",notes:"",image_url:""}),mt(!1),En(!1),fn(null),bn(!1),setTimeout(()=>{Ir()},500)},className:"btn-primary",children:_t._id?"Book Appointment":"Save Booking"})]})]})}),Ce&&ke&&ke.start&&(console.log("\ud83d\uddbc\ufe0f Modal opened - Full selectedEvent:",{id:ke.id,title:ke.title,hasExtendedProps:!!ke.extendedProps,hasLead:!(null===(ea=ke.extendedProps)||void 0===ea||!ea.lead),leadKeys:null!==(ta=ke.extendedProps)&&void 0!==ta&&ta.lead?Object.keys(ke.extendedProps.lead):[],image_url:null===(na=ke.extendedProps)||void 0===na||null===(ra=na.lead)||void 0===ra?void 0:ra.image_url,image_url_type:typeof(null===(aa=ke.extendedProps)||void 0===aa||null===(sa=aa.lead)||void 0===sa?void 0:sa.image_url),image_url_length:null===(oa=ke.extendedProps)||void 0===oa||null===(ia=oa.lead)||void 0===ia||null===(la=ia.image_url)||void 0===la?void 0:la.length}),!0)&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm z-50 flex items-center justify-center p-1 sm:p-2 md:p-4",children:(0,yr.jsxs)("div",{className:"relative w-full max-w-sm sm:max-w-2xl md:max-w-4xl lg:max-w-5xl bg-white rounded-lg shadow-2xl max-h-[95vh] overflow-y-auto calendar-modal-scroll flex flex-col",children:[(0,yr.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 p-3 sm:p-4",children:[(0,yr.jsxs)("div",{className:"flex-1 mb-2 sm:mb-0 mt-10 sm:mt-0",children:[(0,yr.jsxs)("h3",{className:"text-lg sm:text-xl font-bold text-white mb-1 flex items-center flex-wrap",children:[(null===(n=ke.extendedProps)||void 0===n||null===(r=n.lead)||void 0===r?void 0:r.name)||ke.title,(null===(a=ke.extendedProps)||void 0===a||null===(o=a.lead)||void 0===o?void 0:o.age)&&(0,yr.jsxs)("span",{className:"text-white/90 font-normal ml-2",children:["(",ke.extendedProps.lead.age,")"]}),ke.hasUnreadSms||ke.hasUnreadEmail?(0,yr.jsxs)("span",{className:"relative ml-2 animate-pulse",children:[ke.hasUnreadSms?(0,yr.jsx)(Ys,{className:"inline-block w-5 h-5 text-green-300"}):(0,yr.jsx)(Vs,{className:"inline-block w-5 h-5 text-yellow-300"}),(0,yr.jsx)("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full animate-ping",style:{animationDuration:"1.5s"}}),(0,yr.jsx)("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full"})]}):ke.hasReceivedSms||ke.hasReceivedEmail?(0,yr.jsx)("span",{className:"ml-2",children:ke.hasReceivedSms?(0,yr.jsx)(Ys,{className:"inline-block w-4 h-4 text-white/50"}):(0,yr.jsx)(Vs,{className:"inline-block w-4 h-4 text-white/50"})}):null]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("span",{className:"".concat(Hr(null===(i=ke.extendedProps)||void 0===i?void 0:i.status)," px-3 py-1 rounded-lg text-sm font-medium"),children:(null===(l=ke.extendedProps)||void 0===l?void 0:l.status)||"Scheduled"}),(null===(c=ke.extendedProps)||void 0===c?void 0:c.isConfirmed)&&(0,yr.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-lg text-xs font-medium bg-white/20 text-white",children:[(0,yr.jsx)(gs,{className:"h-4 w-4 mr-2"}),"Confirmed"]})]}),((null===(d=ke.extendedProps)||void 0===d||null===(u=d.lead)||void 0===u?void 0:u.booked_at)||(null===(m=ke.extendedProps)||void 0===m||null===(h=m.lead)||void 0===h?void 0:h.created_at))&&(0,yr.jsxs)("p",{className:"text-white/80 text-xs mt-1",children:["Booked on: ",new Date(ke.extendedProps.lead.booked_at||ke.extendedProps.lead.created_at).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})]})]}),(0,yr.jsxs)("div",{className:"relative ml-0 sm:ml-4 absolute top-3 right-3 sm:static",children:[(0,yr.jsx)("div",{className:"cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>{var e,t;null!==(e=ke.extendedProps)&&void 0!==e&&null!==(t=e.lead)&&void 0!==t&&t.image_url&&(console.log("\ud83d\uddbc\ufe0f Opening image:",ke.extendedProps.lead.image_url),Xn(ke.extendedProps.lead.image_url))},children:(0,yr.jsx)(Kl,{src:zl(null===(g=ke.extendedProps)||void 0===g||null===(x=g.lead)||void 0===x?void 0:x.image_url,"optimized"),alt:(null===(y=ke.extendedProps)||void 0===y||null===(b=y.lead)||void 0===b?void 0:b.name)||ke.title,className:"w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 border-white shadow-lg object-cover",fallbackClassName:"w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 border-white shadow-lg bg-white flex items-center justify-center",lazy:!1,preload:!0,onError:()=>{var e,t;console.error("\u274c Image failed to load:",null===(e=ke.extendedProps)||void 0===e||null===(t=e.lead)||void 0===t?void 0:t.image_url)},onLoad:()=>{var e,t;console.log("\u2705 Image loaded successfully:",null===(e=ke.extendedProps)||void 0===e||null===(t=e.lead)||void 0===t?void 0:t.image_url)}},"".concat(ke.id,"-").concat((null===(p=ke.extendedProps)||void 0===p||null===(f=p.lead)||void 0===f?void 0:f.image_url)||"no-image"))}),(0,yr.jsx)("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 sm:w-5 sm:h-5 rounded-full border-2 border-white shadow-lg ".concat("Attended"===(null===(v=ke.extendedProps)||void 0===v?void 0:v.status)?"bg-green-500":"Booked"===(null===(w=ke.extendedProps)||void 0===w?void 0:w.status)?"bg-blue-500":"Cancelled"===(null===(j=ke.extendedProps)||void 0===j?void 0:j.status)?"bg-red-500":"bg-gray-400")})]}),(()=>{const e=(()=>{const e=Kr(),t=e.findIndex(e=>e.id===ke.id);return{canGoPrevious:t>0,canGoNext:t<e.length-1,currentIndex:t+1,totalEvents:e.length}})();return(0,yr.jsxs)("div",{className:"absolute top-3 left-1/2 transform -translate-x-1/2 flex space-x-1 sm:space-x-2 z-10",children:[(0,yr.jsx)("button",{onClick:Jr,disabled:!e.canGoPrevious,className:"p-1.5 sm:p-2 rounded-full bg-white/20 backdrop-blur-sm transition-all duration-200 ".concat(e.canGoPrevious?"text-white hover:text-gray-900 hover:bg-white/40 shadow-lg":"text-white/30 cursor-not-allowed bg-white/10"),title:"Previous booking",children:(0,yr.jsx)(ys,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),(0,yr.jsx)("button",{onClick:Tr,className:"p-1.5 sm:p-2 rounded-full bg-white/20 backdrop-blur-sm text-white hover:text-gray-900 hover:bg-white/40 transition-all duration-200 shadow-lg",title:"Close",children:(0,yr.jsx)(ko,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),(0,yr.jsx)("button",{onClick:Qr,disabled:!e.canGoNext,className:"p-1.5 sm:p-2 rounded-full bg-white/20 backdrop-blur-sm transition-all duration-200 ".concat(e.canGoNext?"text-white hover:text-gray-900 hover:bg-white/40 shadow-lg":"text-white/30 cursor-not-allowed bg-white/10"),title:"Next booking",children:(0,yr.jsx)(bs,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]})})()]}),(0,yr.jsxs)("div",{className:"p-2 sm:p-3 md:p-4 flex-1",children:[(0,yr.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("h4",{className:"text-sm font-bold text-gray-900 mb-3 flex items-center",children:[(0,yr.jsx)(vo,{className:"h-4 w-4 mr-2 text-indigo-600"}),"Contact Information"]}),(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsx)("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-3",children:(0,yr.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,yr.jsx)("div",{className:"w-8 h-8 rounded-lg bg-indigo-500 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(hs,{className:"h-4 w-4 text-white"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("p",{className:"text-xs font-medium text-indigo-600 uppercase tracking-wide",children:"Appointment Date & Time"}),(0,yr.jsx)("p",{className:"text-sm font-bold text-gray-900",children:ke.start?new Date(ke.start).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"Date not available"}),(0,yr.jsxs)("p",{className:"text-xs text-gray-600 flex items-center",children:[(0,yr.jsx)(ws,{className:"h-3 w-3 mr-1"}),ke.start?(e=>{const t=new Date(e.start),n=e.end?new Date(e.end):t;return"".concat(t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})," - ").concat(n.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}))})(ke):"Time not available"]})]})]})}),(null===(N=ke.extendedProps)||void 0===N?void 0:N.phone)&&(0,yr.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-3",children:(0,yr.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,yr.jsx)("div",{className:"w-8 h-8 rounded-lg bg-purple-500 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(Js,{className:"h-4 w-4 text-white"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("p",{className:"text-xs font-medium text-purple-600 uppercase tracking-wide",children:"Phone Number"}),(0,yr.jsx)("p",{className:"text-sm font-bold text-gray-900",children:ke.extendedProps.phone}),(0,yr.jsx)("a",{href:"tel:".concat(ke.extendedProps.phone),className:"text-xs text-purple-600 hover:text-purple-800 transition-colors",children:"Click to call \u2192"})]})]})}),(null===(k=ke.extendedProps)||void 0===k||null===(S=k.lead)||void 0===S?void 0:S.email)&&(0,yr.jsx)("div",{className:"bg-gradient-to-r from-pink-50 to-rose-50 rounded-lg p-3",children:(0,yr.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,yr.jsx)("div",{className:"w-8 h-8 rounded-lg bg-pink-500 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(Vs,{className:"h-4 w-4 text-white"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("p",{className:"text-xs font-medium text-pink-600 uppercase tracking-wide",children:"Email Address"}),(0,yr.jsx)("p",{className:"text-sm font-bold text-gray-900 break-all",children:ke.extendedProps.lead.email}),(0,yr.jsx)("a",{href:"mailto:".concat(ke.extendedProps.lead.email),className:"text-xs text-pink-600 hover:text-pink-800 transition-colors",children:"Send email \u2192"})]})]})}),(null===(C=ke.extendedProps)||void 0===C||null===(_=C.lead)||void 0===_?void 0:_.postcode)&&(0,yr.jsx)("div",{className:"bg-gradient-to-r from-orange-50 to-amber-50 rounded-lg p-3",children:(0,yr.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,yr.jsx)("div",{className:"w-8 h-8 rounded-lg bg-orange-500 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(Ws,{className:"h-4 w-4 text-white"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("p",{className:"text-xs font-medium text-orange-600 uppercase tracking-wide",children:"Postcode"}),(0,yr.jsx)("p",{className:"text-sm font-bold text-gray-900",children:ke.extendedProps.lead.postcode}),(0,yr.jsx)("a",{href:"https://maps.google.com/maps?q=".concat(ke.extendedProps.lead.postcode),target:"_blank",rel:"noopener noreferrer",className:"text-xs text-orange-600 hover:text-orange-800 transition-colors",children:"View on map \u2192"})]})]})}),(0,yr.jsxs)("div",{className:"mt-4 bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-100 rounded-xl p-4 border border-gray-200 shadow-sm",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,yr.jsxs)("h5",{className:"text-xs font-bold text-gray-700 uppercase tracking-widest flex items-center",children:[(0,yr.jsx)("span",{className:"w-6 h-6 rounded-full bg-gradient-to-r from-gray-800 to-gray-600 flex items-center justify-center mr-2",children:(0,yr.jsx)(vo,{className:"h-3 w-3 text-white"})}),"Model Stats"]}),(0,yr.jsxs)("button",{onClick:()=>tt(!et),className:"text-xs text-gray-500 hover:text-gray-700 transition-colors flex items-center gap-1",children:[(0,yr.jsx)(Ss,{className:"h-3 w-3"}),et?"Cancel":"Edit"]})]}),et?(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Date of Birth"}),(0,yr.jsx)("input",{type:"date",value:at.date_of_birth||"",onChange:e=>st(Ye(Ye({},at),{},{date_of_birth:e.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent transition-all"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Height (inches)"}),(0,yr.jsx)("input",{type:"number",value:at.height_inches||"",onChange:e=>st(Ye(Ye({},at),{},{height_inches:e.target.value})),placeholder:"e.g. 65",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent transition-all"})]})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Chest (inches)"}),(0,yr.jsx)("input",{type:"number",value:at.chest_inches||"",onChange:e=>st(Ye(Ye({},at),{},{chest_inches:e.target.value})),placeholder:"e.g. 34",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent transition-all"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Waist (inches)"}),(0,yr.jsx)("input",{type:"number",value:at.waist_inches||"",onChange:e=>st(Ye(Ye({},at),{},{waist_inches:e.target.value})),placeholder:"e.g. 28",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent transition-all"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Hips (inches)"}),(0,yr.jsx)("input",{type:"number",value:at.hips_inches||"",onChange:e=>st(Ye(Ye({},at),{},{hips_inches:e.target.value})),placeholder:"e.g. 36",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent transition-all"})]})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Eye Color"}),(0,yr.jsxs)("select",{value:at.eye_color||"",onChange:e=>st(Ye(Ye({},at),{},{eye_color:e.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent transition-all",children:[(0,yr.jsx)("option",{value:"",children:"Select..."}),(0,yr.jsx)("option",{value:"Brown",children:"Brown"}),(0,yr.jsx)("option",{value:"Blue",children:"Blue"}),(0,yr.jsx)("option",{value:"Green",children:"Green"}),(0,yr.jsx)("option",{value:"Hazel",children:"Hazel"}),(0,yr.jsx)("option",{value:"Grey",children:"Grey"}),(0,yr.jsx)("option",{value:"Amber",children:"Amber"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Hair Color"}),(0,yr.jsxs)("select",{value:at.hair_color||"",onChange:e=>st(Ye(Ye({},at),{},{hair_color:e.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent transition-all",children:[(0,yr.jsx)("option",{value:"",children:"Select..."}),(0,yr.jsx)("option",{value:"Black",children:"Black"}),(0,yr.jsx)("option",{value:"Brown",children:"Brown"}),(0,yr.jsx)("option",{value:"Blonde",children:"Blonde"}),(0,yr.jsx)("option",{value:"Red",children:"Red"}),(0,yr.jsx)("option",{value:"Auburn",children:"Auburn"}),(0,yr.jsx)("option",{value:"Grey",children:"Grey"}),(0,yr.jsx)("option",{value:"White",children:"White"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Hair Length"}),(0,yr.jsxs)("select",{value:at.hair_length||"",onChange:e=>st(Ye(Ye({},at),{},{hair_length:e.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent transition-all",children:[(0,yr.jsx)("option",{value:"",children:"Select..."}),(0,yr.jsx)("option",{value:"Bald",children:"Bald"}),(0,yr.jsx)("option",{value:"Buzz",children:"Buzz"}),(0,yr.jsx)("option",{value:"Short",children:"Short"}),(0,yr.jsx)("option",{value:"Medium",children:"Medium"}),(0,yr.jsx)("option",{value:"Long",children:"Long"}),(0,yr.jsx)("option",{value:"Very Long",children:"Very Long"})]})]})]}),(0,yr.jsx)("button",{onClick:async()=>{if(null!==ke&&void 0!==ke&&ke.id){rt(!0);try{const e=await xr.put("/api/leads/".concat(ke.id),{date_of_birth:at.date_of_birth||null,height_inches:at.height_inches?parseInt(at.height_inches):null,chest_inches:at.chest_inches?parseInt(at.chest_inches):null,waist_inches:at.waist_inches?parseInt(at.waist_inches):null,hips_inches:at.hips_inches?parseInt(at.hips_inches):null,eye_color:at.eye_color||null,hair_color:at.hair_color||null,hair_length:at.hair_length||null});if(e.data.success||e.data.lead){e.data.lead||e.data;we(e=>e.map(e=>e.id===ke.id?Ye(Ye({},e),{},{extendedProps:Ye(Ye({},e.extendedProps),{},{lead:Ye(Ye({},e.extendedProps.lead),{},{date_of_birth:at.date_of_birth,height_inches:at.height_inches,chest_inches:at.chest_inches,waist_inches:at.waist_inches,hips_inches:at.hips_inches,eye_color:at.eye_color,hair_color:at.hair_color,hair_length:at.hair_length})})}):e)),Se(e=>e?Ye(Ye({},e),{},{extendedProps:Ye(Ye({},e.extendedProps),{},{lead:Ye(Ye({},e.extendedProps.lead),{},{date_of_birth:at.date_of_birth,height_inches:at.height_inches,chest_inches:at.chest_inches,waist_inches:at.waist_inches,hips_inches:at.hips_inches,eye_color:at.eye_color,hair_color:at.hair_color,hair_length:at.hair_length})})}):null),tt(!1),alert("Model stats saved successfully!")}}catch(e){console.error("Error saving stats:",e),alert("Failed to save stats. Please try again.")}finally{rt(!1)}}},disabled:nt,className:"w-full mt-2 px-4 py-2 bg-gradient-to-r from-gray-800 to-gray-700 text-white text-sm font-medium rounded-lg hover:from-gray-700 hover:to-gray-600 transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:nt?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(gs,{className:"h-4 w-4"}),"Save Stats"]})})]}):(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center py-1.5 border-b border-gray-200",children:[(0,yr.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"DOB"}),(0,yr.jsx)("span",{className:"text-sm font-medium text-gray-900",children:null!==(E=ke.extendedProps)&&void 0!==E&&null!==(P=E.lead)&&void 0!==P&&P.date_of_birth?new Date(ke.extendedProps.lead.date_of_birth).toLocaleDateString("en-GB"):"\u2014"})]}),(0,yr.jsxs)("div",{className:"flex justify-between items-center py-1.5 border-b border-gray-200",children:[(0,yr.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Height"}),(0,yr.jsx)("span",{className:"text-sm font-medium text-gray-900",children:null!==(O=ke.extendedProps)&&void 0!==O&&null!==(A=O.lead)&&void 0!==A&&A.height_inches?"".concat(ke.extendedProps.lead.height_inches,'"'):"\u2014"})]}),(0,yr.jsxs)("div",{className:"flex justify-between items-center py-1.5 border-b border-gray-200",children:[(0,yr.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Chest"}),(0,yr.jsx)("span",{className:"text-sm font-medium text-gray-900",children:null!==(T=ke.extendedProps)&&void 0!==T&&null!==(D=T.lead)&&void 0!==D&&D.chest_inches?"".concat(ke.extendedProps.lead.chest_inches,'"'):"\u2014"})]}),(0,yr.jsxs)("div",{className:"flex justify-between items-center py-1.5 border-b border-gray-200",children:[(0,yr.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Waist"}),(0,yr.jsx)("span",{className:"text-sm font-medium text-gray-900",children:null!==(M=ke.extendedProps)&&void 0!==M&&null!==(I=M.lead)&&void 0!==I&&I.waist_inches?"".concat(ke.extendedProps.lead.waist_inches,'"'):"\u2014"})]}),(0,yr.jsxs)("div",{className:"flex justify-between items-center py-1.5 border-b border-gray-200",children:[(0,yr.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Hips"}),(0,yr.jsx)("span",{className:"text-sm font-medium text-gray-900",children:null!==(L=ke.extendedProps)&&void 0!==L&&null!==(R=L.lead)&&void 0!==R&&R.hips_inches?"".concat(ke.extendedProps.lead.hips_inches,'"'):"\u2014"})]}),(0,yr.jsxs)("div",{className:"flex justify-between items-center py-1.5 border-b border-gray-200",children:[(0,yr.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Eyes"}),(0,yr.jsx)("span",{className:"text-sm font-medium text-gray-900",children:(null===(F=ke.extendedProps)||void 0===F||null===(B=F.lead)||void 0===B?void 0:B.eye_color)||"\u2014"})]}),(0,yr.jsxs)("div",{className:"flex justify-between items-center py-1.5 border-b border-gray-200",children:[(0,yr.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Hair"}),(0,yr.jsx)("span",{className:"text-sm font-medium text-gray-900",children:(null===(U=ke.extendedProps)||void 0===U||null===(z=U.lead)||void 0===z?void 0:z.hair_color)||"\u2014"})]}),(0,yr.jsxs)("div",{className:"col-span-2 flex justify-between items-center py-1.5",children:[(0,yr.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Hair Length"}),(0,yr.jsx)("span",{className:"text-sm font-medium text-gray-900",children:(null===(V=ke.extendedProps)||void 0===V||null===(W=V.lead)||void 0===W?void 0:W.hair_length)||"\u2014"})]})]})]})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("h4",{className:"text-sm font-bold text-gray-900 mb-3 flex items-center",children:[(0,yr.jsx)(so,{className:"h-4 w-4 mr-2 text-indigo-600"}),"Details & Actions"]}),(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{className:"bg-white border border-gray-100 rounded-lg p-3",children:[(0,yr.jsx)("h5",{className:"text-sm font-bold text-gray-900 mb-2",children:"Booking confirmation channels"}),(0,yr.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,yr.jsxs)("label",{className:"inline-flex items-center space-x-2",children:[(0,yr.jsx)("input",{type:"checkbox",className:"h-4 w-4 text-indigo-600 border-gray-300 rounded",checked:sn,onChange:e=>on(e.target.checked)}),(0,yr.jsx)("span",{className:"text-sm text-gray-700",children:"Email"})]}),(0,yr.jsxs)("label",{className:"inline-flex items-center space-x-2",children:[(0,yr.jsx)("input",{type:"checkbox",className:"h-4 w-4 text-indigo-600 border-gray-300 rounded",checked:ln,onChange:e=>cn(e.target.checked)}),(0,yr.jsx)("span",{className:"text-sm text-gray-700",children:"Text (SMS)"})]})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"These settings apply when you reschedule from this modal."}),(sn||ln)&&(0,yr.jsxs)("div",{className:"mt-3",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"primary"===vn?"Booking Confirmation":"Secondary Confirmation"}),gn&&gn.length>0&&(0,yr.jsxs)("button",{type:"button",onClick:()=>wn("primary"===vn?"secondary":"primary"),className:"flex items-center space-x-2 px-3 py-1.5 text-sm font-semibold rounded-lg shadow-sm transition-all duration-200 ".concat("primary"===vn?"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600":"bg-gradient-to-r from-indigo-500 to-blue-500 text-white hover:from-indigo-600 hover:to-blue-600"),children:[(0,yr.jsx)(to,{className:"h-4 w-4"}),(0,yr.jsxs)("span",{children:["Switch to ","primary"===vn?"Confirm":"Primary"]})]})]}),"primary"===vn?mn.length>0?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("select",{value:dn||"",onChange:e=>un(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm",children:mn.map(e=>(0,yr.jsxs)("option",{value:e._id,children:[e.name," ","secondary"===e.emailAccount?"(Diary)":"(Primary)"]},e._id))}),sn&&!Nn&&(0,yr.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:"\u26a0\ufe0f This template has email disabled"}),ln&&!kn&&(0,yr.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:"\u26a0\ufe0f This template has SMS disabled"})]}):(0,yr.jsx)("div",{className:"text-xs text-amber-600 bg-amber-50 border border-amber-200 rounded-md p-2",children:"\u26a0\ufe0f No active booking templates found"}):(0,yr.jsxs)("select",{value:pn||"",onChange:e=>fn(e.target.value||null),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm",children:[(0,yr.jsx)("option",{value:"",children:"None - No secondary email"}),gn.map(e=>(0,yr.jsx)("option",{value:e._id,children:e.name},e._id))]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"primary"===vn?"Main booking confirmation":"Optional additional email"})]}),(null===(q=ke.extendedProps)||void 0===q||null===(H=q.lead)||void 0===H?void 0:H.date_booked)&&(0,yr.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:"primary"===vn?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsxs)("button",{onClick:async()=>{var e;if(!ke||null===(e=ke.extendedProps)||void 0===e||!e.lead)return void alert("No lead data available for this event.");const t=ke.extendedProps.lead.id||ke.id,n=ke.extendedProps.lead.name||ke.title.split(" - ")[0];if(t){if(window.confirm("Resend welcome pack to ".concat(n,"?\n\nThis will send the booking confirmation email and SMS using the selected template.")))try{const e=await xr.post("/api/leads/".concat(t,"/resend-welcome-pack"),{templateId:dn||(mn.length>0?mn[0]._id:null)});if(e.data.success){const t=[];e.data.emailSent&&t.push("Email"),e.data.smsSent&&t.push("SMS"),alert("\u2705 Welcome pack resent successfully via ".concat(t.join(" and "),"!")),setTimeout(()=>{Ir()},1e3)}else alert("\u274c Failed to resend welcome pack: ".concat(e.data.message||"Unknown error"))}catch(s){var r,a;console.error("Error resending welcome pack:",s),alert("\u274c Error resending welcome pack: ".concat((null===(r=s.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||s.message||"Unknown error"))}}else alert("Unable to identify lead ID.")},className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-lg hover:from-indigo-600 hover:to-purple-700 transition-all duration-200 shadow-md hover:shadow-lg",title:"Resend welcome pack (booking confirmation email and SMS)",children:[(0,yr.jsx)(ao,{className:"h-4 w-4"}),(0,yr.jsx)("span",{className:"text-sm font-medium",children:"Resend Welcome Pack"})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1 text-center",children:"Sends booking confirmation via email and SMS"})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsxs)("button",{onClick:async()=>{var e,t;if(!ke||null===(e=ke.extendedProps)||void 0===e||!e.lead)return void alert("No lead data available for this event.");if(!pn)return void alert("Please select a template first.");const n=ke.extendedProps.lead.id||ke.id,r=ke.extendedProps.lead.name||ke.title.split(" - ")[0],a=(null===(t=gn.find(e=>e._id===pn))||void 0===t?void 0:t.name)||"Template";if(n){if(window.confirm('Send "'.concat(a,'" to ').concat(r,"?")))try{const e=await xr.post("/api/leads/".concat(n,"/resend-welcome-pack"),{templateId:pn});if(e.data.success){const t=[];e.data.emailSent&&t.push("Email"),e.data.smsSent&&t.push("SMS"),alert('\u2705 "'.concat(a,'" sent successfully via ').concat(t.join(" and "),"!")),setTimeout(()=>{Ir()},1e3)}else alert("\u274c Failed to send template: ".concat(e.data.message||"Unknown error"))}catch(i){var s,o;console.error("Error sending template:",i),alert("\u274c Error sending template: ".concat((null===(s=i.response)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.message)||i.message||"Unknown error"))}}else alert("Unable to identify lead ID.")},disabled:!pn,className:"w-full flex items-center justify-center space-x-2 px-4 py-2 rounded-lg transition-all duration-200 shadow-md hover:shadow-lg ".concat(pn?"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600":"bg-gray-200 text-gray-400 cursor-not-allowed"),title:"Send selected template",children:[(0,yr.jsx)(ao,{className:"h-4 w-4"}),(0,yr.jsx)("span",{className:"text-sm font-medium",children:"Send"})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1 text-center",children:pn?"Send selected template to customer":"Select a template above"})]})})]}),(null===(Y=ke.extendedProps)||void 0===Y?void 0:Y.booker)&&(0,yr.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-3",children:(0,yr.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,yr.jsx)("div",{className:"w-8 h-8 rounded-lg bg-green-500 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(vo,{className:"h-4 w-4 text-white"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("p",{className:"text-xs font-medium text-green-600 uppercase tracking-wide",children:"Assigned To"}),(0,yr.jsx)("p",{className:"text-sm font-bold text-gray-900",children:ke.extendedProps.booker}),(0,yr.jsx)("p",{className:"text-xs text-green-600",children:"Account Manager"})]})]})}),(0,yr.jsxs)("div",{className:"bg-white border border-gray-100 rounded-lg p-3",children:[(0,yr.jsxs)("h5",{className:"text-sm font-bold text-gray-900 mb-2 flex items-center",children:[(0,yr.jsx)(ss,{className:"h-4 w-4 mr-2 text-indigo-600"}),"Quick Status Update"]}),((e,t,n,r,a,s,o)=>{const i="Booked"===(null===(e=ke.extendedProps)||void 0===e?void 0:e.status),l=null===(t=ke.extendedProps)||void 0===t?void 0:t.isConfirmed,c=(null===(n=ke.extendedProps)||void 0===n?void 0:n.isDoubleConfirmed)||(null===(r=ke.extendedProps)||void 0===r||null===(a=r.lead)||void 0===a?void 0:a.is_double_confirmed);let d=(null===(s=ke.extendedProps)||void 0===s?void 0:s.displayStatus)||(null===(o=ke.extendedProps)||void 0===o?void 0:o.bookingStatus);if(!d)if(i&&c)d="Double Confirmed";else if(i&&l)d="Confirmed";else if(i&&!1===l)d="Unconfirmed";else if(i)d="Booked";else{var u;d=(null===(u=ke.extendedProps)||void 0===u?void 0:u.status)||"Unknown"}const m="admin"===(null===ge||void 0===ge?void 0:ge.role)||"viewer"===(null===ge||void 0===ge?void 0:ge.role)||"booker"===(null===ge||void 0===ge?void 0:ge.role),h="admin"===(null===ge||void 0===ge?void 0:ge.role)||"viewer"===(null===ge||void 0===ge?void 0:ge.role),p=[{value:"Unconfirmed",label:"Unconfirmed",color:"#fb923c",permission:m},{value:"Confirmed",label:"Confirmed \u2713",color:"#22c55e",permission:m},{value:"Double Confirmed",label:"Double Confirmed \u2713\u2713",color:"#15803d",permission:m},{value:"Arrived",label:"Arrived",color:"#2563eb",permission:h},{value:"Left",label:"Left",color:"#1f2937",permission:h},{value:"No Show",label:"No Show",color:"#ef4444",permission:h},{value:"No Sale",label:"No Sale",color:"#b91c1c",permission:h},{value:"Review",label:"Review",color:"#8b5cf6",permission:h},{value:"Cancelled",label:"Cancelled",color:"#f43f5e",permission:m}],f=()=>{const e=p.find(e=>e.value===d);return(null===e||void 0===e?void 0:e.color)||"#6b7280"};return(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)("select",{value:d,onChange:e=>{const t=e.target.value;"Review"===t?qe(!0):$r(t)},className:"w-full px-4 py-3 rounded-lg border-2 border-gray-200 bg-white text-sm font-semibold appearance-none cursor-pointer hover:border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-all",style:{paddingLeft:"40px",borderLeftWidth:"4px",borderLeftColor:f()},children:p.filter(e=>e.permission).map(e=>(0,yr.jsx)("option",{value:e.value,style:{color:e.color},children:e.label},e.value))}),(0,yr.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 rounded-full shadow-sm border-2 border-white",style:{backgroundColor:f()}}),(0,yr.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:(0,yr.jsx)(xs,{className:"h-5 w-5 text-gray-400"})})]}),(0,yr.jsx)("div",{className:"grid grid-cols-3 gap-2 text-xs",children:p.slice(0,6).map(e=>(0,yr.jsxs)("div",{className:"flex items-center space-x-1.5",children:[(0,yr.jsx)("div",{className:"w-3 h-3 rounded-full flex-shrink-0 shadow-sm",style:{backgroundColor:e.color}}),(0,yr.jsx)("span",{className:"text-gray-700 font-medium truncate",children:e.value.replace(" Confirmed","")})]},e.value))})]})})()]})]})]})]}),(0,yr.jsx)("div",{className:"mt-4 pt-3 border-t border-gray-200",children:(0,yr.jsxs)("div",{className:"flex flex-col space-y-3",children:[((e,t,n,r,a,s)=>{const o=null!==(e=null!==(t=null===(n=ke.extendedProps)||void 0===n||null===(r=n.lead)||void 0===r?void 0:r.bookingHistory)&&void 0!==t?t:null===(a=ke.extendedProps)||void 0===a||null===(s=a.lead)||void 0===s?void 0:s.booking_history)&&void 0!==e?e:[];let i=[];try{Array.isArray(o)?i=o:"string"===typeof o?i=o.trim()?JSON.parse(o):[]:o&&"object"===typeof o&&(i=Array.isArray(o)?o:[])}catch(FB){i=[]}const l=Array.isArray(i)?i.filter(e=>["SMS_SENT","SMS_RECEIVED","SMS_FAILED","EMAIL_SENT","EMAIL_RECEIVED"].includes(e.action)):[];return 0===l.length?null:(0,yr.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-3",style:{minWidth:0},children:(0,yr.jsxs)("div",{className:"flex items-start space-x-3",style:{minWidth:0},children:[(0,yr.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-500 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(Ys,{className:"h-4 w-4 text-white"})}),(0,yr.jsx)("div",{className:"flex-1 min-w-0",children:(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:"Messages"}),(0,yr.jsx)("span",{className:"text-xs bg-blue-200 text-blue-700 px-2 py-0.5 rounded-full",children:l.length})]}),(()=>{const e=l.some(e=>e.action.startsWith("SMS")),t=l.some(e=>e.action.startsWith("EMAIL"));return(0,yr.jsxs)("div",{className:"flex items-center space-x-1",children:[e&&(0,yr.jsx)("span",{className:"text-[10px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded",children:"SMS"}),t&&(0,yr.jsx)("span",{className:"text-[10px] bg-indigo-100 text-indigo-600 px-1.5 py-0.5 rounded",children:"Email"})]})})()]}),((e,t,n,r,a,s,o,i)=>{const c=l[l.length-1],d=l.some(e=>e.action.startsWith("SMS")),u=l.some(e=>e.action.startsWith("EMAIL"));return(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsxs)("div",{onClick:()=>{Ve(d&&!u?"sms":u?"email":"sms"),Ue(!0)},className:"cursor-pointer bg-white rounded-lg p-2 md:p-3 shadow-sm border border-blue-200 hover:border-blue-400 hover:shadow-md transition-all group w-full overflow-hidden",style:{maxWidth:"100%",minWidth:0},children:[(0,yr.jsxs)("div",{className:"flex items-start space-x-2 overflow-hidden",children:[(0,yr.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 ".concat(["SMS_SENT","EMAIL_SENT"].includes(c.action)?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"),children:["SMS_SENT","EMAIL_SENT"].includes(c.action)?(0,yr.jsx)("span",{className:"text-xs font-bold",children:"Y"}):(0,yr.jsx)(vo,{className:"w-3 h-3"})}),(0,yr.jsxs)("div",{className:"flex-1 min-w-0",style:{maxWidth:"calc(100% - 2rem)"},children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 mb-1 overflow-hidden",children:[(0,yr.jsx)("span",{className:"text-xs font-medium text-gray-700 truncate block max-w-[80px]",children:["SMS_SENT","EMAIL_SENT"].includes(c.action)?"You":(null===(e=ke.extendedProps)||void 0===e||null===(t=e.lead)||void 0===t?void 0:t.name)||"Customer"}),(0,yr.jsx)("span",{className:"text-[10px] flex-shrink-0 ".concat(c.action.startsWith("EMAIL")?"text-indigo-500":"text-blue-500"),children:c.action.startsWith("EMAIL")?"Email":"SMS"})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-600 group-hover:text-gray-800 transition-colors truncate block",style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},children:Oo((null===(n=c.details)||void 0===n?void 0:n.body)||(null===(r=c.details)||void 0===r?void 0:r.message)||"No content")})]})]}),(0,yr.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-100 flex items-center justify-between",children:[(0,yr.jsx)("span",{className:"text-xs text-gray-400",children:(()=>{try{if(!c.timestamp)return"";const e=new Date(c.timestamp);if(isNaN(e.getTime()))return"";const t=new Date,n=(t-e)/36e5;if(n<1){const n=Math.floor((t-e)/6e4);return n<=0?"Just now":"".concat(n,"m ago")}return n<24?e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):e.toLocaleDateString([],{month:"short",day:"numeric"})}catch(e){return""}})()}),(0,yr.jsxs)("span",{className:"text-xs font-medium text-blue-600 group-hover:text-blue-700 flex items-center",children:["View all messages",(0,yr.jsx)(bs,{className:"w-3 h-3 ml-0.5"})]})]})]}),(0,yr.jsxs)("div",{className:"mt-2 flex space-x-2",children:[(null===(a=ke.extendedProps)||void 0===a||null===(s=a.lead)||void 0===s?void 0:s.phone)&&(0,yr.jsxs)("button",{onClick:()=>{Ve("sms"),Ue(!0)},className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 bg-blue-500 text-white text-xs font-medium rounded-lg hover:bg-blue-600 transition-colors",children:[(0,yr.jsx)(Ys,{className:"w-3 h-3"}),(0,yr.jsx)("span",{children:"Reply SMS"})]}),(null===(o=ke.extendedProps)||void 0===o||null===(i=o.lead)||void 0===i?void 0:i.email)&&(0,yr.jsxs)("button",{onClick:()=>{Ve("email"),Ue(!0)},className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 bg-indigo-500 text-white text-xs font-medium rounded-lg hover:bg-indigo-600 transition-colors",children:[(0,yr.jsx)(Vs,{className:"w-3 h-3"}),(0,yr.jsx)("span",{children:"Reply Email"})]})]})]})})()]})})]})})})(),(0,yr.jsx)("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 rounded-lg p-3",children:(0,yr.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,yr.jsx)("div",{className:"w-8 h-8 rounded-lg bg-gray-500 flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(Os,{className:"h-4 w-4 text-white"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-1 cursor-pointer hover:bg-gray-100 -mx-2 px-2 py-1 rounded transition-colors",onClick:()=>!tn&&Te(!Oe),children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:"Notes"}),!tn&&(Oe?(0,yr.jsx)(vs,{className:"h-4 w-4 text-gray-600"}):(0,yr.jsx)(xs,{className:"h-4 w-4 text-gray-600"}))]}),!tn&&(0,yr.jsxs)("button",{onClick:e=>{e.stopPropagation(),(()=>{var e,t;const n=(null===(e=ke.extendedProps)||void 0===e||null===(t=e.lead)||void 0===t?void 0:t.notes)||"";an(n),Te(!0),nn(!0)})()},className:"text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center space-x-1 hover:bg-blue-50 px-2 py-1 rounded transition-colors",children:[(0,yr.jsx)(Cs,{className:"h-3 w-3"}),(0,yr.jsx)("span",{children:"Edit Notes"})]})]}),Oe&&(0,yr.jsx)(yr.Fragment,{children:tn?(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)("textarea",{value:rn,onChange:e=>an(e.target.value),rows:"6",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none break-words",placeholder:"Add detailed notes about this lead...",autoFocus:!0}),(0,yr.jsxs)("div",{className:"absolute bottom-2 right-2 text-xs text-gray-400",children:[rn.length," characters"]})]}),(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsx)("div",{className:"text-xs text-gray-500",children:"All users can edit notes \u2022 Changes appear in booking history"}),(0,yr.jsxs)("div",{className:"flex space-x-2",children:[(0,yr.jsx)("button",{onClick:async()=>{var e,t;if(null===ke||void 0===ke||!ke.id)return;const n=(null===(e=ke.extendedProps)||void 0===e||null===(t=e.lead)||void 0===t?void 0:t.notes)||"",r=rn.trim();if(n!==r){Cn(!0);try{const e=await xr.patch("/api/leads/".concat(ke.id,"/notes"),{notes:r,oldNotes:n});we(e=>e.map(e=>e.id===ke.id?Ye(Ye({},e),{},{extendedProps:Ye(Ye({},e.extendedProps),{},{lead:Ye(Ye({},e.extendedProps.lead),{},{notes:r})})}):e)),Se(e=>Ye(Ye({},e),{},{extendedProps:Ye(Ye({},e.extendedProps),{},{lead:Ye(Ye({},e.extendedProps.lead),{},{notes:r})})})),nn(!1);alert("Notes ".concat(n?"modified":"added"," successfully by ").concat(e.data.updatedBy,"!"))}catch(s){var a;console.error("Error updating notes:",s),403===(null===(a=s.response)||void 0===a?void 0:a.status)?alert("Access denied. You may not have permission to edit this lead."):alert("Failed to update notes. Please try again.")}finally{Cn(!1)}}else nn(!1)},disabled:Sn,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 text-sm font-medium flex items-center space-x-1",children:Sn?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),(0,yr.jsx)("span",{children:"Saving..."})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(gs,{className:"h-3 w-3"}),(0,yr.jsx)("span",{children:"Save Notes"})]})}),(0,yr.jsx)("button",{onClick:()=>{nn(!1),an("")},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 text-sm font-medium",children:"Cancel"})]})]})]}):(0,yr.jsx)("div",{className:"mt-2",children:null!==(G=ke.extendedProps)&&void 0!==G&&null!==(X=G.lead)&&void 0!==X&&X.notes?(0,yr.jsxs)("div",{className:"max-h-64 overflow-y-auto",children:[(0,yr.jsx)("p",{className:"text-base text-gray-900 leading-relaxed whitespace-pre-wrap break-words",children:ke.extendedProps.lead.notes}),((e,t,n,r)=>{const a=((null===(e=ke.extendedProps)||void 0===e||null===(t=e.lead)||void 0===t?void 0:t.bookingHistory)||(null===(n=ke.extendedProps)||void 0===n||null===(r=n.lead)||void 0===r?void 0:r.booking_history)||[]).filter(e=>"NOTES_UPDATED"===e.action),s=a[a.length-1];if(s){var o;const e=(null===(o=s.details)||void 0===o?void 0:o.updatedBy)||s.performedByName||s.performed_by_name||s.performedBy||s.performed_by||"Unknown",t=s.timestamp?new Date(s.timestamp).toLocaleString("en-GB",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}):"";return(0,yr.jsxs)("div",{className:"mt-2 text-xs text-gray-500 flex items-center justify-between",children:[(0,yr.jsxs)("span",{children:["Last updated by ",(0,yr.jsx)("span",{className:"font-medium text-gray-700",children:e})]}),t&&(0,yr.jsx)("span",{children:t})]})}return(0,yr.jsx)("div",{className:"mt-2 text-xs text-gray-500",children:'Click "Edit Notes" to modify'})})()]}):(0,yr.jsxs)("div",{className:"text-center py-4",children:[(0,yr.jsx)("p",{className:"text-base text-gray-500 italic",children:"No notes available"}),(0,yr.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:'Click "Edit Notes" to add notes'})]})})})]})]})}),Zt&&(0,yr.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,yr.jsx)("h4",{className:"font-bold text-blue-700 mb-2",children:"Sale Details"}),(0,yr.jsxs)("div",{className:"text-sm text-blue-900",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("b",{children:"Amount:"})," \xa3",Zt.saleAmount]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("b",{children:"Payment Method:"})," ",Zt.paymentMethod]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("b",{children:"Notes:"})," ",Zt.notes||"None"]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("b",{children:"Recorded By:"})," ",null===($=Zt.user)||void 0===$?void 0:$.name]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("b",{children:"Date:"})," ",new Date(Zt.bookingDate).toLocaleDateString()]})]})]}),(null===(K=ke.extendedProps)||void 0===K||null===(Q=K.lead)||void 0===Q?void 0:Q.bookingHistory)&&Array.isArray(ke.extendedProps.lead.bookingHistory)&&(()=>{const e=ke.extendedProps.lead.bookingHistory.filter(e=>["EMAIL_SENT","EMAIL_RECEIVED","SMS_SENT","SMS_RECEIVED"].includes(e.action));return 0===e.length?null:(0,yr.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-4 mt-4",children:[(0,yr.jsx)("div",{className:"flex items-center justify-between mb-2 cursor-pointer hover:bg-blue-100/50 -mx-2 px-2 py-1 rounded transition-colors",onClick:()=>Le(!Ie),children:(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("h4",{className:"text-base font-bold text-blue-700",children:"Message History"}),(0,yr.jsx)("span",{className:"text-xs text-blue-500 bg-blue-200/50 px-1.5 py-0.5 rounded-full",children:e.length}),Ie?(0,yr.jsx)(vs,{className:"h-4 w-4 text-blue-700"}):(0,yr.jsx)(xs,{className:"h-4 w-4 text-blue-700"})]})}),Ie&&(0,yr.jsx)("div",{className:"max-h-48 overflow-y-auto space-y-2",children:e.sort((e,t)=>new Date(t.timestamp)-new Date(e.timestamp)).map((e,t)=>{var n,r,a,s,o;return(0,yr.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,yr.jsx)("div",{className:"mt-0.5",children:e.action.startsWith("EMAIL")?(0,yr.jsx)(Vs,{className:"h-4 w-4 ".concat("EMAIL_RECEIVED"===e.action?"text-green-600":"text-indigo-500")}):(0,yr.jsx)(Ys,{className:"h-4 w-4 ".concat("SMS_RECEIVED"===e.action?"text-green-500":"text-blue-500")})}),(0,yr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,yr.jsxs)("div",{className:"text-xs font-semibold text-gray-700 flex items-center flex-wrap gap-1",children:[(0,yr.jsxs)("span",{children:["EMAIL_SENT"===e.action&&"Email Sent","EMAIL_RECEIVED"===e.action&&"Email Received","SMS_SENT"===e.action&&"SMS Sent","SMS_RECEIVED"===e.action&&"SMS Received"]}),((t,n,r)=>{const a=e.performedByName||e.performed_by_name||e.performedBy||e.performed_by||(null===(t=e.details)||void 0===t?void 0:t.sent_by_name)||(null===(n=e.details)||void 0===n?void 0:n.performedByName)||(null===(r=e.details)||void 0===r?void 0:r.performed_by_name);return a?(0,yr.jsxs)("span",{className:"text-blue-600 font-medium",children:["by ",a]}):null})(),(0,yr.jsx)("span",{className:"text-gray-400 font-normal ml-auto",children:new Date(e.timestamp).toLocaleString()})]}),(null===(n=e.details)||void 0===n?void 0:n.subject)&&(0,yr.jsxs)("div",{className:"text-xs text-gray-500 truncate",children:["Subject: ",e.details.subject]}),(0,yr.jsxs)("div",{className:"text-xs text-gray-600 truncate",children:[null===(r=e.details)||void 0===r||null===(a=r.body)||void 0===a?void 0:a.slice(0,100),((null===(s=e.details)||void 0===s||null===(o=s.body)||void 0===o?void 0:o.length)||0)>100?"...":""]})]})]},t)})})]})})()]})}),("admin"===(null===ge||void 0===ge?void 0:ge.role)||"viewer"===(null===ge||void 0===ge?void 0:ge.role)||"photographer"===(null===ge||void 0===ge?void 0:ge.role))&&(null===(Z=ke.extendedProps)||void 0===Z||null===(ee=Z.lead)||void 0===ee?void 0:ee.id)&&(0,yr.jsxs)("div",{className:"mt-6",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,yr.jsxs)("h4",{className:"text-sm font-bold text-gray-900 flex items-center",children:[(0,yr.jsx)(Is,{className:"h-4 w-4 mr-2 text-indigo-600"}),"Client Photos",$n.length>0&&(0,yr.jsx)("span",{className:"ml-2 bg-indigo-100 text-indigo-700 text-xs px-2 py-0.5 rounded-full",children:$n.length})]}),("photographer"===(null===ge||void 0===ge?void 0:ge.role)||"admin"===(null===ge||void 0===ge?void 0:ge.role))&&(0,yr.jsxs)("button",{onClick:()=>cr(!lr),className:"flex items-center space-x-1 px-3 py-1.5 rounded-lg text-xs font-medium transition-all ".concat(lr?"bg-indigo-600 text-white":"bg-indigo-100 text-indigo-700 hover:bg-indigo-200"),children:[(0,yr.jsx)(yo,{className:"h-3.5 w-3.5"}),(0,yr.jsx)("span",{children:lr?"Close":"Upload"})]})]}),lr&&("photographer"===(null===ge||void 0===ge?void 0:ge.role)||"admin"===(null===ge||void 0===ge?void 0:ge.role))&&(0,yr.jsx)("div",{className:"mb-4",children:wr||dr?(0,yr.jsxs)("div",{children:[wr&&!dr&&(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-2 px-2",children:[(0,yr.jsxs)("span",{className:"text-sm text-gray-600",children:["Uploading to: ",(0,yr.jsxs)("span",{className:"font-semibold text-indigo-700",children:[null===(te=Cr.find(e=>e.id===wr))||void 0===te?void 0:te.icon," ",null===(ne=Cr.find(e=>e.id===wr))||void 0===ne?void 0:ne.label]})]}),(0,yr.jsx)("button",{onClick:()=>jr(null),className:"text-xs text-indigo-600 hover:text-indigo-800 font-medium",children:"Change"})]}),(0,yr.jsx)("div",{onDragEnter:Vr,onDragLeave:Vr,onDragOver:Vr,onDrop:e=>{e.preventDefault(),e.stopPropagation(),br(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0&&zr(e.dataTransfer.files)},className:"border-2 border-dashed rounded-lg p-6 text-center transition-all ".concat(gr?"border-indigo-500 bg-indigo-50":"border-gray-300 bg-gray-50 hover:border-indigo-400"),children:dr?(0,yr.jsxs)("div",{className:"space-y-3 py-2",children:[(0,yr.jsxs)("div",{className:"relative mx-auto w-12 h-12",children:[(0,yr.jsx)(ps,{className:"h-12 w-12 text-indigo-600"}),(0,yr.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,yr.jsx)("div",{className:"w-16 h-16 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin"})})]}),(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsxs)("p",{className:"text-lg font-semibold text-indigo-700",children:["Uploading ",pr.current," of ",pr.total]}),pr.currentFileName&&(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1 font-mono",children:pr.currentFileName})]}),(0,yr.jsxs)("div",{className:"w-full",children:[(0,yr.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[(0,yr.jsxs)("span",{children:[mr,"% complete"]}),(0,yr.jsxs)("span",{children:[pr.total-pr.current," remaining"]})]}),(0,yr.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:(0,yr.jsx)("div",{className:"h-full rounded-full transition-all duration-300 ease-out relative overflow-hidden",style:{width:"".concat(mr,"%"),background:"linear-gradient(90deg, #4F46E5, #7C3AED)"},children:(0,yr.jsx)("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:"linear-gradient(45deg, rgba(255,255,255,.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,.15) 50%, rgba(255,255,255,.15) 75%, transparent 75%, transparent)",backgroundSize:"1rem 1rem",animation:"progress-stripes 1s linear infinite"}})})})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-400 text-center",children:"Please don't close this window"})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(yo,{className:"h-8 w-8 mx-auto text-gray-400 mb-2"}),(0,yr.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Drag & drop photos here"}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:"or click to select files"}),(0,yr.jsx)("input",{type:"file",ref:vr,multiple:!0,accept:"image/*,video/*",onChange:e=>zr(e.target.files),className:"hidden"}),(0,yr.jsx)("button",{onClick:()=>{var e;return null===(e=vr.current)||void 0===e?void 0:e.click()},className:"px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors",children:"Select Photos"})]})})]}):(0,yr.jsxs)("div",{className:"bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-4",children:[(0,yr.jsx)("h5",{className:"text-sm font-semibold text-gray-700 text-center mb-3",children:"Select Folder for Photos"}),(0,yr.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Cr.map(e=>(0,yr.jsxs)("button",{onClick:()=>jr(e.id),className:"flex items-center justify-center space-x-2 px-3 py-3 bg-white border-2 border-gray-200 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-all text-sm font-medium text-gray-700 hover:text-indigo-700",children:[(0,yr.jsx)("span",{className:"text-lg",children:e.icon}),(0,yr.jsx)("span",{children:e.label})]},e.id))})]})}),Zn?(0,yr.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[(0,yr.jsx)("div",{className:"animate-spin h-6 w-6 border-2 border-indigo-500 border-t-transparent rounded-full mx-auto mb-2"}),(0,yr.jsx)("p",{className:"text-gray-500 text-sm",children:"Loading photos..."})]}):Jn>0||$n.length>0||"all"!==kr?(0,yr.jsxs)("div",{className:"flex gap-3",children:[(0,yr.jsxs)("div",{className:"w-20 flex-shrink-0 space-y-1",children:[(0,yr.jsx)("button",{onClick:()=>Sr("all"),className:"w-full px-2 py-1.5 rounded-lg text-xs font-medium transition-all text-left ".concat("all"===kr?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Full Shoot"}),Cr.map(e=>(0,yr.jsxs)("button",{onClick:()=>Sr(e.id),className:"w-full px-2 py-1.5 rounded-lg text-xs font-medium transition-all text-left ".concat(kr===e.id?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,yr.jsx)("span",{className:"mr-1",children:e.icon}),(0,yr.jsx)("span",{className:"truncate",children:e.label})]},e.id))]}),(0,yr.jsx)("div",{className:"flex-1 min-w-0",children:$n.length>0?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2",children:$n.map(e=>{const t=e.cloudinary_secure_url||e.cloudinary_url;return(0,yr.jsxs)("div",{className:"relative group cursor-pointer rounded-lg overflow-hidden border-2 border-gray-200 hover:border-blue-400 transition-all bg-gray-100",style:{aspectRatio:"1"},onClick:()=>Xn(t),children:[(0,yr.jsx)(kc,{src:t,alt:e.description||"Client photo",size:"thumb",className:"w-full h-full object-cover",useBlur:!0,threshold:100,onError:e=>{e&&e.target&&e.target.style&&(e.target.style.opacity="0.3")}}),(0,yr.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-opacity flex items-center justify-center z-10 pointer-events-none",children:(0,yr.jsx)(Is,{className:"h-6 w-6 text-white opacity-0 group-hover:opacity-100 transition-opacity"})}),("admin"===(null===ge||void 0===ge?void 0:ge.role)||"viewer"===(null===ge||void 0===ge?void 0:ge.role)||"photographer"===(null===ge||void 0===ge?void 0:ge.role))&&(0,yr.jsx)("button",{onClick:t=>Wr(e.id,t),className:"absolute top-1 right-1 p-1.5 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity z-20 hover:bg-red-600 shadow-lg",title:"Delete photo",children:(0,yr.jsx)(ho,{className:"h-3 w-3"})})]},e.id)})}),tr&&(0,yr.jsx)("div",{className:"mt-3 text-center",children:(0,yr.jsx)("button",{onClick:Ur,disabled:sr,className:"px-4 py-2 bg-indigo-100 text-indigo-700 rounded-lg hover:bg-indigo-200 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:sr?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-indigo-500 border-t-transparent rounded-full inline-block mr-2"}),"Loading..."]}):"Load More Photos (".concat($n.length," loaded)")})})]}):(0,yr.jsxs)("div",{className:"bg-gray-100 rounded-lg p-4 text-center",children:[(0,yr.jsx)(Is,{className:"h-6 w-6 mx-auto text-gray-300 mb-2"}),(0,yr.jsx)("p",{className:"text-gray-500 text-sm",children:"No photos in this folder"})]})})]}):(0,yr.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[(0,yr.jsx)(Is,{className:"h-8 w-8 mx-auto text-gray-300 mb-2"}),(0,yr.jsx)("p",{className:"text-gray-500 text-sm",children:"No photos uploaded yet"}),("photographer"===(null===ge||void 0===ge?void 0:ge.role)||"admin"===(null===ge||void 0===ge?void 0:ge.role))&&!lr&&(0,yr.jsx)("button",{onClick:()=>cr(!0),className:"mt-2 text-indigo-600 text-sm hover:text-indigo-800",children:"Upload photos now"})]})]}),(0,yr.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200 space-y-2",children:[("viewer"===(null===ge||void 0===ge?void 0:ge.role)||"admin"===(null===ge||void 0===ge?void 0:ge.role))&&$n.length>0&&(0,yr.jsxs)("div",{className:"flex space-x-2",children:[(0,yr.jsxs)("button",{onClick:()=>{Qt(!1),qt(!0)},className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 bg-gradient-to-r from-purple-500 to-indigo-500 text-white rounded-lg hover:from-purple-600 hover:to-indigo-600 transition-all duration-300 shadow text-xs font-medium",children:[(0,yr.jsx)(Is,{className:"h-4 w-4"}),(0,yr.jsxs)("span",{children:["View Gallery (",Jn||$n.length,")"]})]}),(0,yr.jsxs)("button",{onClick:()=>{var e,t;const n=null===ke||void 0===ke||null===(e=ke.extendedProps)||void 0===e||null===(t=e.lead)||void 0===t?void 0:t.id,r="selectedPhotos_".concat(n),a=localStorage.getItem(r);let s=[];if(a)try{s=JSON.parse(a)}catch(FB){console.warn("Failed to parse saved photo selection:",FB)}Yt(s),Xt([]),Kt(null),Qt(!0),qt(!0)},className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-lg hover:from-green-600 hover:to-emerald-600 transition-all duration-300 shadow text-xs font-medium",children:[(0,yr.jsx)(fs,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Start Sale"})]})]}),(0,yr.jsxs)("div",{className:"flex space-x-2",children:["Cancelled"!==(null===(re=ke.extendedProps)||void 0===re?void 0:re.status)&&(0,yr.jsxs)("button",{onClick:()=>(()=>{var e,t;if(!ke||null===(e=ke.extendedProps)||void 0===e||!e.lead)return void alert("No lead data available for this event.");const n=ke.extendedProps.lead.name||ke.title.split(" - ")[0];if(window.confirm("Are you sure you want to reschedule ".concat(n,"'s appointment?"))){if(console.log("\ud83d\udcc5 Starting reschedule for:",n),console.log("\ud83d\udcc5 Current template selected:",dn),console.log("\ud83d\udcc5 Available templates:",mn.length),Et({_id:ke.extendedProps.lead.id,name:ke.extendedProps.lead.name||"",phone:ke.extendedProps.lead.phone||"",email:ke.extendedProps.lead.email||"",postcode:ke.extendedProps.lead.postcode||"",status:"Booked",notes:ke.extendedProps.lead.notes||"",image_url:ke.extendedProps.lead.image_url||"",isReschedule:!0,original_booker_id:ke.extendedProps.lead.booker_id||null}),Tr(),on(!0),cn(!0),!dn&&mn.length>0&&(console.log("\u26a0\ufe0f No template selected, setting default template:",mn[0].name),un(mn[0]._id)),mt(!0),ke.start){const e=new Date(ke.start);pt({dateStr:e.toISOString(),date:e})}console.log("\ud83d\udcc5 Reschedule modal opened - Template ID:",dn||(null===(t=mn[0])||void 0===t?void 0:t._id))}})(),className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 bg-gradient-to-r from-orange-400 to-amber-400 text-white rounded-lg hover:from-orange-500 hover:to-amber-500 transition-all duration-300 shadow text-xs font-medium",children:[(0,yr.jsx)(ws,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Reschedule"})]}),"viewer"!==(null===ge||void 0===ge?void 0:ge.role)&&(0,yr.jsxs)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),xe("/leads/".concat(ke.id))},className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-all duration-300 shadow text-xs font-medium",children:[(0,yr.jsx)(_s,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"View Lead Details"})]})]})]})]})]})}),Be&&(null===ke||void 0===ke||null===(ae=ke.extendedProps)||void 0===ae?void 0:ae.lead)&&(0,yr.jsx)(hd,{isOpen:Be,onClose:()=>Ue(!1),lead:ke.extendedProps.lead,initialChannel:ze}),Pt&&ke&&(null===(se=ke.extendedProps)||void 0===se?void 0:se.lead)&&(0,yr.jsx)(Lc,{isOpen:Pt,onClose:()=>Ot(!1),lead:ke.extendedProps.lead,existingSale:Zt,onSaveSuccess:()=>{Ot(!1),Tr(),alert(Zt?"Sale updated successfully!":"Sale recorded successfully!"),$r("Attended"),Fr()}}),We&&ke&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 overflow-hidden",children:[(0,yr.jsxs)("div",{className:"bg-gradient-to-r from-purple-500 to-indigo-600 px-6 py-4",children:[(0,yr.jsxs)("h3",{className:"text-lg font-bold text-white flex items-center",children:[(0,yr.jsx)(hs,{className:"h-5 w-5 mr-2"}),"Schedule Review Appointment"]}),(0,yr.jsx)("p",{className:"text-purple-100 text-sm mt-1",children:"Keep the original slot and schedule a review date"})]}),(0,yr.jsxs)("div",{className:"p-6 space-y-4",children:[(0,yr.jsx)("div",{className:"bg-purple-50 rounded-lg p-3 border border-purple-100",children:(0,yr.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-800",children:"Original Booking:"})," ",null!==(oe=ke.extendedProps)&&void 0!==oe&&null!==(ie=oe.lead)&&void 0!==ie&&ie.date_booked?new Date(ke.extendedProps.lead.date_booked).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"}):"N/A"," ","at ",(null===(le=ke.extendedProps)||void 0===le||null===(ce=le.lead)||void 0===ce?void 0:ce.time_booked)||"N/A"]})}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Review Date"}),(0,yr.jsx)("input",{type:"date",value:He,onChange:e=>{const t=e.target.value;Ge(t),$e(""),t?it(t):Je([])},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",min:(new Date).toISOString().split("T")[0]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Review Time ",Qe&&(0,yr.jsx)("span",{className:"text-purple-500",children:"(Loading...)"})]}),(0,yr.jsxs)("select",{value:Xe,onChange:e=>$e(e.target.value),disabled:!He||Qe,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[(0,yr.jsx)("option",{value:"",children:He?Qe?"Loading available slots...":0===Ke.length?"No available slots":"Select an available time":"Select a date first"}),Ke.map((e,t)=>(0,yr.jsxs)("option",{value:"".concat(e.time,"|").concat(e.slot),children:[e.label," ",1===e.slot?"(Slot 1)":2===e.slot?"(Slot 2)":"(Slot 3)"]},"".concat(e.time,"-").concat(e.slot,"-").concat(t)))]}),He&&!Qe&&0===Ke.length&&(0,yr.jsx)("p",{className:"text-sm text-red-500 mt-1",children:"No available slots on this date. Please select another date."}),He&&!Qe&&Ke.length>0&&(0,yr.jsxs)("p",{className:"text-sm text-green-600 mt-1",children:[Ke.length," slot(s) available"]})]})]}),(0,yr.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100 flex justify-end space-x-3",children:[(0,yr.jsx)("button",{onClick:()=>{qe(!1),Ge(""),$e(""),Je([])},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,yr.jsx)("button",{onClick:async()=>{if(He&&Xe)try{var e,t;const n=null===(e=ke.extendedProps)||void 0===e||null===(t=e.lead)||void 0===t?void 0:t.id,[r,a]=Xe.split("|"),s=ke.extendedProps.lead,{has_received_email:o,has_received_sms:i,has_unread_email:l,has_unread_sms:c,hasReceivedEmail:d,hasReceivedSms:u,hasUnreadEmail:m,hasUnreadSms:h}=s,p=Il(s,Nd);await xr.put("/api/leads/".concat(n),Ye(Ye({},p),{},{review_date:He,review_time:r,review_slot:parseInt(a),booking_status:"Review"})),qe(!1),Ge(""),$e(""),Je([]),$r("Review"),alert("Review scheduled for ".concat(new Date(He).toLocaleDateString("en-GB")," at ").concat(r," (Slot ").concat(a,")"))}catch(n){console.error("Error scheduling review:",n),alert("Failed to schedule review. Please try again.")}else alert("Please select both a date and time for the review.")},disabled:!He||!Xe||Qe,className:"px-4 py-2 text-sm font-medium text-white bg-gradient-to-r from-purple-500 to-indigo-600 rounded-lg hover:from-purple-600 hover:to-indigo-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Schedule Review"})]})]})}),At&&ke&&(null===(de=ke.extendedProps)||void 0===de?void 0:de.lead)&&(0,yr.jsx)(Gc,{isOpen:At,onClose:()=>{Tt(!1),0===Ht.length&&Kt(null)},lead:ke.extendedProps.lead,selectedPhotoCount:Ht.length,selectedPhotoIds:Ht,initialPackage:$t,onTrimSelection:()=>{Tt(!1),Qt(!0),qt(!0)},onPackageSelected:e=>{Kt(e),Tt(!1),Qt(!0),qt(!0)},onChangeImages:e=>{Kt(e),Tt(!1),Qt(!0),qt(!0)},onSendContract:e=>{var t;Kt(e.package),Vt({subtotal:e.totals.subtotal,vatAmount:e.totals.vatAmount,total:e.totals.total}),Tt(!1),Ut(null===ke||void 0===ke||null===(t=ke.extendedProps)||void 0===t?void 0:t.lead),Ft(!0)}}),Wt&&(null===ke||void 0===ke||null===(ue=ke.extendedProps)||void 0===ue?void 0:ue.lead)&&(0,yr.jsx)(Ec,{isOpen:Wt,onClose:()=>{qt(!1),Qt(!1)},photos:$n,leadId:ke.extendedProps.lead.id,leadName:ke.extendedProps.lead.name||"Client",initialSelectedIds:Ht,imageLimit:null!==(me=null===$t||void 0===$t?void 0:$t.imageCount)&&void 0!==me?me:null===$t||void 0===$t?void 0:$t.image_count,selectionMode:Jt,onDeletePhoto:"admin"===(null===ge||void 0===ge?void 0:ge.role)||"viewer"===(null===ge||void 0===ge?void 0:ge.role)||"photographer"===(null===ge||void 0===ge?void 0:ge.role)?Wr:null,onProceedToPackage:(e,t)=>{var n,r;Yt(e),Xt(t);const a=null===ke||void 0===ke||null===(n=ke.extendedProps)||void 0===n||null===(r=n.lead)||void 0===r?void 0:r.id;a&&e.length>0&&localStorage.setItem("selectedPhotos_".concat(a),JSON.stringify(e)),qt(!1),Tt(!0)}}),Dt&&It&&(0,yr.jsx)(ed,{isOpen:Dt,onClose:()=>Mt(!1),invoice:It,lead:null===ke||void 0===ke||null===(he=ke.extendedProps)||void 0===he?void 0:he.lead,onPaymentRecorded:e=>{Lt(e)},onSignatureSaved:e=>{Lt(e)},onComplete:e=>{Lt(e),Mt(!1),Tr(),alert("Sale completed successfully!"),$r("Attended"),Fr()}}),Rt&&Bt&&$t&&(0,yr.jsx)(md,{isOpen:Rt,onClose:()=>{Ft(!1),Ut(null),Vt(null)},lead:Bt,packageData:$t,invoiceData:zt,selectedPhotoIds:Ht,onContractSent:e=>{console.log("Contract sent:",e);const t=null===Bt||void 0===Bt?void 0:Bt.id;t&&localStorage.removeItem("selectedPhotos_".concat(t))},onBackToPackages:()=>{Ft(!1),Ut(null),Vt(null),Tt(!0)},onBackToPhotos:()=>{Ft(!1),Ut(null),Vt(null),Qt(!0),qt(!0)}}),zn&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-96",children:[(0,yr.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Reject Lead"}),(0,yr.jsx)("label",{className:"block mb-2 font-medium",children:"Reason:"}),(0,yr.jsxs)("select",{className:"w-full border rounded px-3 py-2 mb-4",value:Wn,onChange:e=>qn(e.target.value),children:[(0,yr.jsx)("option",{value:"Duplicate",children:"Duplicate"}),(0,yr.jsx)("option",{value:"Already Booked",children:"Already Booked"}),(0,yr.jsx)("option",{value:"Far South",children:"Far South"}),(0,yr.jsx)("option",{value:"Photo",children:"Photo"}),(0,yr.jsx)("option",{value:"Not Interested",children:"Not Interested"}),(0,yr.jsx)("option",{value:"Wrong Number",children:"Wrong Number"}),(0,yr.jsx)("option",{value:"Other",children:"Other"})]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,yr.jsx)("button",{className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",onClick:()=>Vn(!1),disabled:Hn,children:"Cancel"}),(0,yr.jsx)("button",{className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:Hn,onClick:async()=>{if(null!==ke&&void 0!==ke&&ke.id){Yn(!0);try{const e=await xr.patch("/api/leads/".concat(ke.id,"/reject"),{reason:Wn});if(e.data.success||e.data.lead){const e=ke.extendedProps.lead.name||ke.title.split(" - ")[0];we(e=>e.filter(e=>e.id!==ke.id)),Tr(),Vn(!1),alert("\u274c Successfully rejected ".concat(e,'. The lead has been moved to "Rejected" status.')),setTimeout(()=>{Fr()},1500)}}catch(e){console.error("Error rejecting lead:",e),alert("Failed to reject lead. Please try again.")}finally{Yn(!1)}}},children:Hn?"Rejecting...":"Confirm Reject"})]})]})}),Gn&&(0,yr.jsx)(Jl,{src:Gn,alt:(null===ke||void 0===ke||null===(pe=ke.extendedProps)||void 0===pe||null===(fe=pe.lead)||void 0===fe?void 0:fe.name)||"Lead Photo",onClose:()=>Xn(null)})]});var ea,ta,na,ra,aa,sa,oa,ia,la};function Sd(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=Sd(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}const Cd=function(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=Sd(e))&&(r&&(r+=" "),r+=t);return r};var _d=n(9889),Ed=n.n(_d),Pd=n(620),Od=n.n(Pd),Ad=n(5268),Td=n.n(Ad),Dd=n(3097),Md=n.n(Dd),Id=n(9160),Ld=n.n(Id),Rd=n(9686),Fd=n.n(Rd),Bd=function(e){return 0===e?0:e>0?1:-1},Ud=function(e){return Od()(e)&&e.indexOf("%")===e.length-1},zd=function(e){return Ld()(e)&&!Td()(e)},Vd=function(e){return zd(e)||Od()(e)},Wd=0,qd=function(e){var t=++Wd;return"".concat(e||"").concat(t)},Hd=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!zd(e)&&!Od()(e))return r;if(Ud(e)){var s=e.indexOf("%");n=t*parseFloat(e.slice(0,s))/100}else n=+e;return Td()(n)&&(n=r),a&&n>t&&(n=t),n},Yd=function(e){if(!e)return null;var t=Object.keys(e);return t&&t.length?e[t[0]]:null},Gd=function(e,t){return zd(e)&&zd(t)?function(n){return e+n*(t-e)}:function(){return t}};function Xd(e,t,n){return e&&e.length?e.find(function(e){return e&&("function"===typeof t?t(e):Md()(e,t))===n}):null}var $d=function(e,t){return zd(e)&&zd(t)?e-t:Od()(e)&&Od()(t)?e.localeCompare(t):e instanceof Date&&t instanceof Date?e.getTime()-t.getTime():String(e).localeCompare(String(t))},Kd=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a]},Jd=n(1629),Qd=n.n(Jd),Zd=n(6686),eu=n.n(Zd),tu=n(9062);function nu(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function ru(e){return ru="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ru(e)}var au=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],su=["points","pathLength"],ou={svg:["viewBox","children"],polygon:su,polyline:su},iu=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],lu=function(e,t){if(!e||"function"===typeof e||"boolean"===typeof e)return null;var n=e;if((0,s.isValidElement)(e)&&(n=e.props),!eu()(n))return null;var r={};return Object.keys(n).forEach(function(e){iu.includes(e)&&(r[e]=t||function(t){return n[e](n,t)})}),r},cu=function(e,t,n){if(!eu()(e)||"object"!==ru(e))return null;var r=null;return Object.keys(e).forEach(function(a){var s=e[a];iu.includes(a)&&"function"===typeof s&&(r||(r={}),r[a]=function(e,t,n){return function(r){return e(t,n,r),null}}(s,t,n))}),r},du=["children"],uu=["children"];function mu(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var hu={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},pu=function(e){return"string"===typeof e?e:e?e.displayName||e.name||"Component":""},fu=null,gu=null,xu=function e(t){if(t===fu&&Array.isArray(gu))return gu;var n=[];return s.Children.forEach(t,function(t){Fd()(t)||((0,tu.isFragment)(t)?n=n.concat(e(t.props.children)):n.push(t))}),gu=n,fu=t,n};function yu(e,t){var n=[],r=[];return r=Array.isArray(t)?t.map(function(e){return pu(e)}):[pu(t)],xu(e).forEach(function(e){var t=Md()(e,"type.displayName")||Md()(e,"type.name");-1!==r.indexOf(t)&&n.push(e)}),n}function bu(e,t){var n=yu(e,t);return n&&n[0]}var vu=function(e){if(!e||!e.props)return!1;var t=e.props,n=t.width,r=t.height;return!(!zd(n)||n<=0||!zd(r)||r<=0)},wu=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],ju=function(e){return e&&e.type&&Od()(e.type)&&wu.indexOf(e.type)>=0},Nu=function(e,t,n){if(!e||"function"===typeof e||"boolean"===typeof e)return null;var r=e;if((0,s.isValidElement)(e)&&(r=e.props),!eu()(r))return null;var a={};return Object.keys(r).forEach(function(e){var s;(function(e,t,n,r){var a,s=null!==(a=null===ou||void 0===ou?void 0:ou[r])&&void 0!==a?a:[];return t.startsWith("data-")||!Qd()(e)&&(r&&s.includes(t)||au.includes(t))||n&&iu.includes(t)})(null===(s=r)||void 0===s?void 0:s[e],e,t,n)&&(a[e]=r[e])}),a},ku=function e(t,n){if(t===n)return!0;var r=s.Children.count(t);if(r!==s.Children.count(n))return!1;if(0===r)return!0;if(1===r)return Su(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var a=0;a<r;a++){var o=t[a],i=n[a];if(Array.isArray(o)||Array.isArray(i)){if(!e(o,i))return!1}else if(!Su(o,i))return!1}return!0},Su=function(e,t){if(Fd()(e)&&Fd()(t))return!0;if(!Fd()(e)&&!Fd()(t)){var n=e.props||{},r=n.children,a=mu(n,du),s=t.props||{},o=s.children,i=mu(s,uu);return r&&o?nu(a,i)&&ku(r,o):!r&&!o&&nu(a,i)}return!1},Cu=function(e,t){var n=[],r={};return xu(e).forEach(function(e,a){if(ju(e))n.push(e);else if(e){var s=pu(e.type),o=t[s]||{},i=o.handler,l=o.once;if(i&&(!l||!r[s])){var c=i(e,s,a);n.push(c),r[s]=!0}}}),n};function _u(e){return _u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_u(e)}function Eu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Pu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Eu(Object(n),!0).forEach(function(t){Ou(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Eu(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ou(e,t,n){return t=function(e){var t=function(e,t){if("object"!=_u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_u(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Au(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,i=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Tu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tu(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Du=(0,s.forwardRef)(function(e,t){var n=e.aspect,r=e.initialDimension,a=void 0===r?{width:-1,height:-1}:r,o=e.width,i=void 0===o?"100%":o,l=e.height,c=void 0===l?"100%":l,d=e.minWidth,u=void 0===d?0:d,m=e.minHeight,h=e.maxHeight,p=e.children,f=e.debounce,g=void 0===f?0:f,x=e.id,y=e.className,b=e.onResize,v=e.style,w=void 0===v?{}:v,j=(0,s.useRef)(null),N=(0,s.useRef)();N.current=b,(0,s.useImperativeHandle)(t,function(){return Object.defineProperty(j.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),j.current},configurable:!0})});var k=Au((0,s.useState)({containerWidth:a.width,containerHeight:a.height}),2),S=k[0],C=k[1],_=(0,s.useCallback)(function(e,t){C(function(n){var r=Math.round(e),a=Math.round(t);return n.containerWidth===r&&n.containerHeight===a?n:{containerWidth:r,containerHeight:a}})},[]);(0,s.useEffect)(function(){var e=function(e){var t,n=e[0].contentRect,r=n.width,a=n.height;_(r,a),null===(t=N.current)||void 0===t||t.call(N,r,a)};g>0&&(e=Ed()(e,g,{trailing:!0,leading:!1}));var t=new ResizeObserver(e),n=j.current.getBoundingClientRect(),r=n.width,a=n.height;return _(r,a),t.observe(j.current),function(){t.disconnect()}},[_,g]);var E=(0,s.useMemo)(function(){var e=S.containerWidth,t=S.containerHeight;if(e<0||t<0)return null;Kd(Ud(i)||Ud(c),"The width(%s) and height(%s) are both fixed numbers,\n       maybe you don't need to use a ResponsiveContainer.",i,c),Kd(!n||n>0,"The aspect(%s) must be greater than zero.",n);var r=Ud(i)?e:i,a=Ud(c)?t:c;n&&n>0&&(r?a=r/n:a&&(r=a*n),h&&a>h&&(a=h)),Kd(r>0||a>0,"The width(%s) and height(%s) of chart should be greater than 0,\n       please check the style of container, or the props width(%s) and height(%s),\n       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the\n       height and width.",r,a,i,c,u,m,n);var o=!Array.isArray(p)&&pu(p.type).endsWith("Chart");return s.Children.map(p,function(e){return s.isValidElement(e)?(0,s.cloneElement)(e,Pu({width:r,height:a},o?{style:Pu({height:"100%",width:"100%",maxHeight:a,maxWidth:r},e.props.style)}:{})):e})},[n,p,c,h,m,u,S,i]);return s.createElement("div",{id:x?"".concat(x):void 0,className:Cd("recharts-responsive-container",y),style:Pu(Pu({},w),{},{width:i,height:c,minWidth:u,minHeight:m,maxHeight:h}),ref:j},E)}),Mu=n(6604),Iu=n.n(Mu),Lu=n(7424),Ru=n.n(Lu),Fu="Invariant failed";function Bu(e,t){if(!e)throw new Error(Fu)}var Uu=["children","width","height","viewBox","className","style","title","desc"];function zu(){return zu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zu.apply(this,arguments)}function Vu(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Wu(e){var t=e.children,n=e.width,r=e.height,a=e.viewBox,o=e.className,i=e.style,l=e.title,c=e.desc,d=Vu(e,Uu),u=a||{width:n,height:r,x:0,y:0},m=Cd("recharts-surface",o);return s.createElement("svg",zu({},Nu(d,!0,"svg"),{className:m,width:n,height:r,style:i,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),s.createElement("title",null,l),s.createElement("desc",null,c),t)}var qu=["children","className"];function Hu(){return Hu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Hu.apply(this,arguments)}function Yu(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Gu=s.forwardRef(function(e,t){var n=e.children,r=e.className,a=Yu(e,qu),o=Cd("recharts-layer",r);return s.createElement("g",Hu({className:o},Nu(a,!0),{ref:t}),n)});function Xu(e){return Xu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xu(e)}function $u(){return $u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$u.apply(this,arguments)}function Ku(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,i=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Ju(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ju(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ju(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Qu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Zu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qu(Object(n),!0).forEach(function(t){em(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qu(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function em(e,t,n){return t=function(e){var t=function(e,t){if("object"!=Xu(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Xu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Xu(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tm(e){return Array.isArray(e)&&Vd(e[0])&&Vd(e[1])?e.join(" ~ "):e}var nm=function(e){var t=e.separator,n=void 0===t?" : ":t,r=e.contentStyle,a=void 0===r?{}:r,o=e.itemStyle,i=void 0===o?{}:o,l=e.labelStyle,c=void 0===l?{}:l,d=e.payload,u=e.formatter,m=e.itemSorter,h=e.wrapperClassName,p=e.labelClassName,f=e.label,g=e.labelFormatter,x=e.accessibilityLayer,y=void 0!==x&&x,b=Zu({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),v=Zu({margin:0},c),w=!Fd()(f),j=w?f:"",N=Cd("recharts-default-tooltip",h),k=Cd("recharts-tooltip-label",p);w&&g&&void 0!==d&&null!==d&&(j=g(f,d));var S=y?{role:"status","aria-live":"assertive"}:{};return s.createElement("div",$u({className:N,style:b},S),s.createElement("p",{className:k,style:v},s.isValidElement(j)?j:"".concat(j)),function(){if(d&&d.length){var e=(m?Ru()(d,m):d).map(function(e,t){if("none"===e.type)return null;var r=Zu({display:"block",paddingTop:4,paddingBottom:4,color:e.color||"#000"},i),a=e.formatter||u||tm,o=e.value,l=e.name,c=o,m=l;if(a&&null!=c&&null!=m){var h=a(o,l,e,t,d);if(Array.isArray(h)){var p=Ku(h,2);c=p[0],m=p[1]}else c=h}return s.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(t),style:r},Vd(m)?s.createElement("span",{className:"recharts-tooltip-item-name"},m):null,Vd(m)?s.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,s.createElement("span",{className:"recharts-tooltip-item-value"},c),s.createElement("span",{className:"recharts-tooltip-item-unit"},e.unit||""))});return s.createElement("ul",{className:"recharts-tooltip-item-list",style:{padding:0,margin:0}},e)}return null}())};function rm(e){return rm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rm(e)}function am(e,t,n){return t=function(e){var t=function(e,t){if("object"!=rm(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=rm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==rm(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var sm="recharts-tooltip-wrapper",om={visibility:"hidden"};function im(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return Cd(sm,am(am(am(am({},"".concat(sm,"-right"),zd(n)&&t&&zd(t.x)&&n>=t.x),"".concat(sm,"-left"),zd(n)&&t&&zd(t.x)&&n<t.x),"".concat(sm,"-bottom"),zd(r)&&t&&zd(t.y)&&r>=t.y),"".concat(sm,"-top"),zd(r)&&t&&zd(t.y)&&r<t.y))}function lm(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,a=e.offsetTopLeft,s=e.position,o=e.reverseDirection,i=e.tooltipDimension,l=e.viewBox,c=e.viewBoxDimension;if(s&&zd(s[r]))return s[r];var d=n[r]-i-a,u=n[r]+a;return t[r]?o[r]?d:u:o[r]?d<l[r]?Math.max(u,l[r]):Math.max(d,l[r]):u+i>l[r]+c?Math.max(d,l[r]):Math.max(u,l[r])}function cm(e){return cm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cm(e)}function dm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function um(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dm(Object(n),!0).forEach(function(t){xm(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dm(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function mm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ym(r.key),r)}}function hm(e,t,n){return t=fm(t),function(e,t){if(t&&("object"===cm(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,pm()?Reflect.construct(t,n||[],fm(e).constructor):t.apply(e,n))}function pm(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(pm=function(){return!!e})()}function fm(e){return fm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fm(e)}function gm(e,t){return gm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},gm(e,t)}function xm(e,t,n){return(t=ym(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ym(e){var t=function(e,t){if("object"!=cm(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=cm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==cm(t)?t:t+""}var bm=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return xm(e=hm(this,t,[].concat(r)),"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),xm(e,"handleKeyDown",function(t){var n,r,a,s;"Escape"===t.key&&e.setState({dismissed:!0,dismissedAtCoordinate:{x:null!==(n=null===(r=e.props.coordinate)||void 0===r?void 0:r.x)&&void 0!==n?n:0,y:null!==(a=null===(s=e.props.coordinate)||void 0===s?void 0:s.y)&&void 0!==a?a:0}})}),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gm(e,t)}(t,e),n=t,(r=[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var e=this.wrapperNode.getBoundingClientRect();(Math.abs(e.width-this.state.lastBoundingBox.width)>1||Math.abs(e.height-this.state.lastBoundingBox.height)>1)&&this.setState({lastBoundingBox:{width:e.width,height:e.height}})}else-1===this.state.lastBoundingBox.width&&-1===this.state.lastBoundingBox.height||this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var e,t;this.props.active&&this.updateBBox(),this.state.dismissed&&((null===(e=this.props.coordinate)||void 0===e?void 0:e.x)===this.state.dismissedAtCoordinate.x&&(null===(t=this.props.coordinate)||void 0===t?void 0:t.y)===this.state.dismissedAtCoordinate.y||(this.state.dismissed=!1))}},{key:"render",value:function(){var e=this,t=this.props,n=t.active,r=t.allowEscapeViewBox,a=t.animationDuration,o=t.animationEasing,i=t.children,l=t.coordinate,c=t.hasPayload,d=t.isAnimationActive,u=t.offset,m=t.position,h=t.reverseDirection,p=t.useTranslate3d,f=t.viewBox,g=t.wrapperStyle,x=function(e){var t,n,r=e.allowEscapeViewBox,a=e.coordinate,s=e.offsetTopLeft,o=e.position,i=e.reverseDirection,l=e.tooltipBox,c=e.useTranslate3d,d=e.viewBox;return{cssProperties:l.height>0&&l.width>0&&a?function(e){var t=e.translateX,n=e.translateY;return{transform:e.useTranslate3d?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}({translateX:t=lm({allowEscapeViewBox:r,coordinate:a,key:"x",offsetTopLeft:s,position:o,reverseDirection:i,tooltipDimension:l.width,viewBox:d,viewBoxDimension:d.width}),translateY:n=lm({allowEscapeViewBox:r,coordinate:a,key:"y",offsetTopLeft:s,position:o,reverseDirection:i,tooltipDimension:l.height,viewBox:d,viewBoxDimension:d.height}),useTranslate3d:c}):om,cssClasses:im({translateX:t,translateY:n,coordinate:a})}}({allowEscapeViewBox:r,coordinate:l,offsetTopLeft:u,position:m,reverseDirection:h,tooltipBox:this.state.lastBoundingBox,useTranslate3d:p,viewBox:f}),y=x.cssClasses,b=x.cssProperties,v=um(um({transition:d&&n?"transform ".concat(a,"ms ").concat(o):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&n&&c?"visible":"hidden",position:"absolute",top:0,left:0},g);return s.createElement("div",{tabIndex:-1,className:y,style:v,ref:function(t){e.wrapperNode=t}},i)}}])&&mm(n.prototype,r),a&&mm(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.PureComponent),vm={isSsr:!("undefined"!==typeof window&&window.document&&window.document.createElement&&window.setTimeout),get:function(e){return vm[e]},set:function(e,t){if("string"===typeof e)vm[e]=t;else{var n=Object.keys(e);n&&n.length&&n.forEach(function(t){vm[t]=e[t]})}}},wm=n(977),jm=n.n(wm);function Nm(e,t,n){return!0===t?jm()(e,n):Qd()(t)?jm()(e,t):e}function km(e){return km="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},km(e)}function Sm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Cm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sm(Object(n),!0).forEach(function(t){Tm(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sm(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Dm(r.key),r)}}function Em(e,t,n){return t=Om(t),function(e,t){if(t&&("object"===km(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Pm()?Reflect.construct(t,n||[],Om(e).constructor):t.apply(e,n))}function Pm(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Pm=function(){return!!e})()}function Om(e){return Om=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Om(e)}function Am(e,t){return Am=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Am(e,t)}function Tm(e,t,n){return(t=Dm(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dm(e){var t=function(e,t){if("object"!=km(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=km(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==km(t)?t:t+""}function Mm(e){return e.dataKey}var Im=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Em(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Am(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props,n=t.active,r=t.allowEscapeViewBox,a=t.animationDuration,o=t.animationEasing,i=t.content,l=t.coordinate,c=t.filterNull,d=t.isAnimationActive,u=t.offset,m=t.payload,h=t.payloadUniqBy,p=t.position,f=t.reverseDirection,g=t.useTranslate3d,x=t.viewBox,y=t.wrapperStyle,b=null!==m&&void 0!==m?m:[];c&&b.length&&(b=Nm(m.filter(function(t){return null!=t.value&&(!0!==t.hide||e.props.includeHidden)}),h,Mm));var v=b.length>0;return s.createElement(bm,{allowEscapeViewBox:r,animationDuration:a,animationEasing:o,isAnimationActive:d,active:n,coordinate:l,hasPayload:v,offset:u,position:p,reverseDirection:f,useTranslate3d:g,viewBox:x,wrapperStyle:y},function(e,t){return s.isValidElement(e)?s.cloneElement(e,t):"function"===typeof e?s.createElement(e,t):s.createElement(nm,t)}(i,Cm(Cm({},this.props),{},{payload:b})))}}])&&_m(n.prototype,r),a&&_m(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.PureComponent);Tm(Im,"displayName","Tooltip"),Tm(Im,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!vm.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var Lm=n(643),Rm=n.n(Lm);Math.abs,Math.atan2;const Fm=Math.cos,Bm=(Math.max,Math.min,Math.sin),Um=Math.sqrt,zm=Math.PI,Vm=2*zm;const Wm={draw(e,t){const n=Um(t/zm);e.moveTo(n,0),e.arc(0,0,n,0,Vm)}},qm={draw(e,t){const n=Um(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},Hm=Um(1/3),Ym=2*Hm,Gm={draw(e,t){const n=Um(t/Ym),r=n*Hm;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},Xm={draw(e,t){const n=Um(t),r=-n/2;e.rect(r,r,n,n)}},$m=Bm(zm/10)/Bm(7*zm/10),Km=Bm(Vm/10)*$m,Jm=-Fm(Vm/10)*$m,Qm={draw(e,t){const n=Um(.8908130915292852*t),r=Km*n,a=Jm*n;e.moveTo(0,-n),e.lineTo(r,a);for(let s=1;s<5;++s){const t=Vm*s/5,o=Fm(t),i=Bm(t);e.lineTo(i*n,-o*n),e.lineTo(o*r-i*a,i*r+o*a)}e.closePath()}},Zm=Um(3),eh={draw(e,t){const n=-Um(t/(3*Zm));e.moveTo(0,2*n),e.lineTo(-Zm*n,-n),e.lineTo(Zm*n,-n),e.closePath()}},th=-.5,nh=Um(3)/2,rh=1/Um(12),ah=3*(rh/2+1),sh={draw(e,t){const n=Um(t/ah),r=n/2,a=n*rh,s=r,o=n*rh+n,i=-s,l=o;e.moveTo(r,a),e.lineTo(s,o),e.lineTo(i,l),e.lineTo(th*r-nh*a,nh*r+th*a),e.lineTo(th*s-nh*o,nh*s+th*o),e.lineTo(th*i-nh*l,nh*i+th*l),e.lineTo(th*r+nh*a,th*a-nh*r),e.lineTo(th*s+nh*o,th*o-nh*s),e.lineTo(th*i+nh*l,th*l-nh*i),e.closePath()}};function oh(e){return function(){return e}}function ih(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var lh,ch,dh,uh,mh,hh,ph,fh,gh,xh,yh,bh,vh,wh;const jh=Math.PI,Nh=2*jh,kh=1e-6,Sh=Nh-kh;function Ch(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class _h{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?Ch:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return Ch;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append(lh||(lh=ih(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(ch||(ch=ih(["Z"]))))}lineTo(e,t){this._append(dh||(dh=ih(["L",",",""])),this._x1=+e,this._y1=+t)}quadraticCurveTo(e,t,n,r){this._append(uh||(uh=ih(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}bezierCurveTo(e,t,n,r,a,s){this._append(mh||(mh=ih(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+a,this._y1=+s)}arcTo(e,t,n,r,a){if(e=+e,t=+t,n=+n,r=+r,(a=+a)<0)throw new Error("negative radius: ".concat(a));let s=this._x1,o=this._y1,i=n-e,l=r-t,c=s-e,d=o-t,u=c*c+d*d;if(null===this._x1)this._append(hh||(hh=ih(["M",",",""])),this._x1=e,this._y1=t);else if(u>kh)if(Math.abs(d*i-l*c)>kh&&a){let m=n-s,h=r-o,p=i*i+l*l,f=m*m+h*h,g=Math.sqrt(p),x=Math.sqrt(u),y=a*Math.tan((jh-Math.acos((p+u-f)/(2*g*x)))/2),b=y/x,v=y/g;Math.abs(b-1)>kh&&this._append(fh||(fh=ih(["L",",",""])),e+b*c,t+b*d),this._append(gh||(gh=ih(["A",",",",0,0,",",",",",""])),a,a,+(d*m>c*h),this._x1=e+v*i,this._y1=t+v*l)}else this._append(ph||(ph=ih(["L",",",""])),this._x1=e,this._y1=t);else;}arc(e,t,n,r,a,s){if(e=+e,t=+t,s=!!s,(n=+n)<0)throw new Error("negative radius: ".concat(n));let o=n*Math.cos(r),i=n*Math.sin(r),l=e+o,c=t+i,d=1^s,u=s?r-a:a-r;null===this._x1?this._append(xh||(xh=ih(["M",",",""])),l,c):(Math.abs(this._x1-l)>kh||Math.abs(this._y1-c)>kh)&&this._append(yh||(yh=ih(["L",",",""])),l,c),n&&(u<0&&(u=u%Nh+Nh),u>Sh?this._append(bh||(bh=ih(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,d,e-o,t-i,n,n,d,this._x1=l,this._y1=c):u>kh&&this._append(vh||(vh=ih(["A",",",",0,",",",",",",",""])),n,n,+(u>=jh),d,this._x1=e+n*Math.cos(a),this._y1=t+n*Math.sin(a)))}rect(e,t,n,r){this._append(wh||(wh=ih(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}toString(){return this._}}function Eh(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError("invalid digits: ".concat(n));t=e}return e},()=>new _h(t)}Um(3),Um(3);function Ph(e){return Ph="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ph(e)}var Oh=["type","size","sizeType"];function Ah(){return Ah=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ah.apply(this,arguments)}function Th(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Dh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Th(Object(n),!0).forEach(function(t){Mh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Th(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Mh(e,t,n){return t=function(e){var t=function(e,t){if("object"!=Ph(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Ph(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ph(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ih(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Lh={symbolCircle:Wm,symbolCross:qm,symbolDiamond:Gm,symbolSquare:Xm,symbolStar:Qm,symbolTriangle:eh,symbolWye:sh},Rh=Math.PI/180,Fh=function(e){var t=e.type,n=void 0===t?"circle":t,r=e.size,a=void 0===r?64:r,o=e.sizeType,i=void 0===o?"area":o,l=Dh(Dh({},Ih(e,Oh)),{},{type:n,size:a,sizeType:i}),c=l.className,d=l.cx,u=l.cy,m=Nu(l,!0);return d===+d&&u===+u&&a===+a?s.createElement("path",Ah({},m,{className:Cd("recharts-symbols",c),transform:"translate(".concat(d,", ").concat(u,")"),d:function(){var e=function(e){var t="symbol".concat(Rm()(e));return Lh[t]||Wm}(n),t=function(e,t){let n=null,r=Eh(a);function a(){let a;if(n||(n=a=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),a)return n=null,a+""||null}return e="function"===typeof e?e:oh(e||Wm),t="function"===typeof t?t:oh(void 0===t?64:+t),a.type=function(t){return arguments.length?(e="function"===typeof t?t:oh(t),a):e},a.size=function(e){return arguments.length?(t="function"===typeof e?e:oh(+e),a):t},a.context=function(e){return arguments.length?(n=null==e?null:e,a):n},a}().type(e).size(function(e,t,n){if("area"===t)return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return.5*e*e/Math.sqrt(3);case"square":return e*e;case"star":var r=18*Rh;return 1.25*e*e*(Math.tan(r)-Math.tan(2*r)*Math.pow(Math.tan(r),2));case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}}(a,i,n));return t()}()})):null};function Bh(e){return Bh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bh(e)}function Uh(){return Uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Uh.apply(this,arguments)}function zh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Vh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Xh(r.key),r)}}function Wh(e,t,n){return t=Hh(t),function(e,t){if(t&&("object"===Bh(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,qh()?Reflect.construct(t,n||[],Hh(e).constructor):t.apply(e,n))}function qh(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(qh=function(){return!!e})()}function Hh(e){return Hh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Hh(e)}function Yh(e,t){return Yh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Yh(e,t)}function Gh(e,t,n){return(t=Xh(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xh(e){var t=function(e,t){if("object"!=Bh(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Bh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Bh(t)?t:t+""}Fh.registerSymbol=function(e,t){Lh["symbol".concat(Rm()(e))]=t};var $h=32,Kh=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Wh(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yh(e,t)}(t,e),n=t,r=[{key:"renderIcon",value:function(e){var t=this.props.inactiveColor,n=16,r=$h/6,a=$h/3,o=e.inactive?t:e.color;if("plainline"===e.type)return s.createElement("line",{strokeWidth:4,fill:"none",stroke:o,strokeDasharray:e.payload.strokeDasharray,x1:0,y1:n,x2:$h,y2:n,className:"recharts-legend-icon"});if("line"===e.type)return s.createElement("path",{strokeWidth:4,fill:"none",stroke:o,d:"M0,".concat(n,"h").concat(a,"\n            A").concat(r,",").concat(r,",0,1,1,").concat(2*a,",").concat(n,"\n            H").concat($h,"M").concat(2*a,",").concat(n,"\n            A").concat(r,",").concat(r,",0,1,1,").concat(a,",").concat(n),className:"recharts-legend-icon"});if("rect"===e.type)return s.createElement("path",{stroke:"none",fill:o,d:"M0,".concat(4,"h").concat($h,"v").concat(24,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(s.isValidElement(e.legendIcon)){var i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zh(Object(n),!0).forEach(function(t){Gh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zh(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e);return delete i.legendIcon,s.cloneElement(e.legendIcon,i)}return s.createElement(Fh,{fill:o,cx:n,cy:n,size:$h,sizeType:"diameter",type:e.type})}},{key:"renderItems",value:function(){var e=this,t=this.props,n=t.payload,r=t.iconSize,a=t.layout,o=t.formatter,i=t.inactiveColor,l={x:0,y:0,width:$h,height:$h},c={display:"horizontal"===a?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return n.map(function(t,n){var a=t.formatter||o,u=Cd(Gh(Gh({"recharts-legend-item":!0},"legend-item-".concat(n),!0),"inactive",t.inactive));if("none"===t.type)return null;var m=Qd()(t.value)?null:t.value;Kd(!Qd()(t.value),'The name property is also required when using a function for the dataKey of a chart\'s cartesian components. Ex: <Bar name="Name of my Data"/>');var h=t.inactive?i:t.color;return s.createElement("li",Uh({className:u,style:c,key:"legend-item-".concat(n)},cu(e.props,t,n)),s.createElement(Wu,{width:r,height:r,viewBox:l,style:d},e.renderIcon(t)),s.createElement("span",{className:"recharts-legend-item-text",style:{color:h}},a?a(m,t,n):m))})}},{key:"render",value:function(){var e=this.props,t=e.payload,n=e.layout,r=e.align;if(!t||!t.length)return null;var a={padding:0,margin:0,textAlign:"horizontal"===n?r:"left"};return s.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}],r&&Vh(n.prototype,r),a&&Vh(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.PureComponent);function Jh(e){return Jh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jh(e)}Gh(Kh,"displayName","Legend"),Gh(Kh,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var Qh=["ref"];function Zh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ep(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zh(Object(n),!0).forEach(function(t){op(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zh(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function tp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ip(r.key),r)}}function np(e,t,n){return t=ap(t),function(e,t){if(t&&("object"===Jh(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,rp()?Reflect.construct(t,n||[],ap(e).constructor):t.apply(e,n))}function rp(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(rp=function(){return!!e})()}function ap(e){return ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ap(e)}function sp(e,t){return sp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sp(e,t)}function op(e,t,n){return(t=ip(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ip(e){var t=function(e,t){if("object"!=Jh(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Jh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Jh(t)?t:t+""}function lp(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function cp(e){return e.value}var dp=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return op(e=np(this,t,[].concat(r)),"lastBoundingBox",{width:-1,height:-1}),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sp(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var e=this.wrapperNode.getBoundingClientRect();return e.height=this.wrapperNode.offsetHeight,e.width=this.wrapperNode.offsetWidth,e}return null}},{key:"updateBBox",value:function(){var e=this.props.onBBoxUpdate,t=this.getBBox();t?(Math.abs(t.width-this.lastBoundingBox.width)>1||Math.abs(t.height-this.lastBoundingBox.height)>1)&&(this.lastBoundingBox.width=t.width,this.lastBoundingBox.height=t.height,e&&e(t)):-1===this.lastBoundingBox.width&&-1===this.lastBoundingBox.height||(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,e&&e(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?ep({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(e){var t,n,r=this.props,a=r.layout,s=r.align,o=r.verticalAlign,i=r.margin,l=r.chartWidth,c=r.chartHeight;return e&&(void 0!==e.left&&null!==e.left||void 0!==e.right&&null!==e.right)||(t="center"===s&&"vertical"===a?{left:((l||0)-this.getBBoxSnapshot().width)/2}:"right"===s?{right:i&&i.right||0}:{left:i&&i.left||0}),e&&(void 0!==e.top&&null!==e.top||void 0!==e.bottom&&null!==e.bottom)||(n="middle"===o?{top:((c||0)-this.getBBoxSnapshot().height)/2}:"bottom"===o?{bottom:i&&i.bottom||0}:{top:i&&i.top||0}),ep(ep({},t),n)}},{key:"render",value:function(){var e=this,t=this.props,n=t.content,r=t.width,a=t.height,o=t.wrapperStyle,i=t.payloadUniqBy,l=t.payload,c=ep(ep({position:"absolute",width:r||"auto",height:a||"auto"},this.getDefaultPosition(o)),o);return s.createElement("div",{className:"recharts-legend-wrapper",style:c,ref:function(t){e.wrapperNode=t}},function(e,t){if(s.isValidElement(e))return s.cloneElement(e,t);if("function"===typeof e)return s.createElement(e,t);t.ref;var n=lp(t,Qh);return s.createElement(Kh,n)}(n,ep(ep({},this.props),{},{payload:Nm(l,i,cp)})))}}],a=[{key:"getWithHeight",value:function(e,t){var n=ep(ep({},this.defaultProps),e.props).layout;return"vertical"===n&&zd(e.props.height)?{height:e.props.height}:"horizontal"===n?{width:e.props.width||t}:null}}],r&&tp(n.prototype,r),a&&tp(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.PureComponent);function up(){return up=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},up.apply(this,arguments)}op(dp,"displayName","Legend"),op(dp,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var mp=function(e){var t=e.cx,n=e.cy,r=e.r,a=e.className,o=Cd("recharts-dot",a);return t===+t&&n===+n&&r===+r?s.createElement("circle",up({},Nu(e,!1),lu(e),{className:o,cx:t,cy:n,r:r})):null},hp=n(5173),pp=n.n(hp),fp=Object.getOwnPropertyNames,gp=Object.getOwnPropertySymbols,xp=Object.prototype.hasOwnProperty;function yp(e,t){return function(n,r,a){return e(n,r,a)&&t(n,r,a)}}function bp(e){return function(t,n,r){if(!t||!n||"object"!==typeof t||"object"!==typeof n)return e(t,n,r);var a=r.cache,s=a.get(t),o=a.get(n);if(s&&o)return s===n&&o===t;a.set(t,n),a.set(n,t);var i=e(t,n,r);return a.delete(t),a.delete(n),i}}function vp(e){return fp(e).concat(gp(e))}var wp=Object.hasOwn||function(e,t){return xp.call(e,t)};function jp(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var Np=Object.getOwnPropertyDescriptor,kp=Object.keys;function Sp(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function Cp(e,t){return jp(e.getTime(),t.getTime())}function _p(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Ep(e,t){return e===t}function Pp(e,t,n){var r=e.size;if(r!==t.size)return!1;if(!r)return!0;for(var a,s,o=new Array(r),i=e.entries(),l=0;(a=i.next())&&!a.done;){for(var c=t.entries(),d=!1,u=0;(s=c.next())&&!s.done;)if(o[u])u++;else{var m=a.value,h=s.value;if(n.equals(m[0],h[0],l,u,e,t,n)&&n.equals(m[1],h[1],m[0],h[0],e,t,n)){d=o[u]=!0;break}u++}if(!d)return!1;l++}return!0}var Op=jp;function Ap(e,t,n){var r=kp(e),a=r.length;if(kp(t).length!==a)return!1;for(;a-- >0;)if(!Fp(e,t,n,r[a]))return!1;return!0}function Tp(e,t,n){var r,a,s,o=vp(e),i=o.length;if(vp(t).length!==i)return!1;for(;i-- >0;){if(!Fp(e,t,n,r=o[i]))return!1;if(a=Np(e,r),s=Np(t,r),(a||s)&&(!a||!s||a.configurable!==s.configurable||a.enumerable!==s.enumerable||a.writable!==s.writable))return!1}return!0}function Dp(e,t){return jp(e.valueOf(),t.valueOf())}function Mp(e,t){return e.source===t.source&&e.flags===t.flags}function Ip(e,t,n){var r=e.size;if(r!==t.size)return!1;if(!r)return!0;for(var a,s,o=new Array(r),i=e.values();(a=i.next())&&!a.done;){for(var l=t.values(),c=!1,d=0;(s=l.next())&&!s.done;){if(!o[d]&&n.equals(a.value,s.value,a.value,s.value,e,t,n)){c=o[d]=!0;break}d++}if(!c)return!1}return!0}function Lp(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function Rp(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function Fp(e,t,n,r){return!("_owner"!==r&&"__o"!==r&&"__v"!==r||!e.$$typeof&&!t.$$typeof)||wp(t,r)&&n.equals(e[r],t[r],r,r,e,t,n)}var Bp=Array.isArray,Up="function"===typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView:null,zp=Object.assign,Vp=Object.prototype.toString.call.bind(Object.prototype.toString);var Wp=qp();qp({strict:!0}),qp({circular:!0}),qp({circular:!0,strict:!0}),qp({createInternalComparator:function(){return jp}}),qp({strict:!0,createInternalComparator:function(){return jp}}),qp({circular:!0,createInternalComparator:function(){return jp}}),qp({circular:!0,createInternalComparator:function(){return jp},strict:!0});function qp(e){void 0===e&&(e={});var t,n=e.circular,r=void 0!==n&&n,a=e.createInternalComparator,s=e.createState,o=e.strict,i=void 0!==o&&o,l=function(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,a={areArraysEqual:r?Tp:Sp,areDatesEqual:Cp,areErrorsEqual:_p,areFunctionsEqual:Ep,areMapsEqual:r?yp(Pp,Tp):Pp,areNumbersEqual:Op,areObjectsEqual:r?Tp:Ap,arePrimitiveWrappersEqual:Dp,areRegExpsEqual:Mp,areSetsEqual:r?yp(Ip,Tp):Ip,areTypedArraysEqual:r?Tp:Lp,areUrlsEqual:Rp};if(n&&(a=zp({},a,n(a))),t){var s=bp(a.areArraysEqual),o=bp(a.areMapsEqual),i=bp(a.areObjectsEqual),l=bp(a.areSetsEqual);a=zp({},a,{areArraysEqual:s,areMapsEqual:o,areObjectsEqual:i,areSetsEqual:l})}return a}(e),c=function(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areErrorsEqual,a=e.areFunctionsEqual,s=e.areMapsEqual,o=e.areNumbersEqual,i=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,c=e.areRegExpsEqual,d=e.areSetsEqual,u=e.areTypedArraysEqual,m=e.areUrlsEqual;return function(e,h,p){if(e===h)return!0;if(null==e||null==h)return!1;var f=typeof e;if(f!==typeof h)return!1;if("object"!==f)return"number"===f?o(e,h,p):"function"===f&&a(e,h,p);var g=e.constructor;if(g!==h.constructor)return!1;if(g===Object)return i(e,h,p);if(Bp(e))return t(e,h,p);if(null!=Up&&Up(e))return u(e,h,p);if(g===Date)return n(e,h,p);if(g===RegExp)return c(e,h,p);if(g===Map)return s(e,h,p);if(g===Set)return d(e,h,p);var x=Vp(e);return"[object Date]"===x?n(e,h,p):"[object RegExp]"===x?c(e,h,p):"[object Map]"===x?s(e,h,p):"[object Set]"===x?d(e,h,p):"[object Object]"===x?"function"!==typeof e.then&&"function"!==typeof h.then&&i(e,h,p):"[object URL]"===x?m(e,h,p):"[object Error]"===x?r(e,h,p):"[object Arguments]"===x?i(e,h,p):("[object Boolean]"===x||"[object Number]"===x||"[object String]"===x)&&l(e,h,p)}}(l),d=a?a(c):(t=c,function(e,n,r,a,s,o,i){return t(e,n,i)});return function(e){var t=e.circular,n=e.comparator,r=e.createState,a=e.equals,s=e.strict;if(r)return function(e,o){var i=r(),l=i.cache,c=void 0===l?t?new WeakMap:void 0:l,d=i.meta;return n(e,o,{cache:c,equals:a,meta:d,strict:s})};if(t)return function(e,t){return n(e,t,{cache:new WeakMap,equals:a,meta:void 0,strict:s})};var o={cache:void 0,equals:a,meta:void 0,strict:s};return function(e,t){return n(e,t,o)}}({circular:r,comparator:c,createState:s,equals:d,strict:i})}function Hp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1;requestAnimationFrame(function r(a){n<0&&(n=a),a-n>t?(e(a),n=-1):function(e){"undefined"!==typeof requestAnimationFrame&&requestAnimationFrame(e)}(r)})}function Yp(e){return Yp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yp(e)}function Gp(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Xp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xp(e,t)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $p(){var e=function(){return null},t=!1,n=function n(r){if(!t){if(Array.isArray(r)){if(!r.length)return;var a=Gp(r),s=a[0],o=a.slice(1);return"number"===typeof s?void Hp(n.bind(null,o),s):(n(s),void Hp(n.bind(null,o)))}"object"===Yp(r)&&e(r),"function"===typeof r&&r()}};return{stop:function(){t=!0},start:function(e){t=!1,n(e)},subscribe:function(t){return e=t,function(){e=function(){return null}}}}}function Kp(e){return Kp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kp(e)}function Jp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Qp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jp(Object(n),!0).forEach(function(t){Zp(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jp(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Zp(e,t,n){return t=function(e){var t=function(e,t){if("object"!==Kp(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Kp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Kp(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ef=function(e){return e},tf=function(e,t){return Object.keys(t).reduce(function(n,r){return Qp(Qp({},n),{},Zp({},r,e(r,t[r])))},{})},nf=function(e,t,n){return e.map(function(e){return"".concat((r=e,r.replace(/([A-Z])/g,function(e){return"-".concat(e.toLowerCase())}))," ").concat(t,"ms ").concat(n);var r}).join(",")};function rf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,i=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||sf(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function af(e){return function(e){if(Array.isArray(e))return of(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||sf(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sf(e,t){if(e){if("string"===typeof e)return of(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?of(e,t):void 0}}function of(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var lf=1e-4,cf=function(e,t){return[0,3*e,3*t-6*e,3*e-3*t+1]},df=function(e,t){return e.map(function(e,n){return e*Math.pow(t,n)}).reduce(function(e,t){return e+t})},uf=function(e,t){return function(n){var r=cf(e,t);return df(r,n)}},mf=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],a=t[1],s=t[2],o=t[3];if(1===t.length)switch(t[0]){case"linear":r=0,a=0,s=1,o=1;break;case"ease":r=.25,a=.1,s=.25,o=1;break;case"ease-in":r=.42,a=0,s=1,o=1;break;case"ease-out":r=.42,a=0,s=.58,o=1;break;case"ease-in-out":r=0,a=0,s=.58,o=1;break;default:var i=t[0].split("(");if("cubic-bezier"===i[0]&&4===i[1].split(")")[0].split(",").length){var l=rf(i[1].split(")")[0].split(",").map(function(e){return parseFloat(e)}),4);r=l[0],a=l[1],s=l[2],o=l[3]}}[r,s,a,o].every(function(e){return"number"===typeof e&&e>=0&&e<=1});var c,d,u=uf(r,s),m=uf(a,o),h=(c=r,d=s,function(e){var t=cf(c,d),n=[].concat(af(t.map(function(e,t){return e*t}).slice(1)),[0]);return df(n,e)}),p=function(e){return e>1?1:e<0?0:e},f=function(e){for(var t=e>1?1:e,n=t,r=0;r<8;++r){var a=u(n)-t,s=h(n);if(Math.abs(a-t)<lf||s<lf)return m(n);n=p(n-a/s)}return m(n)};return f.isStepper=!1,f},hf=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0];if("string"===typeof r)switch(r){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return mf(r);case"spring":return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.stiff,n=void 0===t?100:t,r=e.damping,a=void 0===r?8:r,s=e.dt,o=void 0===s?17:s,i=function(e,t,r){var s=r+(-(e-t)*n-r*a)*o/1e3,i=r*o/1e3+e;return Math.abs(i-t)<lf&&Math.abs(s)<lf?[t,0]:[i,s]};return i.isStepper=!0,i.dt=o,i}();default:if("cubic-bezier"===r.split("(")[0])return mf(r)}return"function"===typeof r?r:null};function pf(e){return pf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pf(e)}function ff(e){return function(e){if(Array.isArray(e))return wf(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||vf(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gf(Object(n),!0).forEach(function(t){yf(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gf(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function yf(e,t,n){return t=function(e){var t=function(e,t){if("object"!==pf(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==pf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===pf(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,i=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||vf(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vf(e,t){if(e){if("string"===typeof e)return wf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wf(e,t):void 0}}function wf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var jf=function(e,t,n){return e+(t-e)*n},Nf=function(e){return e.from!==e.to},kf=function e(t,n,r){var a=tf(function(e,n){if(Nf(n)){var r=bf(t(n.from,n.to,n.velocity),2),a=r[0],s=r[1];return xf(xf({},n),{},{from:a,velocity:s})}return n},n);return r<1?tf(function(e,t){return Nf(t)?xf(xf({},t),{},{velocity:jf(t.velocity,a[e].velocity,r),from:jf(t.from,a[e].from,r)}):t},n):e(t,a,r-1)};const Sf=function(e,t,n,r,a){var s,o,i,l,c=(s=e,o=t,[Object.keys(s),Object.keys(o)].reduce(function(e,t){return e.filter(function(e){return t.includes(e)})})),d=c.reduce(function(n,r){return xf(xf({},n),{},yf({},r,[e[r],t[r]]))},{}),u=c.reduce(function(n,r){return xf(xf({},n),{},yf({},r,{from:e[r],velocity:0,to:t[r]}))},{}),m=-1,h=function(){return null};return h=n.isStepper?function(r){i||(i=r);var s=(r-i)/n.dt;u=kf(n,u,s),a(xf(xf(xf({},e),t),tf(function(e,t){return t.from},u))),i=r,Object.values(u).filter(Nf).length&&(m=requestAnimationFrame(h))}:function(s){l||(l=s);var o=(s-l)/r,i=tf(function(e,t){return jf.apply(void 0,ff(t).concat([n(o)]))},d);if(a(xf(xf(xf({},e),t),i)),o<1)m=requestAnimationFrame(h);else{var c=tf(function(e,t){return jf.apply(void 0,ff(t).concat([n(1)]))},d);a(xf(xf(xf({},e),t),c))}},function(){return requestAnimationFrame(h),function(){cancelAnimationFrame(m)}}};function Cf(e){return Cf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cf(e)}var _f=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Ef(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Pf(e){return function(e){if(Array.isArray(e))return Of(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Of(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Of(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Of(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Af(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Tf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Af(Object(n),!0).forEach(function(t){Df(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Af(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Df(e,t,n){return(t=If(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,If(r.key),r)}}function If(e){var t=function(e,t){if("object"!==Cf(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Cf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Cf(t)?t:String(t)}function Lf(e,t){return Lf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Lf(e,t)}function Rf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(FB){return!1}}();return function(){var n,r=Uf(e);if(t){var a=Uf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Ff(this,n)}}function Ff(e,t){if(t&&("object"===Cf(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Bf(e)}function Bf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uf(e){return Uf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Uf(e)}var zf=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lf(e,t)}(o,e);var t,n,r,a=Rf(o);function o(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var r=(n=a.call(this,e,t)).props,s=r.isActive,i=r.attributeName,l=r.from,c=r.to,d=r.steps,u=r.children,m=r.duration;if(n.handleStyleChange=n.handleStyleChange.bind(Bf(n)),n.changeStyle=n.changeStyle.bind(Bf(n)),!s||m<=0)return n.state={style:{}},"function"===typeof u&&(n.state={style:c}),Ff(n);if(d&&d.length)n.state={style:d[0].style};else if(l){if("function"===typeof u)return n.state={style:l},Ff(n);n.state={style:i?Df({},i,l):l}}else n.state={style:{}};return n}return t=o,(n=[{key:"componentDidMount",value:function(){var e=this.props,t=e.isActive,n=e.canBegin;this.mounted=!0,t&&n&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isActive,r=t.canBegin,a=t.attributeName,s=t.shouldReAnimate,o=t.to,i=t.from,l=this.state.style;if(r)if(n){if(!(Wp(e.to,o)&&e.canBegin&&e.isActive)){var c=!e.canBegin||!e.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var d=c||s?i:e.to;if(this.state&&l){var u={style:a?Df({},a,d):d};(a&&l[a]!==d||!a&&l!==d)&&this.setState(u)}this.runAnimation(Tf(Tf({},this.props),{},{from:d,begin:0}))}}else{var m={style:a?Df({},a,o):o};this.state&&l&&(a&&l[a]!==o||!a&&l!==o)&&this.setState(m)}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var e=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),e&&e()}},{key:"handleStyleChange",value:function(e){this.changeStyle(e)}},{key:"changeStyle",value:function(e){this.mounted&&this.setState({style:e})}},{key:"runJSAnimation",value:function(e){var t=this,n=e.from,r=e.to,a=e.duration,s=e.easing,o=e.begin,i=e.onAnimationEnd,l=e.onAnimationStart,c=Sf(n,r,hf(s),a,this.changeStyle);this.manager.start([l,o,function(){t.stopJSAnimation=c()},a,i])}},{key:"runStepAnimation",value:function(e){var t=this,n=e.steps,r=e.begin,a=e.onAnimationStart,s=n[0],o=s.style,i=s.duration,l=void 0===i?0:i;return this.manager.start([a].concat(Pf(n.reduce(function(e,r,a){if(0===a)return e;var s=r.duration,o=r.easing,i=void 0===o?"ease":o,l=r.style,c=r.properties,d=r.onAnimationEnd,u=a>0?n[a-1]:r,m=c||Object.keys(l);if("function"===typeof i||"spring"===i)return[].concat(Pf(e),[t.runJSAnimation.bind(t,{from:u.style,to:l,duration:s,easing:i}),s]);var h=nf(m,s,i),p=Tf(Tf(Tf({},u.style),l),{},{transition:h});return[].concat(Pf(e),[p,s,d]).filter(ef)},[o,Math.max(l,r)])),[e.onAnimationEnd]))}},{key:"runAnimation",value:function(e){this.manager||(this.manager=$p());var t=e.begin,n=e.duration,r=e.attributeName,a=e.to,s=e.easing,o=e.onAnimationStart,i=e.onAnimationEnd,l=e.steps,c=e.children,d=this.manager;if(this.unSubscribe=d.subscribe(this.handleStyleChange),"function"!==typeof s&&"function"!==typeof c&&"spring"!==s)if(l.length>1)this.runStepAnimation(e);else{var u=r?Df({},r,a):a,m=nf(Object.keys(u),n,s);d.start([o,t,Tf(Tf({},u),{},{transition:m}),n,i])}else this.runJSAnimation(e)}},{key:"render",value:function(){var e=this.props,t=e.children,n=(e.begin,e.duration),r=(e.attributeName,e.easing,e.isActive),a=(e.steps,e.from,e.to,e.canBegin,e.onAnimationEnd,e.shouldReAnimate,e.onAnimationReStart,Ef(e,_f)),o=s.Children.count(t),i=this.state.style;if("function"===typeof t)return t(i);if(!r||0===o||n<=0)return t;var l=function(e){var t=e.props,n=t.style,r=void 0===n?{}:n,o=t.className;return(0,s.cloneElement)(e,Tf(Tf({},a),{},{style:Tf(Tf({},r),i),className:o}))};return 1===o?l(s.Children.only(t)):s.createElement("div",null,s.Children.map(t,function(e){return l(e)}))}}])&&Mf(t.prototype,n),r&&Mf(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(s.PureComponent);zf.displayName="Animate",zf.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}},zf.propTypes={from:pp().oneOfType([pp().object,pp().string]),to:pp().oneOfType([pp().object,pp().string]),attributeName:pp().string,duration:pp().number,begin:pp().number,easing:pp().oneOfType([pp().string,pp().func]),steps:pp().arrayOf(pp().shape({duration:pp().number.isRequired,style:pp().object.isRequired,easing:pp().oneOfType([pp().oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),pp().func]),properties:pp().arrayOf("string"),onAnimationEnd:pp().func})),children:pp().oneOfType([pp().node,pp().func]),isActive:pp().bool,canBegin:pp().bool,onAnimationEnd:pp().func,shouldReAnimate:pp().bool,onAnimationStart:pp().func,onAnimationReStart:pp().func};const Vf=zf;function Wf(e){return Wf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wf(e)}function qf(){return qf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qf.apply(this,arguments)}function Hf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,i=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Yf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yf(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Gf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Xf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gf(Object(n),!0).forEach(function(t){$f(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gf(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function $f(e,t,n){return t=function(e){var t=function(e,t){if("object"!=Wf(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Wf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Wf(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Kf=function(e,t,n,r,a){var s,o=Math.min(Math.abs(n)/2,Math.abs(r)/2),i=r>=0?1:-1,l=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0;if(o>0&&a instanceof Array){for(var d=[0,0,0,0],u=0;u<4;u++)d[u]=a[u]>o?o:a[u];s="M".concat(e,",").concat(t+i*d[0]),d[0]>0&&(s+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+l*d[0],",").concat(t)),s+="L ".concat(e+n-l*d[1],",").concat(t),d[1]>0&&(s+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,",\n        ").concat(e+n,",").concat(t+i*d[1])),s+="L ".concat(e+n,",").concat(t+r-i*d[2]),d[2]>0&&(s+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,",\n        ").concat(e+n-l*d[2],",").concat(t+r)),s+="L ".concat(e+l*d[3],",").concat(t+r),d[3]>0&&(s+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,",\n        ").concat(e,",").concat(t+r-i*d[3])),s+="Z"}else if(o>0&&a===+a&&a>0){var m=Math.min(o,a);s="M ".concat(e,",").concat(t+i*m,"\n            A ").concat(m,",").concat(m,",0,0,").concat(c,",").concat(e+l*m,",").concat(t,"\n            L ").concat(e+n-l*m,",").concat(t,"\n            A ").concat(m,",").concat(m,",0,0,").concat(c,",").concat(e+n,",").concat(t+i*m,"\n            L ").concat(e+n,",").concat(t+r-i*m,"\n            A ").concat(m,",").concat(m,",0,0,").concat(c,",").concat(e+n-l*m,",").concat(t+r,"\n            L ").concat(e+l*m,",").concat(t+r,"\n            A ").concat(m,",").concat(m,",0,0,").concat(c,",").concat(e,",").concat(t+r-i*m," Z")}else s="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return s},Jf=function(e,t){if(!e||!t)return!1;var n=e.x,r=e.y,a=t.x,s=t.y,o=t.width,i=t.height;if(Math.abs(o)>0&&Math.abs(i)>0){var l=Math.min(a,a+o),c=Math.max(a,a+o),d=Math.min(s,s+i),u=Math.max(s,s+i);return n>=l&&n<=c&&r>=d&&r<=u}return!1},Qf={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Zf=function(e){var t=Xf(Xf({},Qf),e),n=(0,s.useRef)(),r=Hf((0,s.useState)(-1),2),a=r[0],o=r[1];(0,s.useEffect)(function(){if(n.current&&n.current.getTotalLength)try{var e=n.current.getTotalLength();e&&o(e)}catch(BB){}},[]);var i=t.x,l=t.y,c=t.width,d=t.height,u=t.radius,m=t.className,h=t.animationEasing,p=t.animationDuration,f=t.animationBegin,g=t.isAnimationActive,x=t.isUpdateAnimationActive;if(i!==+i||l!==+l||c!==+c||d!==+d||0===c||0===d)return null;var y=Cd("recharts-rectangle",m);return x?s.createElement(Vf,{canBegin:a>0,from:{width:c,height:d,x:i,y:l},to:{width:c,height:d,x:i,y:l},duration:p,animationEasing:h,isActive:x},function(e){var r=e.width,o=e.height,i=e.x,l=e.y;return s.createElement(Vf,{canBegin:a>0,from:"0px ".concat(-1===a?1:a,"px"),to:"".concat(a,"px 0px"),attributeName:"strokeDasharray",begin:f,duration:p,isActive:g,easing:h},s.createElement("path",qf({},Nu(t,!0),{className:y,d:Kf(i,l,r,o,u),ref:n})))}):s.createElement("path",qf({},Nu(t,!0),{className:y,d:Kf(i,l,c,d,u)}))};function eg(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function tg(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}class ng extends Map{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:og;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(rg(this,e))}has(e){return super.has(rg(this,e))}set(e,t){return super.set(ag(this,e),t)}delete(e){return super.delete(sg(this,e))}}Set;function rg(e,t){let{_intern:n,_key:r}=e;const a=r(t);return n.has(a)?n.get(a):t}function ag(e,t){let{_intern:n,_key:r}=e;const a=r(t);return n.has(a)?n.get(a):(n.set(a,t),t)}function sg(e,t){let{_intern:n,_key:r}=e;const a=r(t);return n.has(a)&&(t=n.get(a),n.delete(a)),t}function og(e){return null!==e&&"object"===typeof e?e.valueOf():e}const ig=Symbol("implicit");function lg(){var e=new ng,t=[],n=[],r=ig;function a(a){let s=e.get(a);if(void 0===s){if(r!==ig)return r;e.set(a,s=t.push(a)-1)}return n[s%n.length]}return a.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new ng;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return a},a.range=function(e){return arguments.length?(n=Array.from(e),a):n.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.copy=function(){return lg(t,n).unknown(r)},eg.apply(a,arguments),a}function cg(){var e,t,n=lg().unknown(void 0),r=n.domain,a=n.range,s=0,o=1,i=!1,l=0,c=0,d=.5;function u(){var n=r().length,u=o<s,m=u?o:s,h=u?s:o;e=(h-m)/Math.max(1,n-l+2*c),i&&(e=Math.floor(e)),m+=(h-m-e*(n-l))*d,t=e*(1-l),i&&(m=Math.round(m),t=Math.round(t));var p=function(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),s=new Array(a);++r<a;)s[r]=e+r*n;return s}(n).map(function(t){return m+e*t});return a(u?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),u()):r()},n.range=function(e){return arguments.length?([s,o]=e,s=+s,o=+o,u()):[s,o]},n.rangeRound=function(e){return[s,o]=e,s=+s,o=+o,i=!0,u()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(i=!!e,u()):i},n.padding=function(e){return arguments.length?(l=Math.min(1,c=+e),u()):l},n.paddingInner=function(e){return arguments.length?(l=Math.min(1,e),u()):l},n.paddingOuter=function(e){return arguments.length?(c=+e,u()):c},n.align=function(e){return arguments.length?(d=Math.max(0,Math.min(1,e)),u()):d},n.copy=function(){return cg(r(),[s,o]).round(i).paddingInner(l).paddingOuter(c).align(d)},eg.apply(u(),arguments)}function dg(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return dg(t())},e}function ug(){return dg(cg.apply(null,arguments).paddingInner(1))}function mg(e){return mg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mg(e)}function hg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function pg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hg(Object(n),!0).forEach(function(t){fg(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hg(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function fg(e,t,n){return t=function(e){var t=function(e,t){if("object"!=mg(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=mg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==mg(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gg={widthCache:{},cacheCount:0},xg={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},yg="recharts_measurement_span";var bg=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e||null===e||vm.isSsr)return{width:0,height:0};var n=function(e){var t=pg({},e);return Object.keys(t).forEach(function(e){t[e]||delete t[e]}),t}(t),r=JSON.stringify({text:e,copyStyle:n});if(gg.widthCache[r])return gg.widthCache[r];try{var a=document.getElementById(yg);a||((a=document.createElement("span")).setAttribute("id",yg),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var s=pg(pg({},xg),n);Object.assign(a.style,s),a.textContent="".concat(e);var o=a.getBoundingClientRect(),i={width:o.width,height:o.height};return gg.widthCache[r]=i,++gg.cacheCount>2e3&&(gg.cacheCount=0,gg.widthCache={}),i}catch(FB){return{width:0,height:0}}};function vg(e){return vg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vg(e)}function wg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,i=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return jg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jg(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ng(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,kg(r.key),r)}}function kg(e){var t=function(e,t){if("object"!=vg(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=vg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==vg(t)?t:t+""}var Sg=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Cg=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,_g=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Eg=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Pg={cm:96/2.54,mm:96/25.4,pt:96/72,pc:16,in:96,Q:96/101.6,px:1},Og=Object.keys(Pg),Ag="NaN";var Tg=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),""===n||_g.test(n)||(this.num=NaN,this.unit=""),Og.includes(n)&&(this.num=function(e,t){return e*Pg[t]}(t,n),this.unit="px")}return t=e,r=[{key:"parse",value:function(t){var n,r=wg(null!==(n=Eg.exec(t))&&void 0!==n?n:[],3),a=r[1],s=r[2];return new e(parseFloat(a),null!==s&&void 0!==s?s:"")}}],(n=[{key:"add",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}},{key:"subtract",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}},{key:"multiply",value:function(t){return""!==this.unit&&""!==t.unit&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}},{key:"divide",value:function(t){return""!==this.unit&&""!==t.unit&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}])&&Ng(t.prototype,n),r&&Ng(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}();function Dg(e){if(e.includes(Ag))return Ag;for(var t=e;t.includes("*")||t.includes("/");){var n,r=wg(null!==(n=Sg.exec(t))&&void 0!==n?n:[],4),a=r[1],s=r[2],o=r[3],i=Tg.parse(null!==a&&void 0!==a?a:""),l=Tg.parse(null!==o&&void 0!==o?o:""),c="*"===s?i.multiply(l):i.divide(l);if(c.isNaN())return Ag;t=t.replace(Sg,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,u=wg(null!==(d=Cg.exec(t))&&void 0!==d?d:[],4),m=u[1],h=u[2],p=u[3],f=Tg.parse(null!==m&&void 0!==m?m:""),g=Tg.parse(null!==p&&void 0!==p?p:""),x="+"===h?f.add(g):f.subtract(g);if(x.isNaN())return Ag;t=t.replace(Cg,x.toString())}return t}var Mg=/\(([^()]*)\)/;function Ig(e){var t=e.replace(/\s+/g,"");return t=function(e){for(var t=e;t.includes("(");){var n=wg(Mg.exec(t),2)[1];t=t.replace(Mg,Dg(n))}return t}(t),t=Dg(t)}function Lg(e){var t=function(e){try{return Ig(e)}catch(FB){return Ag}}(e.slice(5,-1));return t===Ag?"":t}var Rg=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Fg=["dx","dy","angle","className","breakAll"];function Bg(){return Bg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bg.apply(this,arguments)}function Ug(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function zg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,i=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Vg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vg(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wg=/[ \f\n\r\t\v\u2028\u2029]+/,qg=function(e){var t=e.children,n=e.breakAll,r=e.style;try{var a=[];return Fd()(t)||(a=n?t.toString().split(""):t.toString().split(Wg)),{wordsWithComputedWidth:a.map(function(e){return{word:e,width:bg(e,r).width}}),spaceWidth:n?0:bg("\xa0",r).width}}catch(FB){return null}},Hg=function(e){return[{words:Fd()(e)?[]:e.toString().split(Wg)}]},Yg=function(e){var t=e.width,n=e.scaleToFit,r=e.children,a=e.style,s=e.breakAll,o=e.maxLines;if((t||n)&&!vm.isSsr){var i=qg({breakAll:s,children:r,style:a});return i?function(e,t,n,r,a){var s=e.maxLines,o=e.children,i=e.style,l=e.breakAll,c=zd(s),d=o,u=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(e,t){var s=t.word,o=t.width,i=e[e.length-1];if(i&&(null==r||a||i.width+o+n<Number(r)))i.words.push(s),i.width+=o+n;else{var l={words:[s],width:o};e.push(l)}return e},[])},m=u(t);if(!c)return m;for(var h,p=function(e){var t=d.slice(0,e),n=qg({breakAll:l,style:i,children:t+"\u2026"}).wordsWithComputedWidth,a=u(n),o=a.length>s||function(e){return e.reduce(function(e,t){return e.width>t.width?e:t})}(a).width>Number(r);return[o,a]},f=0,g=d.length-1,x=0;f<=g&&x<=d.length-1;){var y=Math.floor((f+g)/2),b=zg(p(y-1),2),v=b[0],w=b[1],j=zg(p(y),1)[0];if(v||j||(f=y+1),v&&j&&(g=y-1),!v&&j){h=w;break}x++}return h||m}({breakAll:s,children:r,maxLines:o,style:a},i.wordsWithComputedWidth,i.spaceWidth,t,n):Hg(r)}return Hg(r)},Gg="#808080",Xg=function(e){var t=e.x,n=void 0===t?0:t,r=e.y,a=void 0===r?0:r,o=e.lineHeight,i=void 0===o?"1em":o,l=e.capHeight,c=void 0===l?"0.71em":l,d=e.scaleToFit,u=void 0!==d&&d,m=e.textAnchor,h=void 0===m?"start":m,p=e.verticalAnchor,f=void 0===p?"end":p,g=e.fill,x=void 0===g?Gg:g,y=Ug(e,Rg),b=(0,s.useMemo)(function(){return Yg({breakAll:y.breakAll,children:y.children,maxLines:y.maxLines,scaleToFit:u,style:y.style,width:y.width})},[y.breakAll,y.children,y.maxLines,u,y.style,y.width]),v=y.dx,w=y.dy,j=y.angle,N=y.className,k=y.breakAll,S=Ug(y,Fg);if(!Vd(n)||!Vd(a))return null;var C,_=n+(zd(v)?v:0),E=a+(zd(w)?w:0);switch(f){case"start":C=Lg("calc(".concat(c,")"));break;case"middle":C=Lg("calc(".concat((b.length-1)/2," * -").concat(i," + (").concat(c," / 2))"));break;default:C=Lg("calc(".concat(b.length-1," * -").concat(i,")"))}var P=[];if(u){var O=b[0].width,A=y.width;P.push("scale(".concat((zd(A)?A/O:1)/O,")"))}return j&&P.push("rotate(".concat(j,", ").concat(_,", ").concat(E,")")),P.length&&(S.transform=P.join(" ")),s.createElement("text",Bg({},Nu(S,!0),{x:_,y:E,className:Cd("recharts-text",N),textAnchor:h,fill:x.includes("url")?Gg:x}),b.map(function(e,t){var n=e.words.join(k?"":" ");return s.createElement("tspan",{x:_,dy:0===t?C:i,key:"".concat(n,"-").concat(t)},n)}))};const $g=Math.sqrt(50),Kg=Math.sqrt(10),Jg=Math.sqrt(2);function Qg(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),s=r/Math.pow(10,a),o=s>=$g?10:s>=Kg?5:s>=Jg?2:1;let i,l,c;return a<0?(c=Math.pow(10,-a)/o,i=Math.round(e*c),l=Math.round(t*c),i/c<e&&++i,l/c>t&&--l,c=-c):(c=Math.pow(10,a)*o,i=Math.round(e/c),l=Math.round(t/c),i*c<e&&++i,l*c>t&&--l),l<i&&.5<=n&&n<2?Qg(e,t,2*n):[i,l,c]}function Zg(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[a,s,o]=r?Qg(t,e,n):Qg(e,t,n);if(!(s>=a))return[];const i=s-a+1,l=new Array(i);if(r)if(o<0)for(let c=0;c<i;++c)l[c]=(s-c)/-o;else for(let c=0;c<i;++c)l[c]=(s-c)*o;else if(o<0)for(let c=0;c<i;++c)l[c]=(a+c)/-o;else for(let c=0;c<i;++c)l[c]=(a+c)*o;return l}function ex(e,t,n){return Qg(e=+e,t=+t,n=+n)[2]}function tx(e,t,n){n=+n;const r=(t=+t)<(e=+e),a=r?ex(t,e,n):ex(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function nx(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function rx(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ax(e){let t,n,r;function a(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<s){if(0!==t(r,r))return s;do{const t=a+s>>>1;n(e[t],r)<0?a=t+1:s=t}while(a<s)}return a}return 2!==e.length?(t=nx,n=(t,n)=>nx(e(t),n),r=(t,n)=>e(t)-n):(t=e===nx||e===rx?e:sx,n=e,r=e),{left:a,center:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=a(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return s>n&&r(e[s-1],t)>-r(e[s],t)?s-1:s},right:function(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<s){if(0!==t(r,r))return s;do{const t=a+s>>>1;n(e[t],r)<=0?a=t+1:s=t}while(a<s)}return a}}}function sx(){return 0}function ox(e){return null===e?NaN:+e}const ix=ax(nx),lx=ix.right,cx=(ix.left,ax(ox).center,lx);function dx(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ux(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function mx(){}var hx=.7,px=1/hx,fx="\\s*([+-]?\\d+)\\s*",gx="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",xx="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",yx=/^#([0-9a-f]{3,8})$/,bx=new RegExp("^rgb\\(".concat(fx,",").concat(fx,",").concat(fx,"\\)$")),vx=new RegExp("^rgb\\(".concat(xx,",").concat(xx,",").concat(xx,"\\)$")),wx=new RegExp("^rgba\\(".concat(fx,",").concat(fx,",").concat(fx,",").concat(gx,"\\)$")),jx=new RegExp("^rgba\\(".concat(xx,",").concat(xx,",").concat(xx,",").concat(gx,"\\)$")),Nx=new RegExp("^hsl\\(".concat(gx,",").concat(xx,",").concat(xx,"\\)$")),kx=new RegExp("^hsla\\(".concat(gx,",").concat(xx,",").concat(xx,",").concat(gx,"\\)$")),Sx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Cx(){return this.rgb().formatHex()}function _x(){return this.rgb().formatRgb()}function Ex(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=yx.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Px(t):3===n?new Tx(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Ox(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Ox(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=bx.exec(e))?new Tx(t[1],t[2],t[3],1):(t=vx.exec(e))?new Tx(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=wx.exec(e))?Ox(t[1],t[2],t[3],t[4]):(t=jx.exec(e))?Ox(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Nx.exec(e))?Fx(t[1],t[2]/100,t[3]/100,1):(t=kx.exec(e))?Fx(t[1],t[2]/100,t[3]/100,t[4]):Sx.hasOwnProperty(e)?Px(Sx[e]):"transparent"===e?new Tx(NaN,NaN,NaN,0):null}function Px(e){return new Tx(e>>16&255,e>>8&255,255&e,1)}function Ox(e,t,n,r){return r<=0&&(e=t=n=NaN),new Tx(e,t,n,r)}function Ax(e,t,n,r){return 1===arguments.length?((a=e)instanceof mx||(a=Ex(a)),a?new Tx((a=a.rgb()).r,a.g,a.b,a.opacity):new Tx):new Tx(e,t,n,null==r?1:r);var a}function Tx(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Dx(){return"#".concat(Rx(this.r)).concat(Rx(this.g)).concat(Rx(this.b))}function Mx(){const e=Ix(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(Lx(this.r),", ").concat(Lx(this.g),", ").concat(Lx(this.b)).concat(1===e?")":", ".concat(e,")"))}function Ix(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Lx(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Rx(e){return((e=Lx(e))<16?"0":"")+e.toString(16)}function Fx(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ux(e,t,n,r)}function Bx(e){if(e instanceof Ux)return new Ux(e.h,e.s,e.l,e.opacity);if(e instanceof mx||(e=Ex(e)),!e)return new Ux;if(e instanceof Ux)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,i=s-a,l=(s+a)/2;return i?(o=t===s?(n-r)/i+6*(n<r):n===s?(r-t)/i+2:(t-n)/i+4,i/=l<.5?s+a:2-s-a,o*=60):i=l>0&&l<1?0:o,new Ux(o,i,l,e.opacity)}function Ux(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function zx(e){return(e=(e||0)%360)<0?e+360:e}function Vx(e){return Math.max(0,Math.min(1,e||0))}function Wx(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function qx(e,t,n,r,a){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*r+o*a)/6}dx(mx,Ex,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Cx,formatHex:Cx,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Bx(this).formatHsl()},formatRgb:_x,toString:_x}),dx(Tx,Ax,ux(mx,{brighter(e){return e=null==e?px:Math.pow(px,e),new Tx(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?hx:Math.pow(hx,e),new Tx(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Tx(Lx(this.r),Lx(this.g),Lx(this.b),Ix(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Dx,formatHex:Dx,formatHex8:function(){return"#".concat(Rx(this.r)).concat(Rx(this.g)).concat(Rx(this.b)).concat(Rx(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:Mx,toString:Mx})),dx(Ux,function(e,t,n,r){return 1===arguments.length?Bx(e):new Ux(e,t,n,null==r?1:r)},ux(mx,{brighter(e){return e=null==e?px:Math.pow(px,e),new Ux(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?hx:Math.pow(hx,e),new Ux(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new Tx(Wx(e>=240?e-240:e+120,a,r),Wx(e,a,r),Wx(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new Ux(zx(this.h),Vx(this.s),Vx(this.l),Ix(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ix(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(zx(this.h),", ").concat(100*Vx(this.s),"%, ").concat(100*Vx(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const Hx=e=>()=>e;function Yx(e,t){return function(n){return e+n*t}}function Gx(e){return 1===(e=+e)?Xx:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Hx(isNaN(t)?n:t)}}function Xx(e,t){var n=t-e;return n?Yx(e,n):Hx(isNaN(e)?t:e)}const $x=function e(t){var n=Gx(t);function r(e,t){var r=n((e=Ax(e)).r,(t=Ax(t)).r),a=n(e.g,t.g),s=n(e.b,t.b),o=Xx(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=s(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function Kx(e){return function(t){var n,r,a=t.length,s=new Array(a),o=new Array(a),i=new Array(a);for(n=0;n<a;++n)r=Ax(t[n]),s[n]=r.r||0,o[n]=r.g||0,i[n]=r.b||0;return s=e(s),o=e(o),i=e(i),r.opacity=1,function(e){return r.r=s(e),r.g=o(e),r.b=i(e),r+""}}}Kx(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],s=e[r+1],o=r>0?e[r-1]:2*a-s,i=r<t-1?e[r+2]:2*s-a;return qx((n-r/t)*t,o,a,s,i)}}),Kx(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],s=e[r%t],o=e[(r+1)%t],i=e[(r+2)%t];return qx((n-r/t)*t,a,s,o,i)}});function Jx(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,s=new Array(a),o=new Array(r);for(n=0;n<a;++n)s[n]=sy(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<a;++n)o[n]=s[n](e);return o}}function Qx(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Zx(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function ey(e,t){var n,r={},a={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=sy(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}var ty=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ny=new RegExp(ty.source,"g");function ry(e,t){var n,r,a,s=ty.lastIndex=ny.lastIndex=0,o=-1,i=[],l=[];for(e+="",t+="";(n=ty.exec(e))&&(r=ny.exec(t));)(a=r.index)>s&&(a=t.slice(s,a),i[o]?i[o]+=a:i[++o]=a),(n=n[0])===(r=r[0])?i[o]?i[o]+=r:i[++o]=r:(i[++o]=null,l.push({i:o,x:Zx(n,r)})),s=ny.lastIndex;return s<t.length&&(a=t.slice(s),i[o]?i[o]+=a:i[++o]=a),i.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)i[(n=l[r]).i]=n.x(e);return i.join("")})}function ay(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(s){for(n=0;n<r;++n)a[n]=e[n]*(1-s)+t[n]*s;return a}}function sy(e,t){var n,r,a=typeof t;return null==t||"boolean"===a?Hx(t):("number"===a?Zx:"string"===a?(n=Ex(t))?(t=n,$x):ry:t instanceof Ex?$x:t instanceof Date?Qx:(r=t,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(t)?Jx:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?ey:Zx:ay))(e,t)}function oy(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function iy(e){return+e}var ly=[0,1];function cy(e){return e}function dy(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function uy(e,t,n){var r=e[0],a=e[1],s=t[0],o=t[1];return a<r?(r=dy(a,r),s=n(o,s)):(r=dy(r,a),s=n(s,o)),function(e){return s(r(e))}}function my(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),s=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)a[o]=dy(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(t){var n=cx(e,t,1,r)-1;return s[n](a[n](t))}}function hy(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function py(){var e,t,n,r,a,s,o=ly,i=ly,l=sy,c=cy;function d(){var e=Math.min(o.length,i.length);return c!==cy&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?my:uy,a=s=null,u}function u(t){return null==t||isNaN(t=+t)?n:(a||(a=r(o.map(e),i,l)))(e(c(t)))}return u.invert=function(n){return c(t((s||(s=r(i,o.map(e),Zx)))(n)))},u.domain=function(e){return arguments.length?(o=Array.from(e,iy),d()):o.slice()},u.range=function(e){return arguments.length?(i=Array.from(e),d()):i.slice()},u.rangeRound=function(e){return i=Array.from(e),l=oy,d()},u.clamp=function(e){return arguments.length?(c=!!e||cy,d()):c!==cy},u.interpolate=function(e){return arguments.length?(l=e,d()):l},u.unknown=function(e){return arguments.length?(n=e,u):n},function(n,r){return e=n,t=r,d()}}function fy(){return py()(cy,cy)}var gy,xy=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function yy(e){if(!(t=xy.exec(e)))throw new Error("invalid format: "+e);var t;return new by({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function by(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function vy(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function wy(e){return(e=vy(Math.abs(e)))?e[1]:NaN}function jy(e,t){var n=vy(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}yy.prototype=by.prototype,by.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Ny={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>jy(100*e,t),r:jy,s:function(e,t){var n=vy(e,t);if(!n)return e+"";var r=n[0],a=n[1],s=a-(gy=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+vy(e,Math.max(0,t+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function ky(e){return e}var Sy,Cy,_y,Ey=Array.prototype.map,Py=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Oy(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?ky:(t=Ey.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,s=[],o=0,i=t[0],l=0;a>0&&i>0&&(l+i+1>r&&(i=Math.max(1,r-l)),s.push(e.substring(a-=i,a+i)),!((l+=i+1)>r));)i=t[o=(o+1)%t.length];return s.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",s=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",i=void 0===e.numerals?ky:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(Ey.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",d=void 0===e.nan?"NaN":e.nan+"";function u(e){var t=(e=yy(e)).fill,n=e.align,u=e.sign,m=e.symbol,h=e.zero,p=e.width,f=e.comma,g=e.precision,x=e.trim,y=e.type;"n"===y?(f=!0,y="g"):Ny[y]||(void 0===g&&(g=12),x=!0,y="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var b="$"===m?a:"#"===m&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",v="$"===m?s:/[%p]/.test(y)?l:"",w=Ny[y],j=/[defgprs%]/.test(y);function N(e){var a,s,l,m=b,N=v;if("c"===y)N=w(e)+N,e="";else{var k=(e=+e)<0||1/e<0;if(e=isNaN(e)?d:w(Math.abs(e),g),x&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),k&&0===+e&&"+"!==u&&(k=!1),m=(k?"("===u?u:c:"-"===u||"("===u?"":u)+m,N=("s"===y?Py[8+gy/3]:"")+N+(k&&"("===u?")":""),j)for(a=-1,s=e.length;++a<s;)if(48>(l=e.charCodeAt(a))||l>57){N=(46===l?o+e.slice(a+1):e.slice(a))+N,e=e.slice(0,a);break}}f&&!h&&(e=r(e,1/0));var S=m.length+e.length+N.length,C=S<p?new Array(p-S+1).join(t):"";switch(f&&h&&(e=r(C+e,C.length?p-N.length:1/0),C=""),n){case"<":e=m+e+N+C;break;case"=":e=m+C+e+N;break;case"^":e=C.slice(0,S=C.length>>1)+m+e+N+C.slice(S);break;default:e=C+m+e+N}return i(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),N.toString=function(){return e+""},N}return{format:u,formatPrefix:function(e,t){var n=u(((e=yy(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(wy(t)/3))),a=Math.pow(10,-r),s=Py[8+r/3];return function(e){return n(a*e)+s}}}}function Ay(e,t,n,r){var a,s=tx(e,t,n);switch((r=yy(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(wy(t)/3)))-wy(Math.abs(e)))}(s,o))||(r.precision=a),_y(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,wy(t)-wy(e))+1}(s,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=function(e){return Math.max(0,-wy(Math.abs(e)))}(s))||(r.precision=a-2*("%"===r.type))}return Cy(r)}function Ty(e){var t=e.domain;return e.ticks=function(e){var n=t();return Zg(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return Ay(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,s=t(),o=0,i=s.length-1,l=s[o],c=s[i],d=10;for(c<l&&(a=l,l=c,c=a,a=o,o=i,i=a);d-- >0;){if((a=ex(l,c,n))===r)return s[o]=l,s[i]=c,t(s);if(a>0)l=Math.floor(l/a)*a,c=Math.ceil(c/a)*a;else{if(!(a<0))break;l=Math.ceil(l*a)/a,c=Math.floor(c*a)/a}r=a}return e},e}function Dy(){var e=fy();return e.copy=function(){return hy(e,Dy())},eg.apply(e,arguments),Ty(e)}function My(e){var t;function n(e){return null==e||isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,iy),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return My(e).unknown(t)},e=arguments.length?Array.from(e,iy):[0,1],Ty(n)}function Iy(e,t){var n,r=0,a=(e=e.slice()).length-1,s=e[r],o=e[a];return o<s&&(n=r,r=a,a=n,n=s,s=o,o=n),e[r]=t.floor(s),e[a]=t.ceil(o),e}function Ly(e){return Math.log(e)}function Ry(e){return Math.exp(e)}function Fy(e){return-Math.log(-e)}function By(e){return-Math.exp(-e)}function Uy(e){return isFinite(e)?+("1e"+e):e<0?0:e}function zy(e){return(t,n)=>-e(-t,n)}function Vy(e){const t=e(Ly,Ry),n=t.domain;let r,a,s=10;function o(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(s),a=function(e){return 10===e?Uy:e===Math.E?Math.exp:t=>Math.pow(e,t)}(s),n()[0]<0?(r=zy(r),a=zy(a),e(Fy,By)):e(Ly,Ry),t}return t.base=function(e){return arguments.length?(s=+e,o()):s},t.domain=function(e){return arguments.length?(n(e),o()):n()},t.ticks=e=>{const t=n();let o=t[0],i=t[t.length-1];const l=i<o;l&&([o,i]=[i,o]);let c,d,u=r(o),m=r(i);const h=null==e?10:+e;let p=[];if(!(s%1)&&m-u<h){if(u=Math.floor(u),m=Math.ceil(m),o>0){for(;u<=m;++u)for(c=1;c<s;++c)if(d=u<0?c/a(-u):c*a(u),!(d<o)){if(d>i)break;p.push(d)}}else for(;u<=m;++u)for(c=s-1;c>=1;--c)if(d=u>0?c/a(-u):c*a(u),!(d<o)){if(d>i)break;p.push(d)}2*p.length<h&&(p=Zg(o,i,h))}else p=Zg(u,m,Math.min(m-u,h)).map(a);return l?p.reverse():p},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===s?"s":","),"function"!==typeof n&&(s%1||null!=(n=yy(n)).precision||(n.trim=!0),n=Cy(n)),e===1/0)return n;const o=Math.max(1,s*e/t.ticks().length);return e=>{let t=e/a(Math.round(r(e)));return t*s<s-.5&&(t*=s),t<=o?n(e):""}},t.nice=()=>n(Iy(n(),{floor:e=>a(Math.floor(r(e))),ceil:e=>a(Math.ceil(r(e)))})),t}function Wy(){const e=Vy(py()).domain([1,10]);return e.copy=()=>hy(e,Wy()).base(e.base()),eg.apply(e,arguments),e}function qy(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Hy(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Yy(e){var t=1,n=e(qy(t),Hy(t));return n.constant=function(n){return arguments.length?e(qy(t=+n),Hy(t)):t},Ty(n)}function Gy(){var e=Yy(py());return e.copy=function(){return hy(e,Gy()).constant(e.constant())},eg.apply(e,arguments)}function Xy(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function $y(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Ky(e){return e<0?-e*e:e*e}function Jy(e){var t=e(cy,cy),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(cy,cy):.5===n?e($y,Ky):e(Xy(n),Xy(1/n)):n},Ty(t)}function Qy(){var e=Jy(py());return e.copy=function(){return hy(e,Qy()).exponent(e.exponent())},eg.apply(e,arguments),e}function Zy(){return Qy.apply(null,arguments).exponent(.5)}function eb(e){return Math.sign(e)*e*e}function tb(){var e,t=fy(),n=[0,1],r=!1;function a(n){var a=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(t(n));return isNaN(a)?e:r?Math.round(a):a}return a.invert=function(e){return t.invert(eb(e))},a.domain=function(e){return arguments.length?(t.domain(e),a):t.domain()},a.range=function(e){return arguments.length?(t.range((n=Array.from(e,iy)).map(eb)),a):n.slice()},a.rangeRound=function(e){return a.range(e).round(!0)},a.round=function(e){return arguments.length?(r=!!e,a):r},a.clamp=function(e){return arguments.length?(t.clamp(e),a):t.clamp()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return tb(t.domain(),n).round(r).clamp(t.clamp()).unknown(e)},eg.apply(a,arguments),Ty(a)}function nb(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n<a||void 0===n&&a>=a)&&(n=a)}return n}function rb(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n>a||void 0===n&&a>=a)&&(n=a)}return n}function ab(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nx;if(e===nx)return sb;if("function"!==typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}function sb(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function ob(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,a=arguments.length>4?arguments[4]:void 0;if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=void 0===a?sb:ab(a);r>n;){if(r-n>600){const s=r-n+1,o=t-n+1,i=Math.log(s),l=.5*Math.exp(2*i/3),c=.5*Math.sqrt(i*l*(s-l)/s)*(o-s/2<0?-1:1);ob(e,t,Math.max(n,Math.floor(t-o*l/s+c)),Math.min(r,Math.floor(t+(s-o)*l/s+c)),a)}const s=e[t];let o=n,i=r;for(ib(e,n,t),a(e[r],s)>0&&ib(e,n,r);o<i;){for(ib(e,o,i),++o,--i;a(e[o],s)<0;)++o;for(;a(e[i],s)>0;)--i}0===a(e[n],s)?ib(e,n,i):(++i,ib(e,i,r)),i<=t&&(n=i+1),t<=i&&(r=i-1)}return e}function ib(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function lb(e,t,n){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(let n of e)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n)),(r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return rb(e);if(t>=1)return nb(e);var r,a=(r-1)*t,s=Math.floor(a),o=nb(ob(e,s).subarray(0,s+1));return o+(rb(e.subarray(s+1))-o)*(a-s)}}function cb(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ox;if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,s=Math.floor(a),o=+n(e[s],s,e);return o+(+n(e[s+1],s+1,e)-o)*(a-s)}}function db(){var e,t=[],n=[],r=[];function a(){var e=0,a=Math.max(1,n.length);for(r=new Array(a-1);++e<a;)r[e-1]=cb(t,e/a);return s}function s(t){return null==t||isNaN(t=+t)?e:n[cx(r,t)]}return s.invertExtent=function(e){var a=n.indexOf(e);return a<0?[NaN,NaN]:[a>0?r[a-1]:t[0],a<r.length?r[a]:t[t.length-1]]},s.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let n of e)null==n||isNaN(n=+n)||t.push(n);return t.sort(nx),a()},s.range=function(e){return arguments.length?(n=Array.from(e),a()):n.slice()},s.unknown=function(t){return arguments.length?(e=t,s):e},s.quantiles=function(){return r.slice()},s.copy=function(){return db().domain(t).range(n).unknown(e)},eg.apply(s,arguments)}function ub(){var e,t=0,n=1,r=1,a=[.5],s=[0,1];function o(t){return null!=t&&t<=t?s[cx(a,t,0,r)]:e}function i(){var e=-1;for(a=new Array(r);++e<r;)a[e]=((e+1)*n-(e-r)*t)/(r+1);return o}return o.domain=function(e){return arguments.length?([t,n]=e,t=+t,n=+n,i()):[t,n]},o.range=function(e){return arguments.length?(r=(s=Array.from(e)).length-1,i()):s.slice()},o.invertExtent=function(e){var o=s.indexOf(e);return o<0?[NaN,NaN]:o<1?[t,a[0]]:o>=r?[a[r-1],n]:[a[o-1],a[o]]},o.unknown=function(t){return arguments.length?(e=t,o):o},o.thresholds=function(){return a.slice()},o.copy=function(){return ub().domain([t,n]).range(s).unknown(e)},eg.apply(Ty(o),arguments)}function mb(){var e,t=[.5],n=[0,1],r=1;function a(a){return null!=a&&a<=a?n[cx(t,a,0,r)]:e}return a.domain=function(e){return arguments.length?(t=Array.from(e),r=Math.min(t.length,n.length-1),a):t.slice()},a.range=function(e){return arguments.length?(n=Array.from(e),r=Math.min(t.length,n.length-1),a):n.slice()},a.invertExtent=function(e){var r=n.indexOf(e);return[t[r-1],t[r]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return mb().domain(t).range(n).unknown(e)},eg.apply(a,arguments)}Sy=Oy({thousands:",",grouping:[3],currency:["$",""]}),Cy=Sy.format,_y=Sy.formatPrefix;const hb=1e3,pb=6e4,fb=36e5,gb=864e5,xb=6048e5,yb=2592e6,bb=31536e6,vb=new Date,wb=new Date;function jb(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=t=>(e(t=new Date(+t)),t),a.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),a.round=e=>{const t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),a.range=(n,r,s)=>{const o=[];if(n=a.ceil(n),s=null==s?1:Math.floor(s),!(n<r)||!(s>0))return o;let i;do{o.push(i=new Date(+n)),t(n,s),e(n)}while(i<n&&n<r);return o},a.filter=n=>jb(t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},(e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}),n&&(a.count=(t,r)=>(vb.setTime(+t),wb.setTime(+r),e(vb),e(wb),Math.floor(n(vb,wb))),a.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?t=>r(t)%e===0:t=>a.count(0,t)%e===0):a:null)),a}const Nb=jb(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Nb.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?jb(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Nb:null);Nb.range;const kb=jb(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*hb)},(e,t)=>(t-e)/hb,e=>e.getUTCSeconds()),Sb=(kb.range,jb(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*hb)},(e,t)=>{e.setTime(+e+t*pb)},(e,t)=>(t-e)/pb,e=>e.getMinutes())),Cb=(Sb.range,jb(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*pb)},(e,t)=>(t-e)/pb,e=>e.getUTCMinutes())),_b=(Cb.range,jb(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*hb-e.getMinutes()*pb)},(e,t)=>{e.setTime(+e+t*fb)},(e,t)=>(t-e)/fb,e=>e.getHours())),Eb=(_b.range,jb(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*fb)},(e,t)=>(t-e)/fb,e=>e.getUTCHours())),Pb=(Eb.range,jb(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*pb)/gb,e=>e.getDate()-1)),Ob=(Pb.range,jb(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/gb,e=>e.getUTCDate()-1)),Ab=(Ob.range,jb(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/gb,e=>Math.floor(e/gb)));Ab.range;function Tb(e){return jb(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*pb)/xb)}const Db=Tb(0),Mb=Tb(1),Ib=Tb(2),Lb=Tb(3),Rb=Tb(4),Fb=Tb(5),Bb=Tb(6);Db.range,Mb.range,Ib.range,Lb.range,Rb.range,Fb.range,Bb.range;function Ub(e){return jb(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/xb)}const zb=Ub(0),Vb=Ub(1),Wb=Ub(2),qb=Ub(3),Hb=Ub(4),Yb=Ub(5),Gb=Ub(6),Xb=(zb.range,Vb.range,Wb.range,qb.range,Hb.range,Yb.range,Gb.range,jb(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),e=>e.getMonth())),$b=(Xb.range,jb(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth())),Kb=($b.range,jb(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear()));Kb.every=e=>isFinite(e=Math.floor(e))&&e>0?jb(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}):null;Kb.range;const Jb=jb(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Jb.every=e=>isFinite(e=Math.floor(e))&&e>0?jb(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null;Jb.range;function Qb(e,t,n,r,a,s){const o=[[kb,1,hb],[kb,5,5e3],[kb,15,15e3],[kb,30,3e4],[s,1,pb],[s,5,3e5],[s,15,9e5],[s,30,18e5],[a,1,fb],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,gb],[r,2,1728e5],[n,1,xb],[t,1,yb],[t,3,7776e6],[e,1,bb]];function i(t,n,r){const a=Math.abs(n-t)/r,s=ax(e=>{let[,,t]=e;return t}).right(o,a);if(s===o.length)return e.every(tx(t/bb,n/bb,r));if(0===s)return Nb.every(Math.max(tx(t,n,r),1));const[i,l]=o[a/o[s-1][2]<o[s][2]/a?s-1:s];return i.every(l)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const a=n&&"function"===typeof n.range?n:i(e,t,n),s=a?a.range(e,+t+1):[];return r?s.reverse():s},i]}const[Zb,ev]=Qb(Jb,$b,zb,Ab,Eb,Cb),[tv,nv]=Qb(Kb,Xb,Db,Pb,_b,Sb);function rv(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function av(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function sv(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var ov,iv,lv,cv={"-":"",_:" ",0:"0"},dv=/^\s*\d+/,uv=/^%/,mv=/[\\^$*+?|[\]().{}]/g;function hv(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",s=a.length;return r+(s<n?new Array(n-s+1).join(t)+a:a)}function pv(e){return e.replace(mv,"\\$&")}function fv(e){return new RegExp("^(?:"+e.map(pv).join("|")+")","i")}function gv(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function xv(e,t,n){var r=dv.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function yv(e,t,n){var r=dv.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function bv(e,t,n){var r=dv.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function vv(e,t,n){var r=dv.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function wv(e,t,n){var r=dv.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function jv(e,t,n){var r=dv.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Nv(e,t,n){var r=dv.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function kv(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Sv(e,t,n){var r=dv.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function Cv(e,t,n){var r=dv.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function _v(e,t,n){var r=dv.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Ev(e,t,n){var r=dv.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Pv(e,t,n){var r=dv.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Ov(e,t,n){var r=dv.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Av(e,t,n){var r=dv.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Tv(e,t,n){var r=dv.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Dv(e,t,n){var r=dv.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Mv(e,t,n){var r=uv.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Iv(e,t,n){var r=dv.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Lv(e,t,n){var r=dv.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Rv(e,t){return hv(e.getDate(),t,2)}function Fv(e,t){return hv(e.getHours(),t,2)}function Bv(e,t){return hv(e.getHours()%12||12,t,2)}function Uv(e,t){return hv(1+Pb.count(Kb(e),e),t,3)}function zv(e,t){return hv(e.getMilliseconds(),t,3)}function Vv(e,t){return zv(e,t)+"000"}function Wv(e,t){return hv(e.getMonth()+1,t,2)}function qv(e,t){return hv(e.getMinutes(),t,2)}function Hv(e,t){return hv(e.getSeconds(),t,2)}function Yv(e){var t=e.getDay();return 0===t?7:t}function Gv(e,t){return hv(Db.count(Kb(e)-1,e),t,2)}function Xv(e){var t=e.getDay();return t>=4||0===t?Rb(e):Rb.ceil(e)}function $v(e,t){return e=Xv(e),hv(Rb.count(Kb(e),e)+(4===Kb(e).getDay()),t,2)}function Kv(e){return e.getDay()}function Jv(e,t){return hv(Mb.count(Kb(e)-1,e),t,2)}function Qv(e,t){return hv(e.getFullYear()%100,t,2)}function Zv(e,t){return hv((e=Xv(e)).getFullYear()%100,t,2)}function ew(e,t){return hv(e.getFullYear()%1e4,t,4)}function tw(e,t){var n=e.getDay();return hv((e=n>=4||0===n?Rb(e):Rb.ceil(e)).getFullYear()%1e4,t,4)}function nw(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+hv(t/60|0,"0",2)+hv(t%60,"0",2)}function rw(e,t){return hv(e.getUTCDate(),t,2)}function aw(e,t){return hv(e.getUTCHours(),t,2)}function sw(e,t){return hv(e.getUTCHours()%12||12,t,2)}function ow(e,t){return hv(1+Ob.count(Jb(e),e),t,3)}function iw(e,t){return hv(e.getUTCMilliseconds(),t,3)}function lw(e,t){return iw(e,t)+"000"}function cw(e,t){return hv(e.getUTCMonth()+1,t,2)}function dw(e,t){return hv(e.getUTCMinutes(),t,2)}function uw(e,t){return hv(e.getUTCSeconds(),t,2)}function mw(e){var t=e.getUTCDay();return 0===t?7:t}function hw(e,t){return hv(zb.count(Jb(e)-1,e),t,2)}function pw(e){var t=e.getUTCDay();return t>=4||0===t?Hb(e):Hb.ceil(e)}function fw(e,t){return e=pw(e),hv(Hb.count(Jb(e),e)+(4===Jb(e).getUTCDay()),t,2)}function gw(e){return e.getUTCDay()}function xw(e,t){return hv(Vb.count(Jb(e)-1,e),t,2)}function yw(e,t){return hv(e.getUTCFullYear()%100,t,2)}function bw(e,t){return hv((e=pw(e)).getUTCFullYear()%100,t,2)}function vw(e,t){return hv(e.getUTCFullYear()%1e4,t,4)}function ww(e,t){var n=e.getUTCDay();return hv((e=n>=4||0===n?Hb(e):Hb.ceil(e)).getUTCFullYear()%1e4,t,4)}function jw(){return"+0000"}function Nw(){return"%"}function kw(e){return+e}function Sw(e){return Math.floor(+e/1e3)}function Cw(e){return new Date(e)}function _w(e){return e instanceof Date?+e:+new Date(+e)}function Ew(e,t,n,r,a,s,o,i,l,c){var d=fy(),u=d.invert,m=d.domain,h=c(".%L"),p=c(":%S"),f=c("%I:%M"),g=c("%I %p"),x=c("%a %d"),y=c("%b %d"),b=c("%B"),v=c("%Y");function w(e){return(l(e)<e?h:i(e)<e?p:o(e)<e?f:s(e)<e?g:r(e)<e?a(e)<e?x:y:n(e)<e?b:v)(e)}return d.invert=function(e){return new Date(u(e))},d.domain=function(e){return arguments.length?m(Array.from(e,_w)):m().map(Cw)},d.ticks=function(t){var n=m();return e(n[0],n[n.length-1],null==t?10:t)},d.tickFormat=function(e,t){return null==t?w:c(t)},d.nice=function(e){var n=m();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?m(Iy(n,e)):d},d.copy=function(){return hy(d,Ew(e,t,n,r,a,s,o,i,l,c))},d}function Pw(){return eg.apply(Ew(tv,nv,Kb,Xb,Db,Pb,_b,Sb,kb,iv).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Ow(){return eg.apply(Ew(Zb,ev,Jb,$b,zb,Ob,Eb,Cb,kb,lv).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Aw(){var e,t,n,r,a,s=0,o=1,i=cy,l=!1;function c(t){return null==t||isNaN(t=+t)?a:i(0===n?.5:(t=(r(t)-e)*n,l?Math.max(0,Math.min(1,t)):t))}function d(e){return function(t){var n,r;return arguments.length?([n,r]=t,i=e(n,r),c):[i(0),i(1)]}}return c.domain=function(a){return arguments.length?([s,o]=a,e=r(s=+s),t=r(o=+o),n=e===t?0:1/(t-e),c):[s,o]},c.clamp=function(e){return arguments.length?(l=!!e,c):l},c.interpolator=function(e){return arguments.length?(i=e,c):i},c.range=d(sy),c.rangeRound=d(oy),c.unknown=function(e){return arguments.length?(a=e,c):a},function(a){return r=a,e=a(s),t=a(o),n=e===t?0:1/(t-e),c}}function Tw(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Dw(){var e=Ty(Aw()(cy));return e.copy=function(){return Tw(e,Dw())},tg.apply(e,arguments)}function Mw(){var e=Vy(Aw()).domain([1,10]);return e.copy=function(){return Tw(e,Mw()).base(e.base())},tg.apply(e,arguments)}function Iw(){var e=Yy(Aw());return e.copy=function(){return Tw(e,Iw()).constant(e.constant())},tg.apply(e,arguments)}function Lw(){var e=Jy(Aw());return e.copy=function(){return Tw(e,Lw()).exponent(e.exponent())},tg.apply(e,arguments)}function Rw(){return Lw.apply(null,arguments).exponent(.5)}function Fw(){var e=[],t=cy;function n(n){if(null!=n&&!isNaN(n=+n))return t((cx(e,n,1)-1)/(e.length-1))}return n.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(nx),n},n.interpolator=function(e){return arguments.length?(t=e,n):t},n.range=function(){return e.map((n,r)=>t(r/(e.length-1)))},n.quantiles=function(t){return Array.from({length:t+1},(n,r)=>lb(e,r/t))},n.copy=function(){return Fw(t).domain(e)},tg.apply(n,arguments)}function Bw(){var e,t,n,r,a,s,o,i=0,l=.5,c=1,d=1,u=cy,m=!1;function h(e){return isNaN(e=+e)?o:(e=.5+((e=+s(e))-t)*(d*e<d*t?r:a),u(m?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,a;return arguments.length?([n,r,a]=t,u=function(e,t){void 0===t&&(t=e,e=sy);for(var n=0,r=t.length-1,a=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(a,a=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return s[t](e-t)}}(e,[n,r,a]),h):[u(0),u(.5),u(1)]}}return h.domain=function(o){return arguments.length?([i,l,c]=o,e=s(i=+i),t=s(l=+l),n=s(c=+c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),d=t<e?-1:1,h):[i,l,c]},h.clamp=function(e){return arguments.length?(m=!!e,h):m},h.interpolator=function(e){return arguments.length?(u=e,h):u},h.range=p(sy),h.rangeRound=p(oy),h.unknown=function(e){return arguments.length?(o=e,h):o},function(o){return s=o,e=o(i),t=o(l),n=o(c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),d=t<e?-1:1,h}}function Uw(){var e=Ty(Bw()(cy));return e.copy=function(){return Tw(e,Uw())},tg.apply(e,arguments)}function zw(){var e=Vy(Bw()).domain([.1,1,10]);return e.copy=function(){return Tw(e,zw()).base(e.base())},tg.apply(e,arguments)}function Vw(){var e=Yy(Bw());return e.copy=function(){return Tw(e,Vw()).constant(e.constant())},tg.apply(e,arguments)}function Ww(){var e=Jy(Bw());return e.copy=function(){return Tw(e,Ww()).exponent(e.exponent())},tg.apply(e,arguments)}function qw(){return Ww.apply(null,arguments).exponent(.5)}function Hw(e,t){if((a=e.length)>1)for(var n,r,a,s=1,o=e[t[0]],i=o.length;s<a;++s)for(r=o,o=e[t[s]],n=0;n<i;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}!function(e){ov=function(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,s=e.days,o=e.shortDays,i=e.months,l=e.shortMonths,c=fv(a),d=gv(a),u=fv(s),m=gv(s),h=fv(o),p=gv(o),f=fv(i),g=gv(i),x=fv(l),y=gv(l),b={a:function(e){return o[e.getDay()]},A:function(e){return s[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return i[e.getMonth()]},c:null,d:Rv,e:Rv,f:Vv,g:Zv,G:tw,H:Fv,I:Bv,j:Uv,L:zv,m:Wv,M:qv,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:kw,s:Sw,S:Hv,u:Yv,U:Gv,V:$v,w:Kv,W:Jv,x:null,X:null,y:Qv,Y:ew,Z:nw,"%":Nw},v={a:function(e){return o[e.getUTCDay()]},A:function(e){return s[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return i[e.getUTCMonth()]},c:null,d:rw,e:rw,f:lw,g:bw,G:ww,H:aw,I:sw,j:ow,L:iw,m:cw,M:dw,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:kw,s:Sw,S:uw,u:mw,U:hw,V:fw,w:gw,W:xw,x:null,X:null,y:yw,Y:vw,Z:jw,"%":Nw},w={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=u.exec(t.slice(n));return r?(e.w=m.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=x.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return k(e,t,n,r)},d:_v,e:_v,f:Dv,g:Nv,G:jv,H:Pv,I:Pv,j:Ev,L:Tv,m:Cv,M:Ov,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=d.get(r[0].toLowerCase()),n+r[0].length):-1},q:Sv,Q:Iv,s:Lv,S:Av,u:yv,U:bv,V:vv,w:xv,W:wv,x:function(e,t,r){return k(e,n,t,r)},X:function(e,t,n){return k(e,r,t,n)},y:Nv,Y:jv,Z:kv,"%":Mv};function j(e,t){return function(n){var r,a,s,o=[],i=-1,l=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++i<c;)37===e.charCodeAt(i)&&(o.push(e.slice(l,i)),null!=(a=cv[r=e.charAt(++i)])?r=e.charAt(++i):a="e"===r?" ":"0",(s=t[r])&&(r=s(n,a)),o.push(r),l=i+1);return o.push(e.slice(l,i)),o.join("")}}function N(e,t){return function(n){var r,a,s=sv(1900,void 0,1);if(k(s,e,n+="",0)!=n.length)return null;if("Q"in s)return new Date(s.Q);if("s"in s)return new Date(1e3*s.s+("L"in s?s.L:0));if(t&&!("Z"in s)&&(s.Z=0),"p"in s&&(s.H=s.H%12+12*s.p),void 0===s.m&&(s.m="q"in s?s.q:0),"V"in s){if(s.V<1||s.V>53)return null;"w"in s||(s.w=1),"Z"in s?(a=(r=av(sv(s.y,0,1))).getUTCDay(),r=a>4||0===a?Vb.ceil(r):Vb(r),r=Ob.offset(r,7*(s.V-1)),s.y=r.getUTCFullYear(),s.m=r.getUTCMonth(),s.d=r.getUTCDate()+(s.w+6)%7):(a=(r=rv(sv(s.y,0,1))).getDay(),r=a>4||0===a?Mb.ceil(r):Mb(r),r=Pb.offset(r,7*(s.V-1)),s.y=r.getFullYear(),s.m=r.getMonth(),s.d=r.getDate()+(s.w+6)%7)}else("W"in s||"U"in s)&&("w"in s||(s.w="u"in s?s.u%7:"W"in s?1:0),a="Z"in s?av(sv(s.y,0,1)).getUTCDay():rv(sv(s.y,0,1)).getDay(),s.m=0,s.d="W"in s?(s.w+6)%7+7*s.W-(a+5)%7:s.w+7*s.U-(a+6)%7);return"Z"in s?(s.H+=s.Z/100|0,s.M+=s.Z%100,av(s)):rv(s)}}function k(e,t,n,r){for(var a,s,o=0,i=t.length,l=n.length;o<i;){if(r>=l)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(s=w[a in cv?t.charAt(o++):a])||(r=s(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return b.x=j(n,b),b.X=j(r,b),b.c=j(t,b),v.x=j(n,v),v.X=j(r,v),v.c=j(t,v),{format:function(e){var t=j(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=N(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=j(e+="",v);return t.toString=function(){return e},t},utcParse:function(e){var t=N(e+="",!0);return t.toString=function(){return e},t}}}(e),iv=ov.format,ov.parse,lv=ov.utcFormat,ov.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Array.prototype.slice;function Yw(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function Gw(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function Xw(e,t){return e[t]}function $w(e){const t=[];return t.key=e,t}var Kw=n(539),Jw=n.n(Kw),Qw=n(6745),Zw=n.n(Qw),ej=n(3538),tj=n.n(ej),nj=n(9853),rj=n.n(nj),aj=n(8210),sj=n.n(aj);function oj(e){return function(e){if(Array.isArray(e))return ij(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return ij(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ij(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ij(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var lj=function(e){return e},cj={"@@functional/placeholder":!0},dj=function(e){return e===cj},uj=function(e){return function t(){return 0===arguments.length||1===arguments.length&&dj(arguments.length<=0?void 0:arguments[0])?t:e.apply(void 0,arguments)}},mj=function e(t,n){return 1===t?n:uj(function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];var o=a.filter(function(e){return e!==cj}).length;return o>=t?n.apply(void 0,a):e(t-o,uj(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var s=a.map(function(e){return dj(e)?t.shift():e});return n.apply(void 0,oj(s).concat(t))}))})},hj=function(e){return mj(e.length,e)},pj=function(e,t){for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},fj=hj(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(e){return t[e]}).map(e)}),gj=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return lj;var r=t.reverse(),a=r[0],s=r.slice(1);return function(){return s.reduce(function(e,t){return t(e)},a.apply(void 0,arguments))}},xj=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},yj=function(e){var t=null,n=null;return function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return t&&a.every(function(e,n){return e===t[n]})?n:(t=a,n=e.apply(void 0,a))}};var bj=hj(function(e,t,n){var r=+e;return r+n*(+t-r)}),vj=hj(function(e,t,n){var r=t-+e;return(n-e)/(r=r||1/0)}),wj=hj(function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});const jj={rangeStep:function(e,t,n){for(var r=new(sj())(e),a=0,s=[];r.lt(t)&&a<1e5;)s.push(r.toNumber()),r=r.add(n),a++;return s},getDigitCount:function(e){return 0===e?1:Math.floor(new(sj())(e).abs().log(10).toNumber())+1},interpolateNumber:bj,uninterpolateNumber:vj,uninterpolateTruncation:wj};function Nj(e){return function(e){if(Array.isArray(e))return Cj(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Sj(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,s=void 0;try{for(var o,i=e[Symbol.iterator]();!(r=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(BB){a=!0,s=BB}finally{try{r||null==i.return||i.return()}finally{if(a)throw s}}return n}(e,t)||Sj(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sj(e,t){if(e){if("string"===typeof e)return Cj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cj(e,t):void 0}}function Cj(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _j(e){var t=kj(e,2),n=t[0],r=t[1],a=n,s=r;return n>r&&(a=r,s=n),[a,s]}function Ej(e,t,n){if(e.lte(0))return new(sj())(0);var r=jj.getDigitCount(e.toNumber()),a=new(sj())(10).pow(r),s=e.div(a),o=1!==r?.05:.1,i=new(sj())(Math.ceil(s.div(o).toNumber())).add(n).mul(o).mul(a);return t?i:new(sj())(Math.ceil(i))}function Pj(e,t,n){var r=1,a=new(sj())(e);if(!a.isint()&&n){var s=Math.abs(e);s<1?(r=new(sj())(10).pow(jj.getDigitCount(e)-1),a=new(sj())(Math.floor(a.div(r).toNumber())).mul(r)):s>1&&(a=new(sj())(Math.floor(e)))}else 0===e?a=new(sj())(Math.floor((t-1)/2)):n||(a=new(sj())(Math.floor(e)));var o=Math.floor((t-1)/2);return gj(fj(function(e){return a.add(new(sj())(e-o).mul(r)).toNumber()}),pj)(0,t)}function Oj(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new(sj())(0),tickMin:new(sj())(0),tickMax:new(sj())(0)};var s,o=Ej(new(sj())(t).sub(e).div(n-1),r,a);s=e<=0&&t>=0?new(sj())(0):(s=new(sj())(e).add(t).div(2)).sub(new(sj())(s).mod(o));var i=Math.ceil(s.sub(e).div(o).toNumber()),l=Math.ceil(new(sj())(t).sub(s).div(o).toNumber()),c=i+l+1;return c>n?Oj(e,t,n,r,a+1):(c<n&&(l=t>0?l+(n-c):l,i=t>0?i:i+(n-c)),{step:o,tickMin:s.sub(new(sj())(i).mul(o)),tickMax:s.add(new(sj())(l).mul(o))})}var Aj=yj(function(e){var t=kj(e,2),n=t[0],r=t[1],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=Math.max(a,2),i=kj(_j([n,r]),2),l=i[0],c=i[1];if(l===-1/0||c===1/0){var d=c===1/0?[l].concat(Nj(pj(0,a-1).map(function(){return 1/0}))):[].concat(Nj(pj(0,a-1).map(function(){return-1/0})),[c]);return n>r?xj(d):d}if(l===c)return Pj(l,a,s);var u=Oj(l,c,o,s),m=u.step,h=u.tickMin,p=u.tickMax,f=jj.rangeStep(h,p.add(new(sj())(.1).mul(m)),m);return n>r?xj(f):f}),Tj=(yj(function(e){var t=kj(e,2),n=t[0],r=t[1],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=Math.max(a,2),i=kj(_j([n,r]),2),l=i[0],c=i[1];if(l===-1/0||c===1/0)return[n,r];if(l===c)return Pj(l,a,s);var d=Ej(new(sj())(c).sub(l).div(o-1),s,0),u=gj(fj(function(e){return new(sj())(l).add(new(sj())(e).mul(d)).toNumber()}),pj)(0,o).filter(function(e){return e>=l&&e<=c});return n>r?xj(u):u}),yj(function(e,t){var n=kj(e,2),r=n[0],a=n[1],s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=kj(_j([r,a]),2),i=o[0],l=o[1];if(i===-1/0||l===1/0)return[r,a];if(i===l)return[i];var c=Math.max(t,2),d=Ej(new(sj())(l).sub(i).div(c-1),s,0),u=[].concat(Nj(jj.rangeStep(new(sj())(i),new(sj())(l).sub(new(sj())(.99).mul(d)),d)),[l]);return r>a?xj(u):u})),Dj=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Mj(e){return Mj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mj(e)}function Ij(){return Ij=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ij.apply(this,arguments)}function Lj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,i=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Rj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rj(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rj(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fj(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Bj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Hj(r.key),r)}}function Uj(e,t,n){return t=Vj(t),function(e,t){if(t&&("object"===Mj(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,zj()?Reflect.construct(t,n||[],Vj(e).constructor):t.apply(e,n))}function zj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(zj=function(){return!!e})()}function Vj(e){return Vj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vj(e)}function Wj(e,t){return Wj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Wj(e,t)}function qj(e,t,n){return(t=Hj(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hj(e){var t=function(e,t){if("object"!=Mj(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Mj(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Mj(t)?t:t+""}var Yj=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Uj(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wj(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props,t=e.offset,n=e.layout,r=e.width,a=e.dataKey,o=e.data,i=e.dataPointFormatter,l=e.xAxis,c=e.yAxis,d=Fj(e,Dj),u=Nu(d,!1);"x"===this.props.direction&&"number"!==l.type&&Bu(!1);var m=o.map(function(e){var o=i(e,a),d=o.x,m=o.y,h=o.value,p=o.errorVal;if(!p)return null;var f,g,x=[];if(Array.isArray(p)){var y=Lj(p,2);f=y[0],g=y[1]}else f=g=p;if("vertical"===n){var b=l.scale,v=m+t,w=v+r,j=v-r,N=b(h-f),k=b(h+g);x.push({x1:k,y1:w,x2:k,y2:j}),x.push({x1:N,y1:v,x2:k,y2:v}),x.push({x1:N,y1:w,x2:N,y2:j})}else if("horizontal"===n){var S=c.scale,C=d+t,_=C-r,E=C+r,P=S(h-f),O=S(h+g);x.push({x1:_,y1:O,x2:E,y2:O}),x.push({x1:C,y1:P,x2:C,y2:O}),x.push({x1:_,y1:P,x2:E,y2:P})}return s.createElement(Gu,Ij({className:"recharts-errorBar",key:"bar-".concat(x.map(function(e){return"".concat(e.x1,"-").concat(e.x2,"-").concat(e.y1,"-").concat(e.y2)}))},u),x.map(function(e){return s.createElement("line",Ij({},e,{key:"line-".concat(e.x1,"-").concat(e.x2,"-").concat(e.y1,"-").concat(e.y2)}))}))});return s.createElement(Gu,{className:"recharts-errorBars"},m)}}],r&&Bj(n.prototype,r),a&&Bj(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.Component);function Gj(e){return Gj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gj(e)}function Xj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function $j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xj(Object(n),!0).forEach(function(t){Kj(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xj(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Kj(e,t,n){return t=function(e){var t=function(e,t){if("object"!=Gj(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Gj(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Gj(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}qj(Yj,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"}),qj(Yj,"displayName","ErrorBar");var Jj=function(e){var t=e.children,n=e.formattedGraphicalItems,r=e.legendWidth,a=e.legendContent,s=bu(t,dp);if(!s)return null;var o,i=dp.defaultProps,l=void 0!==i?$j($j({},i),s.props):{};return o=s.props&&s.props.payload?s.props&&s.props.payload:"children"===a?(n||[]).reduce(function(e,t){var n=t.item,r=t.props,a=r.sectors||r.data||[];return e.concat(a.map(function(e){return{type:s.props.iconType||n.props.legendType,value:e.name,color:e.fill,payload:e}}))},[]):(n||[]).map(function(e){var t=e.item,n=t.type.defaultProps,r=void 0!==n?$j($j({},n),t.props):{},a=r.dataKey,s=r.name,o=r.legendType;return{inactive:r.hide,dataKey:a,type:l.iconType||o||"square",color:oN(t),value:s||a,payload:r}}),$j($j($j({},l),dp.getWithHeight(s,r)),{},{payload:o,item:s})};function Qj(e){return Qj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qj(e)}function Zj(e){return function(e){if(Array.isArray(e))return eN(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return eN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eN(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eN(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tN(Object(n),!0).forEach(function(t){rN(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tN(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function rN(e,t,n){return t=function(e){var t=function(e,t){if("object"!=Qj(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Qj(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qj(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aN(e,t,n){return Fd()(e)||Fd()(t)?n:Vd(t)?Md()(e,t,n):Qd()(t)?t(e):n}function sN(e,t,n,r){var a=tj()(e,function(e){return aN(e,t)});if("number"===n){var s=a.filter(function(e){return zd(e)||parseFloat(e)});return s.length?[Zw()(s),Jw()(s)]:[1/0,-1/0]}return(r?a.filter(function(e){return!Fd()(e)}):a).map(function(e){return Vd(e)||e instanceof Date?e:""})}var oN=function(e){var t,n,r=e.type.displayName,a=null!==(t=e.type)&&void 0!==t&&t.defaultProps?nN(nN({},e.type.defaultProps),e.props):e.props,s=a.stroke,o=a.fill;switch(r){case"Line":n=s;break;case"Area":case"Radar":n=s&&"none"!==s?s:o;break;default:n=o}return n},iN=function(e,t,n,r,a){var s=yu(t.props.children,Yj).filter(function(e){return function(e,t,n){return!!Fd()(t)||("horizontal"===e?"yAxis"===t:"vertical"===e||"x"===n?"xAxis"===t:"y"!==n||"yAxis"===t)}(r,a,e.props.direction)});if(s&&s.length){var o=s.map(function(e){return e.props.dataKey});return e.reduce(function(e,t){var r=aN(t,n);if(Fd()(r))return e;var a=Array.isArray(r)?[Zw()(r),Jw()(r)]:[r,r],s=o.reduce(function(e,n){var r=aN(t,n,0),s=a[0]-Math.abs(Array.isArray(r)?r[0]:r),o=a[1]+Math.abs(Array.isArray(r)?r[1]:r);return[Math.min(s,e[0]),Math.max(o,e[1])]},[1/0,-1/0]);return[Math.min(s[0],e[0]),Math.max(s[1],e[1])]},[1/0,-1/0])}return null},lN=function(e,t,n,r,a){var s=t.map(function(t){var s=t.props.dataKey;return"number"===n&&s&&iN(e,t,s,r)||sN(e,s,n,a)});if("number"===n)return s.reduce(function(e,t){return[Math.min(e[0],t[0]),Math.max(e[1],t[1])]},[1/0,-1/0]);var o={};return s.reduce(function(e,t){for(var n=0,r=t.length;n<r;n++)o[t[n]]||(o[t[n]]=!0,e.push(t[n]));return e},[])},cN=function(e,t){return"horizontal"===e&&"xAxis"===t||"vertical"===e&&"yAxis"===t||"centric"===e&&"angleAxis"===t||"radial"===e&&"radiusAxis"===t},dN=function(e,t,n,r){if(r)return e.map(function(e){return e.coordinate});var a,s,o=e.map(function(e){return e.coordinate===t&&(a=!0),e.coordinate===n&&(s=!0),e.coordinate});return a||o.push(t),s||o.push(n),o},uN=function(e,t,n){if(!e)return null;var r=e.scale,a=e.duplicateDomain,s=e.type,o=e.range,i="scaleBand"===e.realScaleType?r.bandwidth()/2:2,l=(t||n)&&"category"===s&&r.bandwidth?r.bandwidth()/i:0;return l="angleAxis"===e.axisType&&(null===o||void 0===o?void 0:o.length)>=2?2*Bd(o[0]-o[1])*l:l,t&&(e.ticks||e.niceTicks)?(e.ticks||e.niceTicks).map(function(e){var t=a?a.indexOf(e):e;return{coordinate:r(t)+l,value:e,offset:l}}).filter(function(e){return!Td()(e.coordinate)}):e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(e,t){return{coordinate:r(e)+l,value:e,index:t,offset:l}}):r.ticks&&!n?r.ticks(e.tickCount).map(function(e){return{coordinate:r(e)+l,value:e,offset:l}}):r.domain().map(function(e,t){return{coordinate:r(e)+l,value:a?a[e]:e,index:t,offset:l}})},mN=new WeakMap,hN=function(e,t){if("function"!==typeof t)return e;mN.has(e)||mN.set(e,new WeakMap);var n=mN.get(e);if(n.has(t))return n.get(t);var r=function(){e.apply(void 0,arguments),t.apply(void 0,arguments)};return n.set(t,r),r},pN=function(e,t,n){var a=e.scale,s=e.type,o=e.layout,i=e.axisType;if("auto"===a)return"radial"===o&&"radiusAxis"===i?{scale:cg(),realScaleType:"band"}:"radial"===o&&"angleAxis"===i?{scale:Dy(),realScaleType:"linear"}:"category"===s&&t&&(t.indexOf("LineChart")>=0||t.indexOf("AreaChart")>=0||t.indexOf("ComposedChart")>=0&&!n)?{scale:ug(),realScaleType:"point"}:"category"===s?{scale:cg(),realScaleType:"band"}:{scale:Dy(),realScaleType:"linear"};if(Od()(a)){var l="scale".concat(Rm()(a));return{scale:(r[l]||ug)(),realScaleType:r[l]?l:"point"}}return Qd()(a)?{scale:a}:{scale:ug(),realScaleType:"point"}},fN=1e-4,gN=function(e){var t=e.domain();if(t&&!(t.length<=2)){var n=t.length,r=e.range(),a=Math.min(r[0],r[1])-fN,s=Math.max(r[0],r[1])+fN,o=e(t[0]),i=e(t[n-1]);(o<a||o>s||i<a||i>s)&&e.domain([t[0],t[n-1]])}},xN={sign:function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,s=0,o=0;o<t;++o){var i=Td()(e[o][n][1])?e[o][n][0]:e[o][n][1];i>=0?(e[o][n][0]=a,e[o][n][1]=a+i,a=e[o][n][1]):(e[o][n][0]=s,e[o][n][1]=s+i,s=e[o][n][1])}},expand:function(e,t){if((r=e.length)>0){for(var n,r,a,s=0,o=e[0].length;s<o;++s){for(a=n=0;n<r;++n)a+=e[n][s][1]||0;if(a)for(n=0;n<r;++n)e[n][s][1]/=a}Hw(e,t)}},none:Hw,silhouette:function(e,t){if((n=e.length)>0){for(var n,r=0,a=e[t[0]],s=a.length;r<s;++r){for(var o=0,i=0;o<n;++o)i+=e[o][r][1]||0;a[r][1]+=a[r][0]=-i/2}Hw(e,t)}},wiggle:function(e,t){if((a=e.length)>0&&(r=(n=e[t[0]]).length)>0){for(var n,r,a,s=0,o=1;o<r;++o){for(var i=0,l=0,c=0;i<a;++i){for(var d=e[t[i]],u=d[o][1]||0,m=(u-(d[o-1][1]||0))/2,h=0;h<i;++h){var p=e[t[h]];m+=(p[o][1]||0)-(p[o-1][1]||0)}l+=u,c+=m*u}n[o-1][1]+=n[o-1][0]=s,l&&(s-=c/l)}n[o-1][1]+=n[o-1][0]=s,Hw(e,t)}},positive:function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,s=0;s<t;++s){var o=Td()(e[s][n][1])?e[s][n][0]:e[s][n][1];o>=0?(e[s][n][0]=a,e[s][n][1]=a+o,a=e[s][n][1]):(e[s][n][0]=0,e[s][n][1]=0)}}},yN=function(e,t,n){var r=t.map(function(e){return e.props.dataKey}),a=xN[n],s=function(){var e=oh([]),t=Gw,n=Hw,r=Xw;function a(a){var s,o,i=Array.from(e.apply(this,arguments),$w),l=i.length,c=-1;for(const e of a)for(s=0,++c;s<l;++s)(i[s][c]=[0,+r(e,i[s].key,c,a)]).data=e;for(s=0,o=Yw(t(i));s<l;++s)i[o[s]].index=s;return n(i,o),i}return a.keys=function(t){return arguments.length?(e="function"===typeof t?t:oh(Array.from(t)),a):e},a.value=function(e){return arguments.length?(r="function"===typeof e?e:oh(+e),a):r},a.order=function(e){return arguments.length?(t=null==e?Gw:"function"===typeof e?e:oh(Array.from(e)),a):t},a.offset=function(e){return arguments.length?(n=null==e?Hw:e,a):n},a}().keys(r).value(function(e,t){return+aN(e,t,0)}).order(Gw).offset(a);return s(e)},bN=function(e,t){var n=t.realScaleType,r=t.type,a=t.tickCount,s=t.originalDomain,o=t.allowDecimals,i=n||t.scale;if("auto"!==i&&"linear"!==i)return null;if(a&&"number"===r&&s&&("auto"===s[0]||"auto"===s[1])){var l=e.domain();if(!l.length)return null;var c=Aj(l,a,o);return e.domain([Zw()(c),Jw()(c)]),{niceTicks:c}}if(a&&"number"===r){var d=e.domain();return{niceTicks:Tj(d,a,o)}}return null};var vN=function(e){var t=e.axis,n=e.ticks,r=e.offset,a=e.bandSize,s=e.entry,o=e.index;if("category"===t.type)return n[o]?n[o].coordinate+r:null;var i=aN(s,t.dataKey,t.domain[o]);return Fd()(i)?null:t.scale(i)-a/2+r},wN=function(e,t,n){return Object.keys(e).reduce(function(r,a){var s=e[a].stackedData.reduce(function(e,r){var a=function(e){return e.reduce(function(e,t){return[Zw()(t.concat([e[0]]).filter(zd)),Jw()(t.concat([e[1]]).filter(zd))]},[1/0,-1/0])}(r.slice(t,n+1));return[Math.min(e[0],a[0]),Math.max(e[1],a[1])]},[1/0,-1/0]);return[Math.min(s[0],r[0]),Math.max(s[1],r[1])]},[1/0,-1/0]).map(function(e){return e===1/0||e===-1/0?0:e})},jN=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,NN=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,kN=function(e,t,n){if(Qd()(e))return e(t,n);if(!Array.isArray(e))return t;var r=[];if(zd(e[0]))r[0]=n?e[0]:Math.min(e[0],t[0]);else if(jN.test(e[0])){var a=+jN.exec(e[0])[1];r[0]=t[0]-a}else Qd()(e[0])?r[0]=e[0](t[0]):r[0]=t[0];if(zd(e[1]))r[1]=n?e[1]:Math.max(e[1],t[1]);else if(NN.test(e[1])){var s=+NN.exec(e[1])[1];r[1]=t[1]+s}else Qd()(e[1])?r[1]=e[1](t[1]):r[1]=t[1];return r},SN=function(e,t,n){if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var a=Ru()(t,function(e){return e.coordinate}),s=1/0,o=1,i=a.length;o<i;o++){var l=a[o],c=a[o-1];s=Math.min((l.coordinate||0)-(c.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0},CN=function(e,t,n){return e&&e.length?rj()(e,Md()(n,"type.defaultProps.domain"))?t:e:t},_N=function(e,t){var n=e.type.defaultProps?nN(nN({},e.type.defaultProps),e.props):e.props,r=n.dataKey,a=n.name,s=n.unit,o=n.formatter,i=n.tooltipType,l=n.chartType,c=n.hide;return nN(nN({},Nu(e,!1)),{},{dataKey:r,unit:s,formatter:o,name:a||r,color:oN(e),value:aN(t,r),type:i,payload:t,chartType:l,hide:c})};function EN(e){return EN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},EN(e)}function PN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ON(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?PN(Object(n),!0).forEach(function(t){AN(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PN(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function AN(e,t,n){return t=function(e){var t=function(e,t){if("object"!=EN(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=EN(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==EN(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var TN=["Webkit","Moz","O","ms"];function DN(e){return DN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DN(e)}function MN(){return MN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},MN.apply(this,arguments)}function IN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function LN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?IN(Object(n),!0).forEach(function(t){VN(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IN(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function RN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,WN(r.key),r)}}function FN(e,t,n){return t=UN(t),function(e,t){if(t&&("object"===DN(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,BN()?Reflect.construct(t,n||[],UN(e).constructor):t.apply(e,n))}function BN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(BN=function(){return!!e})()}function UN(e){return UN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},UN(e)}function zN(e,t){return zN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},zN(e,t)}function VN(e,t,n){return(t=WN(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WN(e){var t=function(e,t){if("object"!=DN(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=DN(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==DN(t)?t:t+""}var qN=function(e){return e.changedTouches&&!!e.changedTouches.length},HN=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),VN(n=FN(this,t,[e]),"handleDrag",function(e){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(e):n.state.isSlideMoving&&n.handleSlideDrag(e)}),VN(n,"handleTouchMove",function(e){null!=e.changedTouches&&e.changedTouches.length>0&&n.handleDrag(e.changedTouches[0])}),VN(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var e=n.props,t=e.endIndex,r=e.onDragEnd,a=e.startIndex;null===r||void 0===r||r({endIndex:t,startIndex:a})}),n.detachDragEndListener()}),VN(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),VN(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),VN(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),VN(n,"handleSlideDragStart",function(e){var t=qN(e)?e.changedTouches[0]:e;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:t.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zN(e,t)}(t,e),n=t,r=[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(e){var n=e.startX,r=e.endX,a=this.state.scaleValues,s=this.props,o=s.gap,i=s.data.length-1,l=Math.min(n,r),c=Math.max(n,r),d=t.getIndexInRange(a,l),u=t.getIndexInRange(a,c);return{startIndex:d-d%o,endIndex:u===i?i:u-u%o}}},{key:"getTextOfTick",value:function(e){var t=this.props,n=t.data,r=t.tickFormatter,a=t.dataKey,s=aN(n[e],a,e);return Qd()(r)?r(s,e):s}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(e){var t=this.state,n=t.slideMoveStartX,r=t.startX,a=t.endX,s=this.props,o=s.x,i=s.width,l=s.travellerWidth,c=s.startIndex,d=s.endIndex,u=s.onChange,m=e.pageX-n;m>0?m=Math.min(m,o+i-l-a,o+i-l-r):m<0&&(m=Math.max(m,o-r,o-a));var h=this.getIndex({startX:r+m,endX:a+m});h.startIndex===c&&h.endIndex===d||!u||u(h),this.setState({startX:r+m,endX:a+m,slideMoveStartX:e.pageX})}},{key:"handleTravellerDragStart",value:function(e,t){var n=qN(t)?t.changedTouches[0]:t;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:e,brushMoveStartX:n.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(e){var t=this.state,n=t.brushMoveStartX,r=t.movingTravellerId,a=t.endX,s=t.startX,o=this.state[r],i=this.props,l=i.x,c=i.width,d=i.travellerWidth,u=i.onChange,m=i.gap,h=i.data,p={startX:this.state.startX,endX:this.state.endX},f=e.pageX-n;f>0?f=Math.min(f,l+c-d-o):f<0&&(f=Math.max(f,l-o)),p[r]=o+f;var g=this.getIndex(p),x=g.startIndex,y=g.endIndex;this.setState(VN(VN({},r,o+f),"brushMoveStartX",e.pageX),function(){u&&function(){var e=h.length-1;return"startX"===r&&(a>s?x%m===0:y%m===0)||a<s&&y===e||"endX"===r&&(a>s?y%m===0:x%m===0)||a>s&&y===e}()&&u(g)})}},{key:"handleTravellerMoveKeyboard",value:function(e,t){var n=this,r=this.state,a=r.scaleValues,s=r.startX,o=r.endX,i=this.state[t],l=a.indexOf(i);if(-1!==l){var c=l+e;if(!(-1===c||c>=a.length)){var d=a[c];"startX"===t&&d>=o||"endX"===t&&d<=s||this.setState(VN({},t,d),function(){n.props.onChange(n.getIndex({startX:n.state.startX,endX:n.state.endX}))})}}}},{key:"renderBackground",value:function(){var e=this.props,t=e.x,n=e.y,r=e.width,a=e.height,o=e.fill,i=e.stroke;return s.createElement("rect",{stroke:i,fill:o,x:t,y:n,width:r,height:a})}},{key:"renderPanorama",value:function(){var e=this.props,t=e.x,n=e.y,r=e.width,a=e.height,o=e.data,i=e.children,l=e.padding,c=s.Children.only(i);return c?s.cloneElement(c,{x:t,y:n,width:r,height:a,margin:l,compact:!0,data:o}):null}},{key:"renderTravellerLayer",value:function(e,n){var r,a,o=this,i=this.props,l=i.y,c=i.travellerWidth,d=i.height,u=i.traveller,m=i.ariaLabel,h=i.data,p=i.startIndex,f=i.endIndex,g=Math.max(e,this.props.x),x=LN(LN({},Nu(this.props,!1)),{},{x:g,y:l,width:c,height:d}),y=m||"Min value: ".concat(null===(r=h[p])||void 0===r?void 0:r.name,", Max value: ").concat(null===(a=h[f])||void 0===a?void 0:a.name);return s.createElement(Gu,{tabIndex:0,role:"slider","aria-label":y,"aria-valuenow":e,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[n],onTouchStart:this.travellerDragStartHandlers[n],onKeyDown:function(e){["ArrowLeft","ArrowRight"].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),o.handleTravellerMoveKeyboard("ArrowRight"===e.key?1:-1,n))},onFocus:function(){o.setState({isTravellerFocused:!0})},onBlur:function(){o.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(u,x))}},{key:"renderSlide",value:function(e,t){var n=this.props,r=n.y,a=n.height,o=n.stroke,i=n.travellerWidth,l=Math.min(e,t)+i,c=Math.max(Math.abs(t-e)-i,0);return s.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:o,fillOpacity:.2,x:l,y:r,width:c,height:a})}},{key:"renderText",value:function(){var e=this.props,t=e.startIndex,n=e.endIndex,r=e.y,a=e.height,o=e.travellerWidth,i=e.stroke,l=this.state,c=l.startX,d=l.endX,u={pointerEvents:"none",fill:i};return s.createElement(Gu,{className:"recharts-brush-texts"},s.createElement(Xg,MN({textAnchor:"end",verticalAnchor:"middle",x:Math.min(c,d)-5,y:r+a/2},u),this.getTextOfTick(t)),s.createElement(Xg,MN({textAnchor:"start",verticalAnchor:"middle",x:Math.max(c,d)+o+5,y:r+a/2},u),this.getTextOfTick(n)))}},{key:"render",value:function(){var e=this.props,t=e.data,n=e.className,r=e.children,a=e.x,o=e.y,i=e.width,l=e.height,c=e.alwaysShowText,d=this.state,u=d.startX,m=d.endX,h=d.isTextActive,p=d.isSlideMoving,f=d.isTravellerMoving,g=d.isTravellerFocused;if(!t||!t.length||!zd(a)||!zd(o)||!zd(i)||!zd(l)||i<=0||l<=0)return null;var x=Cd("recharts-brush",n),y=1===s.Children.count(r),b=function(e,t){if(!e)return null;var n=e.replace(/(\w)/,function(e){return e.toUpperCase()}),r=TN.reduce(function(e,r){return ON(ON({},e),{},AN({},r+n,t))},{});return r[e]=t,r}("userSelect","none");return s.createElement(Gu,{className:x,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:b},this.renderBackground(),y&&this.renderPanorama(),this.renderSlide(u,m),this.renderTravellerLayer(u,"startX"),this.renderTravellerLayer(m,"endX"),(h||p||f||g||c)&&this.renderText())}}],a=[{key:"renderDefaultTraveller",value:function(e){var t=e.x,n=e.y,r=e.width,a=e.height,o=e.stroke,i=Math.floor(n+a/2)-1;return s.createElement(s.Fragment,null,s.createElement("rect",{x:t,y:n,width:r,height:a,fill:o,stroke:"none"}),s.createElement("line",{x1:t+1,y1:i,x2:t+r-1,y2:i,fill:"none",stroke:"#fff"}),s.createElement("line",{x1:t+1,y1:i+2,x2:t+r-1,y2:i+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(e,n){return s.isValidElement(e)?s.cloneElement(e,n):Qd()(e)?e(n):t.renderDefaultTraveller(n)}},{key:"getDerivedStateFromProps",value:function(e,t){var n=e.data,r=e.width,a=e.x,s=e.travellerWidth,o=e.updateId,i=e.startIndex,l=e.endIndex;if(n!==t.prevData||o!==t.prevUpdateId)return LN({prevData:n,prevTravellerWidth:s,prevUpdateId:o,prevX:a,prevWidth:r},n&&n.length?function(e){var t=e.data,n=e.startIndex,r=e.endIndex,a=e.x,s=e.width,o=e.travellerWidth;if(!t||!t.length)return{};var i=t.length,l=ug().domain(Iu()(0,i)).range([a,a+s-o]),c=l.domain().map(function(e){return l(e)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:l(n),endX:l(r),scale:l,scaleValues:c}}({data:n,width:r,x:a,travellerWidth:s,startIndex:i,endIndex:l}):{scale:null,scaleValues:null});if(t.scale&&(r!==t.prevWidth||a!==t.prevX||s!==t.prevTravellerWidth)){t.scale.range([a,a+r-s]);var c=t.scale.domain().map(function(e){return t.scale(e)});return{prevData:n,prevTravellerWidth:s,prevUpdateId:o,prevX:a,prevWidth:r,startX:t.scale(e.startIndex),endX:t.scale(e.endIndex),scaleValues:c}}return null}},{key:"getIndexInRange",value:function(e,t){for(var n=0,r=e.length-1;r-n>1;){var a=Math.floor((n+r)/2);e[a]>t?r=a:n=a}return t>=e[r]?r:n}}],r&&RN(n.prototype,r),a&&RN(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.PureComponent);function YN(e){return YN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},YN(e)}function GN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function XN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?GN(Object(n),!0).forEach(function(t){$N(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GN(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function $N(e,t,n){return t=function(e){var t=function(e,t){if("object"!=YN(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=YN(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==YN(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KN(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,i=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return JN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JN(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function JN(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}VN(HN,"displayName","Brush"),VN(HN,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var QN=Math.PI/180,ZN=function(e){return 180*e/Math.PI},ek=function(e,t,n,r){return{x:e+Math.cos(-QN*r)*n,y:t+Math.sin(-QN*r)*n}},tk=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(t-(n.top||0)-(n.bottom||0)))/2},nk=function(e,t){var n=e.x,r=e.y,a=t.cx,s=t.cy,o=function(e,t){var n=e.x,r=e.y,a=t.x,s=t.y;return Math.sqrt(Math.pow(n-a,2)+Math.pow(r-s,2))}({x:n,y:r},{x:a,y:s});if(o<=0)return{radius:o};var i=(n-a)/o,l=Math.acos(i);return r>s&&(l=2*Math.PI-l),{radius:o,angle:ZN(l),angleInRadian:l}},rk=function(e,t){var n=t.startAngle,r=t.endAngle,a=Math.floor(n/360),s=Math.floor(r/360);return e+360*Math.min(a,s)},ak=function(e,t){var n=e.x,r=e.y,a=nk({x:n,y:r},t),s=a.radius,o=a.angle,i=t.innerRadius,l=t.outerRadius;if(s<i||s>l)return!1;if(0===s)return!0;var c,d=function(e){var t=e.startAngle,n=e.endAngle,r=Math.floor(t/360),a=Math.floor(n/360),s=Math.min(r,a);return{startAngle:t-360*s,endAngle:n-360*s}}(t),u=d.startAngle,m=d.endAngle,h=o;if(u<=m){for(;h>m;)h-=360;for(;h<u;)h+=360;c=h>=u&&h<=m}else{for(;h>u;)h-=360;for(;h<m;)h+=360;c=h>=m&&h<=u}return c?XN(XN({},t),{},{radius:s,angle:rk(h,t)}):null},sk=function(e){return(0,s.isValidElement)(e)||Qd()(e)||"boolean"===typeof e?"":e.className};function ok(e){return ok="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ok(e)}var ik=["offset"];function lk(e){return function(e){if(Array.isArray(e))return ck(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return ck(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ck(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ck(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dk(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function uk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function mk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uk(Object(n),!0).forEach(function(t){hk(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function hk(e,t,n){return t=function(e){var t=function(e,t){if("object"!=ok(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ok(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ok(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pk(){return pk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pk.apply(this,arguments)}var fk=function(e,t,n){var r,a,o=e.position,i=e.viewBox,l=e.offset,c=e.className,d=i,u=d.cx,m=d.cy,h=d.innerRadius,p=d.outerRadius,f=d.startAngle,g=d.endAngle,x=d.clockWise,y=(h+p)/2,b=function(e,t){return Bd(t-e)*Math.min(Math.abs(t-e),360)}(f,g),v=b>=0?1:-1;"insideStart"===o?(r=f+v*l,a=x):"insideEnd"===o?(r=g-v*l,a=!x):"end"===o&&(r=g+v*l,a=x),a=b<=0?a:!a;var w=ek(u,m,y,r),j=ek(u,m,y,r+359*(a?1:-1)),N="M".concat(w.x,",").concat(w.y,"\n    A").concat(y,",").concat(y,",0,1,").concat(a?0:1,",\n    ").concat(j.x,",").concat(j.y),k=Fd()(e.id)?qd("recharts-radial-line-"):e.id;return s.createElement("text",pk({},n,{dominantBaseline:"central",className:Cd("recharts-radial-bar-label",c)}),s.createElement("defs",null,s.createElement("path",{id:k,d:N})),s.createElement("textPath",{xlinkHref:"#".concat(k)},t))};function gk(e){var t,n=e.offset,r=mk({offset:void 0===n?5:n},dk(e,ik)),a=r.viewBox,o=r.position,i=r.value,l=r.children,c=r.content,d=r.className,u=void 0===d?"":d,m=r.textBreakAll;if(!a||Fd()(i)&&Fd()(l)&&!(0,s.isValidElement)(c)&&!Qd()(c))return null;if((0,s.isValidElement)(c))return(0,s.cloneElement)(c,r);if(Qd()(c)){if(t=(0,s.createElement)(c,r),(0,s.isValidElement)(t))return t}else t=function(e){var t=e.value,n=e.formatter,r=Fd()(e.children)?t:e.children;return Qd()(n)?n(r):r}(r);var h=function(e){return"cx"in e&&zd(e.cx)}(a),p=Nu(r,!0);if(h&&("insideStart"===o||"insideEnd"===o||"end"===o))return fk(r,t,p);var f=h?function(e){var t=e.viewBox,n=e.offset,r=e.position,a=t,s=a.cx,o=a.cy,i=a.innerRadius,l=a.outerRadius,c=(a.startAngle+a.endAngle)/2;if("outside"===r){var d=ek(s,o,l+n,c),u=d.x;return{x:u,y:d.y,textAnchor:u>=s?"start":"end",verticalAnchor:"middle"}}if("center"===r)return{x:s,y:o,textAnchor:"middle",verticalAnchor:"middle"};if("centerTop"===r)return{x:s,y:o,textAnchor:"middle",verticalAnchor:"start"};if("centerBottom"===r)return{x:s,y:o,textAnchor:"middle",verticalAnchor:"end"};var m=ek(s,o,(i+l)/2,c);return{x:m.x,y:m.y,textAnchor:"middle",verticalAnchor:"middle"}}(r):function(e){var t=e.viewBox,n=e.parentViewBox,r=e.offset,a=e.position,s=t,o=s.x,i=s.y,l=s.width,c=s.height,d=c>=0?1:-1,u=d*r,m=d>0?"end":"start",h=d>0?"start":"end",p=l>=0?1:-1,f=p*r,g=p>0?"end":"start",x=p>0?"start":"end";if("top"===a)return mk(mk({},{x:o+l/2,y:i-d*r,textAnchor:"middle",verticalAnchor:m}),n?{height:Math.max(i-n.y,0),width:l}:{});if("bottom"===a)return mk(mk({},{x:o+l/2,y:i+c+u,textAnchor:"middle",verticalAnchor:h}),n?{height:Math.max(n.y+n.height-(i+c),0),width:l}:{});if("left"===a){var y={x:o-f,y:i+c/2,textAnchor:g,verticalAnchor:"middle"};return mk(mk({},y),n?{width:Math.max(y.x-n.x,0),height:c}:{})}if("right"===a){var b={x:o+l+f,y:i+c/2,textAnchor:x,verticalAnchor:"middle"};return mk(mk({},b),n?{width:Math.max(n.x+n.width-b.x,0),height:c}:{})}var v=n?{width:l,height:c}:{};return"insideLeft"===a?mk({x:o+f,y:i+c/2,textAnchor:x,verticalAnchor:"middle"},v):"insideRight"===a?mk({x:o+l-f,y:i+c/2,textAnchor:g,verticalAnchor:"middle"},v):"insideTop"===a?mk({x:o+l/2,y:i+u,textAnchor:"middle",verticalAnchor:h},v):"insideBottom"===a?mk({x:o+l/2,y:i+c-u,textAnchor:"middle",verticalAnchor:m},v):"insideTopLeft"===a?mk({x:o+f,y:i+u,textAnchor:x,verticalAnchor:h},v):"insideTopRight"===a?mk({x:o+l-f,y:i+u,textAnchor:g,verticalAnchor:h},v):"insideBottomLeft"===a?mk({x:o+f,y:i+c-u,textAnchor:x,verticalAnchor:m},v):"insideBottomRight"===a?mk({x:o+l-f,y:i+c-u,textAnchor:g,verticalAnchor:m},v):eu()(a)&&(zd(a.x)||Ud(a.x))&&(zd(a.y)||Ud(a.y))?mk({x:o+Hd(a.x,l),y:i+Hd(a.y,c),textAnchor:"end",verticalAnchor:"end"},v):mk({x:o+l/2,y:i+c/2,textAnchor:"middle",verticalAnchor:"middle"},v)}(r);return s.createElement(Xg,pk({className:Cd("recharts-label",u)},p,f,{breakAll:m}),t)}gk.displayName="Label";var xk=function(e){var t=e.cx,n=e.cy,r=e.angle,a=e.startAngle,s=e.endAngle,o=e.r,i=e.radius,l=e.innerRadius,c=e.outerRadius,d=e.x,u=e.y,m=e.top,h=e.left,p=e.width,f=e.height,g=e.clockWise,x=e.labelViewBox;if(x)return x;if(zd(p)&&zd(f)){if(zd(d)&&zd(u))return{x:d,y:u,width:p,height:f};if(zd(m)&&zd(h))return{x:m,y:h,width:p,height:f}}return zd(d)&&zd(u)?{x:d,y:u,width:0,height:0}:zd(t)&&zd(n)?{cx:t,cy:n,startAngle:a||r||0,endAngle:s||r||0,innerRadius:l||0,outerRadius:c||i||o||0,clockWise:g}:e.viewBox?e.viewBox:{}};gk.parseViewBox=xk,gk.renderCallByParent=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=xk(e),o=yu(r,gk).map(function(e,n){return(0,s.cloneElement)(e,{viewBox:t||a,key:"label-".concat(n)})});if(!n)return o;var i=function(e,t){return e?!0===e?s.createElement(gk,{key:"label-implicit",viewBox:t}):Vd(e)?s.createElement(gk,{key:"label-implicit",viewBox:t,value:e}):(0,s.isValidElement)(e)?e.type===gk?(0,s.cloneElement)(e,{key:"label-implicit",viewBox:t}):s.createElement(gk,{key:"label-implicit",content:e,viewBox:t}):Qd()(e)?s.createElement(gk,{key:"label-implicit",content:e,viewBox:t}):eu()(e)?s.createElement(gk,pk({viewBox:t},e,{key:"label-implicit"})):null:null}(e.label,t||a);return[i].concat(lk(o))};var yk=function(e,t){var n=e.alwaysShow,r=e.ifOverflow;return n&&(r="extendDomain"),r===t},bk=n(1733),vk=n.n(bk),wk=n(7002),jk=n.n(wk),Nk=function(e){return null};Nk.displayName="Cell";var kk=n(4065),Sk=n.n(kk);function Ck(e){return Ck="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ck(e)}var _k=["valueAccessor"],Ek=["data","dataKey","clockWise","id","textBreakAll"];function Pk(e){return function(e){if(Array.isArray(e))return Ok(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Ok(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ok(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ok(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ak(){return Ak=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ak.apply(this,arguments)}function Tk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Dk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tk(Object(n),!0).forEach(function(t){Mk(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Mk(e,t,n){return t=function(e){var t=function(e,t){if("object"!=Ck(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Ck(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ck(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ik(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Lk=function(e){return Array.isArray(e.value)?Sk()(e.value):e.value};function Rk(e){var t=e.valueAccessor,n=void 0===t?Lk:t,r=Ik(e,_k),a=r.data,o=r.dataKey,i=r.clockWise,l=r.id,c=r.textBreakAll,d=Ik(r,Ek);return a&&a.length?s.createElement(Gu,{className:"recharts-label-list"},a.map(function(e,t){var r=Fd()(o)?n(e,t):aN(e&&e.payload,o),a=Fd()(l)?{}:{id:"".concat(l,"-").concat(t)};return s.createElement(gk,Ak({},Nu(e,!0),d,a,{parentViewBox:e.parentViewBox,value:r,textBreakAll:c,viewBox:gk.parseViewBox(Fd()(i)?e:Dk(Dk({},e),{},{clockWise:i})),key:"label-".concat(t),index:t}))})):null}Rk.displayName="LabelList",Rk.renderCallByParent=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!e.children&&n&&!e.label)return null;var r=yu(e.children,Rk).map(function(e,n){return(0,s.cloneElement)(e,{data:t,key:"labelList-".concat(n)})});if(!n)return r;var a=function(e,t){return e?!0===e?s.createElement(Rk,{key:"labelList-implicit",data:t}):s.isValidElement(e)||Qd()(e)?s.createElement(Rk,{key:"labelList-implicit",data:t,content:e}):eu()(e)?s.createElement(Rk,Ak({data:t},e,{key:"labelList-implicit"})):null:null}(e.label,t);return[a].concat(Pk(r))};var Fk=n(2322),Bk=n.n(Fk),Uk=n(6361),zk=n.n(Uk);function Vk(e){return Vk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vk(e)}function Wk(){return Wk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Wk.apply(this,arguments)}function qk(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,i=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Hk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hk(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Yk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Gk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yk(Object(n),!0).forEach(function(t){Xk(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Xk(e,t,n){return t=function(e){var t=function(e,t){if("object"!=Vk(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Vk(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Vk(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $k=function(e,t,n,r,a){var s,o=n-r;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+n,",").concat(t),s+="L ".concat(e+n-o/2,",").concat(t+a),s+="L ".concat(e+n-o/2-r,",").concat(t+a),s+="L ".concat(e,",").concat(t," Z")},Kk={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Jk=function(e){var t=Gk(Gk({},Kk),e),n=(0,s.useRef)(),r=qk((0,s.useState)(-1),2),a=r[0],o=r[1];(0,s.useEffect)(function(){if(n.current&&n.current.getTotalLength)try{var e=n.current.getTotalLength();e&&o(e)}catch(BB){}},[]);var i=t.x,l=t.y,c=t.upperWidth,d=t.lowerWidth,u=t.height,m=t.className,h=t.animationEasing,p=t.animationDuration,f=t.animationBegin,g=t.isUpdateAnimationActive;if(i!==+i||l!==+l||c!==+c||d!==+d||u!==+u||0===c&&0===d||0===u)return null;var x=Cd("recharts-trapezoid",m);return g?s.createElement(Vf,{canBegin:a>0,from:{upperWidth:0,lowerWidth:0,height:u,x:i,y:l},to:{upperWidth:c,lowerWidth:d,height:u,x:i,y:l},duration:p,animationEasing:h,isActive:g},function(e){var r=e.upperWidth,o=e.lowerWidth,i=e.height,l=e.x,c=e.y;return s.createElement(Vf,{canBegin:a>0,from:"0px ".concat(-1===a?1:a,"px"),to:"".concat(a,"px 0px"),attributeName:"strokeDasharray",begin:f,duration:p,easing:h},s.createElement("path",Wk({},Nu(t,!0),{className:x,d:$k(l,c,r,o,i),ref:n})))}):s.createElement("g",null,s.createElement("path",Wk({},Nu(t,!0),{className:x,d:$k(i,l,c,d,u)})))};function Qk(e){return Qk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qk(e)}function Zk(){return Zk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zk.apply(this,arguments)}function eS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eS(Object(n),!0).forEach(function(t){nS(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function nS(e,t,n){return t=function(e){var t=function(e,t){if("object"!=Qk(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Qk(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qk(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rS=function(e){var t=e.cx,n=e.cy,r=e.radius,a=e.angle,s=e.sign,o=e.isExternal,i=e.cornerRadius,l=e.cornerIsExternal,c=i*(o?1:-1)+r,d=Math.asin(i/c)/QN,u=l?a:a+s*d,m=l?a-s*d:a;return{center:ek(t,n,c,u),circleTangency:ek(t,n,r,u),lineTangency:ek(t,n,c*Math.cos(d*QN),m),theta:d}},aS=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,s=e.startAngle,o=function(e,t){return Bd(t-e)*Math.min(Math.abs(t-e),359.999)}(s,e.endAngle),i=s+o,l=ek(t,n,a,s),c=ek(t,n,a,i),d="M ".concat(l.x,",").concat(l.y,"\n    A ").concat(a,",").concat(a,",0,\n    ").concat(+(Math.abs(o)>180),",").concat(+(s>i),",\n    ").concat(c.x,",").concat(c.y,"\n  ");if(r>0){var u=ek(t,n,r,s),m=ek(t,n,r,i);d+="L ".concat(m.x,",").concat(m.y,"\n            A ").concat(r,",").concat(r,",0,\n            ").concat(+(Math.abs(o)>180),",").concat(+(s<=i),",\n            ").concat(u.x,",").concat(u.y," Z")}else d+="L ".concat(t,",").concat(n," Z");return d},sS={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},oS=function(e){var t=tS(tS({},sS),e),n=t.cx,r=t.cy,a=t.innerRadius,o=t.outerRadius,i=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,d=t.startAngle,u=t.endAngle,m=t.className;if(o<a||d===u)return null;var h,p=Cd("recharts-sector",m),f=o-a,g=Hd(i,f,0,!0);return h=g>0&&Math.abs(d-u)<360?function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,s=e.cornerRadius,o=e.forceCornerRadius,i=e.cornerIsExternal,l=e.startAngle,c=e.endAngle,d=Bd(c-l),u=rS({cx:t,cy:n,radius:a,angle:l,sign:d,cornerRadius:s,cornerIsExternal:i}),m=u.circleTangency,h=u.lineTangency,p=u.theta,f=rS({cx:t,cy:n,radius:a,angle:c,sign:-d,cornerRadius:s,cornerIsExternal:i}),g=f.circleTangency,x=f.lineTangency,y=f.theta,b=i?Math.abs(l-c):Math.abs(l-c)-p-y;if(b<0)return o?"M ".concat(h.x,",").concat(h.y,"\n        a").concat(s,",").concat(s,",0,0,1,").concat(2*s,",0\n        a").concat(s,",").concat(s,",0,0,1,").concat(2*-s,",0\n      "):aS({cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:l,endAngle:c});var v="M ".concat(h.x,",").concat(h.y,"\n    A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(m.x,",").concat(m.y,"\n    A").concat(a,",").concat(a,",0,").concat(+(b>180),",").concat(+(d<0),",").concat(g.x,",").concat(g.y,"\n    A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(x.x,",").concat(x.y,"\n  ");if(r>0){var w=rS({cx:t,cy:n,radius:r,angle:l,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:i}),j=w.circleTangency,N=w.lineTangency,k=w.theta,S=rS({cx:t,cy:n,radius:r,angle:c,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:i}),C=S.circleTangency,_=S.lineTangency,E=S.theta,P=i?Math.abs(l-c):Math.abs(l-c)-k-E;if(P<0&&0===s)return"".concat(v,"L").concat(t,",").concat(n,"Z");v+="L".concat(_.x,",").concat(_.y,"\n      A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(C.x,",").concat(C.y,"\n      A").concat(r,",").concat(r,",0,").concat(+(P>180),",").concat(+(d>0),",").concat(j.x,",").concat(j.y,"\n      A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(N.x,",").concat(N.y,"Z")}else v+="L".concat(t,",").concat(n,"Z");return v}({cx:n,cy:r,innerRadius:a,outerRadius:o,cornerRadius:Math.min(g,f/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u}):aS({cx:n,cy:r,innerRadius:a,outerRadius:o,startAngle:d,endAngle:u}),s.createElement("path",Zk({},Nu(t,!0),{className:p,d:h,role:"img"}))},iS=["option","shapeType","propTransformer","activeClassName","isActive"];function lS(e){return lS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lS(e)}function cS(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function dS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function uS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dS(Object(n),!0).forEach(function(t){mS(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function mS(e,t,n){return t=function(e){var t=function(e,t){if("object"!=lS(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=lS(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==lS(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hS(e,t){return uS(uS({},t),e)}function pS(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return s.createElement(Zf,n);case"trapezoid":return s.createElement(Jk,n);case"sector":return s.createElement(oS,n);case"symbols":if(function(e){return"symbols"===e}(t))return s.createElement(Fh,n);break;default:return null}}function fS(e){var t,n=e.option,r=e.shapeType,a=e.propTransformer,o=void 0===a?hS:a,i=e.activeClassName,l=void 0===i?"recharts-active-shape":i,c=e.isActive,d=cS(e,iS);if((0,s.isValidElement)(n))t=(0,s.cloneElement)(n,uS(uS({},d),function(e){return(0,s.isValidElement)(e)?e.props:e}(n)));else if(Qd()(n))t=n(d);else if(Bk()(n)&&!zk()(n)){var u=o(n,d);t=s.createElement(pS,{shapeType:r,elementProps:u})}else{var m=d;t=s.createElement(pS,{shapeType:r,elementProps:m})}return c?s.createElement(Gu,{className:l},t):t}function gS(e,t){return null!=t&&"trapezoids"in e.props}function xS(e,t){return null!=t&&"sectors"in e.props}function yS(e,t){return null!=t&&"points"in e.props}function bS(e,t){var n,r,a=e.x===(null===t||void 0===t||null===(n=t.labelViewBox)||void 0===n?void 0:n.x)||e.x===t.x,s=e.y===(null===t||void 0===t||null===(r=t.labelViewBox)||void 0===r?void 0:r.y)||e.y===t.y;return a&&s}function vS(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function wS(e,t){var n=e.x===t.x,r=e.y===t.y,a=e.z===t.z;return n&&r&&a}function jS(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,a=function(e,t){var n;return gS(e,t)?n="trapezoids":xS(e,t)?n="sectors":yS(e,t)&&(n="points"),n}(n,t),s=function(e,t){var n,r;return gS(e,t)?null===(n=t.tooltipPayload)||void 0===n||null===(n=n[0])||void 0===n||null===(n=n.payload)||void 0===n?void 0:n.payload:xS(e,t)?null===(r=t.tooltipPayload)||void 0===r||null===(r=r[0])||void 0===r||null===(r=r.payload)||void 0===r?void 0:r.payload:yS(e,t)?t.payload:{}}(n,t),o=r.filter(function(e,r){var o=rj()(s,e),i=n.props[a].filter(function(e){var r=function(e,t){var n;return gS(e,t)?n=bS:xS(e,t)?n=vS:yS(e,t)&&(n=wS),n}(n,t);return r(e,t)}),l=n.props[a].indexOf(i[i.length-1]);return o&&r===l});return r.indexOf(o[o.length-1])}var NS=["x","y"];function kS(e){return kS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kS(e)}function SS(){return SS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},SS.apply(this,arguments)}function CS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?CS(Object(n),!0).forEach(function(t){ES(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ES(e,t,n){return t=function(e){var t=function(e,t){if("object"!=kS(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=kS(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==kS(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PS(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function OS(e,t){var n=e.x,r=e.y,a=PS(e,NS),s="".concat(n),o=parseInt(s,10),i="".concat(r),l=parseInt(i,10),c="".concat(t.height||a.height),d=parseInt(c,10),u="".concat(t.width||a.width),m=parseInt(u,10);return _S(_S(_S(_S(_S({},t),a),o?{x:o}:{}),l?{y:l}:{}),{},{height:d,width:m,name:t.name,radius:t.radius})}function AS(e){return s.createElement(fS,SS({shapeType:"rectangle",propTransformer:OS,activeClassName:"recharts-active-bar"},e))}var TS,DS=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(n,r){if("number"===typeof e)return e;var a=zd(n)||function(e){return Fd()(e)}(n);return a?e(n,r):(a||Bu(!1),t)}},MS=["value","background"];function IS(e){return IS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},IS(e)}function LS(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function RS(){return RS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},RS.apply(this,arguments)}function FS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function BS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?FS(Object(n),!0).forEach(function(t){HS(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function US(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,YS(r.key),r)}}function zS(e,t,n){return t=WS(t),function(e,t){if(t&&("object"===IS(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,VS()?Reflect.construct(t,n||[],WS(e).constructor):t.apply(e,n))}function VS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(VS=function(){return!!e})()}function WS(e){return WS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},WS(e)}function qS(e,t){return qS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qS(e,t)}function HS(e,t,n){return(t=YS(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YS(e){var t=function(e,t){if("object"!=IS(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=IS(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==IS(t)?t:t+""}var GS=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return HS(e=zS(this,t,[].concat(r)),"state",{isAnimationFinished:!1}),HS(e,"id",qd("recharts-bar-")),HS(e,"handleAnimationEnd",function(){var t=e.props.onAnimationEnd;e.setState({isAnimationFinished:!0}),t&&t()}),HS(e,"handleAnimationStart",function(){var t=e.props.onAnimationStart;e.setState({isAnimationFinished:!1}),t&&t()}),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qS(e,t)}(t,e),n=t,r=[{key:"renderRectanglesStatically",value:function(e){var t=this,n=this.props,r=n.shape,a=n.dataKey,o=n.activeIndex,i=n.activeBar,l=Nu(this.props,!1);return e&&e.map(function(e,n){var c=n===o,d=c?i:r,u=BS(BS(BS({},l),e),{},{isActive:c,option:d,index:n,dataKey:a,onAnimationStart:t.handleAnimationStart,onAnimationEnd:t.handleAnimationEnd});return s.createElement(Gu,RS({className:"recharts-bar-rectangle"},cu(t.props,e,n),{key:"rectangle-".concat(null===e||void 0===e?void 0:e.x,"-").concat(null===e||void 0===e?void 0:e.y,"-").concat(null===e||void 0===e?void 0:e.value,"-").concat(n)}),s.createElement(AS,u))})}},{key:"renderRectanglesWithAnimation",value:function(){var e=this,t=this.props,n=t.data,r=t.layout,a=t.isAnimationActive,o=t.animationBegin,i=t.animationDuration,l=t.animationEasing,c=t.animationId,d=this.state.prevData;return s.createElement(Vf,{begin:o,duration:i,isActive:a,easing:l,from:{t:0},to:{t:1},key:"bar-".concat(c),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(t){var a=t.t,o=n.map(function(e,t){var n=d&&d[t];if(n){var s=Gd(n.x,e.x),o=Gd(n.y,e.y),i=Gd(n.width,e.width),l=Gd(n.height,e.height);return BS(BS({},e),{},{x:s(a),y:o(a),width:i(a),height:l(a)})}if("horizontal"===r){var c=Gd(0,e.height)(a);return BS(BS({},e),{},{y:e.y+e.height-c,height:c})}var u=Gd(0,e.width)(a);return BS(BS({},e),{},{width:u})});return s.createElement(Gu,null,e.renderRectanglesStatically(o))})}},{key:"renderRectangles",value:function(){var e=this.props,t=e.data,n=e.isAnimationActive,r=this.state.prevData;return!(n&&t&&t.length)||r&&rj()(r,t)?this.renderRectanglesStatically(t):this.renderRectanglesWithAnimation()}},{key:"renderBackground",value:function(){var e=this,t=this.props,n=t.data,r=t.dataKey,a=t.activeIndex,o=Nu(this.props.background,!1);return n.map(function(t,n){t.value;var i=t.background,l=LS(t,MS);if(!i)return null;var c=BS(BS(BS(BS(BS({},l),{},{fill:"#eee"},i),o),cu(e.props,t,n)),{},{onAnimationStart:e.handleAnimationStart,onAnimationEnd:e.handleAnimationEnd,dataKey:r,index:n,className:"recharts-bar-background-rectangle"});return s.createElement(AS,RS({key:"background-bar-".concat(n),option:e.props.background,isActive:n===a},c))})}},{key:"renderErrorBar",value:function(e,t){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var n=this.props,r=n.data,a=n.xAxis,o=n.yAxis,i=n.layout,l=yu(n.children,Yj);if(!l)return null;var c="vertical"===i?r[0].height/2:r[0].width/2,d=function(e,t){var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:aN(e,t)}},u={clipPath:e?"url(#clipPath-".concat(t,")"):null};return s.createElement(Gu,u,l.map(function(e){return s.cloneElement(e,{key:"error-bar-".concat(t,"-").concat(e.props.dataKey),data:r,xAxis:a,yAxis:o,layout:i,offset:c,dataPointFormatter:d})}))}},{key:"render",value:function(){var e=this.props,t=e.hide,n=e.data,r=e.className,a=e.xAxis,o=e.yAxis,i=e.left,l=e.top,c=e.width,d=e.height,u=e.isAnimationActive,m=e.background,h=e.id;if(t||!n||!n.length)return null;var p=this.state.isAnimationFinished,f=Cd("recharts-bar",r),g=a&&a.allowDataOverflow,x=o&&o.allowDataOverflow,y=g||x,b=Fd()(h)?this.id:h;return s.createElement(Gu,{className:f},g||x?s.createElement("defs",null,s.createElement("clipPath",{id:"clipPath-".concat(b)},s.createElement("rect",{x:g?i:i-c/2,y:x?l:l-d/2,width:g?c:2*c,height:x?d:2*d}))):null,s.createElement(Gu,{className:"recharts-bar-rectangles",clipPath:y?"url(#clipPath-".concat(b,")"):null},m?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(y,b),(!u||p)&&Rk.renderCallByParent(this.props,n))}}],a=[{key:"getDerivedStateFromProps",value:function(e,t){return e.animationId!==t.prevAnimationId?{prevAnimationId:e.animationId,curData:e.data,prevData:t.curData}:e.data!==t.curData?{curData:e.data}:null}}],r&&US(n.prototype,r),a&&US(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.PureComponent);function XS(e){return XS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},XS(e)}function $S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ZS(r.key),r)}}function KS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function JS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?KS(Object(n),!0).forEach(function(t){QS(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function QS(e,t,n){return(t=ZS(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ZS(e){var t=function(e,t){if("object"!=XS(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=XS(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==XS(t)?t:t+""}TS=GS,HS(GS,"displayName","Bar"),HS(GS,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!vm.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"}),HS(GS,"getComposedData",function(e){var t=e.props,n=e.item,r=e.barPosition,a=e.bandSize,s=e.xAxis,o=e.yAxis,i=e.xAxisTicks,l=e.yAxisTicks,c=e.stackedData,d=e.dataStartIndex,u=e.displayedData,m=e.offset,h=function(e,t){if(!e)return null;for(var n=0,r=e.length;n<r;n++)if(e[n].item===t)return e[n].position;return null}(r,n);if(!h)return null;var p=t.layout,f=n.type.defaultProps,g=void 0!==f?BS(BS({},f),n.props):n.props,x=g.dataKey,y=g.children,b=g.minPointSize,v="horizontal"===p?o:s,w=c?v.scale.domain():null,j=function(e){var t=e.numericAxis,n=t.scale.domain();if("number"===t.type){var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return r<=0&&a>=0?0:a<0?a:r}return n[0]}({numericAxis:v}),N=yu(y,Nk),k=u.map(function(e,t){var r,u,m,f,g,y;c?r=function(e,t){if(!t||2!==t.length||!zd(t[0])||!zd(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!zd(e[0])||e[0]<n)&&(a[0]=n),(!zd(e[1])||e[1]>r)&&(a[1]=r),a[0]>r&&(a[0]=r),a[1]<n&&(a[1]=n),a}(c[d+t],w):(r=aN(e,x),Array.isArray(r)||(r=[j,r]));var v=DS(b,TS.defaultProps.minPointSize)(r[1],t);if("horizontal"===p){var k,S=[o.scale(r[0]),o.scale(r[1])],C=S[0],_=S[1];u=vN({axis:s,ticks:i,bandSize:a,offset:h.offset,entry:e,index:t}),m=null!==(k=null!==_&&void 0!==_?_:C)&&void 0!==k?k:void 0,f=h.size;var E=C-_;if(g=Number.isNaN(E)?0:E,y={x:u,y:o.y,width:f,height:o.height},Math.abs(v)>0&&Math.abs(g)<Math.abs(v)){var P=Bd(g||v)*(Math.abs(v)-Math.abs(g));m-=P,g+=P}}else{var O=[s.scale(r[0]),s.scale(r[1])],A=O[0],T=O[1];if(u=A,m=vN({axis:o,ticks:l,bandSize:a,offset:h.offset,entry:e,index:t}),f=T-A,g=h.size,y={x:s.x,y:m,width:s.width,height:g},Math.abs(v)>0&&Math.abs(f)<Math.abs(v))f+=Bd(f||v)*(Math.abs(v)-Math.abs(f))}return BS(BS(BS({},e),{},{x:u,y:m,width:f,height:g,value:c?r:r[1],payload:e,background:y},N&&N[t]&&N[t].props),{},{tooltipPayload:[_N(n,e)],tooltipPosition:{x:u+f/2,y:m+g/2}})});return BS({data:k,layout:p},m)});var eC=function(e,t){var n=e.x,r=e.y,a=t.x,s=t.y;return{x:Math.min(n,a),y:Math.min(r,s),width:Math.abs(a-n),height:Math.abs(s-r)}},tC=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scale=t}return t=e,n=[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.bandAware,r=t.position;if(void 0!==e){if(r)switch(r){case"start":default:return this.scale(e);case"middle":var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+a;case"end":var s=this.bandwidth?this.bandwidth():0;return this.scale(e)+s}if(n){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+o}return this.scale(e)}}},{key:"isInRange",value:function(e){var t=this.range(),n=t[0],r=t[t.length-1];return n<=r?e>=n&&e<=r:e>=r&&e<=n}}],r=[{key:"create",value:function(t){return new e(t)}}],n&&$S(t.prototype,n),r&&$S(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}();QS(tC,"EPS",1e-4);var nC=function(e){var t=Object.keys(e).reduce(function(t,n){return JS(JS({},t),{},QS({},n,tC.create(e[n])))},{});return JS(JS({},t),{},{apply:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.bandAware,a=n.position;return vk()(e,function(e,n){return t[n].apply(e,{bandAware:r,position:a})})},isInRange:function(e){return jk()(e,function(e,n){return t[n].isInRange(e)})}})};function rC(){return rC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rC.apply(this,arguments)}function aC(e){return aC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aC(e)}function sC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function oC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sC(Object(n),!0).forEach(function(t){mC(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sC(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function iC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,hC(r.key),r)}}function lC(e,t,n){return t=dC(t),function(e,t){if(t&&("object"===aC(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,cC()?Reflect.construct(t,n||[],dC(e).constructor):t.apply(e,n))}function cC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(cC=function(){return!!e})()}function dC(e){return dC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dC(e)}function uC(e,t){return uC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},uC(e,t)}function mC(e,t,n){return(t=hC(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hC(e){var t=function(e,t){if("object"!=aC(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=aC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==aC(t)?t:t+""}var pC=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),lC(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uC(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props,n=e.x,r=e.y,a=e.r,o=e.alwaysShow,i=e.clipPathId,l=Vd(n),c=Vd(r);if(Kd(void 0===o,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!l||!c)return null;var d=function(e){var t=e.x,n=e.y,r=e.xAxis,a=e.yAxis,s=nC({x:r.scale,y:a.scale}),o=s.apply({x:t,y:n},{bandAware:!0});return yk(e,"discard")&&!s.isInRange(o)?null:o}(this.props);if(!d)return null;var u=d.x,m=d.y,h=this.props,p=h.shape,f=h.className,g=oC(oC({clipPath:yk(this.props,"hidden")?"url(#".concat(i,")"):void 0},Nu(this.props,!0)),{},{cx:u,cy:m});return s.createElement(Gu,{className:Cd("recharts-reference-dot",f)},t.renderDot(p,g),gk.renderCallByParent(this.props,{x:u-a,y:m-a,width:2*a,height:2*a}))}}],r&&iC(n.prototype,r),a&&iC(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.Component);mC(pC,"displayName","ReferenceDot"),mC(pC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1}),mC(pC,"renderDot",function(e,t){return s.isValidElement(e)?s.cloneElement(e,t):Qd()(e)?e(t):s.createElement(mp,rC({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"}))});var fC=n(4597),gC=n.n(fC),xC=n(8990),yC=n.n(xC),bC=n(5797),vC=n.n(bC)()(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")});var wC=(0,s.createContext)(void 0),jC=(0,s.createContext)(void 0),NC=(0,s.createContext)(void 0),kC=(0,s.createContext)({}),SC=(0,s.createContext)(void 0),CC=(0,s.createContext)(0),_C=(0,s.createContext)(0),EC=function(e){var t=e.state,n=t.xAxisMap,r=t.yAxisMap,a=t.offset,o=e.clipPathId,i=e.children,l=e.width,c=e.height,d=vC(a);return s.createElement(wC.Provider,{value:n},s.createElement(jC.Provider,{value:r},s.createElement(kC.Provider,{value:a},s.createElement(NC.Provider,{value:d},s.createElement(SC.Provider,{value:o},s.createElement(CC.Provider,{value:c},s.createElement(_C.Provider,{value:l},i)))))))};var PC=function(e){var t=(0,s.useContext)(wC);null==t&&Bu(!1);var n=t[e];return null==n&&Bu(!1),n},OC=function(e){var t=(0,s.useContext)(jC);null==t&&Bu(!1);var n=t[e];return null==n&&Bu(!1),n},AC=function(){return(0,s.useContext)(_C)},TC=function(){return(0,s.useContext)(CC)};function DC(e){return DC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DC(e)}function MC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,VC(r.key),r)}}function IC(e,t,n){return t=RC(t),function(e,t){if(t&&("object"===DC(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,LC()?Reflect.construct(t,n||[],RC(e).constructor):t.apply(e,n))}function LC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(LC=function(){return!!e})()}function RC(e){return RC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},RC(e)}function FC(e,t){return FC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},FC(e,t)}function BC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function UC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?BC(Object(n),!0).forEach(function(t){zC(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BC(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function zC(e,t,n){return(t=VC(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VC(e){var t=function(e,t){if("object"!=DC(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=DC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==DC(t)?t:t+""}function WC(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,i=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return qC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qC(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function HC(){return HC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},HC.apply(this,arguments)}function YC(e){var t=e.x,n=e.y,r=e.segment,a=e.xAxisId,o=e.yAxisId,i=e.shape,l=e.className,c=e.alwaysShow,d=(0,s.useContext)(SC),u=PC(a),m=OC(o),h=(0,s.useContext)(NC);if(!d||!h)return null;Kd(void 0===c,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=function(e,t,n,r,a,s,o,i,l){var c=a.x,d=a.y,u=a.width,m=a.height;if(n){var h=l.y,p=e.y.apply(h,{position:s});if(yk(l,"discard")&&!e.y.isInRange(p))return null;var f=[{x:c+u,y:p},{x:c,y:p}];return"left"===i?f.reverse():f}if(t){var g=l.x,x=e.x.apply(g,{position:s});if(yk(l,"discard")&&!e.x.isInRange(x))return null;var y=[{x:x,y:d+m},{x:x,y:d}];return"top"===o?y.reverse():y}if(r){var b=l.segment.map(function(t){return e.apply(t,{position:s})});return yk(l,"discard")&&gC()(b,function(t){return!e.isInRange(t)})?null:b}return null}(nC({x:u.scale,y:m.scale}),Vd(t),Vd(n),r&&2===r.length,h,e.position,u.orientation,m.orientation,e);if(!p)return null;var f=WC(p,2),g=f[0],x=g.x,y=g.y,b=f[1],v=b.x,w=b.y,j=UC(UC({clipPath:yk(e,"hidden")?"url(#".concat(d,")"):void 0},Nu(e,!0)),{},{x1:x,y1:y,x2:v,y2:w});return s.createElement(Gu,{className:Cd("recharts-reference-line",l)},function(e,t){return s.isValidElement(e)?s.cloneElement(e,t):Qd()(e)?e(t):s.createElement("line",HC({},t,{className:"recharts-reference-line-line"}))}(i,j),gk.renderCallByParent(e,function(e){var t=e.x1,n=e.y1,r=e.x2,a=e.y2;return eC({x:t,y:n},{x:r,y:a})}({x1:x,y1:y,x2:v,y2:w})))}var GC=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),IC(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FC(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){return s.createElement(YC,this.props)}}])&&MC(n.prototype,r),a&&MC(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.Component);function XC(){return XC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},XC.apply(this,arguments)}function $C(e){return $C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$C(e)}function KC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function JC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?KC(Object(n),!0).forEach(function(t){r_(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KC(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function QC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a_(r.key),r)}}function ZC(e,t,n){return t=t_(t),function(e,t){if(t&&("object"===$C(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,e_()?Reflect.construct(t,n||[],t_(e).constructor):t.apply(e,n))}function e_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(e_=function(){return!!e})()}function t_(e){return t_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},t_(e)}function n_(e,t){return n_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n_(e,t)}function r_(e,t,n){return(t=a_(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a_(e){var t=function(e,t){if("object"!=$C(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=$C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$C(t)?t:t+""}zC(GC,"displayName","ReferenceLine"),zC(GC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});var s_=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ZC(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n_(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this.props,n=e.x1,r=e.x2,a=e.y1,o=e.y2,i=e.className,l=e.alwaysShow,c=e.clipPathId;Kd(void 0===l,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var d=Vd(n),u=Vd(r),m=Vd(a),h=Vd(o),p=this.props.shape;if(!d&&!u&&!m&&!h&&!p)return null;var f=function(e,t,n,r,a){var s=a.x1,o=a.x2,i=a.y1,l=a.y2,c=a.xAxis,d=a.yAxis;if(!c||!d)return null;var u=nC({x:c.scale,y:d.scale}),m={x:e?u.x.apply(s,{position:"start"}):u.x.rangeMin,y:n?u.y.apply(i,{position:"start"}):u.y.rangeMin},h={x:t?u.x.apply(o,{position:"end"}):u.x.rangeMax,y:r?u.y.apply(l,{position:"end"}):u.y.rangeMax};return!yk(a,"discard")||u.isInRange(m)&&u.isInRange(h)?eC(m,h):null}(d,u,m,h,this.props);if(!f&&!p)return null;var g=yk(this.props,"hidden")?"url(#".concat(c,")"):void 0;return s.createElement(Gu,{className:Cd("recharts-reference-area",i)},t.renderRect(p,JC(JC({clipPath:g},Nu(this.props,!0)),f)),gk.renderCallByParent(this.props,f))}}])&&QC(n.prototype,r),a&&QC(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.Component);function o_(e){return function(e){if(Array.isArray(e))return i_(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return i_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i_(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}r_(s_,"displayName","ReferenceArea"),r_(s_,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1}),r_(s_,"renderRect",function(e,t){return s.isValidElement(e)?s.cloneElement(e,t):Qd()(e)?e(t):s.createElement(Zf,XC({},t,{className:"recharts-reference-area-rect"}))});var l_=function(e,t,n,r,a){var s=yu(e,GC),o=yu(e,pC),i=[].concat(o_(s),o_(o)),l=yu(e,s_),c="".concat(r,"Id"),d=r[0],u=t;if(i.length&&(u=i.reduce(function(e,t){if(t.props[c]===n&&yk(t.props,"extendDomain")&&zd(t.props[d])){var r=t.props[d];return[Math.min(e[0],r),Math.max(e[1],r)]}return e},u)),l.length){var m="".concat(d,"1"),h="".concat(d,"2");u=l.reduce(function(e,t){if(t.props[c]===n&&yk(t.props,"extendDomain")&&zd(t.props[m])&&zd(t.props[h])){var r=t.props[m],a=t.props[h];return[Math.min(e[0],r,a),Math.max(e[1],r,a)]}return e},u)}return a&&a.length&&(u=a.reduce(function(e,t){return zd(t)?[Math.min(e[0],t),Math.max(e[1],t)]:e},u)),u},c_=n(7283),d_=new(n.n(c_)()),u_="recharts.syncMouseEvents";function m_(e){return m_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m_(e)}function h_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f_(r.key),r)}}function p_(e,t,n){return(t=f_(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f_(e){var t=function(e,t){if("object"!=m_(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=m_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==m_(t)?t:t+""}var g_=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),p_(this,"activeIndex",0),p_(this,"coordinateList",[]),p_(this,"layout","horizontal")},t=[{key:"setDetails",value:function(e){var t,n=e.coordinateList,r=void 0===n?null:n,a=e.container,s=void 0===a?null:a,o=e.layout,i=void 0===o?null:o,l=e.offset,c=void 0===l?null:l,d=e.mouseHandlerCallback,u=void 0===d?null:d;this.coordinateList=null!==(t=null!==r&&void 0!==r?r:this.coordinateList)&&void 0!==t?t:[],this.container=null!==s&&void 0!==s?s:this.container,this.layout=null!==i&&void 0!==i?i:this.layout,this.offset=null!==c&&void 0!==c?c:this.offset,this.mouseHandlerCallback=null!==u&&void 0!==u?u:this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(e){if(0!==this.coordinateList.length)switch(e.key){case"ArrowRight":if("horizontal"!==this.layout)return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break;case"ArrowLeft":if("horizontal"!==this.layout)return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse()}}},{key:"setIndex",value:function(e){this.activeIndex=e}},{key:"spoofMouse",value:function(){var e,t;if("horizontal"===this.layout&&0!==this.coordinateList.length){var n=this.container.getBoundingClientRect(),r=n.x,a=n.y,s=n.height,o=this.coordinateList[this.activeIndex].coordinate,i=(null===(e=window)||void 0===e?void 0:e.scrollX)||0,l=(null===(t=window)||void 0===t?void 0:t.scrollY)||0,c=r+o+i,d=a+this.offset.top+s/2+l;this.mouseHandlerCallback({pageX:c,pageY:d})}}}],t&&h_(e.prototype,t),n&&h_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function x_(){}function y_(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function b_(e){this._context=e}function v_(e){this._context=e}function w_(e){this._context=e}b_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:y_(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:y_(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},v_.prototype={areaStart:x_,areaEnd:x_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:y_(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},w_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:y_(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};class j_{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}function N_(e){this._context=e}function k_(e){this._context=e}function S_(e){return new k_(e)}function C_(e){return e<0?-1:1}function __(e,t,n){var r=e._x1-e._x0,a=t-e._x1,s=(e._y1-e._y0)/(r||a<0&&-0),o=(n-e._y1)/(a||r<0&&-0),i=(s*a+o*r)/(r+a);return(C_(s)+C_(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(i))||0}function E_(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function P_(e,t,n){var r=e._x0,a=e._y0,s=e._x1,o=e._y1,i=(s-r)/3;e._context.bezierCurveTo(r+i,a+i*t,s-i,o-i*n,s,o)}function O_(e){this._context=e}function A_(e){this._context=new T_(e)}function T_(e){this._context=e}function D_(e){this._context=e}function M_(e){var t,n,r=e.length-1,a=new Array(r),s=new Array(r),o=new Array(r);for(a[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,s[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/s[t-1],s[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/s[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/s[t];for(s[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-a[t+1];return[a,s]}function I_(e,t){this._context=e,this._t=t}function L_(e){return e[0]}function R_(e){return e[1]}function F_(e,t){var n=oh(!0),r=null,a=S_,s=null,o=Eh(i);function i(i){var l,c,d,u=(i=Yw(i)).length,m=!1;for(null==r&&(s=a(d=o())),l=0;l<=u;++l)!(l<u&&n(c=i[l],l,i))===m&&((m=!m)?s.lineStart():s.lineEnd()),m&&s.point(+e(c,l,i),+t(c,l,i));if(d)return s=null,d+""||null}return e="function"===typeof e?e:void 0===e?L_:oh(e),t="function"===typeof t?t:void 0===t?R_:oh(t),i.x=function(t){return arguments.length?(e="function"===typeof t?t:oh(+t),i):e},i.y=function(e){return arguments.length?(t="function"===typeof e?e:oh(+e),i):t},i.defined=function(e){return arguments.length?(n="function"===typeof e?e:oh(!!e),i):n},i.curve=function(e){return arguments.length?(a=e,null!=r&&(s=a(r)),i):a},i.context=function(e){return arguments.length?(null==e?r=s=null:s=a(r=e),i):r},i}function B_(e,t,n){var r=null,a=oh(!0),s=null,o=S_,i=null,l=Eh(c);function c(c){var d,u,m,h,p,f=(c=Yw(c)).length,g=!1,x=new Array(f),y=new Array(f);for(null==s&&(i=o(p=l())),d=0;d<=f;++d){if(!(d<f&&a(h=c[d],d,c))===g)if(g=!g)u=d,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),m=d-1;m>=u;--m)i.point(x[m],y[m]);i.lineEnd(),i.areaEnd()}g&&(x[d]=+e(h,d,c),y[d]=+t(h,d,c),i.point(r?+r(h,d,c):x[d],n?+n(h,d,c):y[d]))}if(p)return i=null,p+""||null}function d(){return F_().defined(a).curve(o).context(s)}return e="function"===typeof e?e:void 0===e?L_:oh(+e),t="function"===typeof t?t:oh(void 0===t?0:+t),n="function"===typeof n?n:void 0===n?R_:oh(+n),c.x=function(t){return arguments.length?(e="function"===typeof t?t:oh(+t),r=null,c):e},c.x0=function(t){return arguments.length?(e="function"===typeof t?t:oh(+t),c):e},c.x1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:oh(+e),c):r},c.y=function(e){return arguments.length?(t="function"===typeof e?e:oh(+e),n=null,c):t},c.y0=function(e){return arguments.length?(t="function"===typeof e?e:oh(+e),c):t},c.y1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:oh(+e),c):n},c.lineX0=c.lineY0=function(){return d().x(e).y(t)},c.lineY1=function(){return d().x(e).y(n)},c.lineX1=function(){return d().x(r).y(t)},c.defined=function(e){return arguments.length?(a="function"===typeof e?e:oh(!!e),c):a},c.curve=function(e){return arguments.length?(o=e,null!=s&&(i=o(s)),c):o},c.context=function(e){return arguments.length?(null==e?s=i=null:i=o(s=e),c):s},c}function U_(e){return U_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U_(e)}function z_(){return z_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},z_.apply(this,arguments)}function V_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function W_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V_(Object(n),!0).forEach(function(t){q_(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function q_(e,t,n){return t=function(e){var t=function(e,t){if("object"!=U_(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=U_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==U_(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}N_.prototype={areaStart:x_,areaEnd:x_,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},k_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},O_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:P_(this,this._t0,E_(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,P_(this,E_(this,n=__(this,e,t)),n);break;default:P_(this,this._t0,n=__(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(A_.prototype=Object.create(O_.prototype)).point=function(e,t){O_.prototype.point.call(this,t,e)},T_.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,s){this._context.bezierCurveTo(t,e,r,n,s,a)}},D_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=M_(e),a=M_(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(r[0][s],a[0][s],r[1][s],a[1][s],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},I_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var H_={curveBasisClosed:function(e){return new v_(e)},curveBasisOpen:function(e){return new w_(e)},curveBasis:function(e){return new b_(e)},curveBumpX:function(e){return new j_(e,!0)},curveBumpY:function(e){return new j_(e,!1)},curveLinearClosed:function(e){return new N_(e)},curveLinear:S_,curveMonotoneX:function(e){return new O_(e)},curveMonotoneY:function(e){return new A_(e)},curveNatural:function(e){return new D_(e)},curveStep:function(e){return new I_(e,.5)},curveStepAfter:function(e){return new I_(e,1)},curveStepBefore:function(e){return new I_(e,0)}},Y_=function(e){return e.x===+e.x&&e.y===+e.y},G_=function(e){return e.x},X_=function(e){return e.y},$_=function(e){var t,n=e.type,r=void 0===n?"linear":n,a=e.points,s=void 0===a?[]:a,o=e.baseLine,i=e.layout,l=e.connectNulls,c=void 0!==l&&l,d=function(e,t){if(Qd()(e))return e;var n="curve".concat(Rm()(e));return"curveMonotone"!==n&&"curveBump"!==n||!t?H_[n]||S_:H_["".concat(n).concat("vertical"===t?"Y":"X")]}(r,i),u=c?s.filter(function(e){return Y_(e)}):s;if(Array.isArray(o)){var m=c?o.filter(function(e){return Y_(e)}):o,h=u.map(function(e,t){return W_(W_({},e),{},{base:m[t]})});return(t="vertical"===i?B_().y(X_).x1(G_).x0(function(e){return e.base.x}):B_().x(G_).y1(X_).y0(function(e){return e.base.y})).defined(Y_).curve(d),t(h)}return(t="vertical"===i&&zd(o)?B_().y(X_).x1(G_).x0(o):zd(o)?B_().x(G_).y1(X_).y0(o):F_().x(G_).y(X_)).defined(Y_).curve(d),t(u)},K_=function(e){var t=e.className,n=e.points,r=e.path,a=e.pathRef;if((!n||!n.length)&&!r)return null;var o=n&&n.length?$_(e):r;return s.createElement("path",z_({},Nu(e,!1),lu(e),{className:Cd("recharts-curve",t),d:o,ref:a}))};function J_(e){return J_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J_(e)}var Q_=["x","y","top","left","width","height","className"];function Z_(){return Z_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Z_.apply(this,arguments)}function eE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tE(e,t,n){return t=function(e){var t=function(e,t){if("object"!=J_(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=J_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==J_(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nE(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var rE=function(e,t,n,r,a,s){return"M".concat(e,",").concat(a,"v").concat(r,"M").concat(s,",").concat(t,"h").concat(n)},aE=function(e){var t=e.x,n=void 0===t?0:t,r=e.y,a=void 0===r?0:r,o=e.top,i=void 0===o?0:o,l=e.left,c=void 0===l?0:l,d=e.width,u=void 0===d?0:d,m=e.height,h=void 0===m?0:m,p=e.className,f=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eE(Object(n),!0).forEach(function(t){tE(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({x:n,y:a,top:i,left:c,width:u,height:h},nE(e,Q_));return zd(n)&&zd(a)&&zd(u)&&zd(h)&&zd(i)&&zd(c)?s.createElement("path",Z_({},Nu(f,!0),{className:Cd("recharts-cross",p),d:rE(n,a,u,h,i,c)})):null};function sE(e){var t=e.cx,n=e.cy,r=e.radius,a=e.startAngle,s=e.endAngle;return{points:[ek(t,n,r,a),ek(t,n,r,s)],cx:t,cy:n,radius:r,startAngle:a,endAngle:s}}function oE(e,t,n){var r,a,s,o;if("horizontal"===e)s=r=t.x,a=n.top,o=n.top+n.height;else if("vertical"===e)o=a=t.y,r=n.left,s=n.left+n.width;else if(null!=t.cx&&null!=t.cy){if("centric"!==e)return sE(t);var i=t.cx,l=t.cy,c=t.innerRadius,d=t.outerRadius,u=t.angle,m=ek(i,l,c,u),h=ek(i,l,d,u);r=m.x,a=m.y,s=h.x,o=h.y}return[{x:r,y:a},{x:s,y:o}]}function iE(e){return iE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iE(e)}function lE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function cE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lE(Object(n),!0).forEach(function(t){dE(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function dE(e,t,n){return t=function(e){var t=function(e,t){if("object"!=iE(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=iE(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==iE(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uE(e){var t,n,r,a=e.element,o=e.tooltipEventType,i=e.isActive,l=e.activeCoordinate,c=e.activePayload,d=e.offset,u=e.activeTooltipIndex,m=e.tooltipAxisBandSize,h=e.layout,p=e.chartName,f=null!==(t=a.props.cursor)&&void 0!==t?t:null===(n=a.type.defaultProps)||void 0===n?void 0:n.cursor;if(!a||!f||!i||!l||"ScatterChart"!==p&&"axis"!==o)return null;var g=K_;if("ScatterChart"===p)r=l,g=aE;else if("BarChart"===p)r=function(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:"horizontal"===e?t.x-a:n.left+.5,y:"horizontal"===e?n.top+.5:t.y-a,width:"horizontal"===e?r:n.width-1,height:"horizontal"===e?n.height-1:r}}(h,l,d,m),g=Zf;else if("radial"===h){var x=sE(l),y=x.cx,b=x.cy,v=x.radius;r={cx:y,cy:b,startAngle:x.startAngle,endAngle:x.endAngle,innerRadius:v,outerRadius:v},g=oS}else r={points:oE(h,l,d)},g=K_;var w=cE(cE(cE(cE({stroke:"#ccc",pointerEvents:"none"},d),r),Nu(f,!1)),{},{payload:c,payloadIndex:u,className:Cd("recharts-tooltip-cursor",f.className)});return(0,s.isValidElement)(f)?(0,s.cloneElement)(f,w):(0,s.createElement)(g,w)}var mE=["item"],hE=["children","className","width","height","style","compact","title","desc"];function pE(e){return pE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pE(e)}function fE(){return fE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fE.apply(this,arguments)}function gE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,i=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||kE(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xE(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function yE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,PE(r.key),r)}}function bE(e,t,n){return t=wE(t),function(e,t){if(t&&("object"===pE(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,vE()?Reflect.construct(t,n||[],wE(e).constructor):t.apply(e,n))}function vE(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(vE=function(){return!!e})()}function wE(e){return wE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wE(e)}function jE(e,t){return jE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},jE(e,t)}function NE(e){return function(e){if(Array.isArray(e))return SE(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||kE(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kE(e,t){if(e){if("string"===typeof e)return SE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?SE(e,t):void 0}}function SE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function CE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?CE(Object(n),!0).forEach(function(t){EE(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function EE(e,t,n){return(t=PE(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PE(e){var t=function(e,t){if("object"!=pE(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=pE(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pE(t)?t:t+""}var OE={xAxis:["bottom","top"],yAxis:["left","right"]},AE={width:"100%",height:"100%"},TE={x:0,y:0};function DE(e){return e}var ME=function(e,t){var n=t.graphicalItems,r=t.dataStartIndex,a=t.dataEndIndex,s=(null!==n&&void 0!==n?n:[]).reduce(function(e,t){var n=t.props.data;return n&&n.length?[].concat(NE(e),NE(n)):e},[]);return s.length>0?s:e&&e.length&&zd(r)&&zd(a)?e.slice(r,a+1):[]};function IE(e){return"number"===e?[0,"auto"]:void 0}var LE=function(e,t,n,r){var a=e.graphicalItems,s=e.tooltipAxis,o=ME(t,e);return n<0||!a||!a.length||n>=o.length?null:a.reduce(function(a,i){var l,c,d=null!==(l=i.props.data)&&void 0!==l?l:t;(d&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(d=d.slice(e.dataStartIndex,e.dataEndIndex+1)),s.dataKey&&!s.allowDuplicatedCategory)?c=Xd(void 0===d?o:d,s.dataKey,r):c=d&&d[n]||o[n];return c?[].concat(NE(a),[_N(i,c)]):a},[])},RE=function(e,t,n,r){var a=r||{x:e.chartX,y:e.chartY},s=function(e,t){return"horizontal"===t?e.x:"vertical"===t?e.y:"centric"===t?e.angle:e.radius}(a,n),o=e.orderedTooltipTicks,i=e.tooltipAxis,l=e.tooltipTicks,c=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,s=-1,o=null!==(t=null===n||void 0===n?void 0:n.length)&&void 0!==t?t:0;if(o<=1)return 0;if(a&&"angleAxis"===a.axisType&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var i=a.range,l=0;l<o;l++){var c=l>0?r[l-1].coordinate:r[o-1].coordinate,d=r[l].coordinate,u=l>=o-1?r[0].coordinate:r[l+1].coordinate,m=void 0;if(Bd(d-c)!==Bd(u-d)){var h=[];if(Bd(u-d)===Bd(i[1]-i[0])){m=u;var p=d+i[1]-i[0];h[0]=Math.min(p,(p+c)/2),h[1]=Math.max(p,(p+c)/2)}else{m=c;var f=u+i[1]-i[0];h[0]=Math.min(d,(f+d)/2),h[1]=Math.max(d,(f+d)/2)}var g=[Math.min(d,(m+d)/2),Math.max(d,(m+d)/2)];if(e>g[0]&&e<=g[1]||e>=h[0]&&e<=h[1]){s=r[l].index;break}}else{var x=Math.min(c,u),y=Math.max(c,u);if(e>(x+d)/2&&e<=(y+d)/2){s=r[l].index;break}}}else for(var b=0;b<o;b++)if(0===b&&e<=(n[b].coordinate+n[b+1].coordinate)/2||b>0&&b<o-1&&e>(n[b].coordinate+n[b-1].coordinate)/2&&e<=(n[b].coordinate+n[b+1].coordinate)/2||b===o-1&&e>(n[b].coordinate+n[b-1].coordinate)/2){s=n[b].index;break}return s}(s,o,l,i);if(c>=0&&l){var d=l[c]&&l[c].value,u=LE(e,t,c,d),m=function(e,t,n,r){var a=t.find(function(e){return e&&e.index===n});if(a){if("horizontal"===e)return{x:a.coordinate,y:r.y};if("vertical"===e)return{x:r.x,y:a.coordinate};if("centric"===e){var s=a.coordinate,o=r.radius;return _E(_E(_E({},r),ek(r.cx,r.cy,o,s)),{},{angle:s,radius:o})}var i=a.coordinate,l=r.angle;return _E(_E(_E({},r),ek(r.cx,r.cy,i,l)),{},{angle:l,radius:i})}return TE}(n,o,c,a);return{activeTooltipIndex:c,activeLabel:d,activePayload:u,activeCoordinate:m}}return null},FE=function(e,t){var n=t.axes,r=t.graphicalItems,a=t.axisType,s=t.axisIdKey,o=t.stackGroups,i=t.dataStartIndex,l=t.dataEndIndex,c=e.layout,d=e.children,u=e.stackOffset,m=cN(c,a);return n.reduce(function(t,n){var h,p=void 0!==n.type.defaultProps?_E(_E({},n.type.defaultProps),n.props):n.props,f=p.type,g=p.dataKey,x=p.allowDataOverflow,y=p.allowDuplicatedCategory,b=p.scale,v=p.ticks,w=p.includeHidden,j=p[s];if(t[j])return t;var N,k,S,C=ME(e.data,{graphicalItems:r.filter(function(e){var t;return(s in e.props?e.props[s]:null===(t=e.type.defaultProps)||void 0===t?void 0:t[s])===j}),dataStartIndex:i,dataEndIndex:l}),_=C.length;(function(e,t,n){if("number"===n&&!0===t&&Array.isArray(e)){var r=null===e||void 0===e?void 0:e[0],a=null===e||void 0===e?void 0:e[1];if(r&&a&&zd(r)&&zd(a))return!0}return!1})(p.domain,x,f)&&(N=kN(p.domain,null,x),!m||"number"!==f&&"auto"===b||(S=sN(C,g,"category")));var E=IE(f);if(!N||0===N.length){var P,O=null!==(P=p.domain)&&void 0!==P?P:E;if(g){if(N=sN(C,g,f),"category"===f&&m){var A=function(e){if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++){if(n[e[r]])return!0;n[e[r]]=!0}return!1}(N);y&&A?(k=N,N=Iu()(0,_)):y||(N=CN(O,N,n).reduce(function(e,t){return e.indexOf(t)>=0?e:[].concat(NE(e),[t])},[]))}else if("category"===f)N=y?N.filter(function(e){return""!==e&&!Fd()(e)}):CN(O,N,n).reduce(function(e,t){return e.indexOf(t)>=0||""===t||Fd()(t)?e:[].concat(NE(e),[t])},[]);else if("number"===f){var T=function(e,t,n,r,a){var s=t.map(function(t){return iN(e,t,n,a,r)}).filter(function(e){return!Fd()(e)});return s&&s.length?s.reduce(function(e,t){return[Math.min(e[0],t[0]),Math.max(e[1],t[1])]},[1/0,-1/0]):null}(C,r.filter(function(e){var t,n,r=s in e.props?e.props[s]:null===(t=e.type.defaultProps)||void 0===t?void 0:t[s],a="hide"in e.props?e.props.hide:null===(n=e.type.defaultProps)||void 0===n?void 0:n.hide;return r===j&&(w||!a)}),g,a,c);T&&(N=T)}!m||"number"!==f&&"auto"===b||(S=sN(C,g,"category"))}else N=m?Iu()(0,_):o&&o[j]&&o[j].hasStack&&"number"===f?"expand"===u?[0,1]:wN(o[j].stackGroups,i,l):lN(C,r.filter(function(e){var t=s in e.props?e.props[s]:e.type.defaultProps[s],n="hide"in e.props?e.props.hide:e.type.defaultProps.hide;return t===j&&(w||!n)}),f,c,!0);if("number"===f)N=l_(d,N,j,a,v),O&&(N=kN(O,N,x));else if("category"===f&&O){var D=O;N.every(function(e){return D.indexOf(e)>=0})&&(N=D)}}return _E(_E({},t),{},EE({},j,_E(_E({},p),{},{axisType:a,domain:N,categoricalDomain:S,duplicateDomain:k,originalDomain:null!==(h=p.domain)&&void 0!==h?h:E,isCategorical:m,layout:c})))},{})},BE=function(e,t){var n=t.axisType,r=void 0===n?"xAxis":n,a=t.AxisComp,s=t.graphicalItems,o=t.stackGroups,i=t.dataStartIndex,l=t.dataEndIndex,c=e.children,d="".concat(r,"Id"),u=yu(c,a),m={};return u&&u.length?m=FE(e,{axes:u,graphicalItems:s,axisType:r,axisIdKey:d,stackGroups:o,dataStartIndex:i,dataEndIndex:l}):s&&s.length&&(m=function(e,t){var n=t.graphicalItems,r=t.Axis,a=t.axisType,s=t.axisIdKey,o=t.stackGroups,i=t.dataStartIndex,l=t.dataEndIndex,c=e.layout,d=e.children,u=ME(e.data,{graphicalItems:n,dataStartIndex:i,dataEndIndex:l}),m=u.length,h=cN(c,a),p=-1;return n.reduce(function(e,t){var f,g=(void 0!==t.type.defaultProps?_E(_E({},t.type.defaultProps),t.props):t.props)[s],x=IE("number");return e[g]?e:(p++,h?f=Iu()(0,m):o&&o[g]&&o[g].hasStack?(f=wN(o[g].stackGroups,i,l),f=l_(d,f,g,a)):(f=kN(x,lN(u,n.filter(function(e){var t,n,r=s in e.props?e.props[s]:null===(t=e.type.defaultProps)||void 0===t?void 0:t[s],a="hide"in e.props?e.props.hide:null===(n=e.type.defaultProps)||void 0===n?void 0:n.hide;return r===g&&!a}),"number",c),r.defaultProps.allowDataOverflow),f=l_(d,f,g,a)),_E(_E({},e),{},EE({},g,_E(_E({axisType:a},r.defaultProps),{},{hide:!0,orientation:Md()(OE,"".concat(a,".").concat(p%2),null),domain:f,originalDomain:x,isCategorical:h,layout:c}))))},{})}(e,{Axis:a,graphicalItems:s,axisType:r,axisIdKey:d,stackGroups:o,dataStartIndex:i,dataEndIndex:l})),m},UE=function(e){var t=e.children,n=e.defaultShowTooltip,r=bu(t,HN),a=0,s=0;return e.data&&0!==e.data.length&&(s=e.data.length-1),r&&r.props&&(r.props.startIndex>=0&&(a=r.props.startIndex),r.props.endIndex>=0&&(s=r.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:s,activeTooltipIndex:-1,isTooltipActive:Boolean(n)}},zE=function(e){return"horizontal"===e?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:"vertical"===e?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:"centric"===e?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},VE=function(e,t){var n=e.props,r=(e.graphicalItems,e.xAxisMap),a=void 0===r?{}:r,s=e.yAxisMap,o=void 0===s?{}:s,i=n.width,l=n.height,c=n.children,d=n.margin||{},u=bu(c,HN),m=bu(c,dp),h=Object.keys(o).reduce(function(e,t){var n=o[t],r=n.orientation;return n.mirror||n.hide?e:_E(_E({},e),{},EE({},r,e[r]+n.width))},{left:d.left||0,right:d.right||0}),p=Object.keys(a).reduce(function(e,t){var n=a[t],r=n.orientation;return n.mirror||n.hide?e:_E(_E({},e),{},EE({},r,Md()(e,"".concat(r))+n.height))},{top:d.top||0,bottom:d.bottom||0}),f=_E(_E({},p),h),g=f.bottom;u&&(f.bottom+=u.props.height||HN.defaultProps.height),m&&t&&(f=function(e,t,n,r){var a=n.children,s=n.width,o=n.margin,i=s-(o.left||0)-(o.right||0),l=Jj({children:a,legendWidth:i});if(l){var c=r||{},d=c.width,u=c.height,m=l.align,h=l.verticalAlign,p=l.layout;if(("vertical"===p||"horizontal"===p&&"middle"===h)&&"center"!==m&&zd(e[m]))return nN(nN({},e),{},rN({},m,e[m]+(d||0)));if(("horizontal"===p||"vertical"===p&&"center"===m)&&"middle"!==h&&zd(e[h]))return nN(nN({},e),{},rN({},h,e[h]+(u||0)))}return e}(f,0,n,t));var x=i-f.left-f.right,y=l-f.top-f.bottom;return _E(_E({brushBottom:g},f),{},{width:Math.max(x,0),height:Math.max(y,0)})},WE=function(e,t){return"xAxis"===t?e[t].width:"yAxis"===t?e[t].height:void 0},qE=function(e){var t=e.chartName,n=e.GraphicalChild,r=e.defaultTooltipEventType,a=void 0===r?"axis":r,o=e.validateTooltipEventTypes,i=void 0===o?["axis"]:o,l=e.axisComponents,c=e.legendContent,d=e.formatAxisMap,u=e.defaultProps,m=function(e,t){var n=t.graphicalItems,r=t.stackGroups,a=t.offset,s=t.updateId,o=t.dataStartIndex,i=t.dataEndIndex,c=e.barSize,d=e.layout,u=e.barGap,m=e.barCategoryGap,h=e.maxBarSize,p=zE(d),f=p.numericAxisName,g=p.cateAxisName,x=function(e){return!(!e||!e.length)&&e.some(function(e){var t=pu(e&&e.type);return t&&t.indexOf("Bar")>=0})}(n),y=[];return n.forEach(function(n,p){var b=ME(e.data,{graphicalItems:[n],dataStartIndex:o,dataEndIndex:i}),v=void 0!==n.type.defaultProps?_E(_E({},n.type.defaultProps),n.props):n.props,w=v.dataKey,j=v.maxBarSize,N=v["".concat(f,"Id")],k=v["".concat(g,"Id")],S=l.reduce(function(e,n){var r=t["".concat(n.axisType,"Map")],a=v["".concat(n.axisType,"Id")];r&&r[a]||"zAxis"===n.axisType||Bu(!1);var s=r[a];return _E(_E({},e),{},EE(EE({},n.axisType,s),"".concat(n.axisType,"Ticks"),uN(s)))},{}),C=S[g],_=S["".concat(g,"Ticks")],E=r&&r[N]&&r[N].hasStack&&function(e,t){var n,r=(null!==(n=e.type)&&void 0!==n&&n.defaultProps?nN(nN({},e.type.defaultProps),e.props):e.props).stackId;if(Vd(r)){var a=t[r];if(a){var s=a.items.indexOf(e);return s>=0?a.stackedData[s]:null}}return null}(n,r[N].stackGroups),P=pu(n.type).indexOf("Bar")>=0,O=SN(C,_),A=[],T=x&&function(e){var t=e.barSize,n=e.totalSize,r=e.stackGroups,a=void 0===r?{}:r;if(!a)return{};for(var s={},o=Object.keys(a),i=0,l=o.length;i<l;i++)for(var c=a[o[i]].stackGroups,d=Object.keys(c),u=0,m=d.length;u<m;u++){var h=c[d[u]],p=h.items,f=h.cateAxisId,g=p.filter(function(e){return pu(e.type).indexOf("Bar")>=0});if(g&&g.length){var x=g[0].type.defaultProps,y=void 0!==x?nN(nN({},x),g[0].props):g[0].props,b=y.barSize,v=y[f];s[v]||(s[v]=[]);var w=Fd()(b)?t:b;s[v].push({item:g[0],stackList:g.slice(1),barSize:Fd()(w)?void 0:Hd(w,n,0)})}}return s}({barSize:c,stackGroups:r,totalSize:WE(S,g)});if(P){var D,M,I=Fd()(j)?h:j,L=null!==(D=null!==(M=SN(C,_,!0))&&void 0!==M?M:I)&&void 0!==D?D:0;A=function(e){var t=e.barGap,n=e.barCategoryGap,r=e.bandSize,a=e.sizeList,s=void 0===a?[]:a,o=e.maxBarSize,i=s.length;if(i<1)return null;var l,c=Hd(t,r,0,!0),d=[];if(s[0].barSize===+s[0].barSize){var u=!1,m=r/i,h=s.reduce(function(e,t){return e+t.barSize||0},0);(h+=(i-1)*c)>=r&&(h-=(i-1)*c,c=0),h>=r&&m>0&&(u=!0,h=i*(m*=.9));var p={offset:((r-h)/2|0)-c,size:0};l=s.reduce(function(e,t){var n={item:t.item,position:{offset:p.offset+p.size+c,size:u?m:t.barSize}},r=[].concat(Zj(e),[n]);return p=r[r.length-1].position,t.stackList&&t.stackList.length&&t.stackList.forEach(function(e){r.push({item:e,position:p})}),r},d)}else{var f=Hd(n,r,0,!0);r-2*f-(i-1)*c<=0&&(c=0);var g=(r-2*f-(i-1)*c)/i;g>1&&(g>>=0);var x=o===+o?Math.min(g,o):g;l=s.reduce(function(e,t,n){var r=[].concat(Zj(e),[{item:t.item,position:{offset:f+(g+c)*n+(g-x)/2,size:x}}]);return t.stackList&&t.stackList.length&&t.stackList.forEach(function(e){r.push({item:e,position:r[r.length-1].position})}),r},d)}return l}({barGap:u,barCategoryGap:m,bandSize:L!==O?L:O,sizeList:T[k],maxBarSize:I}),L!==O&&(A=A.map(function(e){return _E(_E({},e),{},{position:_E(_E({},e.position),{},{offset:e.position.offset-L/2})})}))}var R,F,B=n&&n.type&&n.type.getComposedData;B&&y.push({props:_E(_E({},B(_E(_E({},S),{},{displayedData:b,props:e,dataKey:w,item:n,bandSize:O,barPosition:A,offset:a,stackedData:E,layout:d,dataStartIndex:o,dataEndIndex:i}))),{},EE(EE(EE({key:n.key||"item-".concat(p)},f,S[f]),g,S[g]),"animationId",s)),childIndex:(R=n,F=e.children,xu(F).indexOf(R)),item:n})}),y},h=function(e,r){var a=e.props,s=e.dataStartIndex,o=e.dataEndIndex,i=e.updateId;if(!vu({props:a}))return null;var c=a.children,u=a.layout,h=a.stackOffset,p=a.data,f=a.reverseStackOrder,g=zE(u),x=g.numericAxisName,y=g.cateAxisName,b=yu(c,n),v=function(e,t,n,r,a,s){if(!e)return null;var o=(s?t.reverse():t).reduce(function(e,t){var a,s=null!==(a=t.type)&&void 0!==a&&a.defaultProps?nN(nN({},t.type.defaultProps),t.props):t.props,o=s.stackId;if(s.hide)return e;var i=s[n],l=e[i]||{hasStack:!1,stackGroups:{}};if(Vd(o)){var c=l.stackGroups[o]||{numericAxisId:n,cateAxisId:r,items:[]};c.items.push(t),l.hasStack=!0,l.stackGroups[o]=c}else l.stackGroups[qd("_stackId_")]={numericAxisId:n,cateAxisId:r,items:[t]};return nN(nN({},e),{},rN({},i,l))},{});return Object.keys(o).reduce(function(t,s){var i=o[s];return i.hasStack&&(i.stackGroups=Object.keys(i.stackGroups).reduce(function(t,s){var o=i.stackGroups[s];return nN(nN({},t),{},rN({},s,{numericAxisId:n,cateAxisId:r,items:o.items,stackedData:yN(e,o.items,a)}))},{})),nN(nN({},t),{},rN({},s,i))},{})}(p,b,"".concat(x,"Id"),"".concat(y,"Id"),h,f),w=l.reduce(function(e,t){var n="".concat(t.axisType,"Map");return _E(_E({},e),{},EE({},n,BE(a,_E(_E({},t),{},{graphicalItems:b,stackGroups:t.axisType===x&&v,dataStartIndex:s,dataEndIndex:o}))))},{}),j=VE(_E(_E({},w),{},{props:a,graphicalItems:b}),null===r||void 0===r?void 0:r.legendBBox);Object.keys(w).forEach(function(e){w[e]=d(a,w[e],j,e.replace("Map",""),t)});var N=function(e){var t=Yd(e),n=uN(t,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:Ru()(n,function(e){return e.coordinate}),tooltipAxis:t,tooltipAxisBandSize:SN(t,n)}}(w["".concat(y,"Map")]),k=m(a,_E(_E({},w),{},{dataStartIndex:s,dataEndIndex:o,updateId:i,graphicalItems:b,stackGroups:v,offset:j}));return _E(_E({formattedGraphicalItems:k,graphicalItems:b,offset:j,stackGroups:v},N),w)},p=function(e){function n(e){var r,a,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),EE(o=bE(this,n,[e]),"eventEmitterSymbol",Symbol("rechartsEventEmitter")),EE(o,"accessibilityManager",new g_),EE(o,"handleLegendBBoxUpdate",function(e){if(e){var t=o.state,n=t.dataStartIndex,r=t.dataEndIndex,a=t.updateId;o.setState(_E({legendBBox:e},h({props:o.props,dataStartIndex:n,dataEndIndex:r,updateId:a},_E(_E({},o.state),{},{legendBBox:e}))))}}),EE(o,"handleReceiveSyncEvent",function(e,t,n){if(o.props.syncId===e){if(n===o.eventEmitterSymbol&&"function"!==typeof o.props.syncMethod)return;o.applySyncEvent(t)}}),EE(o,"handleBrushChange",function(e){var t=e.startIndex,n=e.endIndex;if(t!==o.state.dataStartIndex||n!==o.state.dataEndIndex){var r=o.state.updateId;o.setState(function(){return _E({dataStartIndex:t,dataEndIndex:n},h({props:o.props,dataStartIndex:t,dataEndIndex:n,updateId:r},o.state))}),o.triggerSyncEvent({dataStartIndex:t,dataEndIndex:n})}}),EE(o,"handleMouseEnter",function(e){var t=o.getMouseInfo(e);if(t){var n=_E(_E({},t),{},{isTooltipActive:!0});o.setState(n),o.triggerSyncEvent(n);var r=o.props.onMouseEnter;Qd()(r)&&r(n,e)}}),EE(o,"triggeredAfterMouseMove",function(e){var t=o.getMouseInfo(e),n=t?_E(_E({},t),{},{isTooltipActive:!0}):{isTooltipActive:!1};o.setState(n),o.triggerSyncEvent(n);var r=o.props.onMouseMove;Qd()(r)&&r(n,e)}),EE(o,"handleItemMouseEnter",function(e){o.setState(function(){return{isTooltipActive:!0,activeItem:e,activePayload:e.tooltipPayload,activeCoordinate:e.tooltipPosition||{x:e.cx,y:e.cy}}})}),EE(o,"handleItemMouseLeave",function(){o.setState(function(){return{isTooltipActive:!1}})}),EE(o,"handleMouseMove",function(e){e.persist(),o.throttleTriggeredAfterMouseMove(e)}),EE(o,"handleMouseLeave",function(e){o.throttleTriggeredAfterMouseMove.cancel();var t={isTooltipActive:!1};o.setState(t),o.triggerSyncEvent(t);var n=o.props.onMouseLeave;Qd()(n)&&n(t,e)}),EE(o,"handleOuterEvent",function(e){var t,n=function(e){var t=e&&e.type;return t&&hu[t]?hu[t]:null}(e),r=Md()(o.props,"".concat(n));n&&Qd()(r)&&r(null!==(t=/.*touch.*/i.test(n)?o.getMouseInfo(e.changedTouches[0]):o.getMouseInfo(e))&&void 0!==t?t:{},e)}),EE(o,"handleClick",function(e){var t=o.getMouseInfo(e);if(t){var n=_E(_E({},t),{},{isTooltipActive:!0});o.setState(n),o.triggerSyncEvent(n);var r=o.props.onClick;Qd()(r)&&r(n,e)}}),EE(o,"handleMouseDown",function(e){var t=o.props.onMouseDown;Qd()(t)&&t(o.getMouseInfo(e),e)}),EE(o,"handleMouseUp",function(e){var t=o.props.onMouseUp;Qd()(t)&&t(o.getMouseInfo(e),e)}),EE(o,"handleTouchMove",function(e){null!=e.changedTouches&&e.changedTouches.length>0&&o.throttleTriggeredAfterMouseMove(e.changedTouches[0])}),EE(o,"handleTouchStart",function(e){null!=e.changedTouches&&e.changedTouches.length>0&&o.handleMouseDown(e.changedTouches[0])}),EE(o,"handleTouchEnd",function(e){null!=e.changedTouches&&e.changedTouches.length>0&&o.handleMouseUp(e.changedTouches[0])}),EE(o,"handleDoubleClick",function(e){var t=o.props.onDoubleClick;Qd()(t)&&t(o.getMouseInfo(e),e)}),EE(o,"handleContextMenu",function(e){var t=o.props.onContextMenu;Qd()(t)&&t(o.getMouseInfo(e),e)}),EE(o,"triggerSyncEvent",function(e){void 0!==o.props.syncId&&d_.emit(u_,o.props.syncId,e,o.eventEmitterSymbol)}),EE(o,"applySyncEvent",function(e){var t=o.props,n=t.layout,r=t.syncMethod,a=o.state.updateId,s=e.dataStartIndex,i=e.dataEndIndex;if(void 0!==e.dataStartIndex||void 0!==e.dataEndIndex)o.setState(_E({dataStartIndex:s,dataEndIndex:i},h({props:o.props,dataStartIndex:s,dataEndIndex:i,updateId:a},o.state)));else if(void 0!==e.activeTooltipIndex){var l=e.chartX,c=e.chartY,d=e.activeTooltipIndex,u=o.state,m=u.offset,p=u.tooltipTicks;if(!m)return;if("function"===typeof r)d=r(p,e);else if("value"===r){d=-1;for(var f=0;f<p.length;f++)if(p[f].value===e.activeLabel){d=f;break}}var g=_E(_E({},m),{},{x:m.left,y:m.top}),x=Math.min(l,g.x+g.width),y=Math.min(c,g.y+g.height),b=p[d]&&p[d].value,v=LE(o.state,o.props.data,d),w=p[d]?{x:"horizontal"===n?p[d].coordinate:x,y:"horizontal"===n?y:p[d].coordinate}:TE;o.setState(_E(_E({},e),{},{activeLabel:b,activeCoordinate:w,activePayload:v,activeTooltipIndex:d}))}else o.setState(e)}),EE(o,"renderCursor",function(e){var n,r=o.state,a=r.isTooltipActive,i=r.activeCoordinate,l=r.activePayload,c=r.offset,d=r.activeTooltipIndex,u=r.tooltipAxisBandSize,m=o.getTooltipEventType(),h=null!==(n=e.props.active)&&void 0!==n?n:a,p=o.props.layout,f=e.key||"_recharts-cursor";return s.createElement(uE,{key:f,activeCoordinate:i,activePayload:l,activeTooltipIndex:d,chartName:t,element:e,isActive:h,layout:p,offset:c,tooltipAxisBandSize:u,tooltipEventType:m})}),EE(o,"renderPolarAxis",function(e,t,n){var r=Md()(e,"type.axisType"),a=Md()(o.state,"".concat(r,"Map")),i=e.type.defaultProps,l=void 0!==i?_E(_E({},i),e.props):e.props,c=a&&a[l["".concat(r,"Id")]];return(0,s.cloneElement)(e,_E(_E({},c),{},{className:Cd(r,c.className),key:e.key||"".concat(t,"-").concat(n),ticks:uN(c,!0)}))}),EE(o,"renderPolarGrid",function(e){var t=e.props,n=t.radialLines,r=t.polarAngles,a=t.polarRadius,i=o.state,l=i.radiusAxisMap,c=i.angleAxisMap,d=Yd(l),u=Yd(c),m=u.cx,h=u.cy,p=u.innerRadius,f=u.outerRadius;return(0,s.cloneElement)(e,{polarAngles:Array.isArray(r)?r:uN(u,!0).map(function(e){return e.coordinate}),polarRadius:Array.isArray(a)?a:uN(d,!0).map(function(e){return e.coordinate}),cx:m,cy:h,innerRadius:p,outerRadius:f,key:e.key||"polar-grid",radialLines:n})}),EE(o,"renderLegend",function(){var e=o.state.formattedGraphicalItems,t=o.props,n=t.children,r=t.width,a=t.height,i=o.props.margin||{},l=r-(i.left||0)-(i.right||0),d=Jj({children:n,formattedGraphicalItems:e,legendWidth:l,legendContent:c});if(!d)return null;var u=d.item,m=xE(d,mE);return(0,s.cloneElement)(u,_E(_E({},m),{},{chartWidth:r,chartHeight:a,margin:i,onBBoxUpdate:o.handleLegendBBoxUpdate}))}),EE(o,"renderTooltip",function(){var e,t=o.props,n=t.children,r=t.accessibilityLayer,a=bu(n,Im);if(!a)return null;var i=o.state,l=i.isTooltipActive,c=i.activeCoordinate,d=i.activePayload,u=i.activeLabel,m=i.offset,h=null!==(e=a.props.active)&&void 0!==e?e:l;return(0,s.cloneElement)(a,{viewBox:_E(_E({},m),{},{x:m.left,y:m.top}),active:h,label:u,payload:h?d:[],coordinate:c,accessibilityLayer:r})}),EE(o,"renderBrush",function(e){var t=o.props,n=t.margin,r=t.data,a=o.state,i=a.offset,l=a.dataStartIndex,c=a.dataEndIndex,d=a.updateId;return(0,s.cloneElement)(e,{key:e.key||"_recharts-brush",onChange:hN(o.handleBrushChange,e.props.onChange),data:r,x:zd(e.props.x)?e.props.x:i.left,y:zd(e.props.y)?e.props.y:i.top+i.height+i.brushBottom-(n.bottom||0),width:zd(e.props.width)?e.props.width:i.width,startIndex:l,endIndex:c,updateId:"brush-".concat(d)})}),EE(o,"renderReferenceElement",function(e,t,n){if(!e)return null;var r=o.clipPathId,a=o.state,i=a.xAxisMap,l=a.yAxisMap,c=a.offset,d=e.type.defaultProps||{},u=e.props,m=u.xAxisId,h=void 0===m?d.xAxisId:m,p=u.yAxisId,f=void 0===p?d.yAxisId:p;return(0,s.cloneElement)(e,{key:e.key||"".concat(t,"-").concat(n),xAxis:i[h],yAxis:l[f],viewBox:{x:c.left,y:c.top,width:c.width,height:c.height},clipPathId:r})}),EE(o,"renderActivePoints",function(e){var t=e.item,r=e.activePoint,a=e.basePoint,s=e.childIndex,o=e.isRange,i=[],l=t.props.key,c=void 0!==t.item.type.defaultProps?_E(_E({},t.item.type.defaultProps),t.item.props):t.item.props,d=c.activeDot,u=_E(_E({index:s,dataKey:c.dataKey,cx:r.x,cy:r.y,r:4,fill:oN(t.item),strokeWidth:2,stroke:"#fff",payload:r.payload,value:r.value},Nu(d,!1)),lu(d));return i.push(n.renderActiveDot(d,u,"".concat(l,"-activePoint-").concat(s))),a?i.push(n.renderActiveDot(d,_E(_E({},u),{},{cx:a.x,cy:a.y}),"".concat(l,"-basePoint-").concat(s))):o&&i.push(null),i}),EE(o,"renderGraphicChild",function(e,t,n){var r=o.filterFormatItem(e,t,n);if(!r)return null;var a=o.getTooltipEventType(),i=o.state,l=i.isTooltipActive,c=i.tooltipAxis,d=i.activeTooltipIndex,u=i.activeLabel,m=bu(o.props.children,Im),h=r.props,p=h.points,f=h.isRange,g=h.baseLine,x=void 0!==r.item.type.defaultProps?_E(_E({},r.item.type.defaultProps),r.item.props):r.item.props,y=x.activeDot,b=x.hide,v=x.activeBar,w=x.activeShape,j=Boolean(!b&&l&&m&&(y||v||w)),N={};"axis"!==a&&m&&"click"===m.props.trigger?N={onClick:hN(o.handleItemMouseEnter,e.props.onClick)}:"axis"!==a&&(N={onMouseLeave:hN(o.handleItemMouseLeave,e.props.onMouseLeave),onMouseEnter:hN(o.handleItemMouseEnter,e.props.onMouseEnter)});var k=(0,s.cloneElement)(e,_E(_E({},r.props),N));if(j){if(!(d>=0)){var S,C=(null!==(S=o.getItemByXY(o.state.activeCoordinate))&&void 0!==S?S:{graphicalItem:k}).graphicalItem,_=C.item,E=void 0===_?e:_,P=C.childIndex,O=_E(_E(_E({},r.props),N),{},{activeIndex:P});return[(0,s.cloneElement)(E,O),null,null]}var A,T;if(c.dataKey&&!c.allowDuplicatedCategory){var D="function"===typeof c.dataKey?function(e){return"function"===typeof c.dataKey?c.dataKey(e.payload):null}:"payload.".concat(c.dataKey.toString());A=Xd(p,D,u),T=f&&g&&Xd(g,D,u)}else A=null===p||void 0===p?void 0:p[d],T=f&&g&&g[d];if(w||v){var M=void 0!==e.props.activeIndex?e.props.activeIndex:d;return[(0,s.cloneElement)(e,_E(_E(_E({},r.props),N),{},{activeIndex:M})),null,null]}if(!Fd()(A))return[k].concat(NE(o.renderActivePoints({item:r,activePoint:A,basePoint:T,childIndex:d,isRange:f})))}return f?[k,null,null]:[k,null]}),EE(o,"renderCustomized",function(e,t,n){return(0,s.cloneElement)(e,_E(_E({key:"recharts-customized-".concat(n)},o.props),o.state))}),EE(o,"renderMap",{CartesianGrid:{handler:DE,once:!0},ReferenceArea:{handler:o.renderReferenceElement},ReferenceLine:{handler:DE},ReferenceDot:{handler:o.renderReferenceElement},XAxis:{handler:DE},YAxis:{handler:DE},Brush:{handler:o.renderBrush,once:!0},Bar:{handler:o.renderGraphicChild},Line:{handler:o.renderGraphicChild},Area:{handler:o.renderGraphicChild},Radar:{handler:o.renderGraphicChild},RadialBar:{handler:o.renderGraphicChild},Scatter:{handler:o.renderGraphicChild},Pie:{handler:o.renderGraphicChild},Funnel:{handler:o.renderGraphicChild},Tooltip:{handler:o.renderCursor,once:!0},PolarGrid:{handler:o.renderPolarGrid,once:!0},PolarAngleAxis:{handler:o.renderPolarAxis},PolarRadiusAxis:{handler:o.renderPolarAxis},Customized:{handler:o.renderCustomized}}),o.clipPathId="".concat(null!==(r=e.id)&&void 0!==r?r:qd("recharts"),"-clip"),o.throttleTriggeredAfterMouseMove=Ed()(o.triggeredAfterMouseMove,null!==(a=e.throttleDelay)&&void 0!==a?a:1e3/60),o.state={},o}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jE(e,t)}(n,e),r=n,o=[{key:"componentDidMount",value:function(){var e,t;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:null!==(e=this.props.margin.left)&&void 0!==e?e:0,top:null!==(t=this.props.margin.top)&&void 0!==t?t:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var e=this.props,t=e.children,n=e.data,r=e.height,a=e.layout,s=bu(t,Im);if(s){var o=s.props.defaultIndex;if(!("number"!==typeof o||o<0||o>this.state.tooltipTicks.length-1)){var i=this.state.tooltipTicks[o]&&this.state.tooltipTicks[o].value,l=LE(this.state,n,o,i),c=this.state.tooltipTicks[o].coordinate,d=(this.state.offset.top+r)/2,u="horizontal"===a?{x:c,y:d}:{y:c,x:d},m=this.state.formattedGraphicalItems.find(function(e){return"Scatter"===e.item.type.name});m&&(u=_E(_E({},u),m.props.points[o].tooltipPosition),l=m.props.points[o].tooltipPayload);var h={activeTooltipIndex:o,isTooltipActive:!0,activeLabel:i,activePayload:l,activeCoordinate:u};this.setState(h),this.renderCursor(s),this.accessibilityManager.setIndex(o)}}}},{key:"getSnapshotBeforeUpdate",value:function(e,t){return this.props.accessibilityLayer?(this.state.tooltipTicks!==t.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==e.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==e.margin&&this.accessibilityManager.setDetails({offset:{left:null!==(n=this.props.margin.left)&&void 0!==n?n:0,top:null!==(r=this.props.margin.top)&&void 0!==r?r:0}}),null):null;var n,r}},{key:"componentDidUpdate",value:function(e){ku([bu(e.children,Im)],[bu(this.props.children,Im)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var e=bu(this.props.children,Im);if(e&&"boolean"===typeof e.props.shared){var t=e.props.shared?"axis":"item";return i.indexOf(t)>=0?t:a}return a}},{key:"getMouseInfo",value:function(e){if(!this.container)return null;var t,n=this.container,r=n.getBoundingClientRect(),a={top:(t=r).top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft},s={chartX:Math.round(e.pageX-a.left),chartY:Math.round(e.pageY-a.top)},o=r.width/n.offsetWidth||1,i=this.inRange(s.chartX,s.chartY,o);if(!i)return null;var l=this.state,c=l.xAxisMap,d=l.yAxisMap,u=this.getTooltipEventType(),m=RE(this.state,this.props.data,this.props.layout,i);if("axis"!==u&&c&&d){var h=Yd(c).scale,p=Yd(d).scale,f=h&&h.invert?h.invert(s.chartX):null,g=p&&p.invert?p.invert(s.chartY):null;return _E(_E({},s),{},{xValue:f,yValue:g},m)}return m?_E(_E({},s),m):null}},{key:"inRange",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=this.props.layout,a=e/n,s=t/n;if("horizontal"===r||"vertical"===r){var o=this.state.offset;return a>=o.left&&a<=o.left+o.width&&s>=o.top&&s<=o.top+o.height?{x:a,y:s}:null}var i=this.state,l=i.angleAxisMap,c=i.radiusAxisMap;if(l&&c){var d=Yd(l);return ak({x:a,y:s},d)}return null}},{key:"parseEventsOfWrapper",value:function(){var e=this.props.children,t=this.getTooltipEventType(),n=bu(e,Im),r={};return n&&"axis"===t&&(r="click"===n.props.trigger?{onClick:this.handleClick}:{onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu}),_E(_E({},lu(this.props,this.handleOuterEvent)),r)}},{key:"addListener",value:function(){d_.on(u_,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){d_.removeListener(u_,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(e,t,n){for(var r=this.state.formattedGraphicalItems,a=0,s=r.length;a<s;a++){var o=r[a];if(o.item===e||o.props.key===e.key||t===pu(o.item.type)&&n===o.childIndex)return o}return null}},{key:"renderClipPath",value:function(){var e=this.clipPathId,t=this.state.offset,n=t.left,r=t.top,a=t.height,o=t.width;return s.createElement("defs",null,s.createElement("clipPath",{id:e},s.createElement("rect",{x:n,y:r,height:a,width:o})))}},{key:"getXScales",value:function(){var e=this.state.xAxisMap;return e?Object.entries(e).reduce(function(e,t){var n=gE(t,2),r=n[0],a=n[1];return _E(_E({},e),{},EE({},r,a.scale))},{}):null}},{key:"getYScales",value:function(){var e=this.state.yAxisMap;return e?Object.entries(e).reduce(function(e,t){var n=gE(t,2),r=n[0],a=n[1];return _E(_E({},e),{},EE({},r,a.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(e){var t;return null===(t=this.state.xAxisMap)||void 0===t||null===(t=t[e])||void 0===t?void 0:t.scale}},{key:"getYScaleByAxisId",value:function(e){var t;return null===(t=this.state.yAxisMap)||void 0===t||null===(t=t[e])||void 0===t?void 0:t.scale}},{key:"getItemByXY",value:function(e){var t=this.state,n=t.formattedGraphicalItems,r=t.activeItem;if(n&&n.length)for(var a=0,s=n.length;a<s;a++){var o=n[a],i=o.props,l=o.item,c=void 0!==l.type.defaultProps?_E(_E({},l.type.defaultProps),l.props):l.props,d=pu(l.type);if("Bar"===d){var u=(i.data||[]).find(function(t){return Jf(e,t)});if(u)return{graphicalItem:o,payload:u}}else if("RadialBar"===d){var m=(i.data||[]).find(function(t){return ak(e,t)});if(m)return{graphicalItem:o,payload:m}}else if(gS(o,r)||xS(o,r)||yS(o,r)){var h=jS({graphicalItem:o,activeTooltipItem:r,itemData:c.data}),p=void 0===c.activeIndex?h:c.activeIndex;return{graphicalItem:_E(_E({},o),{},{childIndex:p}),payload:yS(o,r)?c.data[h]:o.props.data[h]}}}return null}},{key:"render",value:function(){var e=this;if(!vu(this))return null;var t,n,r=this.props,a=r.children,o=r.className,i=r.width,l=r.height,c=r.style,d=r.compact,u=r.title,m=r.desc,h=xE(r,hE),p=Nu(h,!1);if(d)return s.createElement(EC,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},s.createElement(Wu,fE({},p,{width:i,height:l,title:u,desc:m}),this.renderClipPath(),Cu(a,this.renderMap)));this.props.accessibilityLayer&&(p.tabIndex=null!==(t=this.props.tabIndex)&&void 0!==t?t:0,p.role=null!==(n=this.props.role)&&void 0!==n?n:"application",p.onKeyDown=function(t){e.accessibilityManager.keyboardEvent(t)},p.onFocus=function(){e.accessibilityManager.focus()});var f=this.parseEventsOfWrapper();return s.createElement(EC,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},s.createElement("div",fE({className:Cd("recharts-wrapper",o),style:_E({position:"relative",cursor:"default",width:i,height:l},c)},f,{ref:function(t){e.container=t}}),s.createElement(Wu,fE({},p,{width:i,height:l,title:u,desc:m,style:AE}),this.renderClipPath(),Cu(a,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}],o&&yE(r.prototype,o),l&&yE(r,l),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,l}(s.Component);EE(p,"displayName",t),EE(p,"defaultProps",_E({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},u)),EE(p,"getDerivedStateFromProps",function(e,t){var n=e.dataKey,r=e.data,a=e.children,s=e.width,o=e.height,i=e.layout,l=e.stackOffset,c=e.margin,d=t.dataStartIndex,u=t.dataEndIndex;if(void 0===t.updateId){var m=UE(e);return _E(_E(_E({},m),{},{updateId:0},h(_E(_E({props:e},m),{},{updateId:0}),t)),{},{prevDataKey:n,prevData:r,prevWidth:s,prevHeight:o,prevLayout:i,prevStackOffset:l,prevMargin:c,prevChildren:a})}if(n!==t.prevDataKey||r!==t.prevData||s!==t.prevWidth||o!==t.prevHeight||i!==t.prevLayout||l!==t.prevStackOffset||!nu(c,t.prevMargin)){var p=UE(e),f={chartX:t.chartX,chartY:t.chartY,isTooltipActive:t.isTooltipActive},g=_E(_E({},RE(t,r,i)),{},{updateId:t.updateId+1}),x=_E(_E(_E({},p),f),g);return _E(_E(_E({},x),h(_E({props:e},x),t)),{},{prevDataKey:n,prevData:r,prevWidth:s,prevHeight:o,prevLayout:i,prevStackOffset:l,prevMargin:c,prevChildren:a})}if(!ku(a,t.prevChildren)){var y,b,v,w,j=bu(a,HN),N=j&&null!==(y=null===(b=j.props)||void 0===b?void 0:b.startIndex)&&void 0!==y?y:d,k=j&&null!==(v=null===(w=j.props)||void 0===w?void 0:w.endIndex)&&void 0!==v?v:u,S=N!==d||k!==u,C=!Fd()(r)&&!S?t.updateId:t.updateId+1;return _E(_E({updateId:C},h(_E(_E({props:e},t),{},{updateId:C,dataStartIndex:N,dataEndIndex:k}),t)),{},{prevChildren:a,dataStartIndex:N,dataEndIndex:k})}return null}),EE(p,"renderActiveDot",function(e,t,n){var r;return r=(0,s.isValidElement)(e)?(0,s.cloneElement)(e,t):Qd()(e)?e(t):s.createElement(mp,t),s.createElement(Gu,{className:"recharts-active-dot",key:n},r)});var f=(0,s.forwardRef)(function(e,t){return s.createElement(p,fE({},e,{ref:t}))});return f.displayName=p.displayName,f};function HE(e,t,n){if(t<1)return[];if(1===t&&void 0===n)return e;for(var r=[],a=0;a<e.length;a+=t){if(void 0!==n&&!0!==n(e[a]))return;r.push(e[a])}return r}function YE(e,t,n){return function(e){var t=e.width,n=e.height,r=function(e){return(e%180+180)%180}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0),a=r*Math.PI/180,s=Math.atan(n/t),o=a>s&&a<Math.PI-s?n/Math.sin(a):t/Math.cos(a);return Math.abs(o)}({width:e.width+t.width,height:e.height+t.height},n)}function GE(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var s=n();return e*(t-e*s/2-r)>=0&&e*(t+e*s/2-a)<=0}function XE(e){return XE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},XE(e)}function $E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function KE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$E(Object(n),!0).forEach(function(t){JE(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$E(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function JE(e,t,n){return t=function(e){var t=function(e,t){if("object"!=XE(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=XE(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==XE(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QE(e,t,n){var r=e.tick,a=e.ticks,s=e.viewBox,o=e.minTickGap,i=e.orientation,l=e.interval,c=e.tickFormatter,d=e.unit,u=e.angle;if(!a||!a.length||!r)return[];if(zd(l)||vm.isSsr)return function(e,t){return HE(e,t+1)}(a,"number"===typeof l&&zd(l)?l:0);var m=[],h="top"===i||"bottom"===i?"width":"height",p=d&&"width"===h?bg(d,{fontSize:t,letterSpacing:n}):{width:0,height:0},f=function(e,r){var a=Qd()(c)?c(e.value,r):e.value;return"width"===h?YE(bg(a,{fontSize:t,letterSpacing:n}),p,u):bg(a,{fontSize:t,letterSpacing:n})[h]},g=a.length>=2?Bd(a[1].coordinate-a[0].coordinate):1,x=function(e,t,n){var r="width"===n,a=e.x,s=e.y,o=e.width,i=e.height;return 1===t?{start:r?a:s,end:r?a+o:s+i}:{start:r?a+o:s+i,end:r?a:s}}(s,g,h);return"equidistantPreserveStart"===l?function(e,t,n,r,a){for(var s,o=(r||[]).slice(),i=t.start,l=t.end,c=0,d=1,u=i,m=function(){var t=null===r||void 0===r?void 0:r[c];if(void 0===t)return{v:HE(r,d)};var s,o=c,m=function(){return void 0===s&&(s=n(t,o)),s},h=t.coordinate,p=0===c||GE(e,h,m,u,l);p||(c=0,u=i,d+=1),p&&(u=h+e*(m()/2+a),c+=d)};d<=o.length;)if(s=m())return s.v;return[]}(g,x,f,a,o):(m="preserveStart"===l||"preserveStartEnd"===l?function(e,t,n,r,a,s){var o=(r||[]).slice(),i=o.length,l=t.start,c=t.end;if(s){var d=r[i-1],u=n(d,i-1),m=e*(d.coordinate+e*u/2-c);o[i-1]=d=KE(KE({},d),{},{tickCoord:m>0?d.coordinate-m*e:d.coordinate}),GE(e,d.tickCoord,function(){return u},l,c)&&(c=d.tickCoord-e*(u/2+a),o[i-1]=KE(KE({},d),{},{isShow:!0}))}for(var h=s?i-1:i,p=function(t){var r,s=o[t],i=function(){return void 0===r&&(r=n(s,t)),r};if(0===t){var d=e*(s.coordinate-e*i()/2-l);o[t]=s=KE(KE({},s),{},{tickCoord:d<0?s.coordinate-d*e:s.coordinate})}else o[t]=s=KE(KE({},s),{},{tickCoord:s.coordinate});GE(e,s.tickCoord,i,l,c)&&(l=s.tickCoord+e*(i()/2+a),o[t]=KE(KE({},s),{},{isShow:!0}))},f=0;f<h;f++)p(f);return o}(g,x,f,a,o,"preserveStartEnd"===l):function(e,t,n,r,a){for(var s=(r||[]).slice(),o=s.length,i=t.start,l=t.end,c=function(t){var r,c=s[t],d=function(){return void 0===r&&(r=n(c,t)),r};if(t===o-1){var u=e*(c.coordinate+e*d()/2-l);s[t]=c=KE(KE({},c),{},{tickCoord:u>0?c.coordinate-u*e:c.coordinate})}else s[t]=c=KE(KE({},c),{},{tickCoord:c.coordinate});GE(e,c.tickCoord,d,i,l)&&(l=c.tickCoord-e*(d()/2+a),s[t]=KE(KE({},c),{},{isShow:!0}))},d=o-1;d>=0;d--)c(d);return s}(g,x,f,a,o),m.filter(function(e){return e.isShow}))}var ZE=["viewBox"],eP=["viewBox"],tP=["ticks"];function nP(e){return nP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nP(e)}function rP(){return rP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rP.apply(this,arguments)}function aP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function sP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?aP(Object(n),!0).forEach(function(t){mP(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aP(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function oP(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function iP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,hP(r.key),r)}}function lP(e,t,n){return t=dP(t),function(e,t){if(t&&("object"===nP(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,cP()?Reflect.construct(t,n||[],dP(e).constructor):t.apply(e,n))}function cP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(cP=function(){return!!e})()}function dP(e){return dP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dP(e)}function uP(e,t){return uP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},uP(e,t)}function mP(e,t,n){return(t=hP(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hP(e){var t=function(e,t){if("object"!=nP(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=nP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==nP(t)?t:t+""}var pP=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=lP(this,t,[e])).state={fontSize:"",letterSpacing:""},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uP(e,t)}(t,e),n=t,r=[{key:"shouldComponentUpdate",value:function(e,t){var n=e.viewBox,r=oP(e,ZE),a=this.props,s=a.viewBox,o=oP(a,eP);return!nu(n,s)||!nu(r,o)||!nu(t,this.state)}},{key:"componentDidMount",value:function(){var e=this.layerReference;if(e){var t=e.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];t&&this.setState({fontSize:window.getComputedStyle(t).fontSize,letterSpacing:window.getComputedStyle(t).letterSpacing})}}},{key:"getTickLineCoord",value:function(e){var t,n,r,a,s,o,i=this.props,l=i.x,c=i.y,d=i.width,u=i.height,m=i.orientation,h=i.tickSize,p=i.mirror,f=i.tickMargin,g=p?-1:1,x=e.tickSize||h,y=zd(e.tickCoord)?e.tickCoord:e.coordinate;switch(m){case"top":t=n=e.coordinate,o=(r=(a=c+ +!p*u)-g*x)-g*f,s=y;break;case"left":r=a=e.coordinate,s=(t=(n=l+ +!p*d)-g*x)-g*f,o=y;break;case"right":r=a=e.coordinate,s=(t=(n=l+ +p*d)+g*x)+g*f,o=y;break;default:t=n=e.coordinate,o=(r=(a=c+ +p*u)+g*x)+g*f,s=y}return{line:{x1:t,y1:r,x2:n,y2:a},tick:{x:s,y:o}}}},{key:"getTickTextAnchor",value:function(){var e,t=this.props,n=t.orientation,r=t.mirror;switch(n){case"left":e=r?"start":"end";break;case"right":e=r?"end":"start";break;default:e="middle"}return e}},{key:"getTickVerticalAnchor",value:function(){var e=this.props,t=e.orientation,n=e.mirror,r="end";switch(t){case"left":case"right":r="middle";break;case"top":r=n?"start":"end";break;default:r=n?"end":"start"}return r}},{key:"renderAxisLine",value:function(){var e=this.props,t=e.x,n=e.y,r=e.width,a=e.height,o=e.orientation,i=e.mirror,l=e.axisLine,c=sP(sP(sP({},Nu(this.props,!1)),Nu(l,!1)),{},{fill:"none"});if("top"===o||"bottom"===o){var d=+("top"===o&&!i||"bottom"===o&&i);c=sP(sP({},c),{},{x1:t,y1:n+d*a,x2:t+r,y2:n+d*a})}else{var u=+("left"===o&&!i||"right"===o&&i);c=sP(sP({},c),{},{x1:t+u*r,y1:n,x2:t+u*r,y2:n+a})}return s.createElement("line",rP({},c,{className:Cd("recharts-cartesian-axis-line",Md()(l,"className"))}))}},{key:"renderTicks",value:function(e,n,r){var a=this,o=this.props,i=o.tickLine,l=o.stroke,c=o.tick,d=o.tickFormatter,u=o.unit,m=QE(sP(sP({},this.props),{},{ticks:e}),n,r),h=this.getTickTextAnchor(),p=this.getTickVerticalAnchor(),f=Nu(this.props,!1),g=Nu(c,!1),x=sP(sP({},f),{},{fill:"none"},Nu(i,!1)),y=m.map(function(e,n){var r=a.getTickLineCoord(e),o=r.line,y=r.tick,b=sP(sP(sP(sP({textAnchor:h,verticalAnchor:p},f),{},{stroke:"none",fill:l},g),y),{},{index:n,payload:e,visibleTicksCount:m.length,tickFormatter:d});return s.createElement(Gu,rP({className:"recharts-cartesian-axis-tick",key:"tick-".concat(e.value,"-").concat(e.coordinate,"-").concat(e.tickCoord)},cu(a.props,e,n)),i&&s.createElement("line",rP({},x,o,{className:Cd("recharts-cartesian-axis-tick-line",Md()(i,"className"))})),c&&t.renderTickItem(c,b,"".concat(Qd()(d)?d(e.value,n):e.value).concat(u||"")))});return s.createElement("g",{className:"recharts-cartesian-axis-ticks"},y)}},{key:"render",value:function(){var e=this,t=this.props,n=t.axisLine,r=t.width,a=t.height,o=t.ticksGenerator,i=t.className;if(t.hide)return null;var l=this.props,c=l.ticks,d=oP(l,tP),u=c;return Qd()(o)&&(u=c&&c.length>0?o(this.props):o(d)),r<=0||a<=0||!u||!u.length?null:s.createElement(Gu,{className:Cd("recharts-cartesian-axis",i),ref:function(t){e.layerReference=t}},n&&this.renderAxisLine(),this.renderTicks(u,this.state.fontSize,this.state.letterSpacing),gk.renderCallByParent(this.props))}}],a=[{key:"renderTickItem",value:function(e,t,n){var r=Cd(t.className,"recharts-cartesian-axis-tick-value");return s.isValidElement(e)?s.cloneElement(e,sP(sP({},t),{},{className:r})):Qd()(e)?e(sP(sP({},t),{},{className:r})):s.createElement(Xg,rP({},t,{className:"recharts-cartesian-axis-tick-value"}),n)}}],r&&iP(n.prototype,r),a&&iP(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.Component);function fP(e){return fP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fP(e)}function gP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,jP(r.key),r)}}function xP(e,t,n){return t=bP(t),function(e,t){if(t&&("object"===fP(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,yP()?Reflect.construct(t,n||[],bP(e).constructor):t.apply(e,n))}function yP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(yP=function(){return!!e})()}function bP(e){return bP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bP(e)}function vP(e,t){return vP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},vP(e,t)}function wP(e,t,n){return(t=jP(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jP(e){var t=function(e,t){if("object"!=fP(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=fP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==fP(t)?t:t+""}function NP(){return NP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},NP.apply(this,arguments)}function kP(e){var t=e.xAxisId,n=AC(),r=TC(),a=PC(t);return null==a?null:s.createElement(pP,NP({},a,{className:Cd("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(e){return uN(e,!0)}}))}mP(pP,"displayName","CartesianAxis"),mP(pP,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var SP=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),xP(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vP(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){return s.createElement(kP,this.props)}}])&&gP(n.prototype,r),a&&gP(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.Component);function CP(e){return CP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},CP(e)}function _P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,DP(r.key),r)}}function EP(e,t,n){return t=OP(t),function(e,t){if(t&&("object"===CP(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,PP()?Reflect.construct(t,n||[],OP(e).constructor):t.apply(e,n))}function PP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(PP=function(){return!!e})()}function OP(e){return OP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},OP(e)}function AP(e,t){return AP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},AP(e,t)}function TP(e,t,n){return(t=DP(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DP(e){var t=function(e,t){if("object"!=CP(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=CP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==CP(t)?t:t+""}function MP(){return MP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},MP.apply(this,arguments)}wP(SP,"displayName","XAxis"),wP(SP,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});var IP=function(e){var t=e.yAxisId,n=AC(),r=TC(),a=OC(t);return null==a?null:s.createElement(pP,MP({},a,{className:Cd("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(e){return uN(e,!0)}}))},LP=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),EP(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AP(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){return s.createElement(IP,this.props)}}])&&_P(n.prototype,r),a&&_P(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.Component);TP(LP,"displayName","YAxis"),TP(LP,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});var RP=qE({chartName:"BarChart",GraphicalChild:GS,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:SP},{axisType:"yAxis",AxisComp:LP}],formatAxisMap:function(e,t,n,r,a){var s=e.width,o=e.height,i=e.layout,l=e.children,c=Object.keys(t),d={left:n.left,leftMirror:n.left,right:s-n.right,rightMirror:s-n.right,top:n.top,topMirror:n.top,bottom:o-n.bottom,bottomMirror:o-n.bottom},u=!!bu(l,GS);return c.reduce(function(s,o){var l,c,m,h,p,f=t[o],g=f.orientation,x=f.domain,y=f.padding,b=void 0===y?{}:y,v=f.mirror,w=f.reversed,j="".concat(g).concat(v?"Mirror":"");if("number"===f.type&&("gap"===f.padding||"no-gap"===f.padding)){var N=x[1]-x[0],k=1/0,S=f.categoricalDomain.sort($d);if(S.forEach(function(e,t){t>0&&(k=Math.min((e||0)-(S[t-1]||0),k))}),Number.isFinite(k)){var C=k/N,_="vertical"===f.layout?n.height:n.width;if("gap"===f.padding&&(l=C*_/2),"no-gap"===f.padding){var E=Hd(e.barCategoryGap,C*_),P=C*_/2;l=P-E-(P-E)/_*E}}}c="xAxis"===r?[n.left+(b.left||0)+(l||0),n.left+n.width-(b.right||0)-(l||0)]:"yAxis"===r?"horizontal"===i?[n.top+n.height-(b.bottom||0),n.top+(b.top||0)]:[n.top+(b.top||0)+(l||0),n.top+n.height-(b.bottom||0)-(l||0)]:f.range,w&&(c=[c[1],c[0]]);var O=pN(f,a,u),A=O.scale,T=O.realScaleType;A.domain(x).range(c),gN(A);var D=bN(A,JS(JS({},f),{},{realScaleType:T}));"xAxis"===r?(p="top"===g&&!v||"bottom"===g&&v,m=n.left,h=d[j]-p*f.height):"yAxis"===r&&(p="left"===g&&!v||"right"===g&&v,m=d[j]-p*f.width,h=n.top);var M=JS(JS(JS({},f),D),{},{realScaleType:T,x:m,y:h,scale:A,width:"xAxis"===r?n.width:f.width,height:"yAxis"===r?n.height:f.height});return M.bandSize=SN(M,D),f.hide||"xAxis"!==r?f.hide||(d[j]+=(p?-1:1)*M.width):d[j]+=(p?-1:1)*M.height,JS(JS({},s),{},QS({},o,M))},{})}}),FP=["x1","y1","x2","y2","key"],BP=["offset"];function UP(e){return UP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},UP(e)}function zP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function VP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zP(Object(n),!0).forEach(function(t){WP(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zP(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function WP(e,t,n){return t=function(e){var t=function(e,t){if("object"!=UP(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=UP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==UP(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qP(){return qP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qP.apply(this,arguments)}function HP(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var YP=function(e){var t=e.fill;if(!t||"none"===t)return null;var n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,l=e.ry;return s.createElement("rect",{x:r,y:a,ry:l,width:o,height:i,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function GP(e,t){var n;if(s.isValidElement(e))n=s.cloneElement(e,t);else if(Qd()(e))n=e(t);else{var r=t.x1,a=t.y1,o=t.x2,i=t.y2,l=t.key,c=HP(t,FP),d=Nu(c,!1),u=(d.offset,HP(d,BP));n=s.createElement("line",qP({},u,{x1:r,y1:a,x2:o,y2:i,fill:"none",key:l}))}return n}function XP(e){var t=e.x,n=e.width,r=e.horizontal,a=void 0===r||r,o=e.horizontalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(r,s){var o=VP(VP({},e),{},{x1:t,y1:r,x2:t+n,y2:r,key:"line-".concat(s),index:s});return GP(a,o)});return s.createElement("g",{className:"recharts-cartesian-grid-horizontal"},i)}function $P(e){var t=e.y,n=e.height,r=e.vertical,a=void 0===r||r,o=e.verticalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(r,s){var o=VP(VP({},e),{},{x1:r,y1:t,x2:r,y2:t+n,key:"line-".concat(s),index:s});return GP(a,o)});return s.createElement("g",{className:"recharts-cartesian-grid-vertical"},i)}function KP(e){var t=e.horizontalFill,n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,l=e.horizontalPoints,c=e.horizontal;if(!(void 0===c||c)||!t||!t.length)return null;var d=l.map(function(e){return Math.round(e+a-a)}).sort(function(e,t){return e-t});a!==d[0]&&d.unshift(0);var u=d.map(function(e,l){var c=!d[l+1]?a+i-e:d[l+1]-e;if(c<=0)return null;var u=l%t.length;return s.createElement("rect",{key:"react-".concat(l),y:e,x:r,height:c,width:o,stroke:"none",fill:t[u],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return s.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function JP(e){var t=e.vertical,n=void 0===t||t,r=e.verticalFill,a=e.fillOpacity,o=e.x,i=e.y,l=e.width,c=e.height,d=e.verticalPoints;if(!n||!r||!r.length)return null;var u=d.map(function(e){return Math.round(e+o-o)}).sort(function(e,t){return e-t});o!==u[0]&&u.unshift(0);var m=u.map(function(e,t){var n=!u[t+1]?o+l-e:u[t+1]-e;if(n<=0)return null;var d=t%r.length;return s.createElement("rect",{key:"react-".concat(t),x:e,y:i,width:n,height:c,stroke:"none",fill:r[d],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return s.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},m)}var QP=function(e,t){var n=e.xAxis,r=e.width,a=e.height,s=e.offset;return dN(QE(VP(VP(VP({},pP.defaultProps),n),{},{ticks:uN(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),s.left,s.left+s.width,t)},ZP=function(e,t){var n=e.yAxis,r=e.width,a=e.height,s=e.offset;return dN(QE(VP(VP(VP({},pP.defaultProps),n),{},{ticks:uN(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),s.top,s.top+s.height,t)},eO={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function tO(e){var t,n,r,a,o,i,l=AC(),c=TC(),d=(0,s.useContext)(kC),u=VP(VP({},e),{},{stroke:null!==(t=e.stroke)&&void 0!==t?t:eO.stroke,fill:null!==(n=e.fill)&&void 0!==n?n:eO.fill,horizontal:null!==(r=e.horizontal)&&void 0!==r?r:eO.horizontal,horizontalFill:null!==(a=e.horizontalFill)&&void 0!==a?a:eO.horizontalFill,vertical:null!==(o=e.vertical)&&void 0!==o?o:eO.vertical,verticalFill:null!==(i=e.verticalFill)&&void 0!==i?i:eO.verticalFill,x:zd(e.x)?e.x:d.left,y:zd(e.y)?e.y:d.top,width:zd(e.width)?e.width:d.width,height:zd(e.height)?e.height:d.height}),m=u.x,h=u.y,p=u.width,f=u.height,g=u.syncWithTicks,x=u.horizontalValues,y=u.verticalValues,b=function(){var e=(0,s.useContext)(wC);return Yd(e)}(),v=function(){var e=(0,s.useContext)(jC);return yC()(e,function(e){return jk()(e.domain,Number.isFinite)})||Yd(e)}();if(!zd(p)||p<=0||!zd(f)||f<=0||!zd(m)||m!==+m||!zd(h)||h!==+h)return null;var w=u.verticalCoordinatesGenerator||QP,j=u.horizontalCoordinatesGenerator||ZP,N=u.horizontalPoints,k=u.verticalPoints;if((!N||!N.length)&&Qd()(j)){var S=x&&x.length,C=j({yAxis:v?VP(VP({},v),{},{ticks:S?x:v.ticks}):void 0,width:l,height:c,offset:d},!!S||g);Kd(Array.isArray(C),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(UP(C),"]")),Array.isArray(C)&&(N=C)}if((!k||!k.length)&&Qd()(w)){var _=y&&y.length,E=w({xAxis:b?VP(VP({},b),{},{ticks:_?y:b.ticks}):void 0,width:l,height:c,offset:d},!!_||g);Kd(Array.isArray(E),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(UP(E),"]")),Array.isArray(E)&&(k=E)}return s.createElement("g",{className:"recharts-cartesian-grid"},s.createElement(YP,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),s.createElement(XP,qP({},u,{offset:d,horizontalPoints:N,xAxis:b,yAxis:v})),s.createElement($P,qP({},u,{offset:d,verticalPoints:k,xAxis:b,yAxis:v})),s.createElement(KP,qP({},u,{horizontalPoints:N})),s.createElement(JP,qP({},u,{verticalPoints:k})))}tO.displayName="CartesianGrid";var nO=["points","className","baseLinePoints","connectNulls"];function rO(){return rO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rO.apply(this,arguments)}function aO(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function sO(e){return function(e){if(Array.isArray(e))return oO(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return oO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oO(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var iO=function(e){return e&&e.x===+e.x&&e.y===+e.y},lO=function(e,t){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[[]];return e.forEach(function(e){iO(e)?t[t.length-1].push(e):t[t.length-1].length>0&&t.push([])}),iO(e[0])&&t[t.length-1].push(e[0]),t[t.length-1].length<=0&&(t=t.slice(0,-1)),t}(e);t&&(n=[n.reduce(function(e,t){return[].concat(sO(e),sO(t))},[])]);var r=n.map(function(e){return e.reduce(function(e,t,n){return"".concat(e).concat(0===n?"M":"L").concat(t.x,",").concat(t.y)},"")}).join("");return 1===n.length?"".concat(r,"Z"):r},cO=function(e){var t=e.points,n=e.className,r=e.baseLinePoints,a=e.connectNulls,o=aO(e,nO);if(!t||!t.length)return null;var i=Cd("recharts-polygon",n);if(r&&r.length){var l=o.stroke&&"none"!==o.stroke,c=function(e,t,n){var r=lO(e,n);return"".concat("Z"===r.slice(-1)?r.slice(0,-1):r,"L").concat(lO(t.reverse(),n).slice(1))}(t,r,a);return s.createElement("g",{className:i},s.createElement("path",rO({},Nu(o,!0),{fill:"Z"===c.slice(-1)?o.fill:"none",stroke:"none",d:c})),l?s.createElement("path",rO({},Nu(o,!0),{fill:"none",d:lO(t,a)})):null,l?s.createElement("path",rO({},Nu(o,!0),{fill:"none",d:lO(r,a)})):null)}var d=lO(t,a);return s.createElement("path",rO({},Nu(o,!0),{fill:"Z"===d.slice(-1)?o.fill:"none",className:i,d:d}))};function dO(e){return dO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dO(e)}function uO(){return uO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},uO.apply(this,arguments)}function mO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function hO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mO(Object(n),!0).forEach(function(t){bO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function pO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,vO(r.key),r)}}function fO(e,t,n){return t=xO(t),function(e,t){if(t&&("object"===dO(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,gO()?Reflect.construct(t,n||[],xO(e).constructor):t.apply(e,n))}function gO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(gO=function(){return!!e})()}function xO(e){return xO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xO(e)}function yO(e,t){return yO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yO(e,t)}function bO(e,t,n){return(t=vO(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vO(e){var t=function(e,t){if("object"!=dO(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=dO(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==dO(t)?t:t+""}var wO=Math.PI/180,jO=1e-5,NO=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),fO(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yO(e,t)}(t,e),n=t,r=[{key:"getTickLineCoord",value:function(e){var t=this.props,n=t.cx,r=t.cy,a=t.radius,s=t.orientation,o=t.tickSize||8,i=ek(n,r,a,e.coordinate),l=ek(n,r,a+("inner"===s?-1:1)*o,e.coordinate);return{x1:i.x,y1:i.y,x2:l.x,y2:l.y}}},{key:"getTickTextAnchor",value:function(e){var t=this.props.orientation,n=Math.cos(-e.coordinate*wO);return n>jO?"outer"===t?"start":"end":n<-jO?"outer"===t?"end":"start":"middle"}},{key:"renderAxisLine",value:function(){var e=this.props,t=e.cx,n=e.cy,r=e.radius,a=e.axisLine,o=e.axisLineType,i=hO(hO({},Nu(this.props,!1)),{},{fill:"none"},Nu(a,!1));if("circle"===o)return s.createElement(mp,uO({className:"recharts-polar-angle-axis-line"},i,{cx:t,cy:n,r:r}));var l=this.props.ticks.map(function(e){return ek(t,n,r,e.coordinate)});return s.createElement(cO,uO({className:"recharts-polar-angle-axis-line"},i,{points:l}))}},{key:"renderTicks",value:function(){var e=this,n=this.props,r=n.ticks,a=n.tick,o=n.tickLine,i=n.tickFormatter,l=n.stroke,c=Nu(this.props,!1),d=Nu(a,!1),u=hO(hO({},c),{},{fill:"none"},Nu(o,!1)),m=r.map(function(n,r){var m=e.getTickLineCoord(n),h=hO(hO(hO({textAnchor:e.getTickTextAnchor(n)},c),{},{stroke:"none",fill:l},d),{},{index:r,payload:n,x:m.x2,y:m.y2});return s.createElement(Gu,uO({className:Cd("recharts-polar-angle-axis-tick",sk(a)),key:"tick-".concat(n.coordinate)},cu(e.props,n,r)),o&&s.createElement("line",uO({className:"recharts-polar-angle-axis-tick-line"},u,m)),a&&t.renderTickItem(a,h,i?i(n.value,r):n.value))});return s.createElement(Gu,{className:"recharts-polar-angle-axis-ticks"},m)}},{key:"render",value:function(){var e=this.props,t=e.ticks,n=e.radius,r=e.axisLine;return n<=0||!t||!t.length?null:s.createElement(Gu,{className:Cd("recharts-polar-angle-axis",this.props.className)},r&&this.renderAxisLine(),this.renderTicks())}}],a=[{key:"renderTickItem",value:function(e,t,n){return s.isValidElement(e)?s.cloneElement(e,t):Qd()(e)?e(t):s.createElement(Xg,uO({},t,{className:"recharts-polar-angle-axis-tick-value"}),n)}}],r&&pO(n.prototype,r),a&&pO(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.PureComponent);bO(NO,"displayName","PolarAngleAxis"),bO(NO,"axisType","angleAxis"),bO(NO,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var kO=n(2794),SO=n.n(kO),CO=n(9364),_O=n.n(CO),EO=["cx","cy","angle","ticks","axisLine"],PO=["ticks","tick","angle","tickFormatter","stroke"];function OO(e){return OO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},OO(e)}function AO(){return AO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},AO.apply(this,arguments)}function TO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function DO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TO(Object(n),!0).forEach(function(t){UO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function MO(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function IO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,zO(r.key),r)}}function LO(e,t,n){return t=FO(t),function(e,t){if(t&&("object"===OO(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,RO()?Reflect.construct(t,n||[],FO(e).constructor):t.apply(e,n))}function RO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(RO=function(){return!!e})()}function FO(e){return FO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},FO(e)}function BO(e,t){return BO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},BO(e,t)}function UO(e,t,n){return(t=zO(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zO(e){var t=function(e,t){if("object"!=OO(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=OO(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==OO(t)?t:t+""}var VO,WO=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),LO(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BO(e,t)}(t,e),n=t,r=[{key:"getTickValueCoord",value:function(e){var t=e.coordinate,n=this.props,r=n.angle,a=n.cx,s=n.cy;return ek(a,s,t,r)}},{key:"getTickTextAnchor",value:function(){var e;switch(this.props.orientation){case"left":e="end";break;case"right":e="start";break;default:e="middle"}return e}},{key:"getViewBox",value:function(){var e=this.props,t=e.cx,n=e.cy,r=e.angle,a=e.ticks,s=SO()(a,function(e){return e.coordinate||0});return{cx:t,cy:n,startAngle:r,endAngle:r,innerRadius:_O()(a,function(e){return e.coordinate||0}).coordinate||0,outerRadius:s.coordinate||0}}},{key:"renderAxisLine",value:function(){var e=this.props,t=e.cx,n=e.cy,r=e.angle,a=e.ticks,o=e.axisLine,i=MO(e,EO),l=a.reduce(function(e,t){return[Math.min(e[0],t.coordinate),Math.max(e[1],t.coordinate)]},[1/0,-1/0]),c=ek(t,n,l[0],r),d=ek(t,n,l[1],r),u=DO(DO(DO({},Nu(i,!1)),{},{fill:"none"},Nu(o,!1)),{},{x1:c.x,y1:c.y,x2:d.x,y2:d.y});return s.createElement("line",AO({className:"recharts-polar-radius-axis-line"},u))}},{key:"renderTicks",value:function(){var e=this,n=this.props,r=n.ticks,a=n.tick,o=n.angle,i=n.tickFormatter,l=n.stroke,c=MO(n,PO),d=this.getTickTextAnchor(),u=Nu(c,!1),m=Nu(a,!1),h=r.map(function(n,r){var c=e.getTickValueCoord(n),h=DO(DO(DO(DO({textAnchor:d,transform:"rotate(".concat(90-o,", ").concat(c.x,", ").concat(c.y,")")},u),{},{stroke:"none",fill:l},m),{},{index:r},c),{},{payload:n});return s.createElement(Gu,AO({className:Cd("recharts-polar-radius-axis-tick",sk(a)),key:"tick-".concat(n.coordinate)},cu(e.props,n,r)),t.renderTickItem(a,h,i?i(n.value,r):n.value))});return s.createElement(Gu,{className:"recharts-polar-radius-axis-ticks"},h)}},{key:"render",value:function(){var e=this.props,t=e.ticks,n=e.axisLine,r=e.tick;return t&&t.length?s.createElement(Gu,{className:Cd("recharts-polar-radius-axis",this.props.className)},n&&this.renderAxisLine(),r&&this.renderTicks(),gk.renderCallByParent(this.props,this.getViewBox())):null}}],a=[{key:"renderTickItem",value:function(e,t,n){return s.isValidElement(e)?s.cloneElement(e,t):Qd()(e)?e(t):s.createElement(Xg,AO({},t,{className:"recharts-polar-radius-axis-tick-value"}),n)}}],r&&IO(n.prototype,r),a&&IO(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.PureComponent);function qO(e){return qO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qO(e)}function HO(){return HO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},HO.apply(this,arguments)}function YO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function GO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?YO(Object(n),!0).forEach(function(t){ZO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function XO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,eA(r.key),r)}}function $O(e,t,n){return t=JO(t),function(e,t){if(t&&("object"===qO(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,KO()?Reflect.construct(t,n||[],JO(e).constructor):t.apply(e,n))}function KO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(KO=function(){return!!e})()}function JO(e){return JO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},JO(e)}function QO(e,t){return QO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},QO(e,t)}function ZO(e,t,n){return(t=eA(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eA(e){var t=function(e,t){if("object"!=qO(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=qO(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qO(t)?t:t+""}UO(WO,"displayName","PolarRadiusAxis"),UO(WO,"axisType","radiusAxis"),UO(WO,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});var tA=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ZO(n=$O(this,t,[e]),"pieRef",null),ZO(n,"sectorRefs",[]),ZO(n,"id",qd("recharts-pie-")),ZO(n,"handleAnimationEnd",function(){var e=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Qd()(e)&&e()}),ZO(n,"handleAnimationStart",function(){var e=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Qd()(e)&&e()}),n.state={isAnimationFinished:!e.isAnimationActive,prevIsAnimationActive:e.isAnimationActive,prevAnimationId:e.animationId,sectorToFocus:0},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QO(e,t)}(t,e),n=t,a=[{key:"getDerivedStateFromProps",value:function(e,t){return t.prevIsAnimationActive!==e.isAnimationActive?{prevIsAnimationActive:e.isAnimationActive,prevAnimationId:e.animationId,curSectors:e.sectors,prevSectors:[],isAnimationFinished:!0}:e.isAnimationActive&&e.animationId!==t.prevAnimationId?{prevAnimationId:e.animationId,curSectors:e.sectors,prevSectors:t.curSectors,isAnimationFinished:!0}:e.sectors!==t.curSectors?{curSectors:e.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(e,t){return e>t?"start":e<t?"end":"middle"}},{key:"renderLabelLineItem",value:function(e,t,n){if(s.isValidElement(e))return s.cloneElement(e,t);if(Qd()(e))return e(t);var r=Cd("recharts-pie-label-line","boolean"!==typeof e?e.className:"");return s.createElement(K_,HO({},t,{key:n,type:"linear",className:r}))}},{key:"renderLabelItem",value:function(e,t,n){if(s.isValidElement(e))return s.cloneElement(e,t);var r=n;if(Qd()(e)&&(r=e(t),s.isValidElement(r)))return r;var a=Cd("recharts-pie-label-text","boolean"===typeof e||Qd()(e)?"":e.className);return s.createElement(Xg,HO({},t,{alignmentBaseline:"middle",className:a}),r)}}],(r=[{key:"isActiveIndex",value:function(e){var t=this.props.activeIndex;return Array.isArray(t)?-1!==t.indexOf(e):e===t}},{key:"hasActiveIndex",value:function(){var e=this.props.activeIndex;return Array.isArray(e)?0!==e.length:e||0===e}},{key:"renderLabels",value:function(e){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var n=this.props,r=n.label,a=n.labelLine,o=n.dataKey,i=n.valueKey,l=Nu(this.props,!1),c=Nu(r,!1),d=Nu(a,!1),u=r&&r.offsetRadius||20,m=e.map(function(e,n){var m=(e.startAngle+e.endAngle)/2,h=ek(e.cx,e.cy,e.outerRadius+u,m),p=GO(GO(GO(GO({},l),e),{},{stroke:"none"},c),{},{index:n,textAnchor:t.getTextAnchor(h.x,e.cx)},h),f=GO(GO(GO(GO({},l),e),{},{fill:"none",stroke:e.fill},d),{},{index:n,points:[ek(e.cx,e.cy,e.outerRadius,m),h]}),g=o;return Fd()(o)&&Fd()(i)?g="value":Fd()(o)&&(g=i),s.createElement(Gu,{key:"label-".concat(e.startAngle,"-").concat(e.endAngle,"-").concat(e.midAngle,"-").concat(n)},a&&t.renderLabelLineItem(a,f,"line"),t.renderLabelItem(r,p,aN(e,g)))});return s.createElement(Gu,{className:"recharts-pie-labels"},m)}},{key:"renderSectorsStatically",value:function(e){var t=this,n=this.props,r=n.activeShape,a=n.blendStroke,o=n.inactiveShape;return e.map(function(n,i){if(0===(null===n||void 0===n?void 0:n.startAngle)&&0===(null===n||void 0===n?void 0:n.endAngle)&&1!==e.length)return null;var l=t.isActiveIndex(i),c=o&&t.hasActiveIndex()?o:null,d=l?r:c,u=GO(GO({},n),{},{stroke:a?n.fill:n.stroke,tabIndex:-1});return s.createElement(Gu,HO({ref:function(e){e&&!t.sectorRefs.includes(e)&&t.sectorRefs.push(e)},tabIndex:-1,className:"recharts-pie-sector"},cu(t.props,n,i),{key:"sector-".concat(null===n||void 0===n?void 0:n.startAngle,"-").concat(null===n||void 0===n?void 0:n.endAngle,"-").concat(n.midAngle,"-").concat(i)}),s.createElement(fS,HO({option:d,isActive:l,shapeType:"sector"},u)))})}},{key:"renderSectorsWithAnimation",value:function(){var e=this,t=this.props,n=t.sectors,r=t.isAnimationActive,a=t.animationBegin,o=t.animationDuration,i=t.animationEasing,l=t.animationId,c=this.state,d=c.prevSectors,u=c.prevIsAnimationActive;return s.createElement(Vf,{begin:a,duration:o,isActive:r,easing:i,from:{t:0},to:{t:1},key:"pie-".concat(l,"-").concat(u),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(t){var r=t.t,a=[],o=(n&&n[0]).startAngle;return n.forEach(function(e,t){var n=d&&d[t],s=t>0?Md()(e,"paddingAngle",0):0;if(n){var i=Gd(n.endAngle-n.startAngle,e.endAngle-e.startAngle),l=GO(GO({},e),{},{startAngle:o+s,endAngle:o+i(r)+s});a.push(l),o=l.endAngle}else{var c=e.endAngle,u=e.startAngle,m=Gd(0,c-u)(r),h=GO(GO({},e),{},{startAngle:o+s,endAngle:o+m+s});a.push(h),o=h.endAngle}}),s.createElement(Gu,null,e.renderSectorsStatically(a))})}},{key:"attachKeyboardHandlers",value:function(e){var t=this;e.onkeydown=function(e){if(!e.altKey)switch(e.key){case"ArrowLeft":var n=++t.state.sectorToFocus%t.sectorRefs.length;t.sectorRefs[n].focus(),t.setState({sectorToFocus:n});break;case"ArrowRight":var r=--t.state.sectorToFocus<0?t.sectorRefs.length-1:t.state.sectorToFocus%t.sectorRefs.length;t.sectorRefs[r].focus(),t.setState({sectorToFocus:r});break;case"Escape":t.sectorRefs[t.state.sectorToFocus].blur(),t.setState({sectorToFocus:0})}}}},{key:"renderSectors",value:function(){var e=this.props,t=e.sectors,n=e.isAnimationActive,r=this.state.prevSectors;return!(n&&t&&t.length)||r&&rj()(r,t)?this.renderSectorsStatically(t):this.renderSectorsWithAnimation()}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var e=this,t=this.props,n=t.hide,r=t.sectors,a=t.className,o=t.label,i=t.cx,l=t.cy,c=t.innerRadius,d=t.outerRadius,u=t.isAnimationActive,m=this.state.isAnimationFinished;if(n||!r||!r.length||!zd(i)||!zd(l)||!zd(c)||!zd(d))return null;var h=Cd("recharts-pie",a);return s.createElement(Gu,{tabIndex:this.props.rootTabIndex,className:h,ref:function(t){e.pieRef=t}},this.renderSectors(),o&&this.renderLabels(r),gk.renderCallByParent(this.props,null,!1),(!u||m)&&Rk.renderCallByParent(this.props,r,!1))}}])&&XO(n.prototype,r),a&&XO(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(s.PureComponent);VO=tA,ZO(tA,"displayName","Pie"),ZO(tA,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!vm.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0}),ZO(tA,"parseDeltaAngle",function(e,t){return Bd(t-e)*Math.min(Math.abs(t-e),360)}),ZO(tA,"getRealPieData",function(e){var t=e.data,n=e.children,r=Nu(e,!1),a=yu(n,Nk);return t&&t.length?t.map(function(e,t){return GO(GO(GO({payload:e},r),e),a&&a[t]&&a[t].props)}):a&&a.length?a.map(function(e){return GO(GO({},r),e.props)}):[]}),ZO(tA,"parseCoordinateOfPie",function(e,t){var n=t.top,r=t.left,a=t.width,s=t.height,o=tk(a,s);return{cx:r+Hd(e.cx,a,a/2),cy:n+Hd(e.cy,s,s/2),innerRadius:Hd(e.innerRadius,o,0),outerRadius:Hd(e.outerRadius,o,.8*o),maxRadius:e.maxRadius||Math.sqrt(a*a+s*s)/2}}),ZO(tA,"getComposedData",function(e){var t=e.item,n=e.offset,r=void 0!==t.type.defaultProps?GO(GO({},t.type.defaultProps),t.props):t.props,a=VO.getRealPieData(r);if(!a||!a.length)return null;var s=r.cornerRadius,o=r.startAngle,i=r.endAngle,l=r.paddingAngle,c=r.dataKey,d=r.nameKey,u=r.valueKey,m=r.tooltipType,h=Math.abs(r.minAngle),p=VO.parseCoordinateOfPie(r,n),f=VO.parseDeltaAngle(o,i),g=Math.abs(f),x=c;Fd()(c)&&Fd()(u)?(Kd(!1,'Use "dataKey" to specify the value of pie,\n      the props "valueKey" will be deprecated in 1.1.0'),x="value"):Fd()(c)&&(Kd(!1,'Use "dataKey" to specify the value of pie,\n      the props "valueKey" will be deprecated in 1.1.0'),x=u);var y,b,v=a.filter(function(e){return 0!==aN(e,x,0)}).length,w=g-v*h-(g>=360?v:v-1)*l,j=a.reduce(function(e,t){var n=aN(t,x,0);return e+(zd(n)?n:0)},0);j>0&&(y=a.map(function(e,t){var n,r=aN(e,x,0),a=aN(e,d,t),i=(zd(r)?r:0)/j,c=(n=t?b.endAngle+Bd(f)*l*(0!==r?1:0):o)+Bd(f)*((0!==r?h:0)+i*w),u=(n+c)/2,g=(p.innerRadius+p.outerRadius)/2,y=[{name:a,value:r,payload:e,dataKey:x,type:m}],v=ek(p.cx,p.cy,g,u);return b=GO(GO(GO({percent:i,cornerRadius:s,name:a,tooltipPayload:y,midAngle:u,middleRadius:g,tooltipPosition:v},e),p),{},{value:aN(e,x),startAngle:n,endAngle:c,payload:e,paddingAngle:Bd(f)*l})}));return GO(GO({},p),{},{sectors:y,data:a})});var nA=qE({chartName:"PieChart",GraphicalChild:tA,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:NO},{axisType:"radiusAxis",AxisComp:WO}],formatAxisMap:function(e,t,n,r,a){var s=e.width,o=e.height,i=e.startAngle,l=e.endAngle,c=Hd(e.cx,s,s/2),d=Hd(e.cy,o,o/2),u=tk(s,o,n),m=Hd(e.innerRadius,u,0),h=Hd(e.outerRadius,u,.8*u);return Object.keys(t).reduce(function(e,n){var s,o=t[n],u=o.domain,p=o.reversed;if(Fd()(o.range))"angleAxis"===r?s=[i,l]:"radiusAxis"===r&&(s=[m,h]),p&&(s=[s[1],s[0]]);else{var f=KN(s=o.range,2);i=f[0],l=f[1]}var g=pN(o,a),x=g.realScaleType,y=g.scale;y.domain(u).range(s),gN(y);var b=bN(y,XN(XN({},o),{},{realScaleType:x})),v=XN(XN(XN({},o),b),{},{range:s,radius:h,realScaleType:x,scale:y,cx:c,cy:d,innerRadius:m,outerRadius:h,startAngle:i,endAngle:l});return XN(XN({},e),{},$N({},n,v))},{})},defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const rA={assigned:"#3B82F6",booked:"#10B981",arrived:"#8B5CF6",left:"#6366F1",noSale:"#F97316",complete:"#EC4899",noShow:"#EF4444",cancelled:"#6B7280",noAnswer:"#F59E0B",noAnswerX2:"#D97706",noAnswerX3:"#92400E",sales:"#FBBF24"},aA=()=>{const{user:e}=Nr(),{socket:t}=Xa(),[n,r]=(0,s.useState)({assigned:0,booked:0,attended:0,sales:0,revenue:0,arrived:0,left:0,noSale:0,complete:0,noShows:0,cancelled:0,noAnswer:0,noAnswerX2:0,noAnswerX3:0,bookingRate:0,showUpRate:0,salesConversion:0}),[a,o]=(0,s.useState)(!1),[i,l]=(0,s.useState)(()=>({startDate:"2026-02-02",endDate:"2026-02-08",userId:"admin"===(null===e||void 0===e?void 0:e.role)?"all":(null===e||void 0===e?void 0:e.id)||""})),[c,d]=(0,s.useState)([]),[u,m]=(0,s.useState)(null),h=(0,s.useCallback)(async()=>{try{const e=await xr.get("/api/users");d([{id:"all",name:"All Users"},...e.data.filter(e=>"booker"===e.role||"admin"===e.role)])}catch(e){console.error("Error fetching users:",e),d([{id:"all",name:"All Users"}])}},[]),p=(0,s.useCallback)(async()=>{o(!0);try{const e=new Date(i.startDate+"T00:00:00.000Z").toISOString(),t=new Date(i.endDate+"T23:59:59.999Z").toISOString();console.log("\ud83d\udcca Fetching stats:",{startUTC:e,endUTC:t,userId:i.userId});const n={date_start:e,date_end:t};"all"!==i.userId&&(n.booker=i.userId);const[a,s]=await Promise.all([xr.get("/api/stats/leads",{params:n}),xr.get("/api/sales/stats",{params:Ye({dateRange:"custom",startDate:e,endDate:t},"all"!==i.userId?{booker:i.userId}:{})}).catch(()=>({data:{}}))]),o=a.data,l=s.data;console.log("\ud83d\udcca Stats API response:",o),console.log("\ud83d\udcb0 Sales API response:",l);const c=o.assigned||0,d=o.booked||0,u=o.attendedFilter||0,h=l.totalSales||0,p=l.totalRevenue||0,f=o.arrived||0,g=o.leftBuilding||0,x=o.noSale||0,y=o.complete||0,b=o.noShow||0,v=o.cancelledFilter||0,w=o.noAnswerCall||0,j=o.noAnswerX2||0,N=o.noAnswerX3||0,k=c>0?Math.round(d/c*100):0,S=d>0?Math.round(u/d*100):0,C={assigned:c,booked:d,attended:u,sales:h,revenue:p,arrived:f,left:g,noSale:x,complete:y,noShows:b,cancelled:v,noAnswer:w,noAnswerX2:j,noAnswerX3:N,bookingRate:k,showUpRate:S,salesConversion:u>0?Math.round(h/u*100):0};r(C),m(new Date),console.log("\ud83d\udcca Calculated stats:",C)}catch(e){console.error("Error fetching stats:",e)}o(!1)},[i]);(0,s.useEffect)(()=>{"admin"===(null===e||void 0===e?void 0:e.role)&&h(),p()},[e,h,p]),(0,s.useEffect)(()=>{if(t){const e=()=>{p(),m(new Date)};return t.on("lead_updated",e),t.on("stats_update_needed",e),()=>{t.off("lead_updated",e),t.off("stats_update_needed",e)}}},[t,p]);const f=[{name:"Arrived",value:n.arrived,color:rA.arrived},{name:"Left",value:n.left,color:rA.left},{name:"No Sale",value:n.noSale,color:rA.noSale},{name:"Complete",value:n.complete,color:rA.complete},{name:"No Show",value:n.noShows,color:rA.noShow}].filter(e=>e.value>0),g=[{name:"No Answer",value:n.noAnswer,color:rA.noAnswer},{name:"No Answer x2",value:n.noAnswerX2,color:rA.noAnswerX2},{name:"No Answer x3",value:n.noAnswerX3,color:rA.noAnswerX3}].filter(e=>e.value>0),x=([{name:"Booked",value:n.booked,color:rA.booked},{name:"No Answer (all)",value:n.noAnswer+n.noAnswerX2+n.noAnswerX3,color:rA.noAnswer},{name:"Not Interested",value:n.assigned>0?Math.round(.3*n.assigned):0,color:rA.cancelled}].filter(e=>e.value>0),[{name:"Assigned",value:n.assigned,fill:rA.assigned},{name:"Booked",value:n.booked,fill:rA.booked},{name:"Attended",value:n.attended,fill:rA.arrived},{name:"Sales",value:n.sales,fill:rA.sales}]),y=(e,t)=>{l(n=>Ye(Ye({},n),{},{[e]:t}))},b=e=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(e),v=e=>{let{active:t,payload:n}=e;return t&&n&&n.length?(0,yr.jsxs)("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-lg",children:[(0,yr.jsx)("p",{className:"font-semibold",children:n[0].name}),(0,yr.jsx)("p",{className:"text-lg",children:n[0].value})]}):null};return(0,yr.jsxs)("div",{className:"space-y-6",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"\ud83d\udcca Performance Reports"}),(0,yr.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Booker performance analytics and conversion metrics",u&&(0,yr.jsxs)("span",{className:"ml-2 text-green-600",children:["\u2022 Updated ",u.toLocaleTimeString()]})]})]}),(0,yr.jsxs)("button",{onClick:()=>{const e="\nCRM Performance Report\nGenerated: ".concat((new Date).toLocaleString(),"\nPeriod: ").concat(i.startDate," to ").concat(i.endDate,"\n\nSUMMARY:\n- Leads Assigned: ").concat(n.assigned,"\n- Total Booked: ").concat(n.booked,"\n- Attended: ").concat(n.attended,"\n- Sales: ").concat(n.sales,"\n- Revenue: ").concat(b(n.revenue),"\n\nATTENDANCE BREAKDOWN:\n- Arrived: ").concat(n.arrived,"\n- Left: ").concat(n.left,"\n- No Sale: ").concat(n.noSale,"\n- Complete: ").concat(n.complete,"\n- No Shows: ").concat(n.noShows,"\n\nNO ANSWER BREAKDOWN:\n- No Answer: ").concat(n.noAnswer,"\n- No Answer x2: ").concat(n.noAnswerX2,"\n- No Answer x3: ").concat(n.noAnswerX3,"\n\nRATES:\n- Booking Rate: ").concat(n.bookingRate,"%\n- Show Up Rate: ").concat(n.showUpRate,"%\n- Sales Conversion: ").concat(n.salesConversion,"%\n    ").trim(),t=new Blob([e],{type:"text/plain"}),r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download="report-".concat(i.startDate,"-to-").concat(i.endDate,".txt"),a.click(),URL.revokeObjectURL(r)},className:"btn-primary flex items-center space-x-2",children:[(0,yr.jsx)(ks,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Export"})]})]}),(0,yr.jsx)("div",{className:"card bg-gradient-to-r from-blue-50 to-indigo-50",children:(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(hs,{className:"inline h-4 w-4 mr-1"}),"Start Date"]}),(0,yr.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",value:i.startDate,onChange:e=>y("startDate",e.target.value)})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(hs,{className:"inline h-4 w-4 mr-1"}),"End Date"]}),(0,yr.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",value:i.endDate,onChange:e=>y("endDate",e.target.value)})]}),"admin"===(null===e||void 0===e?void 0:e.role)&&(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(vo,{className:"inline h-4 w-4 mr-1"}),"Booker"]}),(0,yr.jsx)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",value:i.userId,onChange:e=>y("userId",e.target.value),children:c.map(e=>(0,yr.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,yr.jsx)("div",{className:"flex items-end",children:(0,yr.jsx)("button",{onClick:p,disabled:a,className:"btn-primary w-full flex items-center justify-center space-x-2",children:a?(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(to,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Generate"})]})})})]})}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,yr.jsx)("div",{className:"card bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"text-blue-100 text-sm",children:"Assigned"}),(0,yr.jsx)("p",{className:"text-3xl font-bold",children:n.assigned})]}),(0,yr.jsx)(vo,{className:"h-10 w-10 text-blue-200"})]})}),(0,yr.jsxs)("div",{className:"card bg-gradient-to-br from-green-500 to-green-600 text-white",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"text-green-100 text-sm",children:"Booked"}),(0,yr.jsx)("p",{className:"text-3xl font-bold",children:n.booked})]}),(0,yr.jsx)(hs,{className:"h-10 w-10 text-green-200"})]}),(0,yr.jsxs)("p",{className:"text-sm mt-2",children:[n.bookingRate,"% booking rate"]})]}),(0,yr.jsxs)("div",{className:"card bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"text-purple-100 text-sm",children:"Attended"}),(0,yr.jsx)("p",{className:"text-3xl font-bold",children:n.attended})]}),(0,yr.jsx)(gs,{className:"h-10 w-10 text-purple-200"})]}),(0,yr.jsxs)("p",{className:"text-sm mt-2",children:[n.showUpRate,"% show up rate"]})]}),(0,yr.jsxs)("div",{className:"card bg-gradient-to-br from-yellow-500 to-yellow-600 text-white",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"text-yellow-100 text-sm",children:"Sales"}),(0,yr.jsx)("p",{className:"text-3xl font-bold",children:n.sales})]}),(0,yr.jsx)(Ns,{className:"h-10 w-10 text-yellow-200"})]}),(0,yr.jsxs)("p",{className:"text-sm mt-2",title:"Revenue from sales in selected date range",children:[b(n.revenue)," revenue"]})]})]}),(0,yr.jsxs)("div",{className:"card",children:[(0,yr.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,yr.jsx)(po,{className:"h-5 w-5 mr-2 text-blue-600"}),"Conversion Funnel"]}),(0,yr.jsx)("div",{className:"h-64",children:(0,yr.jsx)(Du,{width:"100%",height:"100%",children:(0,yr.jsxs)(RP,{data:x,layout:"vertical",children:[(0,yr.jsx)(tO,{strokeDasharray:"3 3"}),(0,yr.jsx)(SP,{type:"number"}),(0,yr.jsx)(LP,{dataKey:"name",type:"category",width:80}),(0,yr.jsx)(Im,{content:(0,yr.jsx)(v,{})}),(0,yr.jsx)(GS,{dataKey:"value",radius:[0,4,4,0]})]})})}),(0,yr.jsxs)("div",{className:"grid grid-cols-3 gap-4 mt-4 text-center",children:[(0,yr.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg",children:[(0,yr.jsxs)("p",{className:"text-2xl font-bold text-blue-900",children:[n.bookingRate,"%"]}),(0,yr.jsx)("p",{className:"text-sm text-blue-700",children:"Booking Rate"})]}),(0,yr.jsxs)("div",{className:"p-3 bg-purple-50 rounded-lg",children:[(0,yr.jsxs)("p",{className:"text-2xl font-bold text-purple-900",children:[n.showUpRate,"%"]}),(0,yr.jsx)("p",{className:"text-sm text-purple-700",children:"Show Up Rate"})]}),(0,yr.jsxs)("div",{className:"p-3 bg-yellow-50 rounded-lg",children:[(0,yr.jsxs)("p",{className:"text-2xl font-bold text-yellow-900",children:[n.salesConversion,"%"]}),(0,yr.jsx)("p",{className:"text-sm text-yellow-700",children:"Sales Conversion"})]})]})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,yr.jsxs)("div",{className:"card",children:[(0,yr.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,yr.jsx)(Qs,{className:"h-5 w-5 mr-2 text-purple-600"}),"Attendance Breakdown"]}),f.length>0?(0,yr.jsx)("div",{className:"h-64",children:(0,yr.jsx)(Du,{width:"100%",height:"100%",children:(0,yr.jsxs)(nA,{children:[(0,yr.jsx)(tA,{data:f,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:f.map((e,t)=>(0,yr.jsx)(Nk,{fill:e.color},"cell-".concat(t)))}),(0,yr.jsx)(Im,{content:(0,yr.jsx)(v,{})}),(0,yr.jsx)(dp,{})]})})}):(0,yr.jsx)("div",{className:"h-64 flex items-center justify-center text-gray-400",children:"No attendance data"}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[(0,yr.jsxs)("div",{className:"flex items-center text-sm",children:[(0,yr.jsx)("div",{className:"w-3 h-3 rounded-full mr-2",style:{background:rA.arrived}}),(0,yr.jsxs)("span",{children:["Arrived: ",n.arrived]})]}),(0,yr.jsxs)("div",{className:"flex items-center text-sm",children:[(0,yr.jsx)("div",{className:"w-3 h-3 rounded-full mr-2",style:{background:rA.left}}),(0,yr.jsxs)("span",{children:["Left: ",n.left]})]}),(0,yr.jsxs)("div",{className:"flex items-center text-sm",children:[(0,yr.jsx)("div",{className:"w-3 h-3 rounded-full mr-2",style:{background:rA.noSale}}),(0,yr.jsxs)("span",{children:["No Sale: ",n.noSale]})]}),(0,yr.jsxs)("div",{className:"flex items-center text-sm",children:[(0,yr.jsx)("div",{className:"w-3 h-3 rounded-full mr-2",style:{background:rA.complete}}),(0,yr.jsxs)("span",{children:["Complete: ",n.complete]})]}),(0,yr.jsxs)("div",{className:"flex items-center text-sm",children:[(0,yr.jsx)("div",{className:"w-3 h-3 rounded-full mr-2",style:{background:rA.noShow}}),(0,yr.jsxs)("span",{children:["No Show: ",n.noShows]})]})]})]}),(0,yr.jsxs)("div",{className:"card",children:[(0,yr.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,yr.jsx)(Js,{className:"h-5 w-5 mr-2 text-amber-600"}),"No Answer Breakdown"]}),g.length>0?(0,yr.jsx)("div",{className:"h-64",children:(0,yr.jsx)(Du,{width:"100%",height:"100%",children:(0,yr.jsxs)(nA,{children:[(0,yr.jsx)(tA,{data:g,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:g.map((e,t)=>(0,yr.jsx)(Nk,{fill:e.color},"cell-".concat(t)))}),(0,yr.jsx)(Im,{content:(0,yr.jsx)(v,{})}),(0,yr.jsx)(dp,{})]})})}):(0,yr.jsx)("div",{className:"h-64 flex items-center justify-center text-gray-400",children:"No no-answer data"}),(0,yr.jsxs)("div",{className:"mt-4 p-4 bg-amber-50 rounded-lg text-center",children:[(0,yr.jsx)("p",{className:"text-3xl font-bold text-amber-900",children:n.noAnswer+n.noAnswerX2+n.noAnswerX3}),(0,yr.jsx)("p",{className:"text-sm text-amber-700",children:"Total No Answer"})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-3 gap-2 mt-4 text-center text-sm",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"font-bold text-amber-700",children:n.noAnswer}),(0,yr.jsx)("p",{className:"text-gray-500",children:"1st"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"font-bold text-amber-700",children:n.noAnswerX2}),(0,yr.jsx)("p",{className:"text-gray-500",children:"2nd"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"font-bold text-amber-700",children:n.noAnswerX3}),(0,yr.jsx)("p",{className:"text-gray-500",children:"3rd"})]})]})]}),(0,yr.jsxs)("div",{className:"card",children:[(0,yr.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,yr.jsx)(ds,{className:"h-5 w-5 mr-2 text-green-600"}),"Key Metrics"]}),(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsx)("span",{className:"text-gray-600",children:"Assigned to Booked"}),(0,yr.jsxs)("span",{className:"text-2xl font-bold text-green-600",children:[n.assigned>0?Math.round(n.booked/n.assigned*100):0,"%"]})]}),(0,yr.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,yr.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"".concat(n.assigned>0?n.booked/n.assigned*100:0,"%")}})})]}),(0,yr.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsx)("span",{className:"text-gray-600",children:"Booked to Attended"}),(0,yr.jsxs)("span",{className:"text-2xl font-bold text-purple-600",children:[n.booked>0?Math.round(n.attended/n.booked*100):0,"%"]})]}),(0,yr.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,yr.jsx)("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:"".concat(n.booked>0?n.attended/n.booked*100:0,"%")}})})]}),(0,yr.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsx)("span",{className:"text-gray-600",children:"Attended to Sales"}),(0,yr.jsxs)("span",{className:"text-2xl font-bold text-yellow-600",children:[n.attended>0?Math.round(n.sales/n.attended*100):0,"%"]})]}),(0,yr.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,yr.jsx)("div",{className:"bg-yellow-500 h-2 rounded-full",style:{width:"".concat(n.attended>0?n.sales/n.attended*100:0,"%")}})})]}),(0,yr.jsxs)("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-green-50 rounded-lg",children:[(0,yr.jsx)("p",{className:"text-sm text-gray-600",children:"Revenue per Attended"}),(0,yr.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:n.attended>0?b(n.revenue/n.attended):b(0)})]})]})]})]}),(0,yr.jsxs)("div",{className:"card",children:[(0,yr.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,yr.jsx)(ss,{className:"h-5 w-5 mr-2 text-blue-600"}),"Detailed Statistics"]}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[(0,yr.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,yr.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:n.assigned}),(0,yr.jsx)("p",{className:"text-xs text-blue-700",children:"Assigned"})]}),(0,yr.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,yr.jsx)("p",{className:"text-2xl font-bold text-green-900",children:n.booked}),(0,yr.jsx)("p",{className:"text-xs text-green-700",children:"Booked"})]}),(0,yr.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,yr.jsx)("p",{className:"text-2xl font-bold text-purple-900",children:n.arrived}),(0,yr.jsx)("p",{className:"text-xs text-purple-700",children:"Arrived"})]}),(0,yr.jsxs)("div",{className:"text-center p-4 bg-indigo-50 rounded-lg",children:[(0,yr.jsx)("p",{className:"text-2xl font-bold text-indigo-900",children:n.left}),(0,yr.jsx)("p",{className:"text-xs text-indigo-700",children:"Left"})]}),(0,yr.jsxs)("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[(0,yr.jsx)("p",{className:"text-2xl font-bold text-orange-900",children:n.noSale}),(0,yr.jsx)("p",{className:"text-xs text-orange-700",children:"No Sale"})]}),(0,yr.jsxs)("div",{className:"text-center p-4 bg-pink-50 rounded-lg",children:[(0,yr.jsx)("p",{className:"text-2xl font-bold text-pink-900",children:n.complete}),(0,yr.jsx)("p",{className:"text-xs text-pink-700",children:"Complete"})]}),(0,yr.jsxs)("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[(0,yr.jsx)("p",{className:"text-2xl font-bold text-red-900",children:n.noShows}),(0,yr.jsx)("p",{className:"text-xs text-red-700",children:"No Shows"})]}),(0,yr.jsxs)("div",{className:"text-center p-4 bg-gray-100 rounded-lg",children:[(0,yr.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:n.cancelled}),(0,yr.jsx)("p",{className:"text-xs text-gray-700",children:"Cancelled"})]}),(0,yr.jsxs)("div",{className:"text-center p-4 bg-amber-50 rounded-lg",children:[(0,yr.jsx)("p",{className:"text-2xl font-bold text-amber-900",children:n.noAnswer}),(0,yr.jsx)("p",{className:"text-xs text-amber-700",children:"No Answer"})]}),(0,yr.jsxs)("div",{className:"text-center p-4 bg-amber-50 rounded-lg",children:[(0,yr.jsx)("p",{className:"text-2xl font-bold text-amber-900",children:n.noAnswerX2}),(0,yr.jsx)("p",{className:"text-xs text-amber-700",children:"No Answer x2"})]}),(0,yr.jsxs)("div",{className:"text-center p-4 bg-amber-50 rounded-lg",children:[(0,yr.jsx)("p",{className:"text-2xl font-bold text-amber-900",children:n.noAnswerX3}),(0,yr.jsx)("p",{className:"text-xs text-amber-700",children:"No Answer x3"})]}),(0,yr.jsxs)("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[(0,yr.jsx)("p",{className:"text-2xl font-bold text-yellow-900",children:n.sales}),(0,yr.jsx)("p",{className:"text-xs text-yellow-700",children:"Sales"})]})]})]})]})},sA=()=>{var e,t,n,r,a,o;const i=$(),l=J(),{user:c}=Nr(),[d,u]=(0,s.useState)([]),[m,h]=(0,s.useState)(!0),[p,f]=(0,s.useState)(!1),[g,x]=(0,s.useState)(null),[y,b]=(0,s.useState)(!1),[v,w]=(0,s.useState)(null),[j,N]=(0,s.useState)([]),[k,S]=(0,s.useState)(""),[C,_]=(0,s.useState)([]),[E,P]=(0,s.useState)([]),O=(0,s.useRef)(null),A=(0,s.useRef)(null),T=(0,s.useRef)(null),D=(0,s.useRef)(null),[M,I]=(0,s.useState)({name:"",type:"admin"===(null===c||void 0===c?void 0:c.role)?"booking_confirmation":"custom",subject:"",emailBody:"",smsBody:"",reminderDays:5,sendEmail:!0,sendSMS:!0,isActive:!0,emailAccount:"",attachments:[]}),[L,R]=(0,s.useState)((null===(e=i.state)||void 0===e?void 0:e.category)||"All");(0,s.useEffect)(()=>{var e;null!==(e=i.state)&&void 0!==e&&e.category&&R(i.state.category)},[null===(t=i.state)||void 0===t?void 0:t.category]),(0,s.useEffect)(()=>{F(),U(),B(),"admin"===(null===c||void 0===c?void 0:c.role)&&z()},[c]),(0,s.useEffect)(()=>{p&&M.type&&U(M.type)},[M.type,p]);const F=async()=>{try{console.log("\ud83d\udd04 Fetching templates...");const e=await fetch("/api/templates",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"},cache:"no-store"});if(e.ok){const t=await e.json();console.log("\ud83d\udce5 Fetched templates:",t.length,"templates"),u(t)}else console.error("\u274c Failed to fetch templates:",e.status,e.statusText)}catch(e){console.error("Error fetching templates:",e)}finally{h(!1)}},B=async()=>{try{const e=await fetch("/api/email-accounts/dropdown",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(e.ok){const t=await e.json();P(t)}}catch(e){console.error("Error fetching email accounts:",e)}},U=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=e?"?type=".concat(e):"",n=await fetch("/api/templates/variables/list".concat(t),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(n.ok){const e=await n.json();_(e)}}catch(t){console.error("Error fetching variables:",t)}},z=async()=>{try{const e=await fetch("/api/leads?limit=100",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(e.ok){const t=await e.json();N(t.leads)}}catch(e){console.error("Error fetching leads:",e)}},V=()=>{I({name:"",type:"admin"===(null===c||void 0===c?void 0:c.role)?"booking_confirmation":"custom",subject:"",emailBody:"",smsBody:"",reminderDays:5,sendEmail:!0,sendSMS:!0,isActive:!0,emailAccount:"",attachments:[]})},W=(e,t)=>{D.current=t.current},q="admin"!==(null===c||void 0===c?void 0:c.role);return(0,yr.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,yr.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,yr.jsx)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Message Templates"}),(0,yr.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage email and SMS templates for automatic messaging"})]}),(0,yr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,yr.jsxs)("button",{onClick:()=>l("/bookers-templates"),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-indigo-700",title:"Manage templates for Lead Details",children:[(0,yr.jsx)(_s,{})," Bookers Templates"]}),(0,yr.jsxs)("button",{onClick:()=>{x(null),V(),f(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-700",children:[(0,yr.jsx)(eo,{})," New Template"]})]})]})}),m?(0,yr.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,yr.jsxs)("div",{className:"animate-pulse",children:[(0,yr.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsx)("div",{className:"h-4 bg-gray-200 rounded"}),(0,yr.jsx)("div",{className:"h-4 bg-gray-200 rounded w-5/6"})]})]})}):!m&&(()=>{let e=d||[];if(q){e=e.filter(e=>e.user_id===(null===c||void 0===c?void 0:c.id));const t=["booking_confirmation","reschedule","cancellation"];e=e.filter(e=>!t.includes(e.type))}const t=((e,t)=>{if(!e||!Array.isArray(e))return{"Diary Templates":[],"Sale Templates":[],"Lead Details Templates":[]};const n="admin"!==t,r={"Diary Templates":["booking_confirmation","reschedule","cancellation","secondary_confirmation"],"Bookers Templates":["no_answer","no_photo","invitation_email"],"Sale Templates":["sale_confirmation","sale_followup","sale","sale_notification","sale_paid_in_full","sale_followup_paid","sale_finance_agreement","sale_followup_finance","contract_signing","contract_delivery"],Receipts:["receipt","sale_receipt","payment_receipt"],"Lead Details Templates":["custom","booker"]},a={"Diary Templates":[],"Bookers Templates":[],"Sale Templates":[],Receipts:[],"Lead Details Templates":[]};return e.forEach(e=>{let t=!1;for(const[n,s]of Object.entries(r))if(s.includes(e.type)){a[n].push(e),t=!0;break}t||a["Diary Templates"].push(e)}),n&&(delete a["Diary Templates"],delete a["Bookers Templates"]),a})("All"===L?e:e.filter(e=>{const t=Object.entries({"Diary Templates":["booking_confirmation","reschedule","cancellation","secondary_confirmation"],"Bookers Templates":["no_answer","no_photo","invitation_email"],"Sale Templates":["sale_confirmation","sale_followup","sale","sale_notification","sale_paid_in_full","sale_followup_paid","sale_finance_agreement","sale_followup_finance","contract_signing","contract_delivery"],"Lead Details Templates":["custom","booker"]}).find(t=>{let[n,r]=t;return r.includes(e.type)});return t?t[0]===L:"Diary Templates"===L}),null===c||void 0===c?void 0:c.role);return Object.entries(t).map(e=>{let[t,n]=e;return n&&n.length>0&&(0,yr.jsxs)("div",{className:"mb-8",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yr.jsx)("h2",{className:"text-xl font-bold",children:t}),"Lead Details Templates"===t&&(0,yr.jsxs)("button",{onClick:()=>l("/bookers-templates"),className:"text-sm text-indigo-600 hover:text-indigo-800 flex items-center gap-1 font-medium",children:[(0,yr.jsx)(_s,{className:"h-4 w-4"}),"Manage in Bookers Templates"]})]}),(0,yr.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(e=>{var n;return(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,yr.jsx)("p",{className:"text-sm text-gray-500 capitalize",children:e.type.replace("_"," ")}),(null===(n=e.creator)||void 0===n?void 0:n.name)&&"Bookers Templates"===t&&(0,yr.jsxs)("p",{className:"text-xs text-blue-600 mt-1",children:[(0,yr.jsx)("span",{className:"font-medium",children:"By:"})," ",e.creator.name]})]}),(0,yr.jsxs)("div",{className:"flex items-center gap-2",children:[e.sendEmail&&(0,yr.jsx)(Vs,{className:"text-blue-500"}),e.sendSMS&&(0,yr.jsx)(Js,{className:"text-green-500"}),e.attachments&&(()=>{try{const t=JSON.parse(e.attachments);return Array.isArray(t)&&t.length>0&&(0,yr.jsxs)("div",{className:"flex items-center gap-1 text-purple-600",title:"".concat(t.length," attachment(s)"),children:[(0,yr.jsx)("span",{className:"text-xs",children:"\ud83d\udcce"}),(0,yr.jsx)("span",{className:"text-xs font-medium",children:t.length})]})}catch(FB){return null}})()]})]}),(0,yr.jsx)("div",{className:"mb-4",children:(0,yr.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.subject})}),(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsx)("div",{className:"flex items-center gap-2",children:(0,yr.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(e.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.isActive?"Active":"Inactive"})}),(0,yr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yr.jsx)("button",{onClick:()=>(e=>{w({template:{name:e.name,type:e.type,subject:e.subject,emailBody:e.emailBody||e.email_body,smsBody:e.smsBody||e.sms_body,sendEmail:e.sendEmail||e.send_email,sendSMS:e.sendSMS||e.send_sms}}),b(!0)})(e),className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Preview",children:(0,yr.jsx)(Ps,{})}),(0,yr.jsx)("button",{onClick:()=>(async e=>{x(e);let t=[];if(e._id)try{const n=await fetch("/api/templates/".concat(e._id),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(n.ok){const e=await n.json();if(e.attachments)try{t=JSON.parse(e.attachments)}catch(FB){console.warn("Failed to parse attachments:",FB)}}}catch(n){console.error("Error loading template attachments:",n)}I({name:e.name,type:e.type,subject:e.subject,emailBody:e.emailBody,smsBody:e.smsBody,reminderDays:e.reminderDays||5,sendEmail:e.sendEmail,sendSMS:e.sendSMS,isActive:e.isActive,emailAccount:e.email_account||e.emailAccount||"",attachments:Array.isArray(t)?t:[]}),f(!0)})(e),className:"p-2 text-gray-600 hover:text-green-600 hover:bg-green-50 rounded",title:"Edit",children:(0,yr.jsx)(Cs,{})}),(0,yr.jsx)("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this template?"))try{const t=await fetch("/api/templates/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(t.ok)F();else{const e=await t.json();alert(e.message||"Error deleting template")}}catch(t){console.error("Error deleting template:",t),alert("Error deleting template")}})(e._id),className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded",title:"Delete",children:(0,yr.jsx)(ho,{})})]})]}),"admin"===(null===c||void 0===c?void 0:c.role)&&(0,yr.jsx)("div",{className:"mt-4 pt-4 border-t",children:(0,yr.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,yr.jsxs)("select",{value:k,onChange:e=>S(e.target.value),className:"px-2 py-1 border border-gray-300 rounded text-xs max-w-xs w-48 focus:ring-1 focus:ring-purple-400",style:{minWidth:0},children:[(0,yr.jsx)("option",{value:"",children:"Select lead to test..."},"select-lead-placeholder"),(j||[]).map((e,t)=>(0,yr.jsxs)("option",{value:e.id,children:[e.name," (",e.email,")"]},"lead-".concat(e.id||t)))]}),(0,yr.jsxs)("button",{onClick:()=>(async e=>{if(k)try{const t=await fetch("/api/templates/".concat(e._id,"/test/").concat(k),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(t.ok)alert("Test message sent successfully!");else{const e=await t.json();alert(e.message||"Error sending test message")}}catch(t){console.error("Error testing template:",t),alert("Error sending test message")}else alert("Please select a lead to test with")})(e),disabled:!k,className:"px-2 py-1 bg-purple-600 text-white rounded text-xs flex items-center gap-1 hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",title:"Send test message",style:{minWidth:0},children:[(0,yr.jsx)(ao,{size:14})," Test"]})]})})]},"template-".concat(e._id))})})]},t)})})(),p&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm overflow-y-auto h-full w-full z-50",children:(0,yr.jsxs)("div",{className:"relative top-5 mx-auto p-0 border-0 w-full max-w-6xl shadow-2xl rounded-2xl bg-white overflow-hidden",children:[(0,yr.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6",children:(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h3",{className:"text-2xl font-bold",children:g?"Edit Template":"Create New Template"}),(0,yr.jsx)("p",{className:"text-blue-100 mt-1",children:g?"Update your message template":"Design beautiful messages for your CRM"})]}),(0,yr.jsx)("button",{onClick:()=>f(!1),className:"text-white hover:text-blue-200 p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]})}),(0,yr.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{var t,n;const e=g?"/api/templates/".concat(g._id):"/api/templates",r=g?"PUT":"POST";console.log("\ud83d\udce4 Sending template data:",{url:e,method:r,templateId:null===g||void 0===g?void 0:g._id,formData:Ye(Ye({},M),{},{emailBody:(null===(t=M.emailBody)||void 0===t?void 0:t.substring(0,50))+"...",smsBody:(null===(n=M.smsBody)||void 0===n?void 0:n.substring(0,50))+"..."})});const a=await fetch(e,{method:r,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(M)});if(a.ok){const e=await a.json();console.log("\u2705 Template saved successfully. Response:",{id:e._id||e.id,name:e.name,type:e.type}),f(!1),x(null),V(),await F(),alert("Template saved successfully! Changes will be applied to future messages.")}else{const e=await a.json();console.error("\u274c Save failed:",e),alert(e.message||"Error saving template")}}catch(r){console.error("\u274c Error saving template:",r),alert("Error saving template")}},className:"p-6",children:[(0,yr.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-8",children:[(0,yr.jsx)("div",{className:"xl:col-span-1",children:(0,yr.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6 h-fit",children:[(0,yr.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,yr.jsx)(so,{className:"text-blue-600"}),"Template Settings"]}),(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Template Name ",(0,yr.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,yr.jsx)("input",{type:"text",name:"name",value:M.name,onChange:e=>I(Ye(Ye({},M),{},{name:e.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Enter template name",required:!0})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Template Type ",(0,yr.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,yr.jsxs)("select",{name:"type",value:M.type,onChange:e=>I(Ye(Ye({},M),{},{type:e.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",required:!0,children:[!q&&(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("option",{value:"booking_confirmation",children:"\ud83d\udcc5 Booking Confirmation"},"booking_confirmation"),(0,yr.jsx)("option",{value:"secondary_confirmation",children:"\ud83d\udccb Secondary Confirmation"},"secondary_confirmation"),(0,yr.jsx)("option",{value:"reschedule",children:"\ud83d\udd04 Reschedule"},"reschedule"),(0,yr.jsx)("option",{value:"cancellation",children:"\ud83d\udeab Cancellation"},"cancellation")]}),(0,yr.jsx)("option",{value:"sale_confirmation",children:"\ud83d\udcb0 Sale Confirmation"},"sale_confirmation"),(0,yr.jsx)("option",{value:"sale_followup",children:"\ud83d\udcde Sale Follow-up"},"sale_followup"),(0,yr.jsx)("option",{value:"sale_paid_in_full",children:"\ud83c\udf89 Paid in Full - Welcome"},"sale_paid_in_full"),(0,yr.jsx)("option",{value:"sale_followup_paid",children:"\u2705 Paid in Full - Follow-up"},"sale_followup_paid"),(0,yr.jsx)("option",{value:"sale_finance_agreement",children:"\ud83d\udccb Finance Agreement - Welcome"},"sale_finance_agreement"),(0,yr.jsx)("option",{value:"sale_followup_finance",children:"\ud83d\udcb3 Finance Agreement - Follow-up"},"sale_followup_finance"),(0,yr.jsx)("option",{value:"contract_signing",children:"\ud83d\udcdd Contract Signing"},"contract_signing"),(0,yr.jsx)("option",{value:"contract_delivery",children:"\ud83d\udce6 Contract Delivery (Photos + PDF)"},"contract_delivery"),(0,yr.jsx)("option",{value:"receipt",children:"\ud83e\uddfe Receipt"},"receipt"),(0,yr.jsx)("option",{value:"sale_receipt",children:"\ud83e\uddfe Sale Receipt"},"sale_receipt"),(0,yr.jsx)("option",{value:"payment_receipt",children:"\ud83e\uddfe Payment Receipt"},"payment_receipt"),(0,yr.jsx)("option",{value:"custom",children:"\ud83d\udcdd Custom Template"},"custom"),(0,yr.jsx)("option",{value:"booker",children:"\ud83d\udc64 Booker Template"},"booker")]})]}),(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("label",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200 hover:border-blue-300 transition-all",children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)(Vs,{className:"text-blue-600 mr-3"}),(0,yr.jsx)("span",{className:"font-medium",children:"Send Email"})]}),(0,yr.jsx)("input",{type:"checkbox",checked:M.sendEmail,onChange:e=>I(Ye(Ye({},M),{},{sendEmail:e.target.checked})),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500"})]}),(0,yr.jsxs)("label",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200 hover:border-blue-300 transition-all",children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)(Js,{className:"text-green-600 mr-3"}),(0,yr.jsx)("span",{className:"font-medium",children:"Send SMS"})]}),(0,yr.jsx)("input",{type:"checkbox",checked:M.sendSMS,onChange:e=>I(Ye(Ye({},M),{},{sendSMS:e.target.checked})),className:"w-5 h-5 text-green-600 rounded focus:ring-green-500"})]}),(0,yr.jsxs)("label",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200 hover:border-blue-300 transition-all",children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-3"}),(0,yr.jsx)("span",{className:"font-medium",children:"Active"})]}),(0,yr.jsx)("input",{type:"checkbox",checked:M.isActive,onChange:e=>I(Ye(Ye({},M),{},{isActive:e.target.checked})),className:"w-5 h-5 text-green-600 rounded focus:ring-green-500"})]}),M.sendEmail&&(0,yr.jsxs)("div",{className:"p-3 bg-white rounded-lg border border-gray-200",children:[(0,yr.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Account"}),(0,yr.jsxs)("select",{value:M.emailAccount,onChange:e=>I(Ye(Ye({},M),{},{emailAccount:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",children:[(0,yr.jsx)("option",{value:"",children:"\ud83d\udc64 Use User's Assigned Account (Recommended)"}),E.filter(e=>e.isEnvVar).length>0&&(0,yr.jsx)("optgroup",{label:"Email Accounts",children:E.filter(e=>e.isEnvVar).map(e=>(0,yr.jsxs)("option",{value:e.id,children:["\ud83d\udce7 ",e.name," (",e.email,")"]},e.id))}),E.filter(e=>!e.isEnvVar).length>0&&(0,yr.jsx)("optgroup",{label:"Database Accounts",children:E.filter(e=>!e.isEnvVar).map(e=>(0,yr.jsxs)("option",{value:e.id,children:["\ud83d\udce7 ",e.name," (",e.email,")",e.is_default?" \u2b50":""]},e.id))})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:""===M.emailAccount?"Email will be sent from the account assigned to the user sending it":"Email will always be sent from the selected account"})]}),(0,yr.jsxs)("div",{className:"p-4 bg-white rounded-lg border border-gray-200",children:[(0,yr.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,yr.jsx)("div",{className:"w-4 h-4 bg-purple-500 rounded"}),(0,yr.jsx)("span",{className:"font-medium",children:"Email Attachments"}),(0,yr.jsxs)("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded-full",children:[(Array.isArray(M.attachments)?M.attachments:[]).length," files"]})]}),(0,yr.jsxs)("div",{className:"mb-3",children:[(0,yr.jsx)("input",{type:"file",multiple:!0,accept:".pdf,.doc,.docx,.png,.jpg,.jpeg,.gif,.csv,.xlsx,.xls,.txt",onChange:async e=>{const t=Array.from(e.target.files||[]);if(0===t.length)return;const n=e.target.nextElementSibling;n&&(n.textContent="Uploading...");const r=[];for(const s of t)try{const e=new FormData;e.append("file",s);const t=await fetch("/api/templates/".concat((null===g||void 0===g?void 0:g._id)||"new","/attachments"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:e});if(t.ok){const e=await t.json();r.push(e)}else console.error("Upload failed for:",s.name)}catch(a){console.error("Upload error for:",s.name,a)}I(e=>Ye(Ye({},e),{},{attachments:Array.isArray(e.attachments)?[...e.attachments,...r]:r})),n&&(n.textContent="Choose Files"),e.target.value=""},className:"w-full text-sm file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 cursor-pointer",id:"attachment-upload"}),(0,yr.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Supported: PDF, Word, Images, CSV, Excel files (max 25MB per file)"})]}),(0,yr.jsxs)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[(Array.isArray(M.attachments)?M.attachments:[]).map((e,t)=>{var n,r,a,s,o,i,l;return(0,yr.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border",children:[(0,yr.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,yr.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:null!==(n=e.mimetype)&&void 0!==n&&n.includes("pdf")?"\ud83d\udcc4":null!==(r=e.mimetype)&&void 0!==r&&r.includes("word")||null!==(a=e.mimetype)&&void 0!==a&&a.includes("document")?"\ud83d\udcdd":null!==(s=e.mimetype)&&void 0!==s&&s.includes("image")?"\ud83d\uddbc\ufe0f":null!==(o=e.mimetype)&&void 0!==o&&o.includes("spreadsheet")||null!==(i=e.mimetype)&&void 0!==i&&i.includes("excel")?"\ud83d\udcca":"\ud83d\udcce"}),(0,yr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,yr.jsx)("div",{className:"font-medium text-sm truncate",title:e.originalName||e.filename,children:e.originalName||e.filename}),(0,yr.jsxs)("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[(0,yr.jsx)("span",{children:e.size?"".concat((e.size/1024/1024).toFixed(1)," MB"):"Unknown size"}),e.mimetype&&(0,yr.jsx)("span",{className:"bg-gray-200 px-1 rounded text-xs",children:null===(l=e.mimetype.split("/")[1])||void 0===l?void 0:l.toUpperCase()})]})]})]}),(0,yr.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,yr.jsx)("a",{href:e.url,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:text-blue-800 text-xs font-medium",title:"Download/View",children:"View"}),(0,yr.jsx)("button",{type:"button",className:"text-red-600 hover:text-red-800 text-xs font-medium",onClick:()=>{window.confirm("Remove this attachment?")&&I(e=>Ye(Ye({},e),{},{attachments:(Array.isArray(e.attachments)?e.attachments:[]).filter((e,n)=>n!==t)}))},title:"Remove attachment",children:"Remove"})]})]},t)}),(!M.attachments||0===M.attachments.length)&&(0,yr.jsxs)("div",{className:"text-center py-6 text-gray-500",children:[(0,yr.jsx)("div",{className:"text-2xl mb-2",children:"\ud83d\udcce"}),(0,yr.jsx)("div",{className:"text-sm",children:"No attachments yet"}),(0,yr.jsx)("div",{className:"text-xs",children:"Files will be sent with every email"})]})]})]})]})]}),(0,yr.jsxs)("div",{className:"mt-6",children:[(0,yr.jsx)("h5",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Available Variables"}),(0,yr.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 max-h-48 overflow-y-auto",children:(0,yr.jsx)("div",{className:"p-3",children:C.map(e=>(0,yr.jsxs)("button",{type:"button",onClick:()=>(e=>{let t=null,n=null;const r=document.activeElement;if(!r||"TEXTAREA"!==r.tagName&&"INPUT"!==r.tagName?D.current?(t=D.current,n=t.name):M.sendEmail&&O.current?(t=O.current,n="emailBody"):M.sendSMS&&A.current&&(t=A.current,n="smsBody"):(t=r,n=r.name),!t||!n)if(M.sendEmail&&O.current)O.current.focus(),t=O.current,n="emailBody";else{if(!M.sendSMS||!A.current)return void console.warn("No target field available for variable insertion");A.current.focus(),t=A.current,n="smsBody"}const a=t.selectionStart||0,s=t.selectionEnd||0,o=M[n]||"",i=o.substring(0,a)+e+o.substring(s);I(e=>Ye(Ye({},e),{},{[n]:i})),setTimeout(()=>{t.focus();const n=a+e.length;t.setSelectionRange(n,n)},0)})(e.name),className:"w-full text-left p-2 hover:bg-blue-50 rounded text-sm transition-all group",title:e.description,children:[(0,yr.jsx)("div",{className:"font-mono text-blue-600 group-hover:text-blue-700",children:e.name}),(0,yr.jsx)("div",{className:"text-gray-500 text-xs",children:e.description})]},"variable-".concat(e.name)))})})]})]})}),(0,yr.jsxs)("div",{className:"xl:col-span-2 space-y-6",children:[M.sendEmail&&(0,yr.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[(0,yr.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,yr.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,yr.jsx)(Vs,{className:"text-blue-600"})}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Email Content"}),(0,yr.jsx)("p",{className:"text-sm text-gray-500",children:"Design your email message"})]})]}),(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Subject Line"}),(0,yr.jsx)("input",{ref:T,name:"subject",type:"text",value:M.subject,onChange:e=>I(Ye(Ye({},M),{},{subject:e.target.value})),onFocus:()=>W(0,T),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Enter email subject",required:!0})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Body"}),(0,yr.jsx)("textarea",{ref:O,name:"emailBody",value:M.emailBody,onChange:e=>I(Ye(Ye({},M),{},{emailBody:e.target.value})),onFocus:()=>W(0,O),rows:12,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm transition-all resize-none",placeholder:"Write your email content here...",required:!0})]})]})]}),M.sendSMS&&(0,yr.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[(0,yr.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,yr.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:(0,yr.jsx)(Js,{className:"text-green-600"})}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"SMS Content"}),(0,yr.jsx)("p",{className:"text-sm text-gray-500",children:"Design your SMS message"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"SMS Message"}),(0,yr.jsx)("textarea",{ref:A,name:"smsBody",value:M.smsBody,onChange:e=>I(Ye(Ye({},M),{},{smsBody:e.target.value})),onFocus:()=>W(0,A),rows:6,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 font-mono text-sm transition-all resize-none",placeholder:"Write your SMS content here...",required:!0}),(0,yr.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,yr.jsxs)("p",{className:"text-xs text-gray-500",children:["Character count: ",(0,yr.jsxs)("span",{className:"font-semibold ".concat((M.smsBody||"").length>160?"text-red-500":"text-green-600"),children:[(M.smsBody||"").length,"/160"]})]}),(0,yr.jsxs)("div",{className:"text-xs text-gray-400",children:[Math.ceil((M.smsBody||"").length/160)," message(s)"]})]})]})]}),(M.emailBody||M.smsBody)&&(0,yr.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-6",children:[(0,yr.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Live Preview"}),(0,yr.jsxs)("div",{className:"space-y-4",children:[M.emailBody&&(0,yr.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,yr.jsxs)("div",{className:"text-sm font-semibold text-gray-600 p-3 bg-gray-50 border-b flex items-center justify-between",children:[(0,yr.jsx)("span",{children:"Email Preview:"}),(0,yr.jsx)("span",{className:"text-xs text-gray-400",children:"Rendered HTML"})]}),M.emailBody.includes("<")&&M.emailBody.includes(">")?(0,yr.jsx)("div",{className:"p-4",children:(0,yr.jsx)("iframe",{title:"Email Preview",srcDoc:M.emailBody,className:"w-full border-0 rounded",style:{minHeight:"400px",maxHeight:"600px"},sandbox:"allow-same-origin"})}):(0,yr.jsx)("div",{className:"p-4 text-sm text-gray-800 whitespace-pre-wrap",children:M.emailBody})]}),M.smsBody&&(0,yr.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,yr.jsx)("div",{className:"text-sm font-semibold text-gray-600 p-3 bg-gray-50 border-b",children:"SMS Preview:"}),(0,yr.jsx)("div",{className:"p-4",children:(0,yr.jsx)("div",{className:"max-w-xs mx-auto bg-gray-100 rounded-2xl p-4",children:(0,yr.jsx)("div",{className:"bg-green-500 text-white rounded-2xl rounded-br-sm p-3 text-sm",children:M.smsBody})})})]})]})]})]})]}),(0,yr.jsxs)("div",{className:"mt-8 flex justify-end gap-4 pt-6 border-t border-gray-200",children:[(0,yr.jsx)("button",{type:"button",onClick:()=>f(!1),className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-all font-medium",children:"Cancel"}),(0,yr.jsxs)("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all font-medium flex items-center gap-2 shadow-lg",children:[(0,yr.jsx)(no,{className:"w-4 h-4"}),g?"Update Template":"Create Template"]})]})]})]})}),y&&v&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden shadow-2xl",children:[(0,yr.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6",children:(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h2",{className:"text-2xl font-bold",children:"Template Preview"}),(0,yr.jsxs)("p",{className:"text-blue-100 mt-1",children:[v.template.name," - ",null===(n=v.template.type)||void 0===n?void 0:n.replace("_"," ")]})]}),(0,yr.jsx)("button",{onClick:()=>b(!1),className:"text-white hover:text-blue-200 p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]})}),(0,yr.jsx)("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"calc(90vh - 100px)"},children:(0,yr.jsxs)("div",{className:"space-y-6",children:[!1!==v.template.sendEmail&&v.template.emailBody&&(0,yr.jsxs)("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:[(0,yr.jsxs)("div",{className:"bg-gray-50 px-4 py-3 border-b flex items-center gap-2",children:[(0,yr.jsx)(Vs,{className:"text-blue-600"}),(0,yr.jsx)("span",{className:"font-semibold text-gray-700",children:"Email Preview"})]}),(0,yr.jsxs)("div",{className:"px-4 py-3 bg-gray-50 border-b",children:[(0,yr.jsx)("span",{className:"text-sm text-gray-500",children:"Subject:"}),(0,yr.jsx)("span",{className:"ml-2 font-medium",children:v.template.subject||"(No subject)"})]}),(0,yr.jsx)("div",{className:"p-4 bg-white",children:null!==(r=v.template.emailBody)&&void 0!==r&&r.includes("<")&&null!==(a=v.template.emailBody)&&void 0!==a&&a.includes(">")?(0,yr.jsx)("iframe",{title:"Email Preview",srcDoc:v.template.emailBody,className:"w-full border border-gray-200 rounded-lg",style:{minHeight:"400px",maxHeight:"500px"},sandbox:"allow-same-origin"}):(0,yr.jsx)("div",{className:"whitespace-pre-wrap text-sm text-gray-800 p-4 bg-gray-50 rounded-lg",children:v.template.emailBody||"(No email content)"})})]}),!1!==v.template.sendSMS&&v.template.smsBody&&(0,yr.jsxs)("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:[(0,yr.jsxs)("div",{className:"bg-gray-50 px-4 py-3 border-b flex items-center gap-2",children:[(0,yr.jsx)(Js,{className:"text-green-600"}),(0,yr.jsx)("span",{className:"font-semibold text-gray-700",children:"SMS Preview"}),(0,yr.jsxs)("span",{className:"ml-auto text-xs text-gray-400",children:[(null===(o=v.template.smsBody)||void 0===o?void 0:o.length)||0," characters"]})]}),(0,yr.jsx)("div",{className:"p-6 bg-gradient-to-b from-gray-100 to-gray-200 flex justify-center",children:(0,yr.jsxs)("div",{className:"w-72 bg-white rounded-3xl shadow-xl overflow-hidden border-4 border-gray-800",children:[(0,yr.jsx)("div",{className:"bg-gray-800 h-6 flex justify-center items-end pb-1",children:(0,yr.jsx)("div",{className:"w-20 h-4 bg-black rounded-b-xl"})}),(0,yr.jsxs)("div",{className:"p-4 min-h-[200px] bg-gray-50",children:[(0,yr.jsx)("div",{className:"text-xs text-gray-400 text-center mb-3",children:"Edge Talent"}),(0,yr.jsx)("div",{className:"bg-green-500 text-white rounded-2xl rounded-bl-sm p-3 text-sm shadow-md",children:v.template.smsBody||"(No SMS content)"}),(0,yr.jsx)("div",{className:"text-xs text-gray-400 text-right mt-1",children:"Just now"})]}),(0,yr.jsx)("div",{className:"bg-white h-8 flex justify-center items-center",children:(0,yr.jsx)("div",{className:"w-24 h-1 bg-gray-300 rounded-full"})})]})})]}),!v.template.emailBody&&!v.template.smsBody&&(0,yr.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,yr.jsx)("div",{className:"text-4xl mb-3",children:"\ud83d\udced"}),(0,yr.jsx)("p",{children:"This template has no content yet."})]})]})})]})})]})})},oA=()=>{const{user:e}=Nr(),t=J(),[n,r]=(0,s.useState)([]),[a,o]=(0,s.useState)(!0),[i,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(null),[u,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)(null),[f,g]=(0,s.useState)([]),[x,y]=(0,s.useState)([]),[b,v]=(0,s.useState)({name:"",type:"no_answer",subject:"",emailBody:"",smsBody:"",reminderDays:5,sendEmail:!0,sendSMS:!1,isActive:!0,emailAccount:""});(0,s.useEffect)(()=>{w(),j(),N()},[e]);const w=async()=>{try{const t="admin"===(null===e||void 0===e?void 0:e.role)?"/api/templates":"/api/templates?bookersOnly=true",n=await fetch(t,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(n.ok){const t=await n.json(),a="admin"===(null===e||void 0===e?void 0:e.role)?["no_answer","no_photo","invitation_email","custom","booker"]:["no_answer","no_photo","invitation_email"];r(t.filter(e=>a.includes(e.type)))}}catch(t){console.error("Error fetching templates:",t)}finally{o(!1)}},j=async()=>{try{const e=await fetch("/api/templates/variables/list",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(e.ok){const t=await e.json();g(t)}}catch(e){console.error("Error fetching variables:",e)}},N=async()=>{try{const e=await fetch("/api/email-accounts/dropdown",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(e.ok){const t=await e.json();y(t)}}catch(e){console.error("Error fetching email accounts:",e)}},k=()=>{v({name:"",type:"no_answer",subject:"",emailBody:"",smsBody:"",reminderDays:5,sendEmail:!0,sendSMS:!1,isActive:!0,emailAccount:""})};return(0,yr.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,yr.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,yr.jsx)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Booker Templates"}),(0,yr.jsx)("p",{className:"text-gray-600 mt-2",children:"admin"===(null===e||void 0===e?void 0:e.role)?"View and manage all bookers' templates":"Create and manage your personal templates"}),(0,yr.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[(0,yr.jsx)("span",{className:"font-medium",children:"No Answer:"}),' Triggered when status = "No answer" |',(0,yr.jsx)("span",{className:"font-medium ml-2",children:"No Photo:"}),' Triggered when status = "No photo" |',(0,yr.jsx)("span",{className:"font-medium ml-2",children:"Invitation Email:"})," Quick button in messages"]})]}),(0,yr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,yr.jsxs)("button",{onClick:()=>t("/templates"),className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 shadow",title:"View all other templates (Diary, Retargeting, Sale)",children:[(0,yr.jsx)(_s,{})," All Templates"]}),(0,yr.jsxs)("button",{onClick:()=>{d(null),k(),l(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 shadow",children:[(0,yr.jsx)(eo,{})," New Template"]})]})]})}),(0,yr.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a?(0,yr.jsx)("div",{children:"Loading..."}):0===n.length?(0,yr.jsxs)("div",{className:"col-span-full text-center py-12",children:[(0,yr.jsx)("div",{className:"text-gray-400 text-5xl mb-4",children:"\ud83d\udcdd"}),(0,yr.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No templates yet"}),(0,yr.jsx)("p",{className:"text-gray-500",children:"Create your first template to get started!"})]}):n.map(t=>{var n;return(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 flex flex-col gap-4",children:[(0,yr.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[t.sendEmail&&(0,yr.jsx)(Vs,{className:"text-blue-500",title:"Email"}),t.sendSMS&&(0,yr.jsx)(Js,{className:"text-green-500",title:"SMS"}),(0,yr.jsx)("span",{className:"text-lg font-semibold",children:t.name})]}),"admin"===(null===e||void 0===e?void 0:e.role)&&(null===(n=t.creator)||void 0===n?void 0:n.name)&&(0,yr.jsxs)("div",{className:"text-xs text-blue-600 -mt-2",children:[(0,yr.jsx)("span",{className:"font-medium",children:"By:"})," ",t.creator.name]}),(0,yr.jsx)("div",{className:"text-gray-700 text-sm line-clamp-3",children:t.smsBody||t.emailBody}),(0,yr.jsxs)("div",{className:"flex gap-2 mt-auto",children:[(0,yr.jsx)("button",{onClick:()=>(e=>{p(e),m(!0)})(t),className:"p-2 hover:bg-gray-100 rounded",title:"Preview",children:(0,yr.jsx)(Ps,{})}),(0,yr.jsx)("button",{onClick:()=>(e=>{d(e),v({name:e.name,type:e.type,subject:e.subject,emailBody:e.emailBody,smsBody:e.smsBody,reminderDays:e.reminderDays||5,sendEmail:e.sendEmail,sendSMS:e.sendSMS,isActive:e.isActive,emailAccount:e.email_account||e.emailAccount||""}),l(!0)})(t),className:"p-2 hover:bg-gray-100 rounded",title:"Edit",children:(0,yr.jsx)(Cs,{})}),(0,yr.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this template?"))try{const t=await fetch("/api/templates/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(t.ok)w();else{const e=await t.json();alert(e.message||"Error deleting template")}}catch(t){console.error("Error deleting template:",t),alert("Error deleting template")}})(t._id),className:"p-2 hover:bg-gray-100 rounded text-red-600",title:"Delete",children:(0,yr.jsx)(ho,{})})]})]},t._id)})}),i&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,yr.jsx)("div",{className:"p-6 border-b",children:(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsx)("h2",{className:"text-2xl font-bold",children:c?"Edit Your Template":"Create New Template"}),(0,yr.jsx)("button",{onClick:()=>l(!1),className:"p-2 hover:bg-gray-100 rounded",children:(0,yr.jsx)(ko,{})})]})}),(0,yr.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=c?"/api/templates/".concat(c._id||c.id):"/api/templates",t=c?"PUT":"POST",n=b.type&&["no_answer","no_photo","invitation_email"].includes(b.type)?b.type:"no_answer",r=await fetch(e,{method:t,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(Ye(Ye({},b),{},{type:n}))});if(r.ok)alert("Template saved successfully!"),l(!1),d(null),k(),w();else{const e=await r.json();alert(e.message||"Error saving template")}}catch(t){console.error("Error saving template:",t),alert("Error saving template")}},className:"p-6",children:[(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Template Name"}),(0,yr.jsx)("input",{type:"text",value:b.name,onChange:e=>v(Ye(Ye({},b),{},{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Template Type"}),(0,yr.jsxs)("select",{value:b.type,onChange:e=>v(Ye(Ye({},b),{},{type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[(0,yr.jsx)("option",{value:"no_answer",children:"\ud83d\udcde No Answer (Auto-triggered when status = No answer)"}),(0,yr.jsx)("option",{value:"no_photo",children:"\ud83d\udcf7 No Photo (Auto-triggered when status = No photo)"}),(0,yr.jsx)("option",{value:"invitation_email",children:"\ud83d\udce7 Invitation Email (Quick button in messages)"})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"no_answer"===b.type?'This template triggers with confirmation when you change a lead status to "No answer"':"no_photo"===b.type?'This template triggers with confirmation when you change a lead status to "No photo"':"This template appears as a quick button in the Lead Details message section"})]}),(0,yr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,yr.jsxs)("label",{className:"flex items-center",children:[(0,yr.jsx)("input",{type:"checkbox",checked:b.sendEmail,onChange:e=>v(Ye(Ye({},b),{},{sendEmail:e.target.checked})),className:"mr-2"}),(0,yr.jsx)("span",{className:"text-sm",children:"Send Email"})]}),(0,yr.jsxs)("label",{className:"flex items-center",children:[(0,yr.jsx)("input",{type:"checkbox",checked:b.sendSMS,onChange:e=>v(Ye(Ye({},b),{},{sendSMS:e.target.checked})),className:"mr-2"}),(0,yr.jsx)("span",{className:"text-sm",children:"Send SMS"})]}),(0,yr.jsxs)("label",{className:"flex items-center",children:[(0,yr.jsx)("input",{type:"checkbox",checked:b.isActive,onChange:e=>v(Ye(Ye({},b),{},{isActive:e.target.checked})),className:"mr-2"}),(0,yr.jsx)("span",{className:"text-sm",children:"Active"})]})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Available Variables"}),(0,yr.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg max-h-60 overflow-y-auto",children:(0,yr.jsx)("div",{className:"grid grid-cols-1 gap-2",children:f.map(e=>(0,yr.jsxs)("button",{type:"button",onClick:()=>(e=>{const t=document.activeElement;if(t&&"TEXTAREA"===t.tagName){const n=t.selectionStart,r=t.selectionEnd,a=t.value,s=a.substring(0,n)+"{{".concat(e,"}}")+a.substring(r),o=t.name;v(e=>Ye(Ye({},e),{},{[o]:s})),setTimeout(()=>{t.value=s,t.setSelectionRange(n+e.length+4,n+e.length+4),t.focus();const r=new Event("input",{bubbles:!0});t.dispatchEvent(r)},0)}else v(t=>Ye(Ye({},t),{},{smsBody:t.smsBody+"{{".concat(e,"}}"),emailBody:t.emailBody+"{{".concat(e,"}}")}))})(e.name),className:"text-left p-2 hover:bg-gray-100 rounded text-sm",title:e.description,children:[(0,yr.jsx)("div",{className:"font-mono text-blue-600",children:e.name}),(0,yr.jsx)("div",{className:"text-gray-600 text-xs",children:e.description})]},e.name))})})]})]}),b.sendEmail&&(0,yr.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,yr.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,yr.jsx)(Vs,{})," Email Content"]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject Line"}),(0,yr.jsx)("input",{type:"text",value:b.subject,onChange:e=>v(Ye(Ye({},b),{},{subject:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Body"}),(0,yr.jsx)("textarea",{name:"emailBody",value:b.emailBody,onChange:e=>v(Ye(Ye({},b),{},{emailBody:e.target.value})),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",required:!0})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Send From Email Account"}),(0,yr.jsxs)("select",{value:b.emailAccount,onChange:e=>v(Ye(Ye({},b),{},{emailAccount:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",children:[(0,yr.jsx)("option",{value:"",children:"\ud83d\udc64 Use User's Assigned Account (Recommended)"}),x.filter(e=>e.isEnvVar).length>0&&(0,yr.jsx)("optgroup",{label:"Email Accounts",children:x.filter(e=>e.isEnvVar).map(e=>(0,yr.jsxs)("option",{value:e.id,children:["\ud83d\udce7 ",e.name," (",e.email,")"]},e.id))}),x.filter(e=>!e.isEnvVar).length>0&&(0,yr.jsx)("optgroup",{label:"Database Accounts",children:x.filter(e=>!e.isEnvVar).map(e=>(0,yr.jsxs)("option",{value:e.id,children:["\ud83d\udce7 ",e.name," (",e.email,")",e.is_default?" \u2b50":""]},e.id))})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:""===b.emailAccount?"Email will be sent from the account assigned to the user sending it":"Email will always be sent from the selected account"})]})]}),b.sendSMS&&(0,yr.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,yr.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,yr.jsx)(Js,{})," SMS Content"]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SMS Message"}),(0,yr.jsx)("textarea",{name:"smsBody",value:b.smsBody,onChange:e=>v(Ye(Ye({},b),{},{smsBody:e.target.value})),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",required:!0})]})]}),(0,yr.jsxs)("div",{className:"mt-6 flex justify-end gap-2",children:[(0,yr.jsx)("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 rounded bg-gray-200 text-gray-700 hover:bg-gray-300",children:"Cancel"}),(0,yr.jsxs)("button",{type:"submit",className:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:[(0,yr.jsx)(no,{className:"inline mr-1"})," Save"]})]})]})]})}),u&&h&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg max-w-lg w-full p-6",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,yr.jsxs)("h3",{className:"text-xl font-bold",children:["Preview: ",h.name]}),(0,yr.jsx)("button",{onClick:()=>m(!1),className:"p-2 hover:bg-gray-100 rounded",children:(0,yr.jsx)(ko,{})})]}),h.sendEmail&&(0,yr.jsxs)("div",{className:"mb-4",children:[(0,yr.jsx)("h4",{className:"font-semibold mb-1",children:"Email"}),(0,yr.jsxs)("div",{className:"border rounded p-2 bg-gray-50",children:[(0,yr.jsxs)("div",{className:"font-bold mb-1",children:["Subject: ",h.subject]}),(0,yr.jsx)("div",{className:"whitespace-pre-line font-mono text-sm",children:h.emailBody})]})]}),h.sendSMS&&(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h4",{className:"font-semibold mb-1",children:"SMS"}),(0,yr.jsx)("div",{className:"border rounded p-2 bg-gray-50",children:(0,yr.jsx)("div",{className:"whitespace-pre-line font-mono text-sm",children:h.smsBody})})]})]})})]})})},iA=e=>{let{isOpen:t,onClose:n,agreement:r,onSuccess:a}=e;const[o,i]=(0,s.useState)({amount:"",paymentMethod:"Card",reference:"",notes:""}),[l,c]=(0,s.useState)(!1);if(!t||!r)return null;const d=e=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(e||0);return(0,yr.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,yr.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,yr.jsxs)("div",{className:"mt-3",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Record Payment"}),(0,yr.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]}),(0,yr.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[(0,yr.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Agreement Summary"}),(0,yr.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("strong",{children:"Customer:"})," ",r.lead_name]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("strong",{children:"Agreement:"})," ",r.agreement_number]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("strong",{children:"Remaining Balance:"})," ",d(r.remaining_amount)]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("strong",{children:"Next Due:"})," ",(u=r.next_payment_date,new Date(u).toLocaleDateString("en-GB"))]})]})]}),(0,yr.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!o.amount||parseFloat(o.amount)<=0)alert("Please enter a valid payment amount");else{c(!0);try{201===(await xr.post("/api/finance/payment",{financeId:r.id,leadId:r.lead_id,amount:parseFloat(o.amount),paymentMethod:o.paymentMethod,reference:o.reference,notes:o.notes})).status&&(alert("Payment recorded successfully!"),i({amount:"",paymentMethod:"Card",reference:"",notes:""}),a(),n())}catch(l){var t,s;console.error("Error recording payment:",l),alert((null===(t=l.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"Error recording payment")}finally{c(!1)}}},className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Amount"}),(0,yr.jsxs)("div",{className:"mt-1 relative",children:[(0,yr.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,yr.jsx)(Ns,{className:"h-5 w-5 text-gray-400"})}),(0,yr.jsx)("input",{type:"number",step:"0.01",min:"0.01",max:r.remaining_amount,value:o.amount,onChange:e=>i(Ye(Ye({},o),{},{amount:e.target.value})),className:"block w-full pl-10 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00",required:!0})]}),(0,yr.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["Maximum: ",d(r.remaining_amount)]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Method"}),(0,yr.jsxs)("div",{className:"mt-1 relative",children:[(0,yr.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,yr.jsx)(js,{className:"h-5 w-5 text-gray-400"})}),(0,yr.jsxs)("select",{value:o.paymentMethod,onChange:e=>i(Ye(Ye({},o),{},{paymentMethod:e.target.value})),className:"block w-full pl-10 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,yr.jsx)("option",{value:"Card",children:"Card"}),(0,yr.jsx)("option",{value:"Cash",children:"Cash"}),(0,yr.jsx)("option",{value:"Bank Transfer",children:"Bank Transfer"}),(0,yr.jsx)("option",{value:"Cheque",children:"Cheque"}),(0,yr.jsx)("option",{value:"Other",children:"Other"})]})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Reference"}),(0,yr.jsx)("input",{type:"text",value:o.reference,onChange:e=>i(Ye(Ye({},o),{},{reference:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Transaction reference (optional)"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),(0,yr.jsx)("textarea",{value:o.notes,onChange:e=>i(Ye(Ye({},o),{},{notes:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",placeholder:"Additional notes (optional)"})]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,yr.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",disabled:l,children:"Cancel"}),(0,yr.jsx)("button",{type:"submit",disabled:l,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:l?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Recording..."]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(Ns,{className:"h-4 w-4"}),"Record Payment"]})})]})]})]})})});var u},lA=()=>{var e;const[t,n]=(0,s.useState)([]),[r,a]=(0,s.useState)(!0),[o,i]=(0,s.useState)(!1),[l,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(!1),[p,f]=(0,s.useState)(!1),[g,x]=(0,s.useState)(null),[y,b]=(0,s.useState)({}),[v,w]=(0,s.useState)([]),[j,N]=(0,s.useState)([]),[k,S]=(0,s.useState)([]),[C,_]=(0,s.useState)({leadId:"",saleId:"",totalAmount:"",paymentAmount:"",frequency:"monthly",startDate:"",dueDay:1,gracePeriodDays:5,lateFeeAmount:0,notes:"",emailReminders:!0,smsReminders:!0});(0,s.useEffect)(()=>{E(),P(),O(),A(),T()},[]);const E=async()=>{try{const e=await xr.get("/api/finance/agreements");n(e.data)}catch(e){console.error("Error fetching agreements:",e)}finally{a(!1)}},P=async()=>{try{const e=await xr.get("/api/finance/stats");b(e.data)}catch(e){console.error("Error fetching stats:",e)}},O=async()=>{try{const e=await xr.get("/api/finance/due-payments");w(e.data)}catch(e){console.error("Error fetching due payments:",e)}},A=async()=>{try{const e=await xr.get("/api/finance/overdue");N(e.data)}catch(e){console.error("Error fetching overdue payments:",e)}},T=async()=>{try{const e=await xr.get("/api/leads");S(e.data)}catch(e){console.error("Error fetching leads:",e)}},D=()=>{_({leadId:"",saleId:"",totalAmount:"",paymentAmount:"",frequency:"monthly",startDate:"",dueDay:1,gracePeriodDays:5,lateFeeAmount:0,notes:"",emailReminders:!0,smsReminders:!0})},M=e=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(e||0),I=e=>new Date(e).toLocaleDateString("en-GB"),L=e=>{switch(e){case"active":return"text-green-600 bg-green-100";case"completed":return"text-blue-600 bg-blue-100";case"defaulted":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},R=e=>({weekly:"Weekly","bi-weekly":"Bi-weekly",monthly:"Monthly","bi-monthly":"Bi-monthly",quarterly:"Quarterly"}[e]||e);return r?(0,yr.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,yr.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,yr.jsxs)("div",{className:"animate-pulse",children:[(0,yr.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),(0,yr.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[1,2,3].map(e=>(0,yr.jsx)("div",{className:"h-24 bg-gray-200 rounded"},e))}),(0,yr.jsx)("div",{className:"h-96 bg-gray-200 rounded"})]})})}):(0,yr.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,yr.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,yr.jsx)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Finance Management"}),(0,yr.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage finance agreements and payment schedules"})]}),(0,yr.jsxs)("button",{onClick:()=>{c(null),D(),i(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-700",children:[(0,yr.jsx)(eo,{})," New Agreement"]})]})}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,yr.jsx)("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-blue-200 p-6 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"p-4 bg-gradient-to-br from-blue-400 to-blue-600 rounded-2xl shadow-lg",children:(0,yr.jsx)(Ns,{className:"h-8 w-8 text-white"})}),(0,yr.jsxs)("div",{className:"ml-6",children:[(0,yr.jsx)("p",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wide",children:"Total Financed"}),(0,yr.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:M((null===y||void 0===y?void 0:y.total_financed)||0)}),(0,yr.jsx)("p",{className:"text-xs text-blue-600 font-medium mt-1",children:"Active agreements"})]})]})}),(0,yr.jsx)("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-green-200 p-6 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"p-4 bg-gradient-to-br from-green-400 to-green-600 rounded-2xl shadow-lg",children:(0,yr.jsx)(fs,{className:"h-8 w-8 text-white"})}),(0,yr.jsxs)("div",{className:"ml-6",children:[(0,yr.jsx)("p",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wide",children:"Total Paid"}),(0,yr.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:M((null===y||void 0===y?void 0:y.total_collected)||0)}),(0,yr.jsx)("p",{className:"text-xs text-green-600 font-medium mt-1",children:"\u2197 Collected so far"})]})]})}),(0,yr.jsx)("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-red-200 p-6 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"p-4 bg-gradient-to-br from-red-400 to-red-600 rounded-2xl shadow-lg",children:(0,yr.jsx)(os,{className:"h-8 w-8 text-white"})}),(0,yr.jsxs)("div",{className:"ml-6",children:[(0,yr.jsx)("p",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wide",children:"Unpaid Amount"}),(0,yr.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:M((null===y||void 0===y?void 0:y.total_outstanding)||0)}),(0,yr.jsx)("p",{className:"text-xs text-red-600 font-medium mt-1",children:"Outstanding balance"})]})]})}),(0,yr.jsx)("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-orange-200 p-6 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"p-4 bg-gradient-to-br from-orange-400 to-orange-600 rounded-2xl shadow-lg",children:(0,yr.jsx)(ws,{className:"h-8 w-8 text-white"})}),(0,yr.jsxs)("div",{className:"ml-6",children:[(0,yr.jsx)("p",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wide",children:"Due This Month"}),(0,yr.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:M((null===y||void 0===y?void 0:y.total_due_this_month)||0)}),(0,yr.jsxs)("p",{className:"text-xs text-orange-600 font-medium mt-1",children:[(null===y||void 0===y?void 0:y.agreements_due_this_month)||0," payments"]})]})]})})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[(0,yr.jsxs)("div",{className:"lg:col-span-2 bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-200 p-6",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,yr.jsxs)("h2",{className:"text-xl font-bold text-gray-900 flex items-center",children:[(0,yr.jsx)(po,{className:"h-6 w-6 text-blue-600 mr-3"}),"Payment Performance"]}),(0,yr.jsx)("div",{className:"flex space-x-2",children:(0,yr.jsxs)("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[null!==y&&void 0!==y&&y.total_collected&&null!==y&&void 0!==y&&y.total_financed?Math.round(y.total_collected/y.total_financed*100):0,"% Collected"]})})]}),(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Collection Progress"}),(0,yr.jsxs)("span",{className:"text-sm text-gray-500",children:[M((null===y||void 0===y?void 0:y.total_collected)||0)," of ",M((null===y||void 0===y?void 0:y.total_financed)||0)]})]}),(0,yr.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,yr.jsx)("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-3 rounded-full transition-all duration-500",style:{width:"".concat(null!==y&&void 0!==y&&y.total_collected&&null!==y&&void 0!==y&&y.total_financed?y.total_collected/y.total_financed*100:0,"%")}})})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[(0,yr.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 p-4 rounded-xl border border-blue-200",children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Agreements"}),(0,yr.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:(null===y||void 0===y?void 0:y.active_agreements)||0})]}),(0,yr.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 p-4 rounded-xl border border-green-200",children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Avg Payment"}),(0,yr.jsx)("p",{className:"text-2xl font-bold text-green-600",children:M((null===y||void 0===y?void 0:y.avg_payment_amount)||0)})]})]})]}),(0,yr.jsxs)("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-200 p-6",children:[(0,yr.jsxs)("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center",children:[(0,yr.jsx)(us,{className:"h-5 w-5 text-red-600 mr-2"}),"Payment Alerts"]}),(0,yr.jsxs)("div",{className:"space-y-4",children:[j&&j.length>0&&(0,yr.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-red-800",children:"Overdue Payments"}),(0,yr.jsx)("p",{className:"text-2xl font-bold text-red-600",children:j.length})]}),(0,yr.jsx)(os,{className:"h-8 w-8 text-red-500"})]}),(0,yr.jsx)("p",{className:"text-xs text-red-600 mt-2",children:"Require immediate attention"})]}),v&&v.length>0&&(0,yr.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-yellow-800",children:"Due Soon"}),(0,yr.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:v.length})]}),(0,yr.jsx)(ws,{className:"h-8 w-8 text-yellow-500"})]}),(0,yr.jsx)("p",{className:"text-xs text-yellow-600 mt-2",children:"Next 7 days"})]}),(0,yr.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-blue-800",children:"On Track"}),(0,yr.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:Math.max(0,((null===y||void 0===y?void 0:y.active_agreements)||0)-((null===j||void 0===j?void 0:j.length)||0)-((null===v||void 0===v?void 0:v.length)||0))})]}),(0,yr.jsx)(fs,{className:"h-8 w-8 text-blue-500"})]}),(0,yr.jsx)("p",{className:"text-xs text-blue-600 mt-2",children:"Up to date"})]})]})]})]}),(v&&v.length>0||j&&j.length>0)&&(0,yr.jsxs)("div",{className:"mb-6 space-y-3",children:[j&&j.length>0&&(0,yr.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)(os,{className:"h-5 w-5 text-red-400"}),(0,yr.jsxs)("div",{className:"ml-3",children:[(0,yr.jsxs)("h3",{className:"text-sm font-medium text-red-800",children:[j.length," Overdue Payment",1!==j.length?"s":""]}),(0,yr.jsx)("p",{className:"text-sm text-red-700 mt-1",children:"These payments are past due and require immediate attention."})]})]})}),v&&v.length>0&&(0,yr.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)(ws,{className:"h-5 w-5 text-yellow-400"}),(0,yr.jsxs)("div",{className:"ml-3",children:[(0,yr.jsxs)("h3",{className:"text-sm font-medium text-yellow-800",children:[v.length," Payment",1!==v.length?"s":""," Due Soon"]}),(0,yr.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"These payments are due within the next 7 days."})]})]})})]}),(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,yr.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,yr.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Finance Agreements"})}),(0,yr.jsx)("div",{className:"overflow-x-auto",children:(0,yr.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,yr.jsx)("thead",{className:"bg-gray-50",children:(0,yr.jsxs)("tr",{children:[(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Agreement"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Next Due"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,yr.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t&&t.length>0?t.map(e=>(0,yr.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsxs)("div",{children:[(0,yr.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(null===e||void 0===e?void 0:e.agreement_number)||"N/A"}),(0,yr.jsx)("div",{className:"text-sm text-gray-500",children:R((null===e||void 0===e?void 0:e.payment_frequency)||"monthly")})]})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsxs)("div",{children:[(0,yr.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(null===e||void 0===e?void 0:e.lead_name)||"N/A"}),(0,yr.jsx)("div",{className:"text-sm text-gray-500",children:(null===e||void 0===e?void 0:e.lead_email)||"N/A"})]})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsxs)("div",{children:[(0,yr.jsx)("div",{className:"text-sm font-medium text-gray-900",children:M((null===e||void 0===e?void 0:e.total_amount)||0)}),(0,yr.jsxs)("div",{className:"text-sm text-gray-500",children:[M((null===e||void 0===e?void 0:e.remaining_balance)||0)," remaining"]})]})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("div",{className:"text-sm text-gray-900",children:M((null===e||void 0===e?void 0:e.monthly_payment)||0)})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("div",{className:"text-sm text-gray-900",children:null!==e&&void 0!==e&&e.next_payment_date?I(e.next_payment_date):"N/A"})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(L((null===e||void 0===e?void 0:e.status)||"active")),children:(null===e||void 0===e?void 0:e.status)||"active"})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,yr.jsxs)("div",{className:"flex space-x-2",children:[(0,yr.jsx)("button",{onClick:()=>(async e=>{try{const t=await xr.get("/api/finance/agreement/".concat(e.id));u(t.data),h(!0)}catch(t){console.error("Error fetching agreement details:",t)}})(e),className:"text-blue-600 hover:text-blue-900",title:"View Details",children:(0,yr.jsx)(Ps,{className:"h-4 w-4"})}),(0,yr.jsx)("button",{onClick:()=>(e=>{var t;c(e),_({leadId:e.lead_id,saleId:e.sale_id||"",totalAmount:e.total_amount,paymentAmount:e.monthly_payment,frequency:e.payment_frequency,startDate:(null===(t=e.start_date)||void 0===t?void 0:t.split("T")[0])||"",dueDay:1,gracePeriodDays:5,lateFeeAmount:0,notes:e.notes||"",emailReminders:!0,smsReminders:!0}),i(!0)})(e),className:"text-indigo-600 hover:text-indigo-900",title:"Edit Agreement",children:(0,yr.jsx)(Cs,{className:"h-4 w-4"})}),(null===e||void 0===e?void 0:e.remaining_balance)>0&&(0,yr.jsx)("button",{onClick:()=>(e=>{x(e),f(!0)})(e),className:"text-green-600 hover:text-green-900",title:"Record Payment",children:(0,yr.jsx)(Ns,{className:"h-4 w-4"})})]})})]},e.id)):(0,yr.jsx)("tr",{children:(0,yr.jsx)("td",{colSpan:"7",className:"px-6 py-4 text-center text-gray-500",children:"No finance agreements found"})})})]})})]})]}),o&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,yr.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,yr.jsxs)("div",{className:"mt-3",children:[(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:l?"Edit Finance Agreement":"New Finance Agreement"}),(0,yr.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=Ye(Ye({},C),{},{totalAmount:parseFloat(C.totalAmount)||0,paymentAmount:parseFloat(C.paymentAmount)||0,dueDay:parseInt(C.dueDay)||1,gracePeriodDays:parseInt(C.gracePeriodDays)||5,lateFeeAmount:parseFloat(C.lateFeeAmount)||0});if(!e.leadId||!e.totalAmount||!e.paymentAmount)return void alert("Please fill in all required fields");console.log("\ud83d\udce4 Submitting finance agreement:",e);const t=l?"/api/finance/agreement/".concat(l.id):"/api/finance/agreement",n=l?"PUT":"POST",r=await xr({method:n,url:t,data:e,headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});200!==r.status&&201!==r.status||(i(!1),c(null),D(),E(),P())}catch(r){var t,n;console.error("Error saving agreement:",r),alert((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Error saving agreement")}},className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Lead"}),(0,yr.jsxs)("select",{value:C.leadId,onChange:e=>_(Ye(Ye({},C),{},{leadId:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",required:!0,children:[(0,yr.jsx)("option",{value:"",children:"Select a lead"}),k&&k.length>0?k.map(e=>(0,yr.jsxs)("option",{value:e.id,children:[e.name," - ",e.email]},e.id)):(0,yr.jsx)("option",{value:"",disabled:!0,children:"No leads available"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Total Amount"}),(0,yr.jsx)("input",{type:"number",step:"0.01",value:C.totalAmount,onChange:e=>_(Ye(Ye({},C),{},{totalAmount:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",required:!0})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Amount"}),(0,yr.jsx)("input",{type:"number",step:"0.01",value:C.paymentAmount,onChange:e=>_(Ye(Ye({},C),{},{paymentAmount:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",required:!0})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Frequency"}),(0,yr.jsxs)("select",{value:C.frequency,onChange:e=>_(Ye(Ye({},C),{},{frequency:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",required:!0,children:[(0,yr.jsx)("option",{value:"weekly",children:"Weekly"}),(0,yr.jsx)("option",{value:"bi-weekly",children:"Bi-weekly"}),(0,yr.jsx)("option",{value:"monthly",children:"Monthly"}),(0,yr.jsx)("option",{value:"bi-monthly",children:"Bi-monthly"}),(0,yr.jsx)("option",{value:"quarterly",children:"Quarterly"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Start Date"}),(0,yr.jsx)("input",{type:"date",value:C.startDate,onChange:e=>_(Ye(Ye({},C),{},{startDate:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",required:!0})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Due Day"}),(0,yr.jsx)("input",{type:"number",min:"1",max:"31",value:C.dueDay,onChange:e=>_(Ye(Ye({},C),{},{dueDay:parseInt(e.target.value)})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yr.jsxs)("label",{className:"flex items-center",children:[(0,yr.jsx)("input",{type:"checkbox",checked:C.emailReminders,onChange:e=>_(Ye(Ye({},C),{},{emailReminders:e.target.checked})),className:"rounded border-gray-300 text-blue-600"}),(0,yr.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Email Reminders"})]}),(0,yr.jsxs)("label",{className:"flex items-center",children:[(0,yr.jsx)("input",{type:"checkbox",checked:C.smsReminders,onChange:e=>_(Ye(Ye({},C),{},{smsReminders:e.target.checked})),className:"rounded border-gray-300 text-blue-600"}),(0,yr.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"SMS Reminders"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),(0,yr.jsx)("textarea",{value:C.notes,onChange:e=>_(Ye(Ye({},C),{},{notes:e.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",rows:"3"})]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,yr.jsx)("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Cancel"}),(0,yr.jsx)("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:l?"Update":"Create"})]})]})]})})}),m&&d&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,yr.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-3/4 max-w-4xl shadow-lg rounded-md bg-white",children:(0,yr.jsxs)("div",{className:"mt-3",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Finance Agreement Details"}),(0,yr.jsx)("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Agreement Information"}),(0,yr.jsxs)("dl",{className:"space-y-2",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Agreement Number"}),(0,yr.jsx)("dd",{className:"text-sm text-gray-900",children:(null===d||void 0===d?void 0:d.agreement_number)||"N/A"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Customer"}),(0,yr.jsx)("dd",{className:"text-sm text-gray-900",children:(null===d||void 0===d?void 0:d.lead_name)||"N/A"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Total Amount"}),(0,yr.jsx)("dd",{className:"text-sm text-gray-900",children:M((null===d||void 0===d?void 0:d.total_amount)||0)})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Payment Amount"}),(0,yr.jsx)("dd",{className:"text-sm text-gray-900",children:M((null===d||void 0===d?void 0:d.monthly_payment)||0)})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Frequency"}),(0,yr.jsx)("dd",{className:"text-sm text-gray-900",children:R((null===d||void 0===d?void 0:d.payment_frequency)||"monthly")})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Start Date"}),(0,yr.jsx)("dd",{className:"text-sm text-gray-900",children:null!==d&&void 0!==d&&d.start_date?I(d.start_date):"N/A"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Next Payment Due"}),(0,yr.jsx)("dd",{className:"text-sm text-gray-900",children:null!==d&&void 0!==d&&d.next_payment_date?I(d.next_payment_date):"N/A"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Status"}),(0,yr.jsx)("dd",{className:"text-sm text-gray-900",children:(0,yr.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(L((null===d||void 0===d?void 0:d.status)||"active")),children:(null===d||void 0===d?void 0:d.status)||"active"})})]})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Payment Summary"}),(0,yr.jsxs)("dl",{className:"space-y-2",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Total Paid"}),(0,yr.jsx)("dd",{className:"text-sm text-gray-900",children:M((null===d||void 0===d?void 0:d.total_paid)||0)})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Remaining Amount"}),(0,yr.jsx)("dd",{className:"text-sm text-gray-900",children:M((null===d||void 0===d?void 0:d.remaining_balance)||0)})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Payment Count"}),(0,yr.jsx)("dd",{className:"text-sm text-gray-900",children:(null===d||void 0===d||null===(e=d.payments)||void 0===e?void 0:e.length)||0})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Last Payment"}),(0,yr.jsx)("dd",{className:"text-sm text-gray-900",children:null!==d&&void 0!==d&&d.payments&&d.payments.length>0?I(d.payments[0].payment_date):"No payments yet"})]})]}),(null===d||void 0===d?void 0:d.payments)&&d.payments.length>0&&(0,yr.jsxs)("div",{className:"mt-4",children:[(0,yr.jsx)("h5",{className:"font-medium text-gray-900 mb-2",children:"Payment History"}),(0,yr.jsx)("div",{className:"space-y-2",children:d.payments.map(e=>(0,yr.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,yr.jsx)("span",{children:I(e.payment_date)}),(0,yr.jsx)("span",{className:"font-medium",children:M(e.amount_paid)})]},e.id))})]})]})]}),(0,yr.jsx)("div",{className:"mt-6 flex justify-end",children:(0,yr.jsx)("button",{onClick:()=>h(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Close"})})]})})}),(0,yr.jsx)(iA,{isOpen:p,onClose:()=>{f(!1),x(null)},agreement:g,onSuccess:()=>{E(),P(),O(),A()}})]})},cA=e=>{let{isOpen:t,onClose:n,selectedSales:r,onSuccess:a}=e;const[o,i]=(0,s.useState)([]),[l,c]=(0,s.useState)(""),[d,u]=(0,s.useState)(!1),[m,h]=(0,s.useState)(!1),[p,f]=(0,s.useState)(null),[g,x]=(0,s.useState)(!1),[y,b]=(0,s.useState)("both"),[v,w]=(0,s.useState)(""),[j,N]=(0,s.useState)(""),[k,S]=(0,s.useState)("");(0,s.useEffect)(()=>{t&&C()},[t]),(0,s.useEffect)(()=>{l&&_()},[l]);const C=async()=>{try{u(!0);const e=await xr.get("/api/templates",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=[...new Set(r.map(e=>e.payment_type))],n=e.data.filter(e=>t.includes("full_payment")&&t.includes("finance")?["sale_paid_in_full","sale_followup_paid","sale_finance_agreement","sale_followup_finance","sale_confirmation","sale_followup","sale_notification"].includes(e.type):t.includes("full_payment")?["sale_paid_in_full","sale_followup_paid","sale_confirmation","sale_followup","sale_notification"].includes(e.type):!!t.includes("finance")&&["sale_finance_agreement","sale_followup_finance","sale_confirmation","sale_followup","sale_notification"].includes(e.type));i(n)}catch(e){console.error("Error fetching templates:",e)}finally{u(!1)}},_=async()=>{if(l)try{const e=o.find(e=>e._id===l);e&&(w(e.subject||""),N(e.emailBody||""),S(e.smsBody||""),b(e.sendEmail&&e.sendSMS?"both":e.sendEmail?"email":"sms"))}catch(e){console.error("Error loading template:",e)}},E=e=>{switch(e){case"full_payment":return"Paid in Full";case"finance":return"Finance Agreement";default:return(null===e||void 0===e?void 0:e.replace("_"," "))||"Unknown"}},P=e=>{switch(e){case"full_payment":return"bg-green-100 text-green-800";case"finance":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return t?(0,yr.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,yr.jsxs)("div",{className:"relative top-10 mx-auto p-6 border w-full max-w-4xl shadow-lg rounded-md bg-white",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yr.jsxs)("h3",{className:"text-xl font-semibold text-gray-900",children:["Send Communication to ",r.length," Customer",1!==r.length?"s":""]}),(0,yr.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]}),(0,yr.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,yr.jsxs)("div",{className:"flex items-center mb-3",children:[(0,yr.jsx)(wo,{className:"h-5 w-5 text-gray-600 mr-2"}),(0,yr.jsx)("span",{className:"font-medium text-gray-700",children:"Selected Customers:"})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.slice(0,6).map((e,t)=>(0,yr.jsxs)("div",{className:"flex items-center justify-between p-2 bg-white rounded border",children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-sm font-medium text-blue-600",children:t+1}),(0,yr.jsxs)("div",{className:"ml-3",children:[(0,yr.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.lead_name}),(0,yr.jsx)("div",{className:"text-xs text-gray-500",children:e.lead_email})]})]}),(0,yr.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(P(e.payment_type)),children:E(e.payment_type)})]},e.id)),r.length>6&&(0,yr.jsxs)("div",{className:"text-sm text-gray-500 italic",children:["+",r.length-6," more customers"]})]})]}),(0,yr.jsxs)("div",{className:"mb-6",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Template"}),(0,yr.jsxs)("select",{value:l,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:d,children:[(0,yr.jsx)("option",{value:"",children:"Choose a template..."}),o.map(e=>(0,yr.jsxs)("option",{value:e._id,children:[e.name," (",e.type.replace(/_/g," "),")"]},e._id))]})]}),(0,yr.jsxs)("div",{className:"mb-6",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Communication Type"}),(0,yr.jsxs)("div",{className:"flex space-x-4",children:[(0,yr.jsxs)("label",{className:"flex items-center",children:[(0,yr.jsx)("input",{type:"radio",value:"email",checked:"email"===y,onChange:e=>b(e.target.value),className:"mr-2"}),(0,yr.jsx)(Vs,{className:"h-4 w-4 text-blue-600 mr-1"}),"Email Only"]}),(0,yr.jsxs)("label",{className:"flex items-center",children:[(0,yr.jsx)("input",{type:"radio",value:"sms",checked:"sms"===y,onChange:e=>b(e.target.value),className:"mr-2"}),(0,yr.jsx)(Js,{className:"h-4 w-4 text-green-600 mr-1"}),"SMS Only"]}),(0,yr.jsxs)("label",{className:"flex items-center",children:[(0,yr.jsx)("input",{type:"radio",value:"both",checked:"both"===y,onChange:e=>b(e.target.value),className:"mr-2"}),(0,yr.jsx)(Vs,{className:"h-4 w-4 text-blue-600 mr-1"}),(0,yr.jsx)(Js,{className:"h-4 w-4 text-green-600 mr-1"}),"Both"]})]})]}),("email"===y||"both"===y)&&(0,yr.jsxs)("div",{className:"mb-6",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Subject"}),(0,yr.jsx)("input",{type:"text",value:v,onChange:e=>w(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email subject..."})]}),("email"===y||"both"===y)&&(0,yr.jsxs)("div",{className:"mb-6",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Body"}),(0,yr.jsx)("textarea",{value:j,onChange:e=>N(e.target.value),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email body..."})]}),("sms"===y||"both"===y)&&(0,yr.jsxs)("div",{className:"mb-6",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SMS Body"}),(0,yr.jsx)("textarea",{value:k,onChange:e=>S(e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter SMS message..."}),(0,yr.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Character count: ",k.length," (SMS limit: 160 characters)"]})]}),(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsx)("div",{className:"flex space-x-3",children:(0,yr.jsxs)("button",{onClick:async()=>{if(l&&0!==r.length)try{u(!0);const e=await xr.post("/api/templates/".concat(l,"/preview"),{sales:r.slice(0,3)},{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});f(e.data),x(!0)}catch(e){console.error("Error generating preview:",e)}finally{u(!1)}},disabled:!l||d,className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 disabled:opacity-50 flex items-center",children:[(0,yr.jsx)(Ps,{className:"h-4 w-4 mr-2"}),"Preview"]})}),(0,yr.jsxs)("div",{className:"flex space-x-3",children:[(0,yr.jsx)("button",{onClick:n,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cancel"}),(0,yr.jsx)("button",{onClick:async()=>{if(l&&0!==r.length)try{h(!0);const e={templateId:l,sales:r.map(e=>({id:e.id,payment_type:e.payment_type,lead_name:e.lead_name,lead_email:e.lead_email,lead_phone:e.lead_phone,amount:e.amount,sale_date:e.sale_created_at||e.created_at})),communicationType:y,customSubject:v,customEmailBody:j,customSmsBody:k},t=await xr.post("/api/sales/bulk-communication",e,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});let s="".concat(t.data.message,"\n\n").concat(t.data.note||"");t.data.errorCount>0&&(s+="\n\nErrors:",t.data.results.forEach(e=>{e.error&&(s+="\n\u2022 ".concat(e.customerName||e.saleId,": ").concat(e.error))})),alert(s),a(),n()}catch(e){console.error("Error sending communications:",e),alert("Error sending communications. Please try again.")}finally{h(!1)}},disabled:!l||m||0===r.length,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 flex items-center",children:m?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(ao,{className:"h-4 w-4 mr-2"}),"Send to ",r.length," Customer",1!==r.length?"s":""]})})]})]}),g&&p&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,yr.jsxs)("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,yr.jsx)("h4",{className:"text-lg font-medium text-gray-900",children:"Preview"}),(0,yr.jsx)("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]}),(0,yr.jsx)("div",{className:"space-y-4",children:p.map((e,t)=>(0,yr.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yr.jsx)("span",{className:"font-medium text-gray-700",children:e.customerName}),(0,yr.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(P(e.paymentType)),children:E(e.paymentType)})]}),("email"===y||"both"===y)&&(0,yr.jsxs)("div",{className:"mb-3",children:[(0,yr.jsx)("div",{className:"text-sm font-medium text-gray-600 mb-1",children:"Email Preview:"}),(0,yr.jsxs)("div",{className:"text-sm text-gray-800 bg-gray-50 p-2 rounded",children:[(0,yr.jsxs)("div",{className:"font-medium",children:["Subject: ",e.emailSubject]}),(0,yr.jsx)("div",{className:"mt-2 whitespace-pre-wrap",children:e.emailBody})]})]}),("sms"===y||"both"===y)&&(0,yr.jsxs)("div",{children:[(0,yr.jsx)("div",{className:"text-sm font-medium text-gray-600 mb-1",children:"SMS Preview:"}),(0,yr.jsx)("div",{className:"text-sm text-gray-800 bg-gray-50 p-2 rounded",children:e.smsBody})]})]},t))})]})})]})}):null},dA=e=>{let{bookingHistory:t,title:n="Message History",maxHeight:r="max-h-48"}=e;if(!t||!Array.isArray(t))return null;const a=t.filter(e=>["EMAIL_SENT","EMAIL_RECEIVED","SMS_SENT","SMS_RECEIVED"].includes(e.action)).sort((e,t)=>new Date(t.timestamp)-new Date(e.timestamp));return 0===a.length?(0,yr.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-4 mt-4",children:[(0,yr.jsx)("h4",{className:"text-base font-bold text-blue-700 mb-2",children:n}),(0,yr.jsx)("div",{className:"text-xs text-gray-400 italic",children:"No messages yet"})]}):(0,yr.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-4 mt-4 ".concat(r," overflow-y-auto"),children:[(0,yr.jsx)("h4",{className:"text-base font-bold text-blue-700 mb-2",children:n}),a.slice(0,10).map((e,t)=>{var n,r,a;return(0,yr.jsxs)("div",{className:"flex items-start space-x-2 mb-2 last:mb-0",children:[(0,yr.jsxs)("div",{className:"mt-1",children:[["EMAIL_SENT","EMAIL_RECEIVED"].includes(e.action)&&(0,yr.jsx)(Vs,{className:"h-4 w-4 ".concat("EMAIL_SENT"===e.action?"text-blue-500":"text-green-600")}),["SMS_SENT","SMS_RECEIVED"].includes(e.action)&&(0,yr.jsx)(Ys,{className:"h-4 w-4 ".concat("SMS_SENT"===e.action?"text-blue-400":"text-green-400")})]}),(0,yr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,yr.jsxs)("div",{className:"text-xs text-gray-700 font-semibold",children:["EMAIL_SENT"===e.action&&"Email Sent","EMAIL_RECEIVED"===e.action&&"Email Received","SMS_SENT"===e.action&&"Text Sent","SMS_RECEIVED"===e.action&&"Text Received",(0,yr.jsx)("span",{className:"ml-2 text-gray-400 font-normal",children:new Date(e.timestamp).toLocaleString()})]}),(null===(n=e.details)||void 0===n?void 0:n.subject)&&(0,yr.jsxs)("div",{className:"text-xs text-gray-500 truncate",children:[(0,yr.jsx)("b",{children:"Subject:"})," ",e.details.subject]}),(0,yr.jsxs)("div",{className:"text-xs text-gray-600 truncate",children:[(0,yr.jsx)("b",{children:"Message:"})," ",null!==(r=e.details)&&void 0!==r&&r.body?"No content available"===e.details.body?(0,yr.jsx)("span",{className:"italic text-gray-400",children:e.details.body}):(0,yr.jsxs)(yr.Fragment,{children:[e.details.body.slice(0,80),e.details.body.length>80?"...":""]}):(0,yr.jsx)("span",{className:"italic text-gray-400",children:"No message content"})]}),(0,yr.jsxs)("div",{className:"text-[10px] text-gray-400",children:["sent"===(null===(a=e.details)||void 0===a?void 0:a.direction)?"To":"From",": ",e.performedByName]})]})]},t)})]})},uA=()=>{var e,t,n,r,a,o,i,l;const{user:c}=Nr(),{socket:d}=Xa(),[u,m]=(0,s.useState)([]),[h,p]=(0,s.useState)({}),[f,g]=(0,s.useState)(!0),[x,y]=(0,s.useState)("all"),[b,v]=(0,s.useState)("this_month"),[w,j]=(0,s.useState)(null),[N,k]=(0,s.useState)(!1),[S,C]=(0,s.useState)(!1),[_,E]=(0,s.useState)(!1),[P,O]=(0,s.useState)(!1),[A,T]=(0,s.useState)(new Set),[D,M]=(0,s.useState)(!1),[I,L]=(0,s.useState)(!1),[R,F]=(0,s.useState)(!1),[B,U]=(0,s.useState)("details"),[z,V]=(0,s.useState)(null),[W,q]=(0,s.useState)(!1),[H,Y]=(0,s.useState)(!1),[G,X]=(0,s.useState)({totalAmount:"",paymentAmount:"",frequency:"monthly",startDate:(new Date).toISOString().split("T")[0],notes:""});(0,s.useEffect)(()=>{$(),K()},[b,x]),(0,s.useEffect)(()=>{if(d)return d.on("sales_deleted",e=>{console.log("\ud83d\udce1 Received sales_deleted event:",e),$(),K()}),d.on("sale_created",e=>{console.log("\ud83d\udce1 Received sale_created event:",e),$(),K()}),()=>{d.off("sales_deleted"),d.off("sale_created")}},[d]);const $=async()=>{try{console.log("\ud83d\udd0d Fetching sales with params:",{dateRange:b,paymentType:"all"===x?void 0:x});const e=await xr.get("/api/sales",{params:{dateRange:b,paymentType:"all"===x?void 0:x}});console.log("\ud83d\udcca Sales data received:",e.data),e.data&&e.data.length>0&&(console.log("\ud83d\udd0d SALES USER ATTRIBUTION DEBUG:"),e.data.slice(0,3).forEach((e,t)=>{const n=e.user_name||(e.user_id?"User ".concat(e.user_id.slice(-4)):"System");console.log("   Sale ".concat(t+1,": ID=").concat(e.id.slice(-8),", user_id=").concat(e.user_id,', user_name="').concat(e.user_name,'", display="').concat(n,'"'))})),m(e.data)}catch(e){console.error("\u274c Error fetching sales:",e)}},K=async()=>{try{console.log("\ud83d\udcc8 Fetching stats with params:",{dateRange:b,paymentType:"all"===x?void 0:x});const e=await xr.get("/api/sales/stats",{params:{dateRange:b,paymentType:"all"===x?void 0:x}});console.log("\ud83d\udcca Stats data received:",e.data),p(e.data)}catch(e){console.error("\u274c Error fetching stats:",e)}finally{g(!1)}},J=async e=>{j(e),V(null),U("details"),Y(!1),k(!0),await(async e=>{try{q(!0);const t=await xr.get("/api/sales/".concat(e,"/details"));t.data.success&&V(t.data.sale)}catch(t){console.error("\u274c Error fetching sale details:",t),V(null)}finally{q(!1)}})(e.id)},Q=e=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(e),Z=e=>{if(!e)return"-";const t=new Date(e);return isNaN(t.getTime())?"-":t.toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric"})},ee=async e=>{if(window.confirm("Are you sure you want to delete this sale? This action cannot be undone."))try{console.log("\ud83d\uddd1\ufe0f Attempting to delete sale:",e);const t=await xr.delete("/api/sales/".concat(e),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});console.log("\ud83d\udce5 Delete response:",t),console.log("\ud83d\udce5 Response data:",t.data),t.data&&t.data.message?(console.log("\u2705 Delete successful:",t.data.message),alert(t.data.message),await $(),await K()):(console.log("\u26a0\ufe0f Unexpected response format:",t.data),await $(),await K(),alert("Sale deleted successfully"))}catch(o){var t;if(console.error("\u274c Error deleting sale:",o),console.error("\u274c Error response:",o.response),console.error("\u274c Error response data:",null===(t=o.response)||void 0===t?void 0:t.data),o.response){var n,r;const e=(null===(n=o.response.data)||void 0===n?void 0:n.message)||(null===(r=o.response.data)||void 0===r?void 0:r.error)||"Unknown server error";var a,s;if(e.includes("Failed to delete sale"))alert("Failed to delete sale: "+((null===(a=o.response.data)||void 0===a?void 0:a.error)||(null===(s=o.response.data)||void 0===s?void 0:s.details)||"Unknown error"));else alert("Failed to delete sale: "+e)}else o.request?alert("Failed to delete sale: No response from server"):alert("Failed to delete sale: "+o.message)}},te=e=>{if(!e||"string"!==typeof e)return"bg-gray-100 text-gray-800";switch(e.toLowerCase()){case"card":return"bg-green-100 text-green-800";case"cash":return"bg-yellow-100 text-yellow-800";case"finance":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},ne=e=>{if(!e||"string"!==typeof e)return"Unknown";switch(e.toLowerCase()){case"card":return"Card";case"cash":return"Cash";case"finance":return"Finance";default:return e}},re=u.filter(e=>"all"===x||e.payment_type===x);return console.log("\ud83d\udd0d Debug Info:",{totalSales:u.length,filteredSales:re.length,currentFilter:x,stats:h,salesData:u.map(e=>({name:e.lead_name,amount:e.amount,paymentType:e.payment_type}))}),f?(0,yr.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,yr.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):(0,yr.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:(0,yr.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,yr.jsx)("div",{className:"mb-8",children:(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2",children:"Sales Overview"}),(0,yr.jsx)("p",{className:"text-gray-600 text-lg",children:"Track completed sales and revenue performance"})]}),(0,yr.jsx)("div",{className:"flex items-center space-x-3",children:(0,yr.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm px-4 py-2 rounded-full border border-blue-200",children:[(0,yr.jsx)("span",{className:"text-sm text-gray-600",children:"Last updated: "}),(0,yr.jsx)("span",{className:"text-sm font-medium text-blue-600",children:(new Date).toLocaleTimeString()})]})})]})}),(0,yr.jsxs)("div",{className:"grid gap-6 mb-8 ".concat("admin"===(null===c||void 0===c?void 0:c.role)?"grid-cols-1 md:grid-cols-2 lg:grid-cols-4":"grid-cols-1 md:grid-cols-2"),children:[(0,yr.jsx)("div",{className:"bg-white/80 backdrop-blur-sm p-6 rounded-2xl shadow-lg border border-green-200 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"p-4 bg-gradient-to-br from-green-400 to-green-600 rounded-2xl shadow-lg",children:(0,yr.jsx)(Ns,{className:"h-8 w-8 text-white"})}),(0,yr.jsxs)("div",{className:"ml-6",children:[(0,yr.jsx)("p",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wide",children:"Total Revenue"}),(0,yr.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:Q(h.totalRevenue||0)}),"admin"===(null===c||void 0===c?void 0:c.role)&&(0,yr.jsx)("p",{className:"text-xs text-green-600 font-medium mt-1",children:"\u2197 +12% from last month"})]})]})}),"admin"===(null===c||void 0===c?void 0:c.role)&&(0,yr.jsx)("div",{className:"bg-white/80 backdrop-blur-sm p-6 rounded-2xl shadow-lg border border-blue-200 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"p-4 bg-gradient-to-br from-blue-400 to-blue-600 rounded-2xl shadow-lg",children:(0,yr.jsx)(po,{className:"h-8 w-8 text-white"})}),(0,yr.jsxs)("div",{className:"ml-6",children:[(0,yr.jsx)("p",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wide",children:"Total Sales"}),(0,yr.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:h.totalSales||0}),(0,yr.jsx)("p",{className:"text-xs text-blue-600 font-medium mt-1",children:"\u2197 +8% from last month"})]})]})}),(0,yr.jsx)("div",{className:"bg-white/80 backdrop-blur-sm p-6 rounded-2xl shadow-lg border border-purple-200 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"p-4 bg-gradient-to-br from-purple-400 to-purple-600 rounded-2xl shadow-lg",children:(0,yr.jsx)(js,{className:"h-8 w-8 text-white"})}),(0,yr.jsxs)("div",{className:"ml-6",children:[(0,yr.jsx)("p",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wide",children:"admin"===(null===c||void 0===c?void 0:c.role)?"Avg Sale Value":"Your Avg Sale"}),(0,yr.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:Q(h.averageSaleValue||0)}),"admin"===(null===c||void 0===c?void 0:c.role)&&(0,yr.jsx)("p",{className:"text-xs text-purple-600 font-medium mt-1",children:"\u2197 +5% from last month"})]})]})}),"admin"===(null===c||void 0===c?void 0:c.role)&&(0,yr.jsx)("div",{className:"bg-white/80 backdrop-blur-sm p-6 rounded-2xl shadow-lg border border-orange-200 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"p-4 bg-gradient-to-br from-orange-400 to-orange-600 rounded-2xl shadow-lg",children:(0,yr.jsx)(hs,{className:"h-8 w-8 text-white"})}),(0,yr.jsxs)("div",{className:"ml-6",children:[(0,yr.jsx)("p",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wide",children:"Finance Agreements"}),(0,yr.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:h.financeAgreements||0}),(0,yr.jsx)("p",{className:"text-xs text-orange-600 font-medium mt-1",children:"\u2197 +3% from last month"})]})]})})]}),(0,yr.jsx)("div",{className:"mb-8",children:(0,yr.jsx)("div",{className:"bg-white/80 backdrop-blur-sm p-6 rounded-2xl shadow-lg border border-gray-200",children:(0,yr.jsxs)("div",{className:"flex flex-wrap gap-6 items-center",children:[(0,yr.jsxs)("div",{className:"flex gap-3",children:[(0,yr.jsxs)("label",{className:"text-sm font-semibold text-gray-700 flex items-center",children:[(0,yr.jsx)(As,{className:"mr-2 h-4 w-4"}),"Payment Type:"]}),["all","full_payment","finance"].map(e=>(0,yr.jsx)("button",{onClick:()=>y(e),className:"px-4 py-2 rounded-xl text-sm font-semibold capitalize transition-all duration-200 ".concat(x===e?"bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg transform scale-105":"bg-gray-100 text-gray-700 hover:bg-gray-200 hover:scale-105"),children:e.replace("_"," ")},e))]}),(0,yr.jsxs)("div",{className:"flex gap-3",children:[(0,yr.jsxs)("label",{className:"text-sm font-semibold text-gray-700 flex items-center",children:[(0,yr.jsx)(hs,{className:"mr-2 h-4 w-4"}),"Period:"]}),(0,yr.jsxs)("select",{value:b,onChange:e=>v(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-xl text-sm font-medium focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm hover:shadow-md transition-all duration-200",children:[(0,yr.jsx)("option",{value:"today",children:"Today"}),(0,yr.jsx)("option",{value:"this_week",children:"This Week"}),(0,yr.jsx)("option",{value:"last_week",children:"Last Week"}),(0,yr.jsx)("option",{value:"this_month",children:"This Month"}),(0,yr.jsx)("option",{value:"last_month",children:"Last Month"}),(0,yr.jsx)("option",{value:"this_quarter",children:"This Quarter"}),(0,yr.jsx)("option",{value:"this_year",children:"This Year"})]})]})]})})}),(0,yr.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-200 overflow-hidden",children:[(0,yr.jsx)("div",{className:"bg-gradient-to-r from-gray-50 to-blue-50 px-6 py-4 border-b border-gray-200",children:(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsxs)("h2",{className:"text-xl font-bold text-gray-900 flex items-center",children:[(0,yr.jsx)(po,{className:"h-6 w-6 text-blue-600 mr-3"}),"Sales History"]}),A.size>0&&(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("div",{className:"bg-blue-100 px-3 py-1 rounded-full",children:(0,yr.jsxs)("span",{className:"text-sm font-medium text-blue-700",children:[A.size," selected"]})}),(0,yr.jsxs)("button",{onClick:()=>F(!0),className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white px-4 py-2 rounded-xl flex items-center space-x-2 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:[(0,yr.jsx)(ao,{className:"h-4 w-4"}),(0,yr.jsx)("span",{className:"font-semibold",children:"Send Communication"})]}),(0,yr.jsxs)("button",{onClick:()=>M(!0),className:"bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700 text-white px-4 py-2 rounded-xl flex items-center space-x-2 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:[(0,yr.jsx)(ho,{className:"h-4 w-4"}),(0,yr.jsx)("span",{className:"font-semibold",children:"Delete Selected"})]})]})]})}),(0,yr.jsx)("div",{className:"overflow-x-auto",children:(0,yr.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,yr.jsx)("thead",{className:"bg-gradient-to-r from-gray-50 to-blue-50",children:(0,yr.jsxs)("tr",{children:[(0,yr.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-12",children:(0,yr.jsx)("input",{type:"checkbox",checked:A.size===re.length&&re.length>0,onChange:()=>{A.size===re.length?T(new Set):T(new Set(re.map(e=>e.id)))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded shadow-sm"})}),(0,yr.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Customer"}),(0,yr.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Sale Date"}),(0,yr.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Amount"}),(0,yr.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Payment Method"}),(0,yr.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Sales Agent"}),(0,yr.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),(0,yr.jsx)("tbody",{className:"bg-white divide-y divide-gray-100",children:re.map(e=>(0,yr.jsxs)("tr",{className:"hover:bg-blue-50/50 transition-colors duration-200 ".concat(A.has(e.id)?"bg-blue-50 border-l-4 border-blue-500":""),children:[(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("input",{type:"checkbox",checked:A.has(e.id),onChange:()=>(e=>{const t=new Set(A);t.has(e)?t.delete(e):t.add(e),T(t)})(e.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,yr.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:(0,yr.jsx)(vo,{className:"h-5 w-5 text-gray-600"})})}),(0,yr.jsxs)("div",{className:"ml-4",children:[(0,yr.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.lead_name||"Unknown"}),(0,yr.jsx)("div",{className:"text-sm text-gray-500",children:e.lead_email})]})]})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("div",{className:"text-sm text-gray-900",children:Z(e.sale_created_at||e.created_at)})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("div",{className:"text-sm font-medium text-gray-900",children:Q(e.amount)})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(te(e.payment_method)),children:ne(e.payment_method)})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("div",{className:"text-sm text-gray-900",children:e.user_name||(e.user_id?"User ".concat(e.user_id.slice(-4)):"System")})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,yr.jsxs)("div",{className:"flex space-x-2",children:[(0,yr.jsx)("button",{onClick:()=>J(e),className:"p-2 bg-blue-100 hover:bg-blue-200 text-blue-600 rounded-lg transition-all duration-200 hover:scale-110 shadow-sm hover:shadow-md",title:"View Details",children:(0,yr.jsx)(Ps,{className:"h-4 w-4"})}),"full_payment"===e.payment_type&&(0,yr.jsx)("button",{onClick:()=>(e=>{j(e),X({totalAmount:e.amount,paymentAmount:"",frequency:"monthly",startDate:(new Date).toISOString().split("T")[0],notes:"Finance agreement for ".concat(e.lead_name)}),C(!0)})(e),className:"p-2 bg-green-100 hover:bg-green-200 text-green-600 rounded-lg transition-all duration-200 hover:scale-110 shadow-sm hover:shadow-md",title:"Convert to Finance",children:(0,yr.jsx)(eo,{className:"h-4 w-4"})}),(0,yr.jsx)("button",{onClick:()=>ee(e.id),className:"p-2 bg-red-100 hover:bg-red-200 text-red-600 rounded-lg transition-all duration-200 hover:scale-110 shadow-sm hover:shadow-md",title:"Delete Sale",children:(0,yr.jsx)(ho,{className:"h-4 w-4"})})]})})]},e.id))})]})})]}),N&&w&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm overflow-y-auto h-full w-full z-50",children:(0,yr.jsxs)("div",{className:"relative top-10 mx-auto p-0 w-11/12 md:w-4/5 lg:w-3/4 shadow-2xl rounded-2xl bg-white overflow-hidden",children:[(0,yr.jsxs)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 p-6",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsx)("h3",{className:"text-2xl font-bold text-white",children:"Sale Details"}),(0,yr.jsx)("button",{onClick:()=>k(!1),className:"text-white hover:text-gray-200 transition-colors duration-200",children:(0,yr.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,yr.jsxs)("div",{className:"flex space-x-4 mt-4",children:[(0,yr.jsx)("button",{onClick:()=>U("details"),className:"px-4 py-2 rounded-lg font-semibold transition-all duration-200 ".concat("details"===B?"bg-white text-blue-600 shadow-md":"bg-white/20 text-white hover:bg-white/30"),children:"Sale Details"}),(0,yr.jsxs)("button",{onClick:()=>U("communications"),className:"px-4 py-2 rounded-lg font-semibold transition-all duration-200 ".concat("communications"===B?"bg-white text-blue-600 shadow-md":"bg-white/20 text-white hover:bg-white/30"),children:["Communications (",Array.isArray(null===w||void 0===w||null===(e=w.lead)||void 0===e?void 0:e.booking_history)?w.lead.booking_history.filter(e=>["EMAIL_SENT","EMAIL_RECEIVED","SMS_SENT","SMS_RECEIVED"].includes(e.action)).length:0,")"]})]})]}),(0,yr.jsx)("div",{className:"p-6",children:"details"===B?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,yr.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 p-6 rounded-2xl border border-blue-200",children:[(0,yr.jsxs)("h4",{className:"font-bold text-gray-800 mb-4 flex items-center",children:[(0,yr.jsx)(vo,{className:"h-5 w-5 text-blue-600 mr-2"}),"Customer Information"]}),(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-600",children:"Name:"}),(0,yr.jsx)("span",{className:"text-gray-900",children:w.lead_name})]}),(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-600",children:"Email:"}),(0,yr.jsx)("span",{className:"text-gray-900",children:w.lead_email})]}),(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-600",children:"Phone:"}),(0,yr.jsx)("span",{className:"text-gray-900",children:w.lead_phone})]})]})]}),(0,yr.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 p-6 rounded-2xl border border-green-200",children:[(0,yr.jsxs)("h4",{className:"font-bold text-gray-800 mb-4 flex items-center",children:[(0,yr.jsx)(Ns,{className:"h-5 w-5 text-green-600 mr-2"}),"Sale Information"]}),(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-600",children:"Sale Date:"}),(0,yr.jsx)("span",{className:"text-gray-900",children:Z(w.sale_created_at||w.created_at)})]}),(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-600",children:"Amount:"}),(0,yr.jsx)("span",{className:"text-gray-900 font-bold text-green-600",children:Q(w.amount)})]}),(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-600",children:"Payment Method:"}),(0,yr.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(te(w.payment_method)),children:ne(w.payment_method)})]}),(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-600",children:"Sales Agent:"}),(0,yr.jsx)("span",{className:"text-gray-900",children:w.user_name})]}),(null===z||void 0===z||null===(t=z.contract)||void 0===t||null===(n=t.contract_data)||void 0===n?void 0:n.authCode)&&(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-600",children:"Auth Code:"}),(0,yr.jsx)("span",{className:"text-gray-900 font-mono bg-gray-100 px-2 py-0.5 rounded",children:z.contract.contract_data.authCode})]})]})]})]}),(0,yr.jsxs)("div",{className:"mt-6 bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-2xl border border-purple-200",children:[(0,yr.jsxs)("h4",{className:"font-bold text-gray-800 mb-4 flex items-center",children:[(0,yr.jsx)(Os,{className:"h-5 w-5 text-purple-600 mr-2"}),"Contract Information"]}),W?(0,yr.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-purple-500"}),(0,yr.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading contract details..."})]}):null!==z&&void 0!==z&&z.contract?(0,yr.jsxs)("div",{className:"space-y-3",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-600",children:"Status:"}),(0,yr.jsx)("span",{className:"flex items-center px-3 py-1 rounded-full text-sm font-semibold ".concat("signed"===z.contract.status?"bg-green-100 text-green-800":"sent"===z.contract.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:"signed"===z.contract.status?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(fs,{className:"h-4 w-4 mr-1"})," Signed"]}):"sent"===z.contract.status?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(ws,{className:"h-4 w-4 mr-1"})," Pending Signature"]}):z.contract.status})]}),z.contract.signed_at&&(0,yr.jsxs)("div",{className:"flex justify-between",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-600",children:"Signed At:"}),(0,yr.jsx)("span",{className:"text-gray-900",children:Z(z.contract.signed_at)})]}),z.contract.signed_pdf_url?(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-600",children:"Signed Contract:"}),(0,yr.jsxs)("a",{href:z.contract.signed_pdf_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all duration-200 shadow-md hover:shadow-lg",children:[(0,yr.jsx)(ks,{className:"h-4 w-4 mr-2"}),"Download PDF"]})]}):"signed"===z.contract.status&&z.contract.contract_token?(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-600",children:"Signed Contract:"}),(0,yr.jsxs)("a",{href:"/api/contracts/preview/".concat(z.contract.contract_token),target:"_blank",rel:"noopener noreferrer",className:"flex items-center px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all duration-200 shadow-md hover:shadow-lg",children:[(0,yr.jsx)(Ps,{className:"h-4 w-4 mr-2"}),"View PDF"]})]}):"signed"===z.contract.status?(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-600",children:"Signed Contract:"}),(0,yr.jsx)("span",{className:"text-orange-600 text-sm",children:"PDF not available - contact admin"})]}):null,z.contract.signing_url&&"signed"!==z.contract.status&&(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsx)("span",{className:"font-semibold text-gray-600",children:"Signing Link:"}),(0,yr.jsxs)("a",{href:z.contract.signing_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all duration-200 shadow-md hover:shadow-lg",children:[(0,yr.jsx)(_s,{className:"h-4 w-4 mr-2"}),"Open Signing Page"]})]})]}):(0,yr.jsx)("p",{className:"text-gray-500 italic",children:"No contract associated with this sale"})]}),(0,yr.jsxs)("div",{className:"mt-6 bg-gradient-to-br from-orange-50 to-yellow-50 p-6 rounded-2xl border border-orange-200",children:[(0,yr.jsxs)("h4",{className:"font-bold text-gray-800 mb-4 flex items-center",children:[(0,yr.jsx)(Is,{className:"h-5 w-5 text-orange-600 mr-2"}),"Selected Photos",(null===z||void 0===z||null===(r=z.selected_photos)||void 0===r?void 0:r.length)>0&&(0,yr.jsxs)("span",{className:"ml-2 px-2 py-0.5 bg-orange-200 text-orange-800 text-xs rounded-full",children:[z.selected_photos.length," photos"]})]}),W?(0,yr.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-orange-500"}),(0,yr.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading photos..."})]}):(null===z||void 0===z||null===(a=z.selected_photos)||void 0===a?void 0:a.length)>0?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:(H?z.selected_photos:z.selected_photos.slice(0,4)).map(e=>(0,yr.jsxs)("div",{className:"relative group",children:[(0,yr.jsx)(kc,{src:zl(e.cloudinary_secure_url||e.cloudinary_url,"thumbnail"),alt:e.filename||"Selected photo",className:"w-full h-32 object-cover rounded-lg shadow-md group-hover:shadow-xl transition-all duration-200",fallbackSrc:e.cloudinary_secure_url||e.cloudinary_url}),(0,yr.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-200 rounded-lg flex items-center justify-center",children:(0,yr.jsx)("a",{href:e.cloudinary_secure_url||e.cloudinary_url,target:"_blank",rel:"noopener noreferrer",className:"opacity-0 group-hover:opacity-100 p-2 bg-white rounded-full shadow-lg transition-all duration-200",children:(0,yr.jsx)(_s,{className:"h-4 w-4 text-gray-700"})})})]},e.id))}),z.selected_photos.length>4&&!H&&(0,yr.jsxs)("button",{onClick:()=>Y(!0),className:"mt-4 w-full flex items-center justify-center space-x-2 px-4 py-2 bg-orange-100 hover:bg-orange-200 text-orange-700 rounded-lg transition-colors duration-200",children:[(0,yr.jsx)(xs,{className:"h-4 w-4"}),(0,yr.jsxs)("span",{children:["Show ",z.selected_photos.length-4," more photos"]})]}),H&&z.selected_photos.length>4&&(0,yr.jsxs)("button",{onClick:()=>Y(!1),className:"mt-4 w-full flex items-center justify-center space-x-2 px-4 py-2 bg-orange-100 hover:bg-orange-200 text-orange-700 rounded-lg transition-colors duration-200",children:[(0,yr.jsx)(xs,{className:"h-4 w-4 rotate-180"}),(0,yr.jsx)("span",{children:"Show less"})]})]}):(0,yr.jsx)("p",{className:"text-gray-500 italic",children:"No photos selected for this sale"})]}),w.notes&&!(null!==z&&void 0!==z&&null!==(o=z.parsed_notes)&&void 0!==o&&o.auto_created)&&(0,yr.jsxs)("div",{className:"mt-6 bg-gray-50 p-4 rounded-xl border border-gray-200",children:[(0,yr.jsx)("h4",{className:"font-bold text-gray-800 mb-2",children:"Notes"}),(0,yr.jsx)("p",{className:"text-gray-600",children:w.notes})]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3 mt-8",children:[(0,yr.jsxs)("button",{onClick:()=>(async e=>{if(e)try{E(!0),await xr.post("/api/sales/".concat(e.id,"/send-receipt/email"),{email:e.lead_email},{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),alert("Email receipt sent")}catch(t){console.error("Failed to resend email receipt:",t),alert("Failed to send email receipt")}finally{E(!1)}})(w),disabled:_,className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 disabled:opacity-50 flex items-center transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",title:"Resend Email Receipt",children:[(0,yr.jsx)(Vs,{className:"h-4 w-4 mr-2"}),_?"Sending...":"Resend Email"]}),(0,yr.jsxs)("button",{onClick:()=>(async e=>{if(e)try{O(!0),await xr.post("/api/sales/".concat(e.id,"/send-receipt/sms"),{phone:e.lead_phone},{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),alert("SMS receipt sent")}catch(t){console.error("Failed to resend sms receipt:",t),alert("Failed to send SMS receipt")}finally{O(!1)}})(w),disabled:P,className:"px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl hover:from-green-600 hover:to-green-700 disabled:opacity-50 flex items-center transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",title:"Resend SMS Receipt",children:[(0,yr.jsx)(Ys,{className:"h-4 w-4 mr-2"}),P?"Sending...":"Resend SMS"]}),(0,yr.jsxs)("button",{onClick:()=>{k(!1),ee(w.id)},className:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl hover:from-red-600 hover:to-red-700 flex items-center transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",title:"Delete Sale",children:[(0,yr.jsx)(ho,{className:"h-4 w-4 mr-2"}),"Delete Sale"]}),(0,yr.jsx)("button",{onClick:()=>k(!1),className:"px-6 py-3 bg-gradient-to-r from-gray-400 to-gray-500 text-white rounded-xl hover:from-gray-500 hover:to-gray-600 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:"Close"})]})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(dA,{bookingHistory:null===w||void 0===w||null===(i=w.lead)||void 0===i?void 0:i.booking_history,title:"Communications History for ".concat(w.lead_name),maxHeight:"max-h-96"}),(0,yr.jsx)("div",{className:"flex justify-end space-x-3 mt-8",children:(0,yr.jsx)("button",{onClick:()=>k(!1),className:"px-6 py-3 bg-gradient-to-r from-gray-400 to-gray-500 text-white rounded-xl hover:from-gray-500 hover:to-gray-600 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:"Close"})})]})})]})}),S&&w&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,yr.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-2/3 lg:w-1/2 shadow-lg rounded-md bg-white",children:(0,yr.jsxs)("div",{className:"mt-3",children:[(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Create Finance Agreement"}),(0,yr.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["Convert this sale to a finance agreement for ",null===(l=w.lead)||void 0===l?void 0:l.name]}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount"}),(0,yr.jsx)("input",{type:"number",value:G.totalAmount,onChange:e=>X(Ye(Ye({},G),{},{totalAmount:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["weekly"===G.frequency?"Weekly":"Monthly"," Payment Amount"]}),(0,yr.jsx)("input",{type:"number",value:G.paymentAmount,onChange:e=>X(Ye(Ye({},G),{},{paymentAmount:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter custom payment amount",step:"0.01",min:"0"}),(0,yr.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Set how much the customer will pay each ","weekly"===G.frequency?"week":"month"]})]})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Frequency"}),(0,yr.jsxs)("select",{value:G.frequency,onChange:e=>X(Ye(Ye({},G),{},{frequency:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,yr.jsx)("option",{value:"weekly",children:"Weekly"}),(0,yr.jsx)("option",{value:"monthly",children:"Monthly"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),(0,yr.jsx)("input",{type:"date",value:G.startDate,onChange:e=>X(Ye(Ye({},G),{},{startDate:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),G.totalAmount&&G.paymentAmount&&(0,yr.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md border",children:[(0,yr.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Payment Summary"}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-600",children:"Total Amount:"}),(0,yr.jsxs)("span",{className:"font-medium ml-2",children:["\xa3",parseFloat(G.totalAmount).toFixed(2)]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("span",{className:"text-gray-600",children:["weekly"===G.frequency?"Weekly":"Monthly"," Payment:"]}),(0,yr.jsxs)("span",{className:"font-medium ml-2",children:["\xa3",parseFloat(G.paymentAmount||0).toFixed(2)]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-600",children:"Number of Payments:"}),(0,yr.jsx)("span",{className:"font-medium ml-2",children:G.paymentAmount>0?Math.ceil(parseFloat(G.totalAmount)/parseFloat(G.paymentAmount)):0})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-600",children:"Duration:"}),(0,yr.jsx)("span",{className:"font-medium ml-2",children:G.paymentAmount>0?"weekly"===G.frequency?"".concat(Math.ceil(parseFloat(G.totalAmount)/parseFloat(G.paymentAmount))," weeks"):"".concat(Math.ceil(parseFloat(G.totalAmount)/parseFloat(G.paymentAmount))," months"):"0 months"})]})]})]}),(0,yr.jsxs)("div",{className:"mt-4",children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),(0,yr.jsx)("textarea",{value:G.notes,onChange:e=>X(Ye(Ye({},G),{},{notes:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Additional notes..."})]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,yr.jsx)("button",{onClick:()=>C(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cancel"}),(0,yr.jsx)("button",{onClick:async()=>{try{await xr.post("/api/finance",{leadId:w.lead_id,totalAmount:parseFloat(G.totalAmount),paymentAmount:parseFloat(G.paymentAmount),frequency:G.frequency,startDate:G.startDate,notes:G.notes}),C(!1),X({totalAmount:"",paymentAmount:"",frequency:"monthly",startDate:(new Date).toISOString().split("T")[0],notes:""}),$(),K()}catch(e){console.error("Error creating finance agreement:",e)}},className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"Create Finance Agreement"})]})]})})}),D&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,yr.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,yr.jsxs)("div",{className:"mt-3 text-center",children:[(0,yr.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:(0,yr.jsx)(ho,{className:"h-6 w-6 text-red-600"})}),(0,yr.jsx)("h3",{className:"text-lg font-medium text-gray-900 mt-4",children:"Delete Selected Sales"}),(0,yr.jsx)("div",{className:"mt-2 px-7 py-3",children:(0,yr.jsxs)("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete ",A.size," selected sale",1!==A.size?"s":"","? This action cannot be undone."]})}),(0,yr.jsxs)("div",{className:"items-center px-4 py-3 flex justify-center space-x-4",children:[(0,yr.jsx)("button",{onClick:()=>M(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-300",disabled:I,children:"Cancel"}),(0,yr.jsx)("button",{onClick:async()=>{if(0!==A.size){L(!0);try{const e=await fetch("/api/sales/bulk-delete",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({saleIds:Array.from(A)})});if(console.log("\ud83d\udce5 Bulk delete response:",e),e.ok){const t=await e.json();console.log("\ud83d\udce5 Bulk delete response data:",t),await $(),await K(),T(new Set),M(!1);const n=t.message||"Successfully deleted ".concat(A.size," sales");alert(n),console.log("\u2705 Successfully deleted ".concat(A.size," sales"))}else{const t=await e.json();console.error("\u274c Failed to delete sales:",t);const n=t.message||t.error||"Unknown error";n.includes("Failed to delete sales")?alert("Failed to delete sales: "+(t.error||t.details||"Unknown error")):alert("Failed to delete sales: "+n)}}catch(e){console.error("Error deleting sales:",e),alert("Error deleting sales. Please try again.")}finally{L(!1)}}},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500",disabled:I,children:I?"Deleting...":"Delete"})]})]})})}),(0,yr.jsx)(cA,{isOpen:R,onClose:()=>F(!1),selectedSales:Array.from(A).map(e=>u.find(t=>t.id===e)).filter(Boolean),onSuccess:()=>{$(),K()}})]})})},mA=()=>{const{user:e}=Nr(),{socket:t}=Xa(),[n,r]=(0,s.useState)("email"),[a,o]=(0,s.useState)([]),[i,l]=(0,s.useState)([]),[c,d]=(0,s.useState)(null),[u,m]=(0,s.useState)(!0),[h,p]=(0,s.useState)(""),[f,g]=(0,s.useState)(""),[x,y]=(0,s.useState)(!1),[b,v]=(0,s.useState)(new Set),[w,j]=(0,s.useState)(!1);(0,s.useEffect)(()=>{try{const e=localStorage.getItem("readMessageIds");if(e){const t=JSON.parse(e);Array.isArray(t)&&v(new Set(t))}}catch(e){console.warn("Error loading read message IDs:",e)}finally{j(!0)}},[]),(0,s.useEffect)(()=>{if(w)try{localStorage.setItem("readMessageIds",JSON.stringify(Array.from(b)))}catch(e){console.warn("Error saving read message IDs:",e)}},[b,w]);const N=(0,s.useCallback)(e=>{const t=new Map;return e.forEach(e=>{if(!e.leadId)return;let r;if("email"===n&&"email"===e.type){const t=(e.subject||"").replace(/^(re|fwd?|fw):\s*/i,"").trim().toLowerCase();r="email_".concat(e.leadId,"_").concat(t)}else{if("sms"!==n||"sms"!==e.type)return;r="sms_".concat(e.leadId)}t.has(r)||t.set(r,{id:r,leadId:e.leadId,leadName:e.leadName,leadEmail:e.leadEmail,leadPhone:e.leadPhone,subject:e.subject||"",messages:[],lastMessage:null,unreadCount:0,timestamp:null,type:n});const a=t.get(r);a.messages.push(e),b.has(e.id)||e.isRead||a.unreadCount++;const s=new Date(e.timestamp||e.created_at);(!a.timestamp||s>a.timestamp)&&(a.lastMessage=e,a.timestamp=s)}),Array.from(t.values()).sort((e,t)=>t.timestamp-e.timestamp)},[n,b]),k=(0,s.useCallback)(async()=>{try{m(!0);const e=await xr.get("/api/messages-list"),t=(e.data.messages||[]).map(e=>Ye(Ye({},e),{},{isRead:b.has(e.id)||!0===e.read_status}));o(t);const n=N(t);l(n)}catch(e){console.error("Error fetching messages:",e),o([]),l([])}finally{m(!1)}},[b,N]);(0,s.useEffect)(()=>{w&&k()},[w,k]),(0,s.useEffect)(()=>{const e=N(a);l(e),d(null)},[n,a,N]),(0,s.useEffect)(()=>{if(!w)return;const e=setInterval(k,3e5);return()=>clearInterval(e)},[w,k]),(0,s.useEffect)(()=>{if(!t)return;const e=e=>{("email"===n&&"email"===e.type||"sms"===n&&"sms"===e.type)&&k()};return t.on("message_received",e),t.on("email_received",e),t.on("sms_received",e),()=>{t.off("message_received",e),t.off("email_received",e),t.off("sms_received",e)}},[t,n,k]);const S=e=>{d(e),(async e=>{const t=e.messages.filter(e=>!b.has(e.id));for(const r of t)try{await xr.put("/api/messages-list/".concat(r.id,"/read")),v(e=>new Set([...e,r.id]))}catch(n){console.error("Error marking message as read:",n)}})(e),g("")},C=i.filter(e=>{var t,n,r,a,s;if(!h)return!0;const o=h.toLowerCase();return(null===(t=e.leadName)||void 0===t?void 0:t.toLowerCase().includes(o))||(null===(n=e.leadEmail)||void 0===n?void 0:n.toLowerCase().includes(o))||(null===(r=e.leadPhone)||void 0===r?void 0:r.includes(o))||(null===(a=e.subject)||void 0===a?void 0:a.toLowerCase().includes(o))||(null===(s=e.messages)||void 0===s?void 0:s.some(e=>{var t;return null===(t=e.content)||void 0===t?void 0:t.toLowerCase().includes(o)}))}),_=e=>{if(!e)return"Just now";const t=new Date(e),n=(new Date-t)/36e5;return n<24?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):n<48?"Yesterday":t.toLocaleDateString()},E=i.filter(e=>"email"===e.type&&e.unreadCount>0).length,P=i.filter(e=>"sms"===e.type&&e.unreadCount>0).length;return(0,yr.jsxs)("div",{className:"h-screen flex flex-col bg-gray-50",children:[(0,yr.jsx)("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Messages"}),(0,yr.jsxs)("button",{onClick:k,disabled:u,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[(0,yr.jsx)(to,{className:"h-4 w-4 mr-2 ".concat(u?"animate-spin":"")}),"Refresh"]})]})}),(0,yr.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,yr.jsxs)("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col",children:[(0,yr.jsxs)("div",{className:"flex border-b border-gray-200",children:[(0,yr.jsxs)("button",{onClick:()=>r("email"),className:"flex-1 px-4 py-3 text-sm font-medium flex items-center justify-center space-x-2 ".concat("email"===n?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"),children:[(0,yr.jsx)(Vs,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Emails"}),E>0&&(0,yr.jsx)("span",{className:"ml-1 px-2 py-0.5 text-xs font-semibold bg-blue-100 text-blue-800 rounded-full",children:E})]}),(0,yr.jsxs)("button",{onClick:()=>r("sms"),className:"flex-1 px-4 py-3 text-sm font-medium flex items-center justify-center space-x-2 ".concat("sms"===n?"text-green-600 border-b-2 border-green-600 bg-green-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"),children:[(0,yr.jsx)(Ys,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"SMS"}),P>0&&(0,yr.jsx)("span",{className:"ml-1 px-2 py-0.5 text-xs font-semibold bg-green-100 text-green-800 rounded-full",children:P})]})]}),(0,yr.jsx)("div",{className:"p-3 border-b border-gray-200",children:(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsx)(ro,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,yr.jsx)("input",{type:"text",placeholder:"Search conversations...",value:h,onChange:e=>p(e.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),(0,yr.jsx)("div",{className:"flex-1 overflow-y-auto",children:u?(0,yr.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,yr.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):0===C.length?(0,yr.jsxs)("div",{className:"text-center py-12 px-4",children:[(0,yr.jsx)("div",{className:"text-gray-400 mb-2",children:"email"===n?(0,yr.jsx)(Vs,{className:"h-12 w-12 mx-auto"}):(0,yr.jsx)(Ys,{className:"h-12 w-12 mx-auto"})}),(0,yr.jsxs)("p",{className:"text-sm text-gray-500",children:["No ","email"===n?"emails":"messages"," found"]})]}):C.map(e=>{var t;return(0,yr.jsxs)("div",{onClick:()=>S(e),className:"px-4 py-3 border-b border-gray-100 cursor-pointer transition-all ".concat((null===c||void 0===c?void 0:c.id)===e.id?"bg-blue-50 border-l-4 border-l-blue-600":e.unreadCount>0?"bg-blue-50/50 hover:bg-blue-50":"hover:bg-gray-50"),children:[(0,yr.jsxs)("div",{className:"flex items-start justify-between mb-1",children:[(0,yr.jsx)("p",{className:"text-sm font-medium truncate ".concat(e.unreadCount>0?"text-gray-900 font-semibold":"text-gray-700"),children:e.leadName}),(0,yr.jsx)("span",{className:"text-xs text-gray-500 ml-2 flex-shrink-0",children:_(e.timestamp)})]}),"email"===n&&e.subject&&(0,yr.jsx)("p",{className:"text-xs mb-1 truncate ".concat(e.unreadCount>0?"text-gray-900 font-medium":"text-gray-600"),children:e.subject}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 truncate",children:To((null===(t=e.lastMessage)||void 0===t?void 0:t.content)||"",60)}),e.unreadCount>0&&(0,yr.jsx)("div",{className:"mt-1 flex items-center space-x-1",children:(0,yr.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:[e.unreadCount," unread"]})})]},e.id)})})]}),(0,yr.jsx)("div",{className:"flex-1 flex flex-col bg-gray-50",children:c?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsxs)("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsx)("button",{onClick:()=>d(null),className:"lg:hidden text-gray-500 hover:text-gray-700",children:(0,yr.jsx)(ys,{className:"h-5 w-5"})}),(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:c.leadName}),"email"===n?(0,yr.jsx)("p",{className:"text-sm text-gray-500",children:c.leadEmail}):(0,yr.jsx)("p",{className:"text-sm text-gray-500",children:c.leadPhone})]}),(0,yr.jsx)("div",{className:"flex items-center space-x-2",children:(0,yr.jsx)("button",{className:"p-2 text-gray-400 hover:text-yellow-500 hover:bg-gray-100 rounded-lg",children:(0,yr.jsx)(lo,{className:"h-5 w-5"})})})]}),"email"===n&&c.subject&&(0,yr.jsxs)("p",{className:"mt-2 text-sm font-medium text-gray-700",children:["Subject: ",c.subject]})]}),(0,yr.jsx)("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-4",children:c.messages.sort((e,t)=>new Date(e.timestamp||e.created_at)-new Date(t.timestamp||t.created_at)).map((e,t)=>{var r;return(0,yr.jsxs)("div",{className:"rounded-lg shadow-sm border p-4 ".concat("sent"===e.direction?"bg-blue-50 border-blue-200 ml-12":"bg-white border-gray-200 mr-12"),children:[(0,yr.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat("sent"===e.direction?"bg-blue-600":"bg-gray-600"),children:(0,yr.jsx)("span",{className:"text-white text-sm font-medium",children:"sent"===e.direction?"Y":((null===(r=e.leadName)||void 0===r?void 0:r[0])||"?").toUpperCase()})}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"sent"===e.direction?"You":e.leadName}),(0,yr.jsx)("p",{className:"text-xs text-gray-500",children:"sent"===e.direction?c.leadEmail||c.leadPhone:"email"===n?c.leadEmail:c.leadPhone})]})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[(0,yr.jsx)(ws,{className:"h-3 w-3"}),(0,yr.jsx)("span",{children:_(e.timestamp||e.created_at)})]})]}),(0,yr.jsx)("div",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:e.content})]},e.id||t)})}),(0,yr.jsxs)("div",{className:"bg-white border-t border-gray-200 px-6 py-4",children:[(0,yr.jsxs)("div",{className:"mb-3",children:[(0,yr.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Reply to ","email"===n?c.leadEmail:c.leadPhone]}),(0,yr.jsx)("textarea",{value:f,onChange:e=>g(e.target.value),placeholder:"Type your ".concat("email"===n?"email":"message"," here..."),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"})]}),(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsx)("div",{className:"flex items-center space-x-2",children:"email"===n&&(0,yr.jsx)("button",{className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:(0,yr.jsx)($s,{className:"h-5 w-5"})})}),(0,yr.jsx)("button",{onClick:async()=>{if(f.trim()&&c)try{y(!0),"email"===n?await xr.post("/api/messages/send-email",{leadId:c.leadId,to:c.leadEmail,subject:c.subject.startsWith("Re:")?c.subject:"Re: ".concat(c.subject),body:f}):await xr.post("/api/messages/send-sms",{leadId:c.leadId,to:c.leadPhone,message:f}),g(""),setTimeout(k,1e3)}catch(e){console.error("Error sending reply:",e),alert("Failed to send message")}finally{y(!1)}},disabled:!f.trim()||x,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:x?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(ao,{className:"h-4 w-4 mr-2"}),"Send ","email"===n?"Email":"SMS"]})})]})]})]}):(0,yr.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:(0,yr.jsxs)("div",{className:"text-center",children:["email"===n?(0,yr.jsx)(Vs,{className:"h-16 w-16 mx-auto mb-4"}):(0,yr.jsx)(Ys,{className:"h-16 w-16 mx-auto mb-4"}),(0,yr.jsx)("p",{className:"text-lg font-medium",children:"Select a conversation"}),(0,yr.jsxs)("p",{className:"text-sm mt-1",children:["Choose a ","email"===n?"email thread":"conversation"," from the list to view messages"]})]})})})]})]})},hA=()=>{const{user:e}=Nr(),[t,n]=(0,s.useState)((new Date).toISOString().split("T")[0]),[r,a]=(0,s.useState)([]),[o,i]=(0,s.useState)(!1),[l,c]=(0,s.useState)(""),[d,u]=(0,s.useState)(!1),[m,h]=(0,s.useState)("full-day"),[p,f]=(0,s.useState)(""),[g,x]=(0,s.useState)(null),y=["10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30"];(0,s.useEffect)(()=>{"admin"===(null===e||void 0===e?void 0:e.role)&&b()},[e,t]);const b=async()=>{try{i(!0);const e=await xr.get("/api/blocked-slots",{params:{start_date:t,end_date:t}});a(e.data)}catch(e){console.error("Error fetching blocked slots:",e),alert("Error loading blocked slots")}finally{i(!1)}},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return r.some(n=>{if(!n.time_slot){if(t&&n.slot_number)return parseInt(n.slot_number)===parseInt(t);if(!n.slot_number)return!0}if(e&&n.time_slot===e){if(t&&n.slot_number)return parseInt(n.slot_number)===parseInt(t);if(!n.slot_number)return!0}return!1})},w=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=r.find(n=>{if(e){if(n.time_slot===e)return t&&n.slot_number?parseInt(n.slot_number)===parseInt(t):!n.slot_number}else if(!n.time_slot)return t&&n.slot_number?parseInt(n.slot_number)===parseInt(t):!n.slot_number;return!1});return(null===n||void 0===n?void 0:n.reason)||""};return"admin"!==(null===e||void 0===e?void 0:e.role)?(0,yr.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Access Denied"}),(0,yr.jsx)("p",{className:"text-gray-600",children:"Only administrators can manage blocked slots."})]})}):(0,yr.jsxs)("div",{className:"min-h-screen bg-gray-50 p-6",children:[(0,yr.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,yr.jsx)(hs,{className:"text-2xl text-blue-600"}),(0,yr.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Manage Blocked Slots"})]}),(0,yr.jsxs)("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[(0,yr.jsx)(Us,{}),"Block Slot"]})]}),(0,yr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,yr.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Select Date:"}),(0,yr.jsx)("input",{type:"date",value:t,onChange:e=>n(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,yr.jsxs)("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:["Blocked Slots for ",new Date(t).toLocaleDateString("en-GB",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),o?(0,yr.jsx)("p",{className:"text-gray-600",children:"Loading..."}):0===r.length?(0,yr.jsx)("p",{className:"text-gray-600",children:"No blocked slots for this date."}):(0,yr.jsx)("div",{className:"space-y-3",children:r.map(e=>(0,yr.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[(0,yr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,yr.jsx)(Us,{className:"text-red-500"}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"font-medium text-gray-800",children:e.time_slot?(0,yr.jsxs)(yr.Fragment,{children:[e.time_slot,e.slot_number?" - Slot ".concat(e.slot_number):" - All Slots"]}):(0,yr.jsxs)(yr.Fragment,{children:["Full Day Blocked",e.slot_number&&" - Slot ".concat(e.slot_number," only")]})}),(0,yr.jsx)("p",{className:"text-sm text-gray-600",children:e.reason})]})]}),(0,yr.jsxs)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to unblock this slot?"))try{i(!0),await xr.delete("/api/blocked-slots/".concat(e)),b(),alert("Slot unblocked successfully")}catch(t){console.error("Error unblocking slot:",t),alert("Error unblocking slot")}finally{i(!1)}})(e.id),className:"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700 flex items-center gap-2",children:[(0,yr.jsx)(xo,{}),"Unblock"]})]},e.id))})]}),(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yr.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Time Slots Overview"}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h3",{className:"text-md font-semibold text-gray-700 mb-3 text-center",children:"Slot 1"}),(0,yr.jsx)("div",{className:"space-y-2",children:y.map(e=>(0,yr.jsxs)("div",{className:"p-3 rounded-lg border ".concat(v(e,1)?"bg-red-100 border-red-300":"bg-green-100 border-green-300"),children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsx)("span",{className:"font-medium",children:e}),v(e,1)?(0,yr.jsxs)("span",{className:"text-sm text-red-600 flex items-center gap-1",children:[(0,yr.jsx)(Us,{})," Blocked"]}):(0,yr.jsx)("span",{className:"text-sm text-green-600",children:"Available"})]}),v(e,1)&&(0,yr.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:w(e,1)})]},"slot1-".concat(e)))})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h3",{className:"text-md font-semibold text-gray-700 mb-3 text-center",children:"Slot 2"}),(0,yr.jsx)("div",{className:"space-y-2",children:y.map(e=>(0,yr.jsxs)("div",{className:"p-3 rounded-lg border ".concat(v(e,2)?"bg-red-100 border-red-300":"bg-green-100 border-green-300"),children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsx)("span",{className:"font-medium",children:e}),v(e,2)?(0,yr.jsxs)("span",{className:"text-sm text-red-600 flex items-center gap-1",children:[(0,yr.jsx)(Us,{})," Blocked"]}):(0,yr.jsx)("span",{className:"text-sm text-green-600",children:"Available"})]}),v(e,2)&&(0,yr.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:w(e,2)})]},"slot2-".concat(e)))})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h3",{className:"text-md font-semibold text-gray-700 mb-3 text-center",children:"Slot 3"}),(0,yr.jsx)("div",{className:"space-y-2",children:y.map(e=>(0,yr.jsxs)("div",{className:"p-3 rounded-lg border ".concat(v(e,3)?"bg-red-100 border-red-300":"bg-green-100 border-green-300"),children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsx)("span",{className:"font-medium",children:e}),v(e,3)?(0,yr.jsxs)("span",{className:"text-sm text-red-600 flex items-center gap-1",children:[(0,yr.jsx)(Us,{})," Blocked"]}):(0,yr.jsx)("span",{className:"text-sm text-green-600",children:"Available"})]}),v(e,3)&&(0,yr.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:w(e,3)})]},"slot3-".concat(e)))})]})]})]})]}),d&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yr.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Block Slot"}),(0,yr.jsx)("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"text-xl"})})]}),(0,yr.jsxs)("div",{className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Block Type"}),(0,yr.jsxs)("select",{value:m,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,yr.jsx)("option",{value:"full-day",children:"Full Day (All Slots)"}),(0,yr.jsx)("option",{value:"time-slot",children:"Specific Time (All Slots)"}),(0,yr.jsx)("option",{value:"slot-column",children:"Specific Time & Slot Number"})]})]}),("time-slot"===m||"slot-column"===m)&&(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Slot"}),(0,yr.jsxs)("select",{value:p,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,yr.jsx)("option",{value:"",children:"Select time..."}),y.map(e=>(0,yr.jsx)("option",{value:e,children:e},e))]})]}),"slot-column"===m&&(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Slot Number"}),(0,yr.jsxs)("select",{value:g||"",onChange:e=>x(e.target.value?parseInt(e.target.value):null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,yr.jsx)("option",{value:"",children:"Select slot..."}),(0,yr.jsx)("option",{value:"1",children:"Slot 1"}),(0,yr.jsx)("option",{value:"2",children:"Slot 2"}),(0,yr.jsx)("option",{value:"3",children:"Slot 3"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason (optional)"}),(0,yr.jsx)("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"e.g., Holiday, Staff unavailable",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,yr.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,yr.jsx)("button",{onClick:()=>u(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,yr.jsx)("button",{onClick:async()=>{try{i(!0);const e={date:t,reason:l||"Unavailable"};"time-slot"===m&&(e.time_slot=p),"slot-column"===m&&(e.time_slot=p,e.slot_number=g),"full-day"===m&&g&&(e.slot_number=g),await xr.post("/api/blocked-slots",e),u(!1),c(""),f(""),x(null),b(),alert("Slot blocked successfully")}catch(a){var e,n,r;if(console.error("Error blocking slot:",a),409===(null===(e=a.response)||void 0===e?void 0:e.status))alert("This slot is already blocked");else alert("Error blocking slot: "+((null===(n=a.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||a.message))}finally{i(!1)}},disabled:o||"full-day"!==m&&!p||"slot-column"===m&&!g,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:o?"Blocking...":"Block Slot"})]})]})]})})]})},pA=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],fA=(()=>new Set(pA))(),gA=e=>180*e/Math.PI,xA=e=>{const t=gA(Math.atan2(e[1],e[0]));return bA(t)},yA={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:xA,rotateZ:xA,skewX:e=>gA(Math.atan(e[1])),skewY:e=>gA(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},bA=e=>((e%=360)<0&&(e+=360),e),vA=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),wA=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),jA={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:vA,scaleY:wA,scale:e=>(vA(e)+wA(e))/2,rotateX:e=>bA(gA(Math.atan2(e[6],e[5]))),rotateY:e=>bA(gA(Math.atan2(-e[2],e[0]))),rotateZ:xA,rotate:xA,skewX:e=>gA(Math.atan(e[4])),skewY:e=>gA(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function NA(e){return e.includes("scale")?1:0}function kA(e,t){if(!e||"none"===e)return NA(t);const n=e.match(/^matrix3d\(([\t-\r ,-\.0-9e\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)\)$/);let r,a;if(n)r=jA,a=n;else{const t=e.match(/^matrix\(([\t-\r ,-\.0-9e\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)\)$/);r=yA,a=t}if(!a)return NA(t);const s=r[t],o=a[1].split(",").map(SA);return"function"===typeof s?s(o):o[s]}function SA(e){return parseFloat(e.trim())}const CA=e=>t=>"string"===typeof t&&t.startsWith(e),_A=CA("--"),EA=CA("var(--"),PA=e=>!!EA(e)&&OA.test(e.split("/*")[0].trim()),OA=/var\(--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)$/i;function AA(e){let{top:t,left:n,right:r,bottom:a}=e;return{x:{min:n,max:r},y:{min:t,max:a}}}const TA=(e,t,n)=>e+(t-e)*n;function DA(e){return void 0===e||1===e}function MA(e){let{scale:t,scaleX:n,scaleY:r}=e;return!DA(t)||!DA(n)||!DA(r)}function IA(e){return MA(e)||LA(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function LA(e){return RA(e.x)||RA(e.y)}function RA(e){return e&&"0%"!==e}function FA(e,t,n){return n+t*(e-n)}function BA(e,t,n,r,a){return void 0!==a&&(e=FA(e,a,r)),FA(e,n,r)+t}function UA(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;e.min=BA(e.min,t,n,r,a),e.max=BA(e.max,t,n,r,a)}function zA(e,t){let{x:n,y:r}=t;UA(e.x,n.translate,n.scale,n.originPoint),UA(e.y,r.translate,r.scale,r.originPoint)}const VA=.999999999999,WA=1.0000000000001;function qA(e,t){e.min=e.min+t,e.max=e.max+t}function HA(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;UA(e,t,n,TA(e.min,e.max,a),r)}function YA(e,t){HA(e.x,t.x,t.scaleX,t.scale,t.originX),HA(e.y,t.y,t.scaleY,t.scale,t.originY)}function GA(e,t){return AA(function(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}(e.getBoundingClientRect(),t))}const XA=new Set(["width","height","top","left","right","bottom",...pA]),$A=(e,t,n)=>n>t?t:n<e?e:n,KA={test:e=>"number"===typeof e,parse:parseFloat,transform:e=>e},JA=Ye(Ye({},KA),{},{transform:e=>$A(0,1,e)}),QA=Ye(Ye({},KA),{},{default:1}),ZA=e=>({test:t=>"string"===typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>"".concat(t).concat(e)}),eT=ZA("deg"),tT=ZA("%"),nT=ZA("px"),rT=ZA("vh"),aT=ZA("vw"),sT=(()=>Ye(Ye({},tT),{},{parse:e=>tT.parse(e)/100,transform:e=>tT.transform(100*e)}))(),oT=e=>t=>t.test(e),iT=[KA,nT,tT,eT,aT,rT,{test:e=>"auto"===e,parse:e=>e}],lT=e=>iT.find(oT(e));const cT=e=>/^-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)$/.test(e),dT=/^var\(--(?:([\x2D0-9A-Z_a-z]+)|([\x2D0-9A-Z_a-z]+), ?([ #%\(\),-\.0-9A-Za-z]+))\)/;function uT(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;'Max CSS variable fallback depth detected in property "'.concat(e,'". This may indicate a circular fallback dependency.');const[r,a]=function(e){const t=dT.exec(e);if(!t)return[,];const[,n,r,a]=t;return["--".concat(null!==n&&void 0!==n?n:r),a]}(e);if(!r)return;const s=window.getComputedStyle(t).getPropertyValue(r);if(s){const e=s.trim();return cT(e)?parseFloat(e):e}return PA(a)?uT(a,t,n+1):a}const mT=e=>e===KA||e===nT,hT=new Set(["x","y","z"]),pT=pA.filter(e=>!hT.has(e));const fT={width:(e,t)=>{let{x:n}=e,{paddingLeft:r="0",paddingRight:a="0"}=t;return n.max-n.min-parseFloat(r)-parseFloat(a)},height:(e,t)=>{let{y:n}=e,{paddingTop:r="0",paddingBottom:a="0"}=t;return n.max-n.min-parseFloat(r)-parseFloat(a)},top:(e,t)=>{let{top:n}=t;return parseFloat(n)},left:(e,t)=>{let{left:n}=t;return parseFloat(n)},bottom:(e,t)=>{let{y:n}=e,{top:r}=t;return parseFloat(r)+(n.max-n.min)},right:(e,t)=>{let{x:n}=e,{left:r}=t;return parseFloat(r)+(n.max-n.min)},x:(e,t)=>{let{transform:n}=t;return kA(n,"x")},y:(e,t)=>{let{transform:n}=t;return kA(n,"y")}};fT.translateX=fT.x,fT.translateY=fT.y;const gT=e=>e,xT={},yT=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],bT={value:null,addProjectionMetrics:null};function vT(e,t){let n=!1,r=!0;const a={delta:0,timestamp:0,isProcessing:!1},s=()=>n=!0,o=yT.reduce((e,n)=>(e[n]=function(e,t){let n=new Set,r=new Set,a=!1,s=!1;const o=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1},l=0;function c(t){o.has(t)&&(d.schedule(t),e()),l++,t(i)}const d={schedule:function(e){const t=arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&a?n:r;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&o.add(e),t.has(e)||t.add(e),e},cancel:e=>{r.delete(e),o.delete(e)},process:e=>{i=e,a?s=!0:(a=!0,[n,r]=[r,n],n.forEach(c),t&&bT.value&&bT.value.frameloop[t].push(l),l=0,n.clear(),a=!1,s&&(s=!1,d.process(e)))}};return d}(s,t?n:void 0),e),{}),{setup:i,read:l,resolveKeyframes:c,preUpdate:d,update:u,preRender:m,render:h,postRender:p}=o,f=()=>{const s=xT.useManualTiming?a.timestamp:performance.now();n=!1,xT.useManualTiming||(a.delta=r?1e3/60:Math.max(Math.min(s-a.timestamp,40),1)),a.timestamp=s,a.isProcessing=!0,i.process(a),l.process(a),c.process(a),d.process(a),u.process(a),m.process(a),h.process(a),p.process(a),a.isProcessing=!1,n&&t&&(r=!1,e(f))},g=yT.reduce((t,s)=>{const i=o[s];return t[s]=function(t){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n||(n=!0,r=!0,a.isProcessing||e(f)),i.schedule(t,s,o)},t},{});return{schedule:g,cancel:e=>{for(let t=0;t<yT.length;t++)o[yT[t]].cancel(e)},state:a,steps:o}}const{schedule:wT,cancel:jT,state:NT,steps:kT}=vT("undefined"!==typeof requestAnimationFrame?requestAnimationFrame:gT,!0),ST=new Set;let CT=!1,_T=!1,ET=!1;function PT(){if(_T){const e=Array.from(ST).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),n=new Map;t.forEach(e=>{const t=function(e){const t=[];return pT.forEach(n=>{const r=e.getValue(n);void 0!==r&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}(e);t.length&&(n.set(e,t),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();const t=n.get(e);t&&t.forEach(t=>{var n;let[r,a]=t;null===(n=e.getValue(r))||void 0===n||n.set(a)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}_T=!1,CT=!1,ST.forEach(e=>e.complete(ET)),ST.clear()}function OT(){ST.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(_T=!0)})}class AT{constructor(e,t,n,r,a){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=r,this.element=a,this.isAsync=s}scheduleResolve(){this.state="scheduled",this.isAsync?(ST.add(this),CT||(CT=!0,wT.read(OT),wT.resolveKeyframes(PT))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:r}=this;if(null===e[0]){const a=null===r||void 0===r?void 0:r.get(),s=e[e.length-1];if(void 0!==a)e[0]=a;else if(n&&t){const r=n.readValue(t,s);void 0!==r&&null!==r&&(e[0]=r)}void 0===e[0]&&(e[0]=s),r&&void 0===a&&r.set(e[0])}!function(e){for(let n=1;n<e.length;n++){var t;null!==(t=e[n])&&void 0!==t||(e[n]=e[n-1])}}(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),ST.delete(this)}cancel(){"scheduled"===this.state&&(ST.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}const TT=e=>/^0(?:[\0-\x08\x0E-\x1F!-\x2D\/-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+$/.test(e);function DT(e){return"number"===typeof e?0===e:null===e||("none"===e||"0"===e||TT(e))}const MT=e=>Math.round(1e5*e)/1e5,IT=/-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/g;const LT=/^(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))$/i,RT=(e,t)=>n=>Boolean("string"===typeof n&&LT.test(n)&&n.startsWith(e)||t&&!function(e){return null==e}(n)&&Object.prototype.hasOwnProperty.call(n,t)),FT=(e,t,n)=>r=>{if("string"!==typeof r)return r;const[a,s,o,i]=r.match(IT);return{[e]:parseFloat(a),[t]:parseFloat(s),[n]:parseFloat(o),alpha:void 0!==i?parseFloat(i):1}},BT=Ye(Ye({},KA),{},{transform:e=>Math.round((e=>$A(0,255,e))(e))}),UT={test:RT("rgb","red"),parse:FT("red","green","blue"),transform:e=>{let{red:t,green:n,blue:r,alpha:a=1}=e;return"rgba("+BT.transform(t)+", "+BT.transform(n)+", "+BT.transform(r)+", "+MT(JA.transform(a))+")"}};const zT={test:RT("#"),parse:function(e){let t="",n="",r="",a="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),a=e.substring(4,5),t+=t,n+=n,r+=r,a+=a),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:a?parseInt(a,16)/255:1}},transform:UT.transform},VT={test:RT("hsl","hue"),parse:FT("hue","saturation","lightness"),transform:e=>{let{hue:t,saturation:n,lightness:r,alpha:a=1}=e;return"hsla("+Math.round(t)+", "+tT.transform(MT(n))+", "+tT.transform(MT(r))+", "+MT(JA.transform(a))+")"}},WT={test:e=>UT.test(e)||zT.test(e)||VT.test(e),parse:e=>UT.test(e)?UT.parse(e):VT.test(e)?VT.parse(e):zT.parse(e),transform:e=>"string"===typeof e?e:e.hasOwnProperty("red")?UT.transform(e):VT.transform(e),getAnimatableNone:e=>{const t=WT.parse(e);return t.alpha=0,WT.transform(t)}},qT=/(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))/gi;const HT="number",YT="color",GT=/var[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)|#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\)|-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/gi;function XT(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},a=[];let s=0;const o=t.replace(GT,e=>(WT.test(e)?(r.color.push(s),a.push(YT),n.push(WT.parse(e))):e.startsWith("var(")?(r.var.push(s),a.push("var"),n.push(e)):(r.number.push(s),a.push(HT),n.push(parseFloat(e))),++s,"${}")).split("${}");return{values:n,split:o,indexes:r,types:a}}function $T(e){return XT(e).values}function KT(e){const{split:t,types:n}=XT(e),r=t.length;return e=>{let a="";for(let s=0;s<r;s++)if(a+=t[s],void 0!==e[s]){const t=n[s];a+=t===HT?MT(e[s]):t===YT?WT.transform(e[s]):e[s]}return a}}const JT=e=>"number"===typeof e?0:WT.test(e)?WT.getAnimatableNone(e):e;const QT={test:function(e){var t,n;return isNaN(e)&&"string"===typeof e&&((null===(t=e.match(IT))||void 0===t?void 0:t.length)||0)+((null===(n=e.match(qT))||void 0===n?void 0:n.length)||0)>0},parse:$T,createTransformer:KT,getAnimatableNone:function(e){const t=$T(e);return KT(e)(t.map(JT))}},ZT=new Set(["brightness","contrast","saturate","opacity"]);function eD(e){const[t,n]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[r]=n.match(IT)||[];if(!r)return e;const a=n.replace(r,"");let s=ZT.has(t)?1:0;return r!==n&&(s*=100),t+"("+s+a+")"}const tD=/\b([\x2Da-z]*)\((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\)/g,nD=Ye(Ye({},QT),{},{getAnimatableNone:e=>{const t=e.match(tD);return t?t.map(eD).join(" "):e}}),rD=Ye(Ye({},KA),{},{transform:Math.round}),aD=Ye(Ye({borderWidth:nT,borderTopWidth:nT,borderRightWidth:nT,borderBottomWidth:nT,borderLeftWidth:nT,borderRadius:nT,radius:nT,borderTopLeftRadius:nT,borderTopRightRadius:nT,borderBottomRightRadius:nT,borderBottomLeftRadius:nT,width:nT,maxWidth:nT,height:nT,maxHeight:nT,top:nT,right:nT,bottom:nT,left:nT,padding:nT,paddingTop:nT,paddingRight:nT,paddingBottom:nT,paddingLeft:nT,margin:nT,marginTop:nT,marginRight:nT,marginBottom:nT,marginLeft:nT,backgroundPositionX:nT,backgroundPositionY:nT},{rotate:eT,rotateX:eT,rotateY:eT,rotateZ:eT,scale:QA,scaleX:QA,scaleY:QA,scaleZ:QA,skew:eT,skewX:eT,skewY:eT,distance:nT,translateX:nT,translateY:nT,translateZ:nT,x:nT,y:nT,z:nT,perspective:nT,transformPerspective:nT,opacity:JA,originX:sT,originY:sT,originZ:nT}),{},{zIndex:rD,fillOpacity:JA,strokeOpacity:JA,numOctaves:rD}),sD=Ye(Ye({},aD),{},{color:WT,backgroundColor:WT,outlineColor:WT,fill:WT,stroke:WT,borderColor:WT,borderTopColor:WT,borderRightColor:WT,borderBottomColor:WT,borderLeftColor:WT,filter:nD,WebkitFilter:nD}),oD=e=>sD[e];function iD(e,t){let n=oD(e);return n!==nD&&(n=QT),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const lD=new Set(["auto","none","0"]);class cD extends AT{constructor(e,t,n,r,a){super(e,t,n,r,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let i=0;i<e.length;i++){let n=e[i];if("string"===typeof n&&(n=n.trim(),PA(n))){const r=uT(n,t.current);void 0!==r&&(e[i]=r),i===e.length-1&&(this.finalKeyframe=n)}}if(this.resolveNoneKeyframes(),!XA.has(n)||2!==e.length)return;const[r,a]=e,s=lT(r),o=lT(a);if(s!==o)if(mT(s)&&mT(o))for(let i=0;i<e.length;i++){const t=e[i];"string"===typeof t&&(e[i]=parseFloat(t))}else fT[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let r=0;r<e.length;r++)(null===e[r]||DT(e[r]))&&n.push(r);n.length&&function(e,t,n){let r,a=0;for(;a<e.length&&!r;){const t=e[a];"string"===typeof t&&!lD.has(t)&&XT(t).values.length&&(r=e[a]),a++}if(r&&n)for(const s of t)e[s]=iD(n,r)}(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=fT[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];void 0!==r&&e.getValue(n,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const a=t.getValue(n);a&&a.jump(this.measuredOrigin,!1);const s=r.length-1,o=r[s];r[s]=fT[n](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==o&&void 0===this.finalKeyframe&&(this.finalKeyframe=o),null!==(e=this.removedTransforms)&&void 0!==e&&e.length&&this.removedTransforms.forEach(e=>{let[n,r]=e;t.getValue(n).set(r)}),this.resolveNoneKeyframes()}}const dD=e=>Boolean(e&&e.getVelocity);let uD;function mD(){uD=void 0}const hD={now:()=>(void 0===uD&&hD.set(NT.isProcessing||xT.useManualTiming?NT.timestamp:performance.now()),uD),set:e=>{uD=e,queueMicrotask(mD)}};function pD(e,t){-1===e.indexOf(t)&&e.push(t)}function fD(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class gD{constructor(){this.subscriptions=[]}add(e){return pD(this.subscriptions,e),()=>fD(this.subscriptions,e)}notify(e,t,n){const r=this.subscriptions.length;if(r)if(1===r)this.subscriptions[0](e,t,n);else for(let a=0;a<r;a++){const r=this.subscriptions[a];r&&r(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function xD(e,t){return t?e*(1e3/t):0}const yD={current:void 0};class bD{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.canTrackVelocity=null,this.events={},this.updateAndNotify=e=>{const t=hD.now();var n;if((this.updatedAt!==t&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev)&&(null===(n=this.events.change)||void 0===n||n.notify(this.current),this.dependents))for(const r of this.dependents)r.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=hD.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=(e=>!isNaN(parseFloat(e)))(this.current))}setPrevFrameValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.current;this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new gD);const n=this.events[e].add(t);return"change"===e?()=>{n(),wT.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;null===(e=this.events.change)||void 0===e||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return yD.current&&yD.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=hD.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||e-this.updatedAt>30)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,30);return xD(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;null===(e=this.dependents)||void 0===e||e.clear(),null===(t=this.events.destroy)||void 0===t||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function vD(e,t){return new bD(e,t)}const wD=[...iT,WT,QT],{schedule:jD,cancel:ND}=vT(queueMicrotask,!1),kD={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},SD={};for(const n in kD)SD[n]={isEnabled:e=>kD[n].some(t=>!!e[t])};const CD=()=>({x:{min:0,max:0},y:{min:0,max:0}}),_D="undefined"!==typeof window,ED={current:null},PD={current:!1};const OD=new WeakMap;function AD(e){return null!==e&&"object"===typeof e&&"function"===typeof e.start}function TD(e){return"string"===typeof e||Array.isArray(e)}const DD=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],MD=["initial",...DD];function ID(e){return AD(e.animate)||MD.some(t=>TD(e[t]))}function LD(e){return Boolean(ID(e)||e.variants)}function RD(e){const t=[{},{}];return null===e||void 0===e||e.values.forEach((e,n)=>{t[0][n]=e.get(),t[1][n]=e.getVelocity()}),t}function FD(e,t,n,r){if("function"===typeof t){const[a,s]=RD(r);t=t(void 0!==n?n:e.custom,a,s)}if("string"===typeof t&&(t=e.variants&&e.variants[t]),"function"===typeof t){const[a,s]=RD(r);t=t(void 0!==n?n:e.custom,a,s)}return t}const BD=["willChange"],UD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class zD{scrapeMotionValuesFromProps(e,t,n){return{}}constructor(e){let{parent:t,props:n,presenceContext:r,reducedMotionConfig:a,blockInitialAnimation:s,visualState:o}=e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=AT,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const e=hD.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,wT.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget=Ye({},l),this.initialValues=n.initial?Ye({},l):{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=i,this.blockInitialAnimation=Boolean(s),this.isControllingVariants=ID(n),this.isVariantNode=LD(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(t&&t.current);const d=this.scrapeMotionValuesFromProps(n,{},this),{willChange:u}=d,m=Il(d,BD);for(const h in m){const e=m[h];void 0!==l[h]&&dD(e)&&e.set(l[h])}}mount(e){var t;this.current=e,OD.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),PD.current||function(){if(PD.current=!0,_D)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>ED.current=e.matches;e.addEventListener("change",t),t()}else ED.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||ED.current),null===(t=this.parent)||void 0===t||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),jT(this.notifyUpdate),jT(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),null===(e=this.parent)||void 0===e||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}addChild(e){var t;this.children.add(e),null!==(t=this.enteringChildren)&&void 0!==t||(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=fA.has(e);n&&this.onBindTransform&&this.onBindTransform();const r=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&wT.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in SD){const t=SD[e];if(!t)continue;const{isEnabled:n,Feature:r}=t;if(!this.features[e]&&r&&n(this.props)&&(this.features[e]=new r(this)),this.features[e]){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<UD.length;n++){const t=UD[n];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const r=e["on"+t];r&&(this.propEventSubscriptions[t]=this.on(t,r))}this.prevMotionValues=function(e,t,n){for(const r in t){const a=t[r],s=n[r];if(dD(a))e.addValue(r,a);else if(dD(s))e.addValue(r,vD(a,{owner:e}));else if(s!==a)if(e.hasValue(r)){const t=e.getValue(r);!0===t.liveStyle?t.jump(a):t.hasAnimated||t.set(a)}else{const t=e.getStaticValue(r);e.addValue(r,vD(void 0!==t?t:a,{owner:e}))}}for(const r in n)void 0===t[r]&&e.removeValue(r);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==t&&(n=vD(null===t?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let r=void 0===this.latestValues[e]&&this.current?null!==(n=this.getBaseTargetFromProps(this.props,e))&&void 0!==n?n:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];var a;return void 0!==r&&null!==r&&("string"===typeof r&&(cT(r)||TT(r))?r=parseFloat(r):(a=r,!wD.find(oT(a))&&QT.test(t)&&(r=iD(e,t))),this.setBaseTarget(e,dD(r)?r.get():r)),dD(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let n;if("string"===typeof t||"object"===typeof t){var r;const a=FD(this.props,t,null===(r=this.presenceContext)||void 0===r?void 0:r.custom);a&&(n=a[e])}if(t&&void 0!==n)return n;const a=this.getBaseTargetFromProps(this.props,e);return void 0===a||dD(a)?void 0!==this.initialValues[e]&&void 0===n?void 0:this.baseTarget[e]:a}on(e,t){return this.events[e]||(this.events[e]=new gD),this.events[e].add(t)}notify(e){if(this.events[e]){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.events[e].notify(...n)}}scheduleRenderMicrotask(){jD.render(this.render)}}class VD extends zD{constructor(){super(...arguments),this.KeyframeResolver=cD}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,t){let{vars:n,style:r}=t;delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;dD(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent="".concat(e))}))}}const WD=(e,t)=>t&&"number"===typeof e?t.transform(e):e,qD={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},HD=pA.length;function YD(e,t,n){const{style:r,vars:a,transformOrigin:s}=e;let o=!1,i=!1;for(const l in t){const e=t[l];if(fA.has(l))o=!0;else if(_A(l))a[l]=e;else{const t=WD(e,aD[l]);l.startsWith("origin")?(i=!0,s[l]=t):r[l]=t}}if(t.transform||(o||n?r.transform=function(e,t,n){let r="",a=!0;for(let s=0;s<HD;s++){const o=pA[s],i=e[o];if(void 0===i)continue;let l=!0;if(l="number"===typeof i?i===(o.startsWith("scale")?1:0):0===parseFloat(i),!l||n){const e=WD(i,aD[o]);l||(a=!1,r+="".concat(qD[o]||o,"(").concat(e,") ")),n&&(t[o]=e)}}return r=r.trim(),n?r=n(t,a?"":r):a&&(r="none"),r}(t,e.transform,n):r.transform&&(r.transform="none")),i){const{originX:e="50%",originY:t="50%",originZ:n=0}=s;r.transformOrigin="".concat(e," ").concat(t," ").concat(n)}}function GD(e,t,n,r){let{style:a,vars:s}=t;const o=e.style;let i;for(i in a)o[i]=a[i];for(i in null===r||void 0===r||r.applyProjectionStyles(o,n),s)o.setProperty(i,s[i])}const XD={};function $D(e,t){let{layout:n,layoutId:r}=t;return fA.has(e)||e.startsWith("origin")||(n||void 0!==r)&&(!!XD[e]||"opacity"===e)}function KD(e,t,n){const{style:r}=e,a={};for(const o in r){var s;(dD(r[o])||t.style&&dD(t.style[o])||$D(o,e)||void 0!==(null===n||void 0===n||null===(s=n.getValue(o))||void 0===s?void 0:s.liveStyle))&&(a[o]=r[o])}return a}class JD extends VD{constructor(){super(...arguments),this.type="html",this.renderInstance=GD}readValueFromInstance(e,t){var n,r;if(fA.has(t))return null!==(n=this.projection)&&void 0!==n&&n.isProjecting?NA(t):((e,t)=>{const{transform:n="none"}=getComputedStyle(e);return kA(n,t)})(e,t);{const n=(r=e,window.getComputedStyle(r)),a=(_A(t)?n.getPropertyValue(t):n[t])||0;return"string"===typeof a?a.trim():a}}measureInstanceViewportBox(e,t){let{transformPagePoint:n}=t;return GA(e,n)}build(e,t,n){YD(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return KD(e,t,n)}}const QD=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),ZD={offset:"stroke-dashoffset",array:"stroke-dasharray"},eM={offset:"strokeDashoffset",array:"strokeDasharray"};const tM=["attrX","attrY","attrScale","pathLength","pathSpacing","pathOffset"];function nM(e,t,n,r,a){let{attrX:s,attrY:o,attrScale:i,pathLength:l,pathSpacing:c=1,pathOffset:d=0}=t;if(YD(e,Il(t,tM),r),n)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:u,style:m}=e;var h,p;(u.transform&&(m.transform=u.transform,delete u.transform),m.transform||u.transformOrigin)&&(m.transformOrigin=null!==(h=u.transformOrigin)&&void 0!==h?h:"50% 50%",delete u.transformOrigin);m.transform&&(m.transformBox=null!==(p=null===a||void 0===a?void 0:a.transformBox)&&void 0!==p?p:"fill-box",delete u.transformBox);void 0!==s&&(u.x=s),void 0!==o&&(u.y=o),void 0!==i&&(u.scale=i),void 0!==l&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e.pathLength=1;const s=a?ZD:eM;e[s.offset]=nT.transform(-r);const o=nT.transform(t),i=nT.transform(n);e[s.array]="".concat(o," ").concat(i)}(u,l,c,d,!1)}const rM=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),aM=e=>"string"===typeof e&&"svg"===e.toLowerCase();function sM(e,t,n){const r=KD(e,t,n);for(const a in e)if(dD(e[a])||dD(t[a])){r[-1!==pA.indexOf(a)?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a]=e[a]}return r}class oM extends VD{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=CD}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(fA.has(t)){const e=oD(t);return e&&e.default||0}return t=rM.has(t)?t:QD(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return sM(e,t,n)}build(e,t,n){nM(e,t,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,t,n,r){!function(e,t,n,r){GD(e,t,void 0,r);for(const a in t.attrs)e.setAttribute(rM.has(a)?a:QD(a),t.attrs[a])}(e,t,0,r)}mount(e){this.isSVGTag=aM(e.tagName),super.mount(e)}}const iM=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function lM(e){return"string"===typeof e&&!e.includes("-")&&!!(iM.indexOf(e)>-1||/[A-Z]/.test(e))}const cM=(e,t)=>lM(e)?new oM(t):new JD(t,{allowProjection:e!==s.Fragment}),dM=(0,s.createContext)({}),uM=(0,s.createContext)({strict:!1}),mM=(0,s.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),hM=(0,s.createContext)({});function pM(e){const{initial:t,animate:n}=function(e,t){if(ID(e)){const{initial:t,animate:n}=e;return{initial:!1===t||TD(t)?t:void 0,animate:TD(n)?n:void 0}}return!1!==e.inherit?t:{}}(e,(0,s.useContext)(hM));return(0,s.useMemo)(()=>({initial:t,animate:n}),[fM(t),fM(n)])}function fM(e){return Array.isArray(e)?e.join(" "):e}const gM=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function xM(e,t,n){for(const r in t)dD(t[r])||$D(r,n)||(e[r]=t[r])}function yM(e,t){const n={};return xM(n,e.style||{},e),Object.assign(n,function(e,t){let{transformTemplate:n}=e;return(0,s.useMemo)(()=>{const e={style:{},transform:{},transformOrigin:{},vars:{}};return YD(e,t,n),Object.assign({},e.vars,e.style)},[t])}(e,t)),n}function bM(e,t){const n={},r=yM(e,t);return e.drag&&!1!==e.dragListener&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=!0===e.drag?"none":"pan-".concat("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const vM=()=>Ye(Ye({},{style:{},transform:{},transformOrigin:{},vars:{}}),{},{attrs:{}});function wM(e,t,n,r){const a=(0,s.useMemo)(()=>{const n=vM();return nM(n,t,aM(r),e.transformTemplate,e.style),Ye(Ye({},n.attrs),{},{style:Ye({},n.style)})},[t]);if(e.style){const t={};xM(t,e.style,e),a.style=Ye(Ye({},t),a.style)}return a}const jM=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function NM(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||jM.has(e)}let kM=e=>!NM(e);try{"function"===typeof(SM=require("@emotion/is-prop-valid").default)&&(kM=e=>e.startsWith("on")?!NM(e):SM(e))}catch(UB){}var SM;function CM(e,t,n,r,a){let{latestValues:o}=r,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const l=(lM(e)?wM:bM)(t,o,a,e),c=function(e,t,n){const r={};for(const a in e)"values"===a&&"object"===typeof e.values||(kM(a)||!0===n&&NM(a)||!t&&!NM(a)||e.draggable&&a.startsWith("onDrag"))&&(r[a]=e[a]);return r}(t,"string"===typeof e,i),d=e!==s.Fragment?Ye(Ye(Ye({},c),l),{},{ref:n}):{},{children:u}=t,m=(0,s.useMemo)(()=>dD(u)?u.get():u,[u]);return(0,s.createElement)(e,Ye(Ye({},d),{},{children:m}))}const _M=(0,s.createContext)(null);function EM(e){const t=(0,s.useRef)(null);return null===t.current&&(t.current=e()),t.current}function PM(e){return dD(e)?e.get():e}const OM=["transitionEnd","transition"];function AM(e,t,n,r){const a={},s=r(e,{});for(const m in s)a[m]=PM(s[m]);let{initial:o,animate:i}=e;const l=ID(e),c=LD(e);t&&c&&!l&&!1!==e.inherit&&(void 0===o&&(o=t.initial),void 0===i&&(i=t.animate));let d=!!n&&!1===n.initial;d=d||!1===o;const u=d?i:o;if(u&&"boolean"!==typeof u&&!AD(u)){const t=Array.isArray(u)?u:[u];for(let n=0;n<t.length;n++){const r=FD(e,t[n]);if(r){const{transitionEnd:e,transition:t}=r,n=Il(r,OM);for(const r in n){let e=n[r];if(Array.isArray(e)){e=e[d?e.length-1:0]}null!==e&&(a[r]=e)}for(const r in e)a[r]=e[r]}}}return a}const TM=e=>(t,n)=>{const r=(0,s.useContext)(hM),a=(0,s.useContext)(_M),o=()=>function(e,t,n,r){let{scrapeMotionValuesFromProps:a,createRenderState:s}=e;return{latestValues:AM(t,n,r,a),renderState:s()}}(e,t,r,a);return n?o():EM(o)},DM=TM({scrapeMotionValuesFromProps:KD,createRenderState:gM}),MM=TM({scrapeMotionValuesFromProps:sM,createRenderState:vM});const IM=Symbol.for("motionComponentSymbol");function LM(e){return e&&"object"===typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function RM(e,t,n){return(0,s.useCallback)(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&("function"===typeof n?n(r):LM(n)&&(n.current=r))},[t])}const FM="data-"+QD("framerAppearId"),BM=(0,s.createContext)({}),UM=_D?s.useLayoutEffect:s.useEffect;function zM(e,t,n,r,a){var o,i,l,c;const{visualElement:d}=(0,s.useContext)(hM),u=(0,s.useContext)(uM),m=(0,s.useContext)(_M),h=(0,s.useContext)(mM).reducedMotion,p=(0,s.useRef)(null);r=r||u.renderer,!p.current&&r&&(p.current=r(e,{visualState:t,parent:d,props:n,presenceContext:m,blockInitialAnimation:!!m&&!1===m.initial,reducedMotionConfig:h}));const f=p.current,g=(0,s.useContext)(BM);!f||f.projection||!a||"html"!==f.type&&"svg"!==f.type||function(e,t,n,r){const{layoutId:a,layout:s,drag:o,dragConstraints:i,layoutScroll:l,layoutRoot:c,layoutCrossfade:d}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:VM(e.parent)),e.projection.setOptions({layoutId:a,layout:s,alwaysMeasureLayout:Boolean(o)||i&&LM(i),visualElement:e,animationType:"string"===typeof s?s:"both",initialPromotionConfig:r,crossfade:d,layoutScroll:l,layoutRoot:c})}(p.current,n,a,g);const x=(0,s.useRef)(!1);(0,s.useInsertionEffect)(()=>{f&&x.current&&f.update(n,m)});const y=n[FM],b=(0,s.useRef)(Boolean(y)&&!(null!==(o=(i=window).MotionHandoffIsComplete)&&void 0!==o&&o.call(i,y))&&(null===(l=(c=window).MotionHasOptimisedAnimation)||void 0===l?void 0:l.call(c,y)));return UM(()=>{f&&(x.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),f.scheduleRenderMicrotask(),b.current&&f.animationState&&f.animationState.animateChanges())}),(0,s.useEffect)(()=>{f&&(!b.current&&f.animationState&&f.animationState.animateChanges(),b.current&&(queueMicrotask(()=>{var e,t;null===(e=(t=window).MotionHandoffMarkAsComplete)||void 0===e||e.call(t,y)}),b.current=!1),f.enteringChildren=void 0)}),f}function VM(e){if(e)return!1!==e.options.allowProjection?e.projection:VM(e.parent)}function WM(e){var t,n;let{forwardMotionProps:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;a&&function(e){for(const t in e)SD[t]=Ye(Ye({},SD[t]),e[t])}(a);const i=lM(e)?MM:DM;function l(t,n){let a;const l=Ye(Ye(Ye({},(0,s.useContext)(mM)),t),{},{layoutId:qM(t)}),{isStatic:c}=l,d=pM(t),u=i(t,c);if(!c&&_D){!function(){(0,s.useContext)(uM).strict;0}();const t=function(e){const{drag:t,layout:n}=SD;if(!t&&!n)return{};const r=Ye(Ye({},t),n);return{MeasureLayout:null!==t&&void 0!==t&&t.isEnabled(e)||null!==n&&void 0!==n&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}(l);a=t.MeasureLayout,d.visualElement=zM(e,u,l,o,t.ProjectionNode)}return(0,yr.jsxs)(hM.Provider,{value:d,children:[a&&d.visualElement?(0,yr.jsx)(a,Ye({visualElement:d.visualElement},l)):null,CM(e,t,RM(u,d.visualElement,n),u,c,r)]})}l.displayName="motion.".concat("string"===typeof e?e:"create(".concat(null!==(t=null!==(n=e.displayName)&&void 0!==n?n:e.name)&&void 0!==t?t:"",")"));const c=(0,s.forwardRef)(l);return c[IM]=e,c}function qM(e){let{layoutId:t}=e;const n=(0,s.useContext)(dM).id;return n&&void 0!==t?n+"-"+t:t}function HM(e,t){if("undefined"===typeof Proxy)return WM;const n=new Map,r=(n,r)=>WM(n,r,e,t);return new Proxy((e,t)=>r(e,t),{get:(a,s)=>"create"===s?r:(n.has(s)||n.set(s,WM(s,void 0,e,t)),n.get(s))})}function YM(e,t,n){const r=e.getProps();return FD(r,t,void 0!==n?n:r.custom,e)}function GM(e,t){var n,r;return null!==(n=null!==(r=null===e||void 0===e?void 0:e[t])&&void 0!==r?r:null===e||void 0===e?void 0:e.default)&&void 0!==n?n:e}const XM=e=>Array.isArray(e),$M=["transitionEnd","transition"];function KM(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,vD(n))}function JM(e){return XM(e)?e[e.length-1]||0:e}function QM(e,t){const n=e.getValue("willChange");if(function(e){return Boolean(dD(e)&&e.add)}(n))return n.add(t);if(!n&&xT.WillChange){const n=new xT.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function ZM(e){return e.props[FM]}function eI(e){e.duration=0,e.type="keyframes"}const tI=(e,t)=>n=>t(e(n)),nI=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(tI)},rI=e=>1e3*e,aI=e=>e/1e3,sI={layout:0,mainThread:0,waapi:0};function oI(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function iI(e,t){return n=>n>0?t:e}const lI=(e,t,n)=>{const r=e*e,a=n*(t*t-r)+r;return a<0?0:Math.sqrt(a)},cI=[zT,UT,VT];function dI(e){const t=(n=e,cI.find(e=>e.test(n)));var n;if(Boolean(t),"'".concat(e,"' is not an animatable color. Use the equivalent color code instead."),!Boolean(t))return!1;let r=t.parse(e);return t===VT&&(r=function(e){let{hue:t,saturation:n,lightness:r,alpha:a}=e;t/=360,n/=100,r/=100;let s=0,o=0,i=0;if(n){const e=r<.5?r*(1+n):r+n-r*n,a=2*r-e;s=oI(a,e,t+1/3),o=oI(a,e,t),i=oI(a,e,t-1/3)}else s=o=i=r;return{red:Math.round(255*s),green:Math.round(255*o),blue:Math.round(255*i),alpha:a}}(r)),r}const uI=(e,t)=>{const n=dI(e),r=dI(t);if(!n||!r)return iI(e,t);const a=Ye({},n);return e=>(a.red=lI(n.red,r.red,e),a.green=lI(n.green,r.green,e),a.blue=lI(n.blue,r.blue,e),a.alpha=TA(n.alpha,r.alpha,e),UT.transform(a))},mI=new Set(["none","hidden"]);function hI(e,t){return n=>TA(e,t,n)}function pI(e){return"number"===typeof e?hI:"string"===typeof e?PA(e)?iI:WT.test(e)?uI:xI:Array.isArray(e)?fI:"object"===typeof e?WT.test(e)?uI:gI:iI}function fI(e,t){const n=[...e],r=n.length,a=e.map((e,n)=>pI(e)(e,t[n]));return e=>{for(let t=0;t<r;t++)n[t]=a[t](e);return n}}function gI(e,t){const n=Ye(Ye({},e),t),r={};for(const a in n)void 0!==e[a]&&void 0!==t[a]&&(r[a]=pI(e[a])(e[a],t[a]));return e=>{for(const t in r)n[t]=r[t](e);return n}}const xI=(e,t)=>{const n=QT.createTransformer(t),r=XT(e),a=XT(t);return r.indexes.var.length===a.indexes.var.length&&r.indexes.color.length===a.indexes.color.length&&r.indexes.number.length>=a.indexes.number.length?mI.has(e)&&!a.values.length||mI.has(t)&&!r.values.length?function(e,t){return mI.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}(e,t):nI(fI(function(e,t){const n=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){var a;const o=t.types[s],i=e.indexes[o][r[o]],l=null!==(a=e.values[i])&&void 0!==a?a:0;n[s]=l,r[o]++}return n}(r,a),a.values),n):("Complex values '".concat(e,"' and '").concat(t,"' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition."),iI(e,t))};function yI(e,t,n){if("number"===typeof e&&"number"===typeof t&&"number"===typeof n)return TA(e,t,n);return pI(e)(e,t)}const bI=e=>{const t=t=>{let{timestamp:n}=t;return e(n)};return{start:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return wT.update(t,e)},stop:()=>jT(t),now:()=>NT.isProcessing?NT.timestamp:hD.now()}},vI=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r="";const a=Math.max(Math.round(t/n),2);for(let s=0;s<a;s++)r+=Math.round(1e4*e(s/(a-1)))/1e4+", ";return"linear(".concat(r.substring(0,r.length-2),")")},wI=2e4;function jI(e){let t=0;let n=e.next(t);for(;!n.done&&t<wI;)t+=50,n=e.next(t);return t>=wI?1/0:t}function NI(e,t,n){const r=Math.max(t-5,0);return xD(n-e(r),t-r)}const kI={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},SI=.001;function CI(e){let t,n,{duration:r=kI.duration,bounce:a=kI.bounce,velocity:s=kI.velocity,mass:o=kI.mass}=e;rI(kI.maxDuration);let i=1-a;i=$A(kI.minDamping,kI.maxDamping,i),r=$A(kI.minDuration,kI.maxDuration,aI(r)),i<1?(t=e=>{const t=e*i,n=t*r,a=t-s,o=EI(e,i),l=Math.exp(-n);return SI-a/o*l},n=e=>{const n=e*i*r,a=n*s+s,o=Math.pow(i,2)*Math.pow(e,2)*r,l=Math.exp(-n),c=EI(Math.pow(e,2),i);return(-t(e)+SI>0?-1:1)*((a-o)*l)/c}):(t=e=>Math.exp(-e*r)*((e-s)*r+1)-.001,n=e=>Math.exp(-e*r)*(r*r*(s-e)));const l=function(e,t,n){let r=n;for(let a=1;a<_I;a++)r-=e(r)/t(r);return r}(t,n,5/r);if(r=rI(r),isNaN(l))return{stiffness:kI.stiffness,damping:kI.damping,duration:r};{const e=Math.pow(l,2)*o;return{stiffness:e,damping:2*i*Math.sqrt(o*e),duration:r}}}const _I=12;function EI(e,t){return e*Math.sqrt(1-t*t)}const PI=["duration","bounce"],OI=["stiffness","damping","mass"];function AI(e,t){return t.some(t=>void 0!==e[t])}function TI(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kI.visualDuration,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kI.bounce;const n="object"!==typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:a}=n;const s=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],i={done:!1,value:s},{stiffness:l,damping:c,mass:d,duration:u,velocity:m,isResolvedFromDuration:h}=function(e){let t=Ye({velocity:kI.velocity,stiffness:kI.stiffness,damping:kI.damping,mass:kI.mass,isResolvedFromDuration:!1},e);if(!AI(e,OI)&&AI(e,PI))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(1.2*n),a=r*r,s=2*$A(.05,1,1-(e.bounce||0))*Math.sqrt(a);t=Ye(Ye({},t),{},{mass:kI.mass,stiffness:a,damping:s})}else{const n=CI(e);t=Ye(Ye(Ye({},t),n),{},{mass:kI.mass}),t.isResolvedFromDuration=!0}return t}(Ye(Ye({},n),{},{velocity:-aI(n.velocity||0)})),p=m||0,f=c/(2*Math.sqrt(l*d)),g=o-s,x=aI(Math.sqrt(l/d)),y=Math.abs(g)<5;let b;if(r||(r=y?kI.restSpeed.granular:kI.restSpeed.default),a||(a=y?kI.restDelta.granular:kI.restDelta.default),f<1){const e=EI(x,f);b=t=>{const n=Math.exp(-f*x*t);return o-n*((p+f*x*g)/e*Math.sin(e*t)+g*Math.cos(e*t))}}else if(1===f)b=e=>o-Math.exp(-x*e)*(g+(p+x*g)*e);else{const e=x*Math.sqrt(f*f-1);b=t=>{const n=Math.exp(-f*x*t),r=Math.min(e*t,300);return o-n*((p+f*x*g)*Math.sinh(r)+e*g*Math.cosh(r))/e}}const v={calculatedDuration:h&&u||null,next:e=>{const t=b(e);if(h)i.done=e>=u;else{let n=0===e?p:0;f<1&&(n=0===e?rI(p):NI(b,e,t));const s=Math.abs(n)<=r,l=Math.abs(o-t)<=a;i.done=s&&l}return i.value=i.done?o:t,i},toString:()=>{const e=Math.min(jI(v),wI),t=vI(t=>v.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return v}function DI(e){let{keyframes:t,velocity:n=0,power:r=.8,timeConstant:a=325,bounceDamping:s=10,bounceStiffness:o=500,modifyTarget:i,min:l,max:c,restDelta:d=.5,restSpeed:u}=e;const m=t[0],h={done:!1,value:m},p=e=>void 0===l?c:void 0===c||Math.abs(l-e)<Math.abs(c-e)?l:c;let f=r*n;const g=m+f,x=void 0===i?g:i(g);x!==g&&(f=x-m);const y=e=>-f*Math.exp(-e/a),b=e=>x+y(e),v=e=>{const t=y(e),n=b(e);h.done=Math.abs(t)<=d,h.value=h.done?x:n};let w,j;const N=e=>{var t;(t=h.value,void 0!==l&&t<l||void 0!==c&&t>c)&&(w=e,j=TI({keyframes:[h.value,p(h.value)],velocity:NI(b,e,h.value),damping:s,stiffness:o,restDelta:d,restSpeed:u}))};return N(0),{calculatedDuration:null,next:e=>{let t=!1;return j||void 0!==w||(t=!0,v(e),N(e)),void 0!==w&&e>=w?j.next(e-w):(!t&&v(e),h)}}}TI.applyToOptions=e=>{const t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;const n=(arguments.length>2?arguments[2]:void 0)(Ye(Ye({},e),{},{keyframes:[0,t]})),r=Math.min(jI(n),wI);return{type:"keyframes",ease:e=>n.next(r*e).value/t,duration:aI(r)}}(e,100,TI);return e.ease=t.ease,e.duration=rI(t.duration),e.type="keyframes",e};const MI=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e;function II(e,t,n,r){if(e===t&&n===r)return gT;const a=t=>function(e,t,n,r,a){let s,o,i=0;do{o=t+(n-t)/2,s=MI(o,r,a)-e,s>0?n=o:t=o}while(Math.abs(s)>1e-7&&++i<12);return o}(t,0,1,e,n);return e=>0===e||1===e?e:MI(a(e),t,r)}const LI=II(.42,0,1,1),RI=II(0,0,.58,1),FI=II(.42,0,.58,1),BI=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,UI=e=>t=>1-e(1-t),zI=II(.33,1.53,.69,.99),VI=UI(zI),WI=BI(VI),qI=e=>(e*=2)<1?.5*VI(e):.5*(2-Math.pow(2,-10*(e-1))),HI=e=>1-Math.sin(Math.acos(e)),YI=UI(HI),GI=BI(HI),XI=e=>Array.isArray(e)&&"number"===typeof e[0],$I={linear:gT,easeIn:LI,easeInOut:FI,easeOut:RI,circIn:HI,circInOut:GI,circOut:YI,backIn:VI,backInOut:WI,backOut:zI,anticipate:qI},KI=e=>{if(XI(e)){e.length;const[t,n,r,a]=e;return II(t,n,r,a)}return"string"===typeof e?("Invalid easing type '".concat(e,"'"),$I[e]):e},JI=(e,t,n)=>{const r=t-e;return 0===r?1:(n-e)/r};function QI(e,t){let{clamp:n=!0,ease:r,mixer:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=e.length;if(t.length,1===s)return()=>t[0];if(2===s&&t[0]===t[1])return()=>t[1];const o=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const i=function(e,t,n){const r=[],a=n||xT.mix||yI,s=e.length-1;for(let o=0;o<s;o++){let n=a(e[o],e[o+1]);if(t){const e=Array.isArray(t)?t[o]||gT:t;n=nI(e,n)}r.push(n)}return r}(t,r,a),l=i.length,c=n=>{if(o&&n<e[0])return t[0];let r=0;if(l>1)for(;r<e.length-2&&!(n<e[r+1]);r++);const a=JI(e[r],e[r+1],n);return i[r](a)};return n?t=>c($A(e[0],e[s-1],t)):c}function ZI(e){const t=[0];return function(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const a=JI(0,t,r);e.push(TA(n,1,a))}}(t,e.length-1),t}function eL(e){let{duration:t=300,keyframes:n,times:r,ease:a="easeInOut"}=e;const s=(e=>Array.isArray(e)&&"number"!==typeof e[0])(a)?a.map(KI):KI(a),o={done:!1,value:n[0]},i=function(e,t){return e.map(e=>e*t)}(r&&r.length===n.length?r:ZI(n),t),l=QI(i,n,{ease:Array.isArray(s)?s:(c=n,d=s,c.map(()=>d||FI).splice(0,c.length-1))});var c,d;return{calculatedDuration:t,next:e=>(o.value=l(e),o.done=e>=t,o)}}const tL=e=>null!==e;function nL(e,t,n){let{repeat:r,repeatType:a="loop"}=t,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const o=e.filter(tL),i=s<0||r&&"loop"!==a&&r%2===1?0:o.length-1;return i&&void 0!==n?n:o[i]}const rL={decay:DI,inertia:DI,tween:eL,keyframes:eL,spring:TI};function aL(e){"string"===typeof e.type&&(e.type=rL[e.type])}class sL{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const oL=e=>e/100;class iL extends sL{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var e,t;const{motionValue:n}=this.options;n&&n.updatedAt!==hD.now()&&this.tick(hD.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),null===(e=(t=this.options).onStop)||void 0===e||e.call(t))},sI.mainThread++,this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){const{options:e}=this;aL(e);const{type:t=eL,repeat:n=0,repeatDelay:r=0,repeatType:a,velocity:s=0}=e;let{keyframes:o}=e;const i=t||eL;i!==eL&&"number"!==typeof o[0]&&(this.mixKeyframes=nI(oL,yI(o[0],o[1])),o=[0,100]);const l=i(Ye(Ye({},e),{},{keyframes:o}));"mirror"===a&&(this.mirroredGenerator=i(Ye(Ye({},e),{},{keyframes:[...o].reverse(),velocity:-s}))),null===l.calculatedDuration&&(l.calculatedDuration=jI(l));const{calculatedDuration:c}=l;this.calculatedDuration=c,this.resolvedDuration=c+r,this.totalDuration=this.resolvedDuration*(n+1)-r,this.generator=l}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{generator:n,totalDuration:r,mixKeyframes:a,mirroredGenerator:s,resolvedDuration:o,calculatedDuration:i}=this;if(null===this.startTime)return n.next(0);const{delay:l=0,keyframes:c,repeat:d,repeatType:u,repeatDelay:m,type:h,onUpdate:p,finalKeyframe:f}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const g=this.currentTime-l*(this.playbackSpeed>=0?1:-1),x=this.playbackSpeed>=0?g<0:g>r;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=r);let y=this.currentTime,b=n;if(d){const e=Math.min(this.currentTime,r)/o;let t=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&t--,t=Math.min(t,d+1);Boolean(t%2)&&("reverse"===u?(n=1-n,m&&(n-=m/o)):"mirror"===u&&(b=s)),y=$A(0,1,n)*o}const v=x?{done:!1,value:c[0]}:b.next(y);a&&(v.value=a(v.value));let{done:w}=v;x||null===i||(w=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const j=null===this.holdTime&&("finished"===this.state||"running"===this.state&&w);return j&&h!==DI&&(v.value=nL(c,this.options,f,this.speed)),p&&p(v.value),j&&this.finish(),v}then(e,t){return this.finished.then(e,t)}get duration(){return aI(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+aI(e)}get time(){return aI(this.currentTime)}set time(e){var t;e=rI(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),null===(t=this.driver)||void 0===t||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(hD.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=aI(this.currentTime))}play(){var e,t;if(this.isStopped)return;const{driver:n=bI,startTime:r}=this.options;this.driver||(this.driver=n(e=>this.tick(e))),null===(e=(t=this.options).onPlay)||void 0===e||e.call(t);const a=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=a):null!==this.holdTime?this.startTime=a-this.holdTime:this.startTime||(this.startTime=null!==r&&void 0!==r?r:a),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(hD.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",null===(e=(t=this.options).onComplete)||void 0===e||e.call(t)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),null===(e=(t=this.options).onCancel)||void 0===e||e.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,sI.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),null===(t=this.driver)||void 0===t||t.stop(),e.observe(this)}}function lL(e){let t;return()=>(void 0===t&&(t=e()),t)}const cL=lL(()=>void 0!==window.ScrollTimeline),dL={};function uL(e,t){const n=lL(e);return()=>{var e;return null!==(e=dL[t])&&void 0!==e?e:n()}}const mL=uL(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(FB){return!1}return!0},"linearEasing"),hL=e=>{let[t,n,r,a]=e;return"cubic-bezier(".concat(t,", ").concat(n,", ").concat(r,", ").concat(a,")")},pL={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:hL([0,.65,.55,1]),circOut:hL([.55,0,1,.45]),backIn:hL([.31,.01,.66,-.59]),backOut:hL([.33,1.53,.69,.99])};function fL(e,t){return e?"function"===typeof e?mL()?vI(e,t):"ease-out":XI(e)?hL(e):Array.isArray(e)?e.map(e=>fL(e,t)||pL.easeOut):pL[e]:void 0}function gL(e,t,n){let{delay:r=0,duration:a=300,repeat:s=0,repeatType:o="loop",ease:i="easeOut",times:l}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;const d={[t]:n};l&&(d.offset=l);const u=fL(i,a);Array.isArray(u)&&(d.easing=u),bT.value&&sI.waapi++;const m={delay:r,duration:a,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:"reverse"===o?"alternate":"normal"};c&&(m.pseudoElement=c);const h=e.animate(d,m);return bT.value&&h.finished.finally(()=>{sI.waapi--}),h}function xL(e){return"function"===typeof e&&"applyToOptions"in e}const yL=["type"];class bL extends sL{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:n,keyframes:r,pseudoElement:a,allowFlatten:s=!1,finalKeyframe:o,onComplete:i}=e;this.isPseudoElement=Boolean(a),this.allowFlatten=s,this.options=e,e.type;const l=function(e){let{type:t}=e,n=Il(e,yL);return xL(t)&&mL()?t.applyToOptions(n):(null!==(r=n.duration)&&void 0!==r||(n.duration=300),null!==(a=n.ease)&&void 0!==a||(n.ease="easeOut"),n);var r,a}(e);this.animation=gL(t,n,r,l,a),!1===l.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const e=nL(r,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(e):function(e,t,n){(e=>e.startsWith("--"))(t)?e.style.setProperty(t,n):e.style[t]=n}(t,n,e),this.animation.cancel()}null===i||void 0===i||i(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;null===(e=(t=this.animation).finish)||void 0===e||e.call(t)}cancel(){try{this.animation.cancel()}catch(FB){}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||(null===(e=(t=this.animation).commitStyles)||void 0===e||e.call(t))}get duration(){var e,t;const n=(null===(e=this.animation.effect)||void 0===e||null===(t=e.getComputedTiming)||void 0===t?void 0:t.call(e).duration)||0;return aI(Number(n))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+aI(e)}get time(){return aI(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=rI(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline(e){let{timeline:t,observe:n}=e;var r;this.allowFlatten&&(null===(r=this.animation.effect)||void 0===r||r.updateTiming({easing:"linear"}));return this.animation.onfinish=null,t&&cL()?(this.animation.timeline=t,gT):n(this)}}const vL={anticipate:qI,backInOut:WI,circInOut:GI};function wL(e){"string"===typeof e.ease&&e.ease in vL&&(e.ease=vL[e.ease])}const jL=["motionValue","onUpdate","onComplete","element"];class NL extends bL{constructor(e){wL(e),aL(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){var t;const n=this.options,{motionValue:r,onUpdate:a,onComplete:s,element:o}=n,i=Il(n,jL);if(!r)return;if(void 0!==e)return void r.set(e);const l=new iL(Ye(Ye({},i),{},{autoplay:!1})),c=rI(null!==(t=this.finishedTime)&&void 0!==t?t:this.time);r.setWithVelocity(l.sample(c-10).value,l.sample(c).value,10),l.stop()}}const kL=(e,t)=>"zIndex"!==t&&(!("number"!==typeof e&&!Array.isArray(e))||!("string"!==typeof e||!QT.test(e)&&"0"!==e||e.startsWith("url(")));const SL=new Set(["opacity","clipPath","filter","transform"]),CL=lL(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));const _L=["autoplay","delay","type","repeat","repeatDelay","repeatType","keyframes","name","motionValue","element"];class EL extends sL{constructor(e){var t;let{autoplay:n=!0,delay:r=0,type:a="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:i="loop",keyframes:l,name:c,motionValue:d,element:u}=e,m=Il(e,_L);super(),this.stop=()=>{var e,t;this._animation&&(this._animation.stop(),null===(t=this.stopTimeline)||void 0===t||t.call(this));null===(e=this.keyframeResolver)||void 0===e||e.cancel()},this.createdAt=hD.now();const h=Ye({autoplay:n,delay:r,type:a,repeat:s,repeatDelay:o,repeatType:i,name:c,motionValue:d,element:u},m),p=(null===u||void 0===u?void 0:u.KeyframeResolver)||AT;this.keyframeResolver=new p(l,(e,t,n)=>this.onKeyframesResolved(e,t,h,!n),c,d,u),null===(t=this.keyframeResolver)||void 0===t||t.scheduleResolve()}onKeyframesResolved(e,t,n,r){this.keyframeResolver=void 0;const{name:a,type:s,velocity:o,delay:i,isHandoff:l,onUpdate:c}=n;this.resolvedAt=hD.now(),function(e,t,n,r){const a=e[0];if(null===a)return!1;if("display"===t||"visibility"===t)return!0;const s=e[e.length-1],o=kL(a,t),i=kL(s,t);return"You are trying to animate ".concat(t,' from "').concat(a,'" to "').concat(s,'". "').concat(o?s:a,'" is not an animatable value.'),!(!o||!i)&&(function(e){const t=e[0];if(1===e.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}(e)||("spring"===n||xL(n))&&r)}(e,a,s,o)||(!xT.instantAnimations&&i||null===c||void 0===c||c(nL(e,n,t)),e[0]=e[e.length-1],eI(n),n.repeat=0);const d=Ye(Ye({startTime:r?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:t},n),{},{keyframes:e}),u=!l&&function(e){var t;const{motionValue:n,name:r,repeatDelay:a,repeatType:s,damping:o,type:i}=e;if(!((null===n||void 0===n||null===(t=n.owner)||void 0===t?void 0:t.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=n.owner.getProps();return CL()&&r&&SL.has(r)&&("transform"!==r||!c)&&!l&&!a&&"mirror"!==s&&0!==o&&"inertia"!==i}(d)?new NL(Ye(Ye({},d),{},{element:d.motionValue.owner.current})):new iL(d);u.finished.then(()=>this.notifyFinished()).catch(gT),this.pendingTimeline&&(this.stopTimeline=u.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=u}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;this._animation||(null===(e=this.keyframeResolver)||void 0===e||e.resume(),ET=!0,OT(),PT(),ET=!1);return this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),null===(e=this.keyframeResolver)||void 0===e||e.cancel()}}const PL=e=>null!==e;const OL={type:"spring",stiffness:500,damping:25,restSpeed:10},AL={type:"keyframes",duration:.8},TL={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},DL=(e,t)=>{let{keyframes:n}=t;return n.length>2?AL:fA.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===n[1]?2*Math.sqrt(550):30,restSpeed:10}:OL:TL},ML=["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from","elapsed"];const IL=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;return o=>{const i=GM(r,e)||{},l=i.delay||r.delay||0;let{elapsed:c=0}=r;c-=rI(l);const d=Ye(Ye({keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity()},i),{},{delay:-c,onUpdate:e=>{t.set(e),i.onUpdate&&i.onUpdate(e)},onComplete:()=>{o(),i.onComplete&&i.onComplete()},name:e,motionValue:t,element:s?void 0:a});(function(e){let{when:t,delay:n,delayChildren:r,staggerChildren:a,staggerDirection:s,repeat:o,repeatType:i,repeatDelay:l,from:c,elapsed:d}=e,u=Il(e,ML);return!!Object.keys(u).length})(i)||Object.assign(d,DL(e,d)),d.duration&&(d.duration=rI(d.duration)),d.repeatDelay&&(d.repeatDelay=rI(d.repeatDelay)),void 0!==d.from&&(d.keyframes[0]=d.from);let u=!1;if((!1===d.type||0===d.duration&&!d.repeatDelay)&&(eI(d),0===d.delay&&(u=!0)),(xT.instantAnimations||xT.skipAnimations)&&(u=!0,eI(d),d.delay=0),d.allowFlatten=!i.type&&!i.ease,u&&!s&&void 0!==t.get()){const e=function(e,t,n){let{repeat:r,repeatType:a="loop"}=t;const s=e.filter(PL),o=r&&"loop"!==a&&r%2===1?0:s.length-1;return o&&void 0!==n?n:s[o]}(d.keyframes,i);if(void 0!==e)return void wT.update(()=>{d.onUpdate(e),d.onComplete()})}return i.isSync?new iL(d):new EL(d)}},LL=["transition","transitionEnd"];function RL(e,t){let{protectedKeys:n,needsAnimating:r}=e;const a=n.hasOwnProperty(t)&&!0!==r[t];return r[t]=!1,a}function FL(e,t){let{delay:n=0,transitionOverride:r,type:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{transition:s=e.getDefaultTransition(),transitionEnd:o}=t,i=Il(t,LL);r&&(s=r);const l=[],c=a&&e.animationState&&e.animationState.getState()[a];for(const u in i){var d;const t=e.getValue(u,null!==(d=e.latestValues[u])&&void 0!==d?d:null),r=i[u];if(void 0===r||c&&RL(c,u))continue;const a=Ye({delay:n},GM(s||{},u)),o=t.get();if(void 0!==o&&!t.isAnimating&&!Array.isArray(r)&&r===o&&!a.velocity)continue;let m=!1;if(window.MotionHandoffAnimation){const t=ZM(e);if(t){const e=window.MotionHandoffAnimation(t,u,wT);null!==e&&(a.startTime=e,m=!0)}}QM(e,u),t.start(IL(u,t,r,e.shouldReduceMotion&&XA.has(u)?{type:!1}:a,e,m));const h=t.animation;h&&l.push(h)}return o&&Promise.all(l).then(()=>{wT.update(()=>{o&&function(e,t){let n=YM(e,t)||{},{transitionEnd:r={},transition:a={}}=n,s=Il(n,$M);s=Ye(Ye({},s),r);for(const o in s)KM(e,o,JM(s[o]))}(e,o)})}),l}function BL(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const s=Array.from(e).sort((e,t)=>e.sortNodePosition(t)).indexOf(t),o=e.size,i=(o-1)*r;return"function"===typeof n?n(s,o):1===a?s*r:i-s*r}function UL(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=YM(e,t,"exit"===r.type?null===(n=e.presenceContext)||void 0===n?void 0:n.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(s=r.transitionOverride);const o=a?()=>Promise.all(FL(e,a,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const{delayChildren:a=0,staggerChildren:o,staggerDirection:i}=s;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0;const i=[];for(const l of e.variantChildren)l.notify("AnimationStart",t),i.push(UL(l,t,Ye(Ye({},o),{},{delay:n+("function"===typeof r?0:r)+BL(e.variantChildren,l,r,a,s)})).then(()=>l.notify("AnimationComplete",t)));return Promise.all(i)}(e,t,n,a,o,i,r)}:()=>Promise.resolve(),{when:l}=s;if(l){const[e,t]="beforeChildren"===l?[o,i]:[i,o];return e().then(()=>t())}return Promise.all([o(),i(r.delay)])}function zL(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const VL=MD.length;function WL(e){if(!e)return;if(!e.isControllingVariants){const t=e.parent&&WL(e.parent)||{};return void 0!==e.props.initial&&(t.initial=e.props.initial),t}const t={};for(let n=0;n<VL;n++){const r=MD[n],a=e.props[r];(TD(a)||!1===a)&&(t[r]=a)}return t}const qL=["transition","transitionEnd"],HL=[...DD].reverse(),YL=DD.length;function GL(e){return t=>Promise.all(t.map(t=>{let{animation:n,options:r}=t;return function(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.notify("AnimationStart",t),Array.isArray(t)){const a=t.map(t=>UL(e,t,r));n=Promise.all(a)}else if("string"===typeof t)n=UL(e,t,r);else{const a="function"===typeof t?YM(e,t,r.custom):t;n=Promise.all(FL(e,a,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}(e,n,r)}))}function XL(e){let t=GL(e),n=JL(),r=!0;const a=t=>(n,r)=>{var a;const s=YM(e,r,"exit"===t?null===(a=e.presenceContext)||void 0===a?void 0:a.custom:void 0);if(s){const{transition:e,transitionEnd:t}=s,r=Il(s,qL);n=Ye(Ye(Ye({},n),r),t)}return n};function s(s){const{props:o}=e,i=WL(e.parent)||{},l=[],c=new Set;let d={},u=1/0;for(let t=0;t<YL;t++){const m=HL[t],h=n[m],p=void 0!==o[m]?o[m]:i[m],f=TD(p),g=m===s?h.isActive:null;!1===g&&(u=t);let x=p===i[m]&&p!==o[m]&&f;if(x&&r&&e.manuallyAnimateOnMount&&(x=!1),h.protectedKeys=Ye({},d),!h.isActive&&null===g||!p&&!h.prevProp||AD(p)||"boolean"===typeof p)continue;const y=$L(h.prevProp,p);let b=y||m===s&&h.isActive&&!x&&f||t>u&&f,v=!1;const w=Array.isArray(p)?p:[p];let j=w.reduce(a(m),{});!1===g&&(j={});const{prevResolvedValues:N={}}=h,k=Ye(Ye({},N),j),S=t=>{b=!0,c.has(t)&&(v=!0,c.delete(t)),h.needsAnimating[t]=!0;const n=e.getValue(t);n&&(n.liveStyle=!1)};for(const e in k){const t=j[e],n=N[e];if(d.hasOwnProperty(e))continue;let r=!1;r=XM(t)&&XM(n)?!zL(t,n):t!==n,r?void 0!==t&&null!==t?S(e):c.add(e):void 0!==t&&c.has(e)?S(e):h.protectedKeys[e]=!0}h.prevProp=p,h.prevResolvedValues=j,h.isActive&&(d=Ye(Ye({},d),j)),r&&e.blockInitialAnimation&&(b=!1);const C=x&&y;b&&(!C||v)&&l.push(...w.map(t=>{const n={type:m};if("string"===typeof t&&r&&!C&&e.manuallyAnimateOnMount&&e.parent){const{parent:r}=e,a=YM(r,t);if(r.enteringChildren&&a){const{delayChildren:t}=a.transition||{};n.delay=BL(r.enteringChildren,e,t)}}return{animation:t,options:n}}))}if(c.size){const t={};if("boolean"!==typeof o.initial){const n=YM(e,Array.isArray(o.initial)?o.initial[0]:o.initial);n&&n.transition&&(t.transition=n.transition)}c.forEach(n=>{const r=e.getBaseTarget(n),a=e.getValue(n);a&&(a.liveStyle=!0),t[n]=null!==r&&void 0!==r?r:null}),l.push({animation:t})}let m=Boolean(l.length);return!r||!1!==o.initial&&o.initial!==o.animate||e.manuallyAnimateOnMount||(m=!1),r=!1,m?t(l):Promise.resolve()}return{animateChanges:s,setActive:function(t,r){var a;if(n[t].isActive===r)return Promise.resolve();null===(a=e.variantChildren)||void 0===a||a.forEach(e=>{var n;return null===(n=e.animationState)||void 0===n?void 0:n.setActive(t,r)}),n[t].isActive=r;const o=s(t);for(const e in n)n[e].protectedKeys={};return o},setAnimateFunction:function(n){t=n(e)},getState:()=>n,reset:()=>{n=JL()}}}function $L(e,t){return"string"===typeof t?t!==e:!!Array.isArray(t)&&!zL(t,e)}function KL(){return{isActive:arguments.length>0&&void 0!==arguments[0]&&arguments[0],protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function JL(){return{animate:KL(!0),whileInView:KL(),whileHover:KL(),whileTap:KL(),whileDrag:KL(),whileFocus:KL(),exit:KL()}}class QL{constructor(e){this.isMounted=!1,this.node=e}update(){}}let ZL=0;const eR={animation:{Feature:class extends QL{constructor(e){super(e),e.animationState||(e.animationState=XL(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();AD(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),null===(e=this.unmountControls)||void 0===e||e.call(this)}}},exit:{Feature:class extends QL{constructor(){super(...arguments),this.id=ZL++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}}},tR={x:!1,y:!1};function nR(){return tR.x||tR.y}function rR(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const aR=e=>"mouse"===e.pointerType?"number"!==typeof e.button||e.button<=0:!1!==e.isPrimary;function sR(e){return{point:{x:e.pageX,y:e.pageY}}}function oR(e,t,n,r){return rR(e,t,(e=>t=>aR(t)&&e(t,sR(t)))(n),r)}function iR(e){return e.max-e.min}function lR(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;e.origin=r,e.originPoint=TA(t.min,t.max,e.origin),e.scale=iR(n)/iR(t),e.translate=TA(n.min,n.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function cR(e,t,n,r){lR(e.x,t.x,n.x,r?r.originX:void 0),lR(e.y,t.y,n.y,r?r.originY:void 0)}function dR(e,t,n){e.min=n.min+t.min,e.max=e.min+iR(t)}function uR(e,t,n){e.min=t.min-n.min,e.max=e.min+iR(t)}function mR(e,t,n){uR(e.x,t.x,n.x),uR(e.y,t.y,n.y)}function hR(e){return[e("x"),e("y")]}const pR=e=>{let{current:t}=e;return t?t.ownerDocument.defaultView:null},fR=(e,t)=>Math.abs(e-t);class gR{constructor(e,t){let{transformPagePoint:n,contextWindow:r=window,dragSnapToOrigin:a=!1,distanceThreshold:s=3}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const e=bR(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,n=function(e,t){const n=fR(e.x,t.x),r=fR(e.y,t.y);return Math.sqrt(n**2+r**2)}(e.offset,{x:0,y:0})>=this.distanceThreshold;if(!t&&!n)return;const{point:r}=e,{timestamp:a}=NT;this.history.push(Ye(Ye({},r),{},{timestamp:a}));const{onStart:s,onMove:o}=this.handlers;t||(s&&s(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),o&&o(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=xR(t,this.transformPagePoint),wT.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();const{onEnd:n,onSessionEnd:r,resumeAnimation:a}=this.handlers;if(this.dragSnapToOrigin&&a&&a(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const s=bR("pointercancel"===e.type?this.lastMoveEventInfo:xR(t,this.transformPagePoint),this.history);this.startEvent&&n&&n(e,s),r&&r(e,s)},!aR(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=n,this.distanceThreshold=s,this.contextWindow=r||window;const o=xR(sR(e),this.transformPagePoint),{point:i}=o,{timestamp:l}=NT;this.history=[Ye(Ye({},i),{},{timestamp:l})];const{onSessionStart:c}=t;c&&c(e,bR(o,this.history)),this.removeListeners=nI(oR(this.contextWindow,"pointermove",this.handlePointerMove),oR(this.contextWindow,"pointerup",this.handlePointerUp),oR(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),jT(this.updatePoint)}}function xR(e,t){return t?{point:t(e.point)}:e}function yR(e,t){return{x:e.x-t.x,y:e.y-t.y}}function bR(e,t){let{point:n}=e;return{point:n,delta:yR(n,wR(t)),offset:yR(n,vR(t)),velocity:jR(t,.1)}}function vR(e){return e[0]}function wR(e){return e[e.length-1]}function jR(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const a=wR(e);for(;n>=0&&(r=e[n],!(a.timestamp-r.timestamp>rI(t)));)n--;if(!r)return{x:0,y:0};const s=aI(a.timestamp-r.timestamp);if(0===s)return{x:0,y:0};const o={x:(a.x-r.x)/s,y:(a.y-r.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function NR(e,t,n){return{min:void 0!==t?e.min+t:void 0,max:void 0!==n?e.max+n-(e.max-e.min):void 0}}function kR(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}const SR=.35;function CR(e,t,n){return{min:_R(e,t),max:_R(e,n)}}function _R(e,t){return"number"===typeof e?e:e[t]||0}const ER=new WeakMap;class PR{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e){let{snapToCursor:t=!1,distanceThreshold:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{presenceContext:r}=this.visualElement;if(r&&!1===r.isPresent)return;const{dragSnapToOrigin:a}=this.getProps();this.panSession=new gR(e,{onSessionStart:e=>{const{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(sR(e).point)},onStart:(e,t)=>{const{drag:n,dragPropagation:r,onDragStart:a}=this.getProps();if(n&&!r&&(this.openDragLock&&this.openDragLock(),this.openDragLock="x"===(s=n)||"y"===s?tR[s]?null:(tR[s]=!0,()=>{tR[s]=!1}):tR.x||tR.y?null:(tR.x=tR.y=!0,()=>{tR.x=tR.y=!1}),!this.openDragLock))return;var s;this.latestPointerEvent=e,this.latestPanInfo=t,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),hR(e=>{let t=this.getAxisMotionValue(e).get()||0;if(tT.test(t)){const{projection:n}=this.visualElement;if(n&&n.layout){const r=n.layout.layoutBox[e];if(r){t=iR(r)*(parseFloat(t)/100)}}}this.originPoint[e]=t}),a&&wT.postRender(()=>a(e,t)),QM(this.visualElement,"transform");const{animationState:o}=this.visualElement;o&&o.setActive("whileDrag",!0)},onMove:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t;const{dragPropagation:n,dragDirectionLock:r,onDirectionLock:a,onDrag:s}=this.getProps();if(!n&&!this.openDragLock)return;const{offset:o}=t;if(r&&null===this.currentDirection)return this.currentDirection=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=null;Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x");return n}(o),void(null!==this.currentDirection&&a&&a(this.currentDirection));this.updateAxis("x",t.point,o),this.updateAxis("y",t.point,o),this.visualElement.render(),s&&s(e,t)},onSessionEnd:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t,this.stop(e,t),this.latestPointerEvent=null,this.latestPanInfo=null},resumeAnimation:()=>hR(e=>{var t;return"paused"===this.getAnimationState(e)&&(null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.play())})},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:a,distanceThreshold:n,contextWindow:pR(this.visualElement)})}stop(e,t){const n=e||this.latestPointerEvent,r=t||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!r||!n)return;const{velocity:s}=r;this.startAnimation(s);const{onDragEnd:o}=this.getProps();o&&wT.postRender(()=>o(n,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:r}=this.getProps();if(!n||!OR(e,r,this.currentDirection))return;const a=this.getAxisMotionValue(e);let s=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(s=function(e,t,n){let{min:r,max:a}=t;return void 0!==r&&e<r?e=n?TA(r,e,n.min):Math.max(e,r):void 0!==a&&e>a&&(e=n?TA(a,e,n.max):Math.min(e,a)),e}(s,this.constraints[e],this.elastic[e])),a.set(s)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(e=this.visualElement.projection)||void 0===e?void 0:e.layout,a=this.constraints;t&&LM(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!r)&&function(e,t){let{top:n,left:r,bottom:a,right:s}=t;return{x:NR(e.x,r,s),y:NR(e.y,n,a)}}(r.layoutBox,t),this.elastic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SR;return!1===e?e=0:!0===e&&(e=SR),{x:CR(e,"left","right"),y:CR(e,"top","bottom")}}(n),a!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&hR(e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){const n={};return void 0!==t.min&&(n.min=t.min-e.min),void 0!==t.max&&(n.max=t.max-e.min),n}(r.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!LM(e))return!1;const n=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const a=function(e,t,n){const r=GA(e,n),{scroll:a}=t;return a&&(qA(r.x,a.offset.x),qA(r.y,a.offset.y)),r}(n,r.root,this.visualElement.getTransformPagePoint());let s=function(e,t){return{x:kR(e.x,t.x),y:kR(e.y,t.y)}}(r.layout.layoutBox,a);if(t){const e=t(function(e){let{x:t,y:n}=e;return{top:n.min,right:t.max,bottom:n.max,left:t.min}}(s));this.hasMutatedConstraints=!!e,e&&(s=AA(e))}return s}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:r,dragTransition:a,dragSnapToOrigin:s,onDragTransitionEnd:o}=this.getProps(),i=this.constraints||{},l=hR(o=>{if(!OR(o,t,this.currentDirection))return;let l=i&&i[o]||{};s&&(l={min:0,max:0});const c=r?200:1e6,d=r?40:1e7,u=Ye(Ye({type:"inertia",velocity:n?e[o]:0,bounceStiffness:c,bounceDamping:d,timeConstant:750,restDelta:1,restSpeed:10},a),l);return this.startAxisValueAnimation(o,u)});return Promise.all(l).then(o)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return QM(this.visualElement,e),n.start(IL(e,n,0,t,this.visualElement,!1))}stopAnimation(){hR(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){hR(e=>{var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.pause()})}getAnimationState(e){var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.state}getAxisMotionValue(e){const t="_drag".concat(e.toUpperCase()),n=this.visualElement.getProps(),r=n[t];return r||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){hR(t=>{const{drag:n}=this.getProps();if(!OR(t,n,this.currentDirection))return;const{projection:r}=this.visualElement,a=this.getAxisMotionValue(t);if(r&&r.layout){const{min:n,max:s}=r.layout.layoutBox[t];a.set(e[t]-TA(n,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!LM(t)||!n||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};hR(e=>{const t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){const n=t.get();r[e]=function(e,t){let n=.5;const r=iR(e),a=iR(t);return a>r?n=JI(t.min,t.max-r,e.min):r>a&&(n=JI(e.min,e.max-a,t.min)),$A(0,1,n)}({min:n,max:n},this.constraints[e])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),hR(t=>{if(!OR(t,e,null))return;const n=this.getAxisMotionValue(t),{min:a,max:s}=this.constraints[t];n.set(TA(a,s,r[t]))})}addListeners(){if(!this.visualElement.current)return;ER.set(this.visualElement,this);const e=oR(this.visualElement.current,"pointerdown",e=>{const{drag:t,dragListener:n=!0}=this.getProps();t&&n&&this.start(e)}),t=()=>{const{dragConstraints:e}=this.getProps();LM(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,r=n.addEventListener("measure",t);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),wT.read(t);const a=rR(window,"resize",()=>this.scalePositionWithinConstraints()),s=n.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:n}=e;this.isDragging&&n&&(hR(e=>{const n=this.getAxisMotionValue(e);n&&(this.originPoint[e]+=t[e].translate,n.set(n.get()+t[e].translate))}),this.visualElement.render())});return()=>{a(),e(),r(),s&&s()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:a=!1,dragElastic:s=SR,dragMomentum:o=!0}=e;return Ye(Ye({},e),{},{drag:t,dragDirectionLock:n,dragPropagation:r,dragConstraints:a,dragElastic:s,dragMomentum:o})}}function OR(e,t,n){return(!0===t||t===e)&&(null===n||n===e)}const AR=e=>(t,n)=>{e&&wT.postRender(()=>e(t,n))};function TR(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=(0,s.useContext)(_M);if(null===t)return[!0,null];const{isPresent:n,onExitComplete:r,register:a}=t,o=(0,s.useId)();(0,s.useEffect)(()=>{if(e)return a(o)},[e]);const i=(0,s.useCallback)(()=>e&&r&&r(o),[o,r,e]);return!n&&r?[!1,i]:[!0]}const DR={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function MR(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const IR={correct:(e,t)=>{if(!t.target)return e;if("string"===typeof e){if(!nT.test(e))return e;e=parseFloat(e)}const n=MR(e,t.target.x),r=MR(e,t.target.y);return"".concat(n,"% ").concat(r,"%")}},LR={correct:(e,t)=>{let{treeScale:n,projectionDelta:r}=t;const a=e,s=QT.parse(e);if(s.length>5)return a;const o=QT.createTransformer(e),i="number"!==typeof s[0]?1:0,l=r.x.scale*n.x,c=r.y.scale*n.y;s[0+i]/=l,s[1+i]/=c;const d=TA(l,c,.5);return"number"===typeof s[2+i]&&(s[2+i]/=d),"number"===typeof s[3+i]&&(s[3+i]/=d),o(s)}};let RR=!1;class FR extends s.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:r}=this.props,{projection:a}=e;!function(e){for(const t in e)XD[t]=e[t],_A(t)&&(XD[t].isCSSVariable=!0)}(UR),a&&(t.group&&t.group.add(a),n&&n.register&&r&&n.register(a),RR&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions(Ye(Ye({},a.options),{},{onExitComplete:()=>this.safeToRemove()}))),DR.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:r,isPresent:a}=this.props,{projection:s}=n;return s?(s.isPresent=a,RR=!0,r||e.layoutDependency!==t||void 0===t||e.isPresent!==a?s.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?s.promote():s.relegate()||wT.postRender(()=>{const e=s.getStack();e&&e.members.length||this.safeToRemove()})),null):null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),jD.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:r}=e;RR=!0,r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function BR(e){const[t,n]=TR(),r=(0,s.useContext)(dM);return(0,yr.jsx)(FR,Ye(Ye({},e),{},{layoutGroup:r,switchLayoutGroup:(0,s.useContext)(BM),isPresent:t,safeToRemove:n}))}const UR={borderRadius:Ye(Ye({},IR),{},{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:IR,borderTopRightRadius:IR,borderBottomLeftRadius:IR,borderBottomRightRadius:IR,boxShadow:LR};function zR(e){return"object"===typeof e&&null!==e}function VR(e){return zR(e)&&"ownerSVGElement"in e}const WR=(e,t)=>e.depth-t.depth;class qR{constructor(){this.children=[],this.isDirty=!1}add(e){pD(this.children,e),this.isDirty=!0}remove(e){fD(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(WR),this.isDirty=!1,this.children.forEach(e)}}function HR(e,t){const n=hD.now(),r=a=>{let{timestamp:s}=a;const o=s-n;o>=t&&(jT(r),e(o-t))};return wT.setup(r,!0),()=>jT(r)}const YR=["TopLeft","TopRight","BottomLeft","BottomRight"],GR=YR.length,XR=e=>"string"===typeof e?parseFloat(e):e,$R=e=>"number"===typeof e||nT.test(e);function KR(e,t){return void 0!==e[t]?e[t]:e.borderRadius}const JR=ZR(0,.5,YI),QR=ZR(.5,.95,gT);function ZR(e,t,n){return r=>r<e?0:r>t?1:n(JI(e,t,r))}function eF(e,t){e.min=t.min,e.max=t.max}function tF(e,t){eF(e.x,t.x),eF(e.y,t.y)}function nF(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function rF(e,t,n,r,a){return e=FA(e-=t,1/n,r),void 0!==a&&(e=FA(e,1/a,r)),e}function aF(e,t,n,r,a){let[s,o,i]=n;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e;tT.test(t)&&(t=parseFloat(t),t=TA(o.min,o.max,t/100)-o.min);if("number"!==typeof t)return;let i=TA(s.min,s.max,r);e===s&&(i-=t),e.min=rF(e.min,t,n,i,a),e.max=rF(e.max,t,n,i,a)}(e,t[s],t[o],t[i],t.scale,r,a)}const sF=["x","scaleX","originX"],oF=["y","scaleY","originY"];function iF(e,t,n,r){aF(e.x,t,sF,n?n.x:void 0,r?r.x:void 0),aF(e.y,t,oF,n?n.y:void 0,r?r.y:void 0)}function lF(e){return 0===e.translate&&1===e.scale}function cF(e){return lF(e.x)&&lF(e.y)}function dF(e,t){return e.min===t.min&&e.max===t.max}function uF(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function mF(e,t){return uF(e.x,t.x)&&uF(e.y,t.y)}function hF(e){return iR(e.x)/iR(e.y)}function pF(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class fF{constructor(){this.members=[]}add(e){pD(this.members,e),e.scheduleRender()}remove(e){if(fD(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){const t=this.members.findIndex(t=>e===t);if(0===t)return!1;let n;for(let r=t;r>=0;r--){const e=this.members[r];if(!1!==e.isPresent){n=e;break}}return!!n&&(this.promote(n),!0)}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;!1===r&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const gF={nodes:0,calculatedTargetDeltas:0,calculatedProjections:0},xF=["","X","Y","Z"];let yF=0;function bF(e,t,n,r){const{latestValues:a}=t;a[e]&&(n[e]=a[e],t.setStaticValue(e,0),r&&(r[e]=0))}function vF(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=ZM(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:t,layoutId:r}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",wT,!(t||r))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&vF(r)}function wF(e){let{attachResizeListener:t,defaultParent:n,measureScroll:r,checkIsScrollRoot:a,resetTransform:s}=e;return class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===n||void 0===n?void 0:n();this.id=yF++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,bT.value&&(gF.nodes=gF.calculatedTargetDeltas=gF.calculatedProjections=0),this.nodes.forEach(kF),this.nodes.forEach(AF),this.nodes.forEach(TF),this.nodes.forEach(SF),bT.addProjectionMetrics&&bT.addProjectionMetrics(gF)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=t?t.root||t:this,this.path=t?[...t.path,t]:[],this.parent=t,this.depth=t?t.depth+1:0;for(let n=0;n<this.path.length;n++)this.path[n].shouldResetTransform=!0;this.root===this&&(this.nodes=new qR)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new gD),this.eventHandlers.get(e).add(t)}notifyListeners(e){const t=this.eventHandlers.get(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];t&&t.notify(...r)}hasListeners(e){return this.eventHandlers.has(e)}mount(e){if(this.instance)return;var n;this.isSVG=VR(e)&&!(VR(n=e)&&"svg"===n.tagName),this.instance=e;const{layoutId:r,layout:a,visualElement:s}=this.options;if(s&&!s.current&&s.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(a||r)&&(this.isLayoutDirty=!0),t){let n,r=0;const a=()=>this.root.updateBlockedByResize=!1;wT.read(()=>{r=window.innerWidth}),t(e,()=>{const e=window.innerWidth;e!==r&&(r=e,this.root.updateBlockedByResize=!0,n&&n(),n=HR(a,250),DR.hasAnimatedSinceResize&&(DR.hasAnimatedSinceResize=!1,this.nodes.forEach(OF)))})}r&&this.root.registerSharedNode(r,this),!1!==this.options.animate&&s&&(r||a)&&this.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:n,hasRelativeLayoutChanged:r,layout:a}=e;if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const o=this.options.transition||s.getDefaultTransition()||FF,{onLayoutAnimationStart:i,onLayoutAnimationComplete:l}=s.getProps(),c=!this.targetLayout||!mF(this.targetLayout,a),d=!n&&r;if(this.options.layoutRoot||this.resumeFrom||d||n&&(c||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const e=Ye(Ye({},GM(o,"layout")),{},{onPlay:i,onComplete:l});(s.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e),this.setAnimationOrigin(t,d)}else n||OF(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=a})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),jT(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(DF),this.animationId++)}getTransformTemplate(){const{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&vF(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let a=0;a<this.path.length;a++){const e=this.path[a];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:t,layout:n}=this.options;if(void 0===t&&!n)return;const r=this.getTransformTemplate();this.prevTransformTemplateValue=r?r(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(_F);if(this.animationId<=this.animationCommitId)return void this.nodes.forEach(EF);this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(PF),this.nodes.forEach(jF),this.nodes.forEach(NF)):this.nodes.forEach(EF),this.clearAllSnapshots();const e=hD.now();NT.delta=$A(0,1e3/60,e-NT.timestamp),NT.timestamp=e,NT.isProcessing=!0,kT.update.process(NT),kT.preRender.process(NT),kT.render.process(NT),NT.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,jD.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(CF),this.sharedNodes.forEach(MF)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,wT.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){wT.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||iR(this.snapshot.measuredBox.x)||iR(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance)return;if(this.updateScroll(),(!this.options.alwaysMeasureLayout||!this.isLead())&&!this.isLayoutDirty)return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let n=0;n<this.path.length;n++){this.path[n].updateScroll()}const e=this.layout;this.layout=this.measure(!1),this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"measure",t=Boolean(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&this.instance){const t=a(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!s)return;const e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!cF(this.projectionDelta),n=this.getTransformTemplate(),r=n?n(this.latestValues,""):void 0,a=r!==this.prevTransformTemplateValue;e&&this.instance&&(t||IA(this.latestValues)||a)&&(s(this.instance,r),this.shouldResetTransform=!1,this.scheduleRender())}measure(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.measurePageBox();let n=this.removeElementScroll(t);var r;return e&&(n=this.removeTransform(n)),zF((r=n).x),zF(r.y),{animationId:this.root.animationId,measuredBox:t,layoutBox:n,latestValues:{},source:this.id}}measurePageBox(){var e;const{visualElement:t}=this.options;if(!t)return{x:{min:0,max:0},y:{min:0,max:0}};const n=t.measureViewportBox();if(!((null===(e=this.scroll)||void 0===e?void 0:e.wasRoot)||this.path.some(WF))){const{scroll:e}=this.root;e&&(qA(n.x,e.offset.x),qA(n.y,e.offset.y))}return n}removeElementScroll(e){var t;const n={x:{min:0,max:0},y:{min:0,max:0}};if(tF(n,e),null!==(t=this.scroll)&&void 0!==t&&t.wasRoot)return n;for(let r=0;r<this.path.length;r++){const t=this.path[r],{scroll:a,options:s}=t;t!==this.root&&a&&s.layoutScroll&&(a.wasRoot&&tF(n,e),qA(n.x,a.offset.x),qA(n.y,a.offset.y))}return n}applyTransform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={x:{min:0,max:0},y:{min:0,max:0}};tF(n,e);for(let r=0;r<this.path.length;r++){const e=this.path[r];!t&&e.options.layoutScroll&&e.scroll&&e!==e.root&&YA(n,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),IA(e.latestValues)&&YA(n,e.latestValues)}return IA(this.latestValues)&&YA(n,this.latestValues),n}removeTransform(e){const t={x:{min:0,max:0},y:{min:0,max:0}};tF(t,e);for(let n=0;n<this.path.length;n++){const e=this.path[n];if(!e.instance)continue;if(!IA(e.latestValues))continue;MA(e.latestValues)&&e.updateSnapshot();const r=CD();tF(r,e.measurePageBox()),iF(t,e.latestValues,e.snapshot?e.snapshot.layoutBox:void 0,r)}return IA(this.latestValues)&&iF(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options=Ye(Ye(Ye({},this.options),e),{},{crossfade:void 0===e.crossfade||e.crossfade})}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==NT.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=n.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=n.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=n.isSharedProjectionDirty);const r=Boolean(this.resumingFrom)||this!==n;if(!(t||r&&this.isSharedProjectionDirty||this.isProjectionDirty||null!==(e=this.parent)&&void 0!==e&&e.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:a,layoutId:s}=this.options;if(this.layout&&(a||s)){if(this.resolvedRelativeTargetAt=NT.timestamp,!this.targetDelta&&!this.relativeTarget){const e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},mR(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),tF(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){var o,i,l;if(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),o=this.target,i=this.relativeTarget,l=this.relativeParent.target,dR(o.x,i.x,l.x),dR(o.y,i.y,l.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):tF(this.target,this.layout.layoutBox),zA(this.target,this.targetDelta)):tF(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const e=this.getClosestProjectingParent();e&&Boolean(e.resumingFrom)===Boolean(this.resumingFrom)&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},mR(this.relativeTargetOrigin,this.target,e.target),tF(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}bT.value&&gF.calculatedTargetDeltas++}}}getClosestProjectingParent(){if(this.parent&&!MA(this.parent.latestValues)&&!LA(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;const t=this.getLead(),n=Boolean(this.resumingFrom)||this!==t;let r=!0;if((this.isProjectionDirty||null!==(e=this.parent)&&void 0!==e&&e.isProjectionDirty)&&(r=!1),n&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(r=!1),this.resolvedRelativeTargetAt===NT.timestamp&&(r=!1),r)return;const{layout:a,layoutId:s}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!a&&!s)return;tF(this.layoutCorrected,this.layout.layoutBox);const o=this.treeScale.x,i=this.treeScale.y;!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=n.length;if(!a)return;let s,o;t.x=t.y=1;for(let i=0;i<a;i++){s=n[i],o=s.projectionDelta;const{visualElement:a}=s.options;a&&a.props.style&&"contents"===a.props.style.display||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&YA(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,zA(e,o)),r&&IA(s.latestValues)&&YA(e,s.latestValues))}t.x<WA&&t.x>VA&&(t.x=1),t.y<WA&&t.y>VA&&(t.y=1)}(this.layoutCorrected,this.treeScale,this.path,n),!t.layout||t.target||1===this.treeScale.x&&1===this.treeScale.y||(t.target=t.layout.layoutBox,t.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}});const{target:l}=t;l?(this.projectionDelta&&this.prevProjectionDelta?(nF(this.prevProjectionDelta.x,this.projectionDelta.x),nF(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),cR(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.treeScale.x===o&&this.treeScale.y===i&&pF(this.projectionDelta.x,this.prevProjectionDelta.x)&&pF(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),bT.value&&gF.calculatedProjections++):this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender())}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(null===(e=this.options.visualElement)||void 0===e||e.scheduleRender(),t){const e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}}}setAnimationOrigin(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.snapshot,r=n?n.latestValues:{},a=Ye({},this.latestValues),s={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;const o={x:{min:0,max:0},y:{min:0,max:0}},i=(n?n.source:void 0)!==(this.layout?this.layout.source:void 0),l=this.getStack(),c=!l||l.members.length<=1,d=Boolean(i&&!c&&!0===this.options.crossfade&&!this.path.some(RF));let u;this.animationProgress=0,this.mixTargetDelta=t=>{const n=t/1e3;var l,m,h,p;IF(s.x,e.x,n),IF(s.y,e.y,n),this.setTargetDelta(s),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(mR(o,this.layout.layoutBox,this.relativeParent.layout.layoutBox),l=this.relativeTarget,m=this.relativeTargetOrigin,h=o,p=n,LF(l.x,m.x,h.x,p),LF(l.y,m.y,h.y,p),u&&function(e,t){return dF(e.x,t.x)&&dF(e.y,t.y)}(this.relativeTarget,u)&&(this.isProjectionDirty=!1),u||(u={x:{min:0,max:0},y:{min:0,max:0}}),tF(u,this.relativeTarget)),i&&(this.animationValues=a,function(e,t,n,r,a,s){var o,i;if(a)e.opacity=TA(0,null!==(o=n.opacity)&&void 0!==o?o:1,JR(r)),e.opacityExit=TA(null!==(i=t.opacity)&&void 0!==i?i:1,0,QR(r));else if(s){var l,c;e.opacity=TA(null!==(l=t.opacity)&&void 0!==l?l:1,null!==(c=n.opacity)&&void 0!==c?c:1,r)}for(let d=0;d<GR;d++){const a="border".concat(YR[d],"Radius");let s=KR(t,a),o=KR(n,a);void 0===s&&void 0===o||(s||(s=0),o||(o=0),0===s||0===o||$R(s)===$R(o)?(e[a]=Math.max(TA(XR(s),XR(o),r),0),(tT.test(o)||tT.test(s))&&(e[a]+="%")):e[a]=o)}(t.rotate||n.rotate)&&(e.rotate=TA(t.rotate||0,n.rotate||0,r))}(a,r,this.latestValues,n,d,c)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=n},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){var t,n;this.notifyListeners("animationStart"),null===(t=this.currentAnimation)||void 0===t||t.stop(),null===(n=this.resumingFrom)||void 0===n||null===(n=n.currentAnimation)||void 0===n||n.stop(),this.pendingAnimation&&(jT(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=wT.update(()=>{DR.hasAnimatedSinceResize=!0,sI.layout++,this.motionValue||(this.motionValue=vD(0)),this.currentAnimation=function(e,t,n){const r=dD(e)?e:vD(e);return r.start(IL("",r,t,n)),r.animation}(this.motionValue,[0,1e3],Ye(Ye({},e),{},{velocity:0,isSync:!0,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onStop:()=>{sI.layout--},onComplete:()=>{sI.layout--,e.onComplete&&e.onComplete(),this.completeAnimation()}})),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const e=this.getLead();let{targetWithTransforms:t,target:n,layout:r,latestValues:a}=e;if(t&&n&&r){if(this!==e&&this.layout&&r&&VF(this.options.animationType,this.layout.layoutBox,r.layoutBox)){n=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const t=iR(this.layout.layoutBox.x);n.x.min=e.target.x.min,n.x.max=n.x.min+t;const r=iR(this.layout.layoutBox.y);n.y.min=e.target.y.min,n.y.max=n.y.min+r}tF(t,n),YA(t,a),cR(this.projectionDeltaWithTransform,this.layoutCorrected,t,a)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new fF);this.sharedNodes.get(e).add(t);const n=t.options.initialPromotionConfig;t.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(t):void 0})}isLead(){const e=this.getStack();return!e||e.lead===this}getLead(){var e;const{layoutId:t}=this.options;return t&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this}getPrevLead(){var e;const{layoutId:t}=this.options;return t?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0}getStack(){const{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote(){let{needsReset:e,transition:t,preserveFollowOpacity:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=this.getStack();r&&r.promote(this,n),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){const e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){const{visualElement:e}=this.options;if(!e)return;let t=!1;const{latestValues:n}=e;if((n.z||n.rotate||n.rotateX||n.rotateY||n.rotateZ||n.skewX||n.skewY)&&(t=!0),!t)return;const r={};n.z&&bF("z",e,r,this.animationValues);for(let a=0;a<xF.length;a++)bF("rotate".concat(xF[a]),e,r,this.animationValues),bF("skew".concat(xF[a]),e,r,this.animationValues);e.render();for(const a in r)e.setStaticValue(a,r[a]),this.animationValues&&(this.animationValues[a]=r[a]);e.scheduleRender()}applyProjectionStyles(e,t){if(!this.instance||this.isSVG)return;if(!this.isVisible)return void(e.visibility="hidden");const n=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,e.visibility="",e.opacity="",e.pointerEvents=PM(null===t||void 0===t?void 0:t.pointerEvents)||"",void(e.transform=n?n(this.latestValues,""):"none");const r=this.getLead();if(!this.projectionDelta||!this.layout||!r.target)return this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=PM(null===t||void 0===t?void 0:t.pointerEvents)||""),void(this.hasProjected&&!IA(this.latestValues)&&(e.transform=n?n({},""):"none",this.hasProjected=!1));e.visibility="";const a=r.animationValues||r.latestValues;this.applyTransformsToTarget();let s=function(e,t,n){let r="";const a=e.x.translate/t.x,s=e.y.translate/t.y,o=(null===n||void 0===n?void 0:n.z)||0;if((a||s||o)&&(r="translate3d(".concat(a,"px, ").concat(s,"px, ").concat(o,"px) ")),1===t.x&&1===t.y||(r+="scale(".concat(1/t.x,", ").concat(1/t.y,") ")),n){const{transformPerspective:e,rotate:t,rotateX:a,rotateY:s,skewX:o,skewY:i}=n;e&&(r="perspective(".concat(e,"px) ").concat(r)),t&&(r+="rotate(".concat(t,"deg) ")),a&&(r+="rotateX(".concat(a,"deg) ")),s&&(r+="rotateY(".concat(s,"deg) ")),o&&(r+="skewX(".concat(o,"deg) ")),i&&(r+="skewY(".concat(i,"deg) "))}const i=e.x.scale*t.x,l=e.y.scale*t.y;return 1===i&&1===l||(r+="scale(".concat(i,", ").concat(l,")")),r||"none"}(this.projectionDeltaWithTransform,this.treeScale,a);n&&(s=n(a,s)),e.transform=s;const{x:o,y:i}=this.projectionDelta;var l,c;(e.transformOrigin="".concat(100*o.origin,"% ").concat(100*i.origin,"% 0"),r.animationValues)?e.opacity=r===this?null!==(l=null!==(c=a.opacity)&&void 0!==c?c:this.latestValues.opacity)&&void 0!==l?l:1:this.preserveOpacity?this.latestValues.opacity:a.opacityExit:e.opacity=r===this?void 0!==a.opacity?a.opacity:"":void 0!==a.opacityExit?a.opacityExit:0;for(const d in XD){if(void 0===a[d])continue;const{correct:t,applyTo:n,isCSSVariable:o}=XD[d],i="none"===s?a[d]:t(a[d],r);if(n){const t=n.length;for(let r=0;r<t;r++)e[n[r]]=i}else o?this.options.visualElement.renderState.vars[d]=i:e[d]=i}this.options.layoutId&&(e.pointerEvents=r===this?PM(null===t||void 0===t?void 0:t.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>{var t;return null===(t=e.currentAnimation)||void 0===t?void 0:t.stop()}),this.root.nodes.forEach(_F),this.root.sharedNodes.clear()}}}function jF(e){e.updateLayout()}function NF(e){var t;const n=(null===(t=e.resumeFrom)||void 0===t?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=e.layout,{animationType:a}=e.options,s=n.source!==e.layout.source;"size"===a?hR(e=>{const r=s?n.measuredBox[e]:n.layoutBox[e],a=iR(r);r.min=t[e].min,r.max=r.min+a}):VF(a,n.layoutBox,t)&&hR(r=>{const a=s?n.measuredBox[r]:n.layoutBox[r],o=iR(t[r]);a.max=a.min+o,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[r].max=e.relativeTarget[r].min+o)});const o={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};cR(o,t,n.layoutBox);const i={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};s?cR(i,e.applyTransform(r,!0),n.measuredBox):cR(i,t,n.layoutBox);const l=!cF(o);let c=!1;if(!e.resumeFrom){const r=e.getClosestProjectingParent();if(r&&!r.resumeFrom){const{snapshot:a,layout:s}=r;if(a&&s){const o={x:{min:0,max:0},y:{min:0,max:0}};mR(o,n.layoutBox,a.layoutBox);const i={x:{min:0,max:0},y:{min:0,max:0}};mR(i,t,s.layoutBox),mF(o,i)||(c=!0),r.options.layoutRoot&&(e.relativeTarget=i,e.relativeTargetOrigin=o,e.relativeParent=r)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:n,delta:i,layoutDelta:o,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function kF(e){bT.value&&gF.nodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=Boolean(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function SF(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function CF(e){e.clearSnapshot()}function _F(e){e.clearMeasurements()}function EF(e){e.isLayoutDirty=!1}function PF(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function OF(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function AF(e){e.resolveTargetDelta()}function TF(e){e.calcProjection()}function DF(e){e.resetSkewAndRotation()}function MF(e){e.removeLeadSnapshot()}function IF(e,t,n){e.translate=TA(t.translate,0,n),e.scale=TA(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function LF(e,t,n,r){e.min=TA(t.min,n.min,r),e.max=TA(t.max,n.max,r)}function RF(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}const FF={duration:.45,ease:[.4,0,.1,1]},BF=e=>"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),UF=BF("applewebkit/")&&!BF("chrome/")?Math.round:gT;function zF(e){e.min=UF(e.min),e.max=UF(e.max)}function VF(e,t,n){return"position"===e||"preserve-aspect"===e&&!function(e,t,n){return Math.abs(e-t)<=n}(hF(t),hF(n),.2)}function WF(e){var t;return e!==e.root&&(null===(t=e.scroll)||void 0===t?void 0:t.wasRoot)}const qF=wF({attachResizeListener:(e,t)=>rR(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),HF={current:void 0},YF=wF({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!HF.current){const e=new qF({});e.mount(window),e.setOptions({layoutScroll:!0}),HF.current=e}return HF.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>Boolean("fixed"===window.getComputedStyle(e).position)}),GF={pan:{Feature:class extends QL{constructor(){super(...arguments),this.removePointerDownListener=gT}onPointerDown(e){this.session=new gR(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:pR(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:AR(e),onStart:AR(t),onMove:n,onEnd:(e,t)=>{delete this.session,r&&wT.postRender(()=>r(e,t))}}}mount(){this.removePointerDownListener=oR(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends QL{constructor(e){super(e),this.removeGroupControls=gT,this.removeListeners=gT,this.controls=new PR(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||gT}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:YF,MeasureLayout:BR}};function XF(e,t){const n=function(e,t,n){if(e instanceof EventTarget)return[e];if("string"===typeof e){var r;let a=document;t&&(a=t.current);const s=null!==(r=null===n||void 0===n?void 0:n[e])&&void 0!==r?r:a.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}(e),r=new AbortController;return[n,Ye(Ye({passive:!0},t),{},{signal:r.signal}),()=>r.abort()]}function $F(e){return!("touch"===e.pointerType||nR())}function KF(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover","Start"===n);const a=r["onHover"+n];a&&wT.postRender(()=>a(t,sR(t)))}function JF(e){return zR(e)&&"offsetHeight"in e}const QF=(e,t)=>!!t&&(e===t||QF(e,t.parentElement)),ZF=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);const eB=new WeakSet;function tB(e){return t=>{"Enter"===t.key&&e(t)}}function nB(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}function rB(e){return aR(e)&&!nR()}function aB(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[r,a,s]=XF(e,n),o=e=>{const r=e.currentTarget;if(!rB(e))return;eB.add(r);const s=t(r,e),o=(e,t)=>{window.removeEventListener("pointerup",i),window.removeEventListener("pointercancel",l),eB.has(r)&&eB.delete(r),rB(e)&&"function"===typeof s&&s(e,{success:t})},i=e=>{o(e,r===window||r===document||n.useGlobalTarget||QF(r,e.target))},l=e=>{o(e,!1)};window.addEventListener("pointerup",i,a),window.addEventListener("pointercancel",l,a)};return r.forEach(e=>{var t;(n.useGlobalTarget?window:e).addEventListener("pointerdown",o,a),JF(e)&&(e.addEventListener("focus",e=>((e,t)=>{const n=e.currentTarget;if(!n)return;const r=tB(()=>{if(eB.has(n))return;nB(n,"down");const e=tB(()=>{nB(n,"up")});n.addEventListener("keyup",e,t),n.addEventListener("blur",()=>nB(n,"cancel"),t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)})(e,a)),t=e,ZF.has(t.tagName)||-1!==t.tabIndex||e.hasAttribute("tabindex")||(e.tabIndex=0))}),s}function sB(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap","Start"===n);const a=r["onTap"+("End"===n?"":n)];a&&wT.postRender(()=>a(t,sR(t)))}const oB=["root"],iB=new WeakMap,lB=new WeakMap,cB=e=>{const t=iB.get(e.target);t&&t(e)},dB=e=>{e.forEach(cB)};function uB(e,t,n){const r=function(e){let{root:t}=e,n=Il(e,oB);const r=t||document;lB.has(r)||lB.set(r,{});const a=lB.get(r),s=JSON.stringify(n);return a[s]||(a[s]=new IntersectionObserver(dB,Ye({root:t},n))),a[s]}(t);return iB.set(e,n),r.observe(e),()=>{iB.delete(e),r.unobserve(e)}}const mB={some:0,all:1};const hB={inView:{Feature:class extends QL{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:r="some",once:a}=e,s={root:t?t.current:void 0,rootMargin:n,threshold:"number"===typeof r?r:mB[r]};return uB(this.node.current,s,e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,a&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:n,onViewportLeave:r}=this.node.getProps(),s=t?n:r;s&&s(e)})}mount(){this.startObserver()}update(){if("undefined"===typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node,n=["amount","margin","root"].some(function(e){let{viewport:t={}}=e,{viewport:n={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=>t[e]!==n[e]}(e,t));n&&this.startObserver()}unmount(){}}},tap:{Feature:class extends QL{mount(){const{current:e}=this.node;e&&(this.unmount=aB(e,(e,t)=>(sB(this.node,t,"Start"),(e,t)=>{let{success:n}=t;return sB(this.node,e,n?"End":"Cancel")}),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends QL{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(FB){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=nI(rR(this.node.current,"focus",()=>this.onFocus()),rR(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends QL{mount(){const{current:e}=this.node;e&&(this.unmount=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[r,a,s]=XF(e,n),o=e=>{if(!$F(e))return;const{target:n}=e,r=t(n,e);if("function"!==typeof r||!n)return;const s=e=>{$F(e)&&(r(e),n.removeEventListener("pointerleave",s))};n.addEventListener("pointerleave",s,a)};return r.forEach(e=>{e.addEventListener("pointerenter",o,a)}),s}(e,(e,t)=>(KF(this.node,t,"Start"),e=>KF(this.node,e,"End"))))}unmount(){}}}},pB={layout:{ProjectionNode:YF,MeasureLayout:BR}},fB=HM(Ye(Ye(Ye(Ye({},eR),hB),GF),pB),cM);function gB(e,t){if("function"===typeof e)return e(t);null!==e&&void 0!==e&&(e.current=t)}function xB(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.useCallback(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{let n=!1;const r=t.map(t=>{const r=gB(t,e);return n||"function"!==typeof r||(n=!0),r});if(n)return()=>{for(let e=0;e<r.length;e++){const n=r[e];"function"===typeof n?n():gB(t[e],null)}}}}(...t),t)}class yB extends s.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=t.offsetParent,n=JF(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=n-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function bB(e){let{children:t,isPresent:n,anchorX:r,root:a}=e;const o=(0,s.useId)(),i=(0,s.useRef)(null),l=(0,s.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=(0,s.useContext)(mM),d=xB(i,null===t||void 0===t?void 0:t.ref);return(0,s.useInsertionEffect)(()=>{const{width:e,height:t,top:s,left:d,right:u}=l.current;if(n||!i.current||!e||!t)return;const m="left"===r?"left: ".concat(d):"right: ".concat(u);i.current.dataset.motionPopId=o;const h=document.createElement("style");c&&(h.nonce=c);const p=null!==a&&void 0!==a?a:document.head;return p.appendChild(h),h.sheet&&h.sheet.insertRule('\n          [data-motion-pop-id="'.concat(o,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat(m,"px !important;\n            top: ").concat(s,"px !important;\n          }\n        ")),()=>{p.contains(h)&&p.removeChild(h)}},[n]),(0,yr.jsx)(yB,{isPresent:n,childRef:i,sizeRef:l,children:s.cloneElement(t,{ref:d})})}const vB=e=>{let{children:t,initial:n,isPresent:r,onExitComplete:a,custom:o,presenceAffectsLayout:i,mode:l,anchorX:c,root:d}=e;const u=EM(wB),m=(0,s.useId)();let h=!0,p=(0,s.useMemo)(()=>(h=!1,{id:m,initial:n,isPresent:r,custom:o,onExitComplete:e=>{u.set(e,!0);for(const t of u.values())if(!t)return;a&&a()},register:e=>(u.set(e,!1),()=>u.delete(e))}),[r,u,a]);return i&&h&&(p=Ye({},p)),(0,s.useMemo)(()=>{u.forEach((e,t)=>u.set(t,!1))},[r]),s.useEffect(()=>{!r&&!u.size&&a&&a()},[r]),"popLayout"===l&&(t=(0,yr.jsx)(bB,{isPresent:r,anchorX:c,root:d,children:t})),(0,yr.jsx)(_M.Provider,{value:p,children:t})};function wB(){return new Map}const jB=e=>e.key||"";function NB(e){const t=[];return s.Children.forEach(e,e=>{(0,s.isValidElement)(e)&&t.push(e)}),t}const kB=e=>{let{children:t,custom:n,initial:r=!0,onExitComplete:a,presenceAffectsLayout:o=!0,mode:i="sync",propagate:l=!1,anchorX:c="left",root:d}=e;const[u,m]=TR(l),h=(0,s.useMemo)(()=>NB(t),[t]),p=l&&!u?[]:h.map(jB),f=(0,s.useRef)(!0),g=(0,s.useRef)(h),x=EM(()=>new Map),[y,b]=(0,s.useState)(h),[v,w]=(0,s.useState)(h);UM(()=>{f.current=!1,g.current=h;for(let e=0;e<v.length;e++){const t=jB(v[e]);p.includes(t)?x.delete(t):!0!==x.get(t)&&x.set(t,!1)}},[v,p.length,p.join("-")]);const j=[];if(h!==y){let e=[...h];for(let t=0;t<v.length;t++){const n=v[t],r=jB(n);p.includes(r)||(e.splice(t,0,n),j.push(n))}return"wait"===i&&j.length&&(e=j),w(NB(e)),b(h),null}const{forceRender:N}=(0,s.useContext)(dM);return(0,yr.jsx)(yr.Fragment,{children:v.map(e=>{const t=jB(e),s=!(l&&!u)&&(h===v||p.includes(t));return(0,yr.jsx)(vB,{isPresent:s,initial:!(f.current&&!r)&&void 0,custom:n,presenceAffectsLayout:o,mode:i,root:d,onExitComplete:s?void 0:()=>{if(!x.has(t))return;x.set(t,!0);let e=!0;x.forEach(t=>{t||(e=!1)}),e&&(null===N||void 0===N||N(),w(g.current),l&&(null===m||void 0===m||m()),a&&a())},anchorX:c,children:e},t)})})},SB=()=>{const{leadId:e}=Q(),[t,n]=(0,s.useState)(!0),[r,a]=(0,s.useState)(!1),[o,i]=(0,s.useState)(null),[l,c]=(0,s.useState)([]),[d,u]=(0,s.useState)([]),[m,h]=(0,s.useState)(null),[p,f]=(0,s.useState)(null),[g,x]=(0,s.useState)(null),[y,b]=(0,s.useState)(!1),[v,w]=(0,s.useState)(()=>{const e=new Date;return new Date(e.getFullYear(),e.getMonth(),1)}),[j,N]=(0,s.useState)(1),[k,S]=(0,s.useState)(!1),[C,_]=(0,s.useState)(!1),[E,P]=(0,s.useState)(""),[O,A]=(0,s.useState)(""),T=new Date;T.setHours(0,0,0,0);const D=new Date(T);D.setDate(T.getDate()+21);const M=new Date(T.getFullYear(),T.getMonth(),1),I=new Date(D.getFullYear(),D.getMonth(),1),L=v.getFullYear()===M.getFullYear()&&v.getMonth()===M.getMonth(),R=v.getFullYear()===I.getFullYear()&&v.getMonth()===I.getMonth(),F=["10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30"],B=(0,s.useCallback)(async()=>{try{n(!0);const t=new Date(v.getFullYear(),v.getMonth(),1),r=new Date(v.getFullYear(),v.getMonth()+1,0),a=t.toISOString().split("T")[0],s=r.toISOString().split("T")[0],[o,l,d]=await Promise.all([xr.get("/api/public/booking/lead/".concat(e)),xr.get("/api/stats/calendar-public?start=".concat(a,"&end=").concat(s)),xr.get("/api/blocked-slots?start_date=".concat(a,"&end_date=").concat(s))]);i(o.data),P(o.data.name||""),A(o.data.email||""),c(l.data||[]),u(d.data||[]),n(!1)}catch(BB){console.error("Error fetching data:",BB),x("Unable to load booking page. Please try again later."),n(!1)}},[e,v]);(0,s.useEffect)(()=>{B()},[B]);const U=e=>{if(!e)return!0;const t=e.toISOString().split("T")[0];return d.some(e=>{var n;return(null===(n=e.date)||void 0===n?void 0:n.split("T")[0])===t&&!e.time_slot})},z=e=>{if(!e)return!0;const t=new Date;return t.setHours(0,0,0,0),e<t},V=e=>{if(!e)return[];const t=e.toISOString().split("T")[0],n=l.filter(e=>{var n;return(null===(n=e.booking_date)||void 0===n?void 0:n.split("T")[0])===t&&"Cancelled"!==e.lead_status}).map(e=>e.booking_time),r=d.filter(e=>{var n;return(null===(n=e.date)||void 0===n?void 0:n.split("T")[0])===t&&e.time_slot}).map(e=>e.time_slot);return[...new Set([...n,...r])]},W=e=>!e||U(e)||z(e)||(e=>!e||e>D)(e)?0:F.filter(t=>!V(e).includes(t)).length,q=(()=>{const e=v.getFullYear(),t=v.getMonth(),n=new Date(e,t,1),r=new Date(e,t+1,0).getDate(),a=n.getDay(),s=0===a?6:a-1,o=[];for(let i=0;i<s;i++)o.push(null);for(let i=1;i<=r;i++)o.push(new Date(e,t,i));return o})(),H=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Y={hidden:{opacity:0,x:50,scale:.95},visible:{opacity:1,x:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}},exit:{opacity:0,x:-50,scale:.95,transition:{duration:.3}}},G={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},X={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:[.22,1,.36,1]}}};return t?(0,yr.jsx)("div",{className:"min-h-screen bg-[#fafafa] flex items-center justify-center p-4",children:(0,yr.jsxs)(fB.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center",children:[(0,yr.jsx)(fB.div,{animate:{rotate:360},transition:{duration:1.5,repeat:1/0,ease:"linear"},className:"w-12 h-12 sm:w-16 sm:h-16 border-4 border-[#1a1a1a]/10 border-t-[#1e3a5f] rounded-full mx-auto mb-4 sm:mb-6"}),(0,yr.jsx)("p",{className:"text-[#1a1a1a]/60 text-base sm:text-lg tracking-wide",children:"Loading your booking..."})]})}):g&&!o?(0,yr.jsx)("div",{className:"min-h-screen bg-[#fafafa] flex items-center justify-center p-4",children:(0,yr.jsxs)(fB.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"max-w-md w-full text-center px-4",children:[(0,yr.jsx)("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,yr.jsx)("span",{className:"text-4xl",children:"!"})}),(0,yr.jsx)("h1",{className:"text-2xl sm:text-3xl font-light text-[#1a1a1a] mb-4",children:"Booking Not Found"}),(0,yr.jsx)("p",{className:"text-[#1a1a1a]/60 mb-6",children:g}),(0,yr.jsx)("p",{className:"text-[#1a1a1a]/40 text-sm",children:"Please check your booking link and try again, or contact support if the problem persists."})]})}):y?(0,yr.jsx)("div",{className:"min-h-screen bg-[#fafafa] flex items-center justify-center p-4",children:(0,yr.jsxs)(fB.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.6,ease:[.22,1,.36,1]},className:"max-w-lg w-full text-center px-4",children:[(0,yr.jsx)(fB.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-20 h-20 sm:w-24 sm:h-24 bg-gradient-to-br from-emerald-400 to-emerald-600 rounded-full flex items-center justify-center mx-auto mb-6 sm:mb-8 shadow-2xl shadow-emerald-500/30",children:(0,yr.jsx)(gs,{className:"w-10 h-10 sm:w-12 sm:h-12 text-white",strokeWidth:3})}),(0,yr.jsx)(fB.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-2xl sm:text-4xl font-light text-[#1a1a1a] mb-4 tracking-tight",children:"Booking Confirmed"}),(0,yr.jsxs)(fB.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-2xl p-6 sm:p-8 shadow-xl shadow-black/5 border border-black/5",children:[(0,yr.jsx)("p",{className:"text-[#1a1a1a]/60 mb-3 sm:mb-4 text-sm sm:text-base",children:"Your appointment is scheduled for"}),(0,yr.jsx)("p",{className:"text-lg sm:text-2xl font-medium text-[#1a1a1a] mb-2",children:null===m||void 0===m?void 0:m.toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long"})}),(0,yr.jsx)("p",{className:"text-2xl sm:text-3xl font-light text-[#1a1a1a]",children:p})]}),(0,yr.jsxs)(fB.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-6 sm:mt-8 text-[#1a1a1a]/40 text-xs sm:text-sm px-4",children:["A confirmation has been sent to ",O]})]})}):(0,yr.jsxs)("div",{className:"min-h-screen bg-[#fafafa]",children:[(0,yr.jsx)("div",{className:"fixed inset-0 bg-gradient-to-br from-white via-transparent to-[#f0f0f0] pointer-events-none"}),(0,yr.jsxs)("div",{className:"relative max-w-5xl mx-auto px-4 sm:px-6 py-4 sm:py-8",children:[(0,yr.jsx)(fB.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex justify-center sm:justify-start mb-4 sm:mb-0 sm:absolute sm:top-8 sm:left-6",children:(0,yr.jsx)("img",{src:"/images/edge-talent-logo.png",alt:"Edge Talent",className:"h-12 sm:h-16 w-auto"})}),(0,yr.jsxs)(fB.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-6 sm:mb-12 pt-2 sm:pt-8",children:[(0,yr.jsx)("h1",{className:"text-2xl sm:text-4xl lg:text-5xl font-extralight text-[#1a1a1a] tracking-tight mb-2 sm:mb-3",children:"Book Your Session"}),(0,yr.jsx)("p",{className:"text-[#1a1a1a]/50 text-sm sm:text-lg",children:"Select your preferred date and time"})]}),(0,yr.jsx)(fB.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex justify-center mb-8 sm:mb-16 px-2",children:(0,yr.jsx)("div",{className:"flex items-center gap-1 sm:gap-3",children:[{num:1,label:"Details",color:"from-[#1e3a5f] to-[#152a45]",shadow:"shadow-blue-900/40"},{num:2,label:"Date",color:"from-[#D4145A] to-[#B8124E]",shadow:"shadow-pink-500/40"},{num:3,label:"Time",color:"from-[#9B2335] to-[#7A1C2A]",shadow:"shadow-rose-600/40"},{num:4,label:"Confirm",color:"from-[#C9A227] to-[#A88B1F]",shadow:"shadow-amber-500/40"}].map((e,t)=>(0,yr.jsxs)(s.Fragment,{children:[(0,yr.jsxs)(fB.button,{onClick:()=>e.num<j&&N(e.num),whileHover:e.num<j?{scale:1.1}:{},whileTap:e.num<j?{scale:.95}:{},className:"flex flex-col items-center transition-all duration-500 ".concat(e.num<j?"cursor-pointer":"cursor-default"),children:[(0,yr.jsx)(fB.div,{animate:j===e.num?{scale:[1,1.1,1]}:{},transition:{duration:.5,repeat:j===e.num?1/0:0,repeatDelay:2},className:"w-9 h-9 sm:w-12 sm:h-12 rounded-full flex items-center justify-center text-xs sm:text-sm font-semibold transition-all duration-500 ".concat(j>e.num?"bg-gradient-to-br ".concat(e.color," text-white shadow-lg ").concat(e.shadow):j===e.num?"bg-gradient-to-br ".concat(e.color," text-white shadow-xl ").concat(e.shadow," scale-105 sm:scale-110 ring-2 sm:ring-4 ring-white ring-offset-1 sm:ring-offset-2"):"bg-white text-[#1a1a1a]/30 border-2 border-[#1a1a1a]/10"),children:j>e.num?(0,yr.jsx)(gs,{className:"w-4 h-4 sm:w-5 sm:h-5",strokeWidth:3}):e.num}),(0,yr.jsx)("span",{className:"text-[10px] sm:text-xs mt-1 sm:mt-2 font-semibold tracking-wide transition-all duration-300 hidden sm:block ".concat(j>e.num?1===e.num?"text-[#1e3a5f]":"text-[#C41230]":j===e.num?"text-[#1a1a1a]":"text-[#1a1a1a]/30"),children:e.label})]}),t<3&&(0,yr.jsx)(fB.div,{initial:{scaleX:0},animate:{scaleX:j>e.num?1:0},transition:{duration:.5,ease:"easeOut"},className:"w-6 sm:w-16 h-0.5 sm:h-1 rounded-full origin-left transition-all duration-500 ".concat(j>e.num?"bg-gradient-to-r ".concat(e.color):"bg-[#1a1a1a]/10")})]},e.num))})}),(0,yr.jsxs)(kB,{mode:"wait",children:[1===j&&(0,yr.jsx)(fB.div,{variants:Y,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-xl mx-auto px-2 sm:px-0",children:(0,yr.jsxs)(fB.div,{variants:G,initial:"hidden",animate:"visible",className:"bg-white rounded-2xl sm:rounded-3xl p-6 sm:p-10 shadow-2xl shadow-black/5 border border-black/5",children:[(0,yr.jsx)(fB.h2,{variants:X,className:"text-xl sm:text-2xl font-light text-[#1a1a1a] mb-6 sm:mb-8 text-center",children:"Confirm Your Details"}),(0,yr.jsxs)(fB.div,{variants:X,className:"mb-4 sm:mb-6",children:[(0,yr.jsx)("label",{className:"text-[10px] sm:text-xs font-medium text-[#1a1a1a]/40 uppercase tracking-wider mb-2 sm:mb-3 block",children:"Your Name"}),(0,yr.jsxs)("div",{className:"relative group",children:[(0,yr.jsx)("div",{className:"absolute left-3 sm:left-4 top-1/2 -translate-y-1/2 text-[#1a1a1a]/30",children:(0,yr.jsx)(vo,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),k?(0,yr.jsx)("input",{type:"text",value:E,onChange:e=>P(e.target.value),onBlur:()=>S(!1),autoFocus:!0,className:"w-full pl-10 sm:pl-12 pr-4 py-3 sm:py-4 text-base sm:text-xl text-[#1a1a1a] bg-[#fafafa] rounded-xl border-2 border-[#1a1a1a] outline-none transition-all"}):(0,yr.jsxs)("div",{onClick:()=>S(!0),className:"w-full pl-10 sm:pl-12 pr-10 sm:pr-12 py-3 sm:py-4 text-base sm:text-xl text-[#1a1a1a] bg-[#fafafa] rounded-xl border-2 border-transparent hover:border-[#1a1a1a]/20 cursor-pointer transition-all group",children:[E||"Enter your name",(0,yr.jsx)(Ss,{className:"absolute right-3 sm:right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#1a1a1a]/30 group-hover:text-[#1a1a1a]/60 transition-colors"})]})]})]}),(0,yr.jsxs)(fB.div,{variants:X,className:"mb-6 sm:mb-10",children:[(0,yr.jsx)("label",{className:"text-[10px] sm:text-xs font-medium text-[#1a1a1a]/40 uppercase tracking-wider mb-2 sm:mb-3 block",children:"Email Address"}),(0,yr.jsxs)("div",{className:"relative group",children:[(0,yr.jsx)("div",{className:"absolute left-3 sm:left-4 top-1/2 -translate-y-1/2 text-[#1a1a1a]/30",children:(0,yr.jsx)(Vs,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),C?(0,yr.jsx)("input",{type:"email",value:O,onChange:e=>A(e.target.value),onBlur:()=>_(!1),autoFocus:!0,className:"w-full pl-10 sm:pl-12 pr-4 py-3 sm:py-4 text-base sm:text-xl text-[#1a1a1a] bg-[#fafafa] rounded-xl border-2 border-[#1a1a1a] outline-none transition-all"}):(0,yr.jsxs)("div",{onClick:()=>_(!0),className:"w-full pl-10 sm:pl-12 pr-10 sm:pr-12 py-3 sm:py-4 text-base sm:text-xl text-[#1a1a1a] bg-[#fafafa] rounded-xl border-2 border-transparent hover:border-[#1a1a1a]/20 cursor-pointer transition-all group truncate",children:[O||"Enter your email",(0,yr.jsx)(Ss,{className:"absolute right-3 sm:right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#1a1a1a]/30 group-hover:text-[#1a1a1a]/60 transition-colors"})]})]})]}),(0,yr.jsx)(fB.button,{variants:X,onClick:()=>N(2),whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},className:"w-full py-4 sm:py-5 bg-[#1a1a1a] text-white rounded-xl font-medium text-base sm:text-lg shadow-xl shadow-black/20 hover:shadow-2xl hover:shadow-black/30 transition-all",children:"Continue to Calendar"})]})},"step1"),2===j&&(0,yr.jsx)(fB.div,{variants:Y,initial:"hidden",animate:"visible",exit:"exit",className:"px-2 sm:px-0",children:(0,yr.jsxs)(fB.div,{className:"bg-white rounded-2xl sm:rounded-3xl p-4 sm:p-8 lg:p-12 shadow-2xl shadow-black/5 border border-black/5",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-6 sm:mb-10",children:[(0,yr.jsx)(fB.button,{onClick:()=>!L&&w(new Date(v.getFullYear(),v.getMonth()-1)),whileHover:L?{}:{scale:1.1,x:-3},whileTap:L?{}:{scale:.9},disabled:L,className:"w-10 h-10 sm:w-14 sm:h-14 rounded-full flex items-center justify-center transition-colors ".concat(L?"bg-[#fafafa]/50 cursor-not-allowed":"bg-[#fafafa] hover:bg-[#f0f0f0]"),children:(0,yr.jsx)(ys,{className:"w-5 h-5 sm:w-6 sm:h-6 ".concat(L?"text-[#1a1a1a]/20":"text-[#1a1a1a]")})}),(0,yr.jsxs)(fB.h2,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-lg sm:text-2xl lg:text-3xl font-light text-[#1a1a1a] tracking-tight",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][v.getMonth()]," ",v.getFullYear()]},v.toString()),(0,yr.jsx)(fB.button,{onClick:()=>!R&&w(new Date(v.getFullYear(),v.getMonth()+1)),whileHover:R?{}:{scale:1.1,x:3},whileTap:R?{}:{scale:.9},disabled:R,className:"w-10 h-10 sm:w-14 sm:h-14 rounded-full flex items-center justify-center transition-colors ".concat(R?"bg-[#fafafa]/50 cursor-not-allowed":"bg-[#fafafa] hover:bg-[#f0f0f0]"),children:(0,yr.jsx)(bs,{className:"w-5 h-5 sm:w-6 sm:h-6 ".concat(R?"text-[#1a1a1a]/20":"text-[#1a1a1a]")})})]}),(0,yr.jsx)("div",{className:"grid grid-cols-7 gap-1 sm:gap-2 mb-2 sm:mb-4",children:["M","T","W","T","F","S","S"].map((e,t)=>(0,yr.jsxs)("div",{className:"text-center py-2 sm:py-3 text-xs sm:text-sm font-medium text-[#1a1a1a]/40 uppercase tracking-wider",children:[(0,yr.jsx)("span",{className:"sm:hidden",children:e}),(0,yr.jsx)("span",{className:"hidden sm:inline",children:H[t]})]},e+t))}),(0,yr.jsx)(fB.div,{variants:G,initial:"hidden",animate:"visible",className:"grid grid-cols-7 gap-1 sm:gap-2",children:q.map((e,t)=>{const n=e&&U(e),r=e&&z(e),a=e?W(e):0,s=!e||n||r||0===a;return(0,yr.jsx)(fB.button,{variants:X,onClick:()=>(e=>{!e||U(e)||z(e)||0===W(e)||(h(e),f(null),N(3))})(e),disabled:s,whileHover:s?{}:{scale:1.05,y:-2},whileTap:s?{}:{scale:.95},className:"aspect-square rounded-lg sm:rounded-2xl flex flex-col items-center justify-center transition-all duration-300 min-h-[40px] sm:min-h-[60px] ".concat(e?s?"text-[#1a1a1a]/20 cursor-not-allowed":"bg-[#fafafa] hover:bg-[#1a1a1a] hover:text-white cursor-pointer shadow-sm hover:shadow-xl hover:shadow-black/20 group":""),children:e&&(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("span",{className:"text-sm sm:text-xl font-medium",children:e.getDate()}),!s&&a>0&&(0,yr.jsxs)("span",{className:"text-[8px] sm:text-[10px] text-[#1a1a1a]/40 group-hover:text-white/60 font-medium hidden sm:block",children:[a," slots"]})]})},t)})}),(0,yr.jsx)(fB.button,{onClick:()=>N(1),whileHover:{scale:1.02},whileTap:{scale:.98},className:"mt-6 sm:mt-8 w-full py-3 sm:py-4 border-2 border-[#1a1a1a]/20 text-[#1a1a1a]/60 rounded-xl font-medium hover:border-[#1a1a1a]/40 hover:text-[#1a1a1a] transition-colors",children:"Back to Details"})]})},"step2"),3===j&&m&&(0,yr.jsx)(fB.div,{variants:Y,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-3xl mx-auto px-2 sm:px-0",children:(0,yr.jsxs)(fB.div,{className:"bg-white rounded-2xl sm:rounded-3xl p-4 sm:p-8 lg:p-12 shadow-2xl shadow-black/5 border border-black/5",children:[(0,yr.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 sm:mb-10 gap-4",children:[(0,yr.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4",children:[(0,yr.jsx)("div",{className:"w-10 h-10 sm:w-14 sm:h-14 rounded-full bg-[#1a1a1a] flex items-center justify-center flex-shrink-0",children:(0,yr.jsx)(ws,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("p",{className:"text-[10px] sm:text-sm text-[#1a1a1a]/40 font-medium uppercase tracking-wider",children:"Selected Date"}),(0,yr.jsx)("p",{className:"text-base sm:text-2xl font-light text-[#1a1a1a]",children:m.toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long"})})]})]}),(0,yr.jsx)(fB.button,{onClick:()=>N(2),whileHover:{scale:1.05},whileTap:{scale:.95},className:"text-[#1a1a1a]/50 hover:text-[#1a1a1a] font-medium transition-colors text-sm sm:text-base self-end sm:self-auto",children:"Change"})]}),(0,yr.jsx)("h3",{className:"text-base sm:text-lg font-medium text-[#1a1a1a]/60 mb-4 sm:mb-6",children:"Available Times"}),(0,yr.jsx)(fB.div,{variants:G,initial:"hidden",animate:"visible",className:"grid grid-cols-3 sm:grid-cols-5 gap-2 sm:gap-3",children:F.map((e,t)=>{const n=V(m).includes(e);return(0,yr.jsx)(fB.button,{variants:X,custom:t,onClick:()=>!n&&(e=>{f(e),N(4)})(e),disabled:n,whileHover:n?{}:{scale:1.05,y:-3},whileTap:n?{}:{scale:.95},className:"py-3 sm:py-5 rounded-lg sm:rounded-xl font-medium text-sm sm:text-lg transition-all duration-300 ".concat(n?"bg-[#fafafa] text-[#1a1a1a]/20 cursor-not-allowed":"bg-[#fafafa] hover:bg-[#1a1a1a] hover:text-white hover:shadow-xl hover:shadow-black/20"),children:e},e)})})]})},"step3"),4===j&&m&&p&&(0,yr.jsx)(fB.div,{variants:Y,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-xl mx-auto px-2 sm:px-0",children:(0,yr.jsxs)(fB.div,{className:"bg-white rounded-2xl sm:rounded-3xl p-6 sm:p-10 shadow-2xl shadow-black/5 border border-black/5",children:[(0,yr.jsx)(fB.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-[#1a1a1a] flex items-center justify-center mx-auto mb-6 sm:mb-8",children:(0,yr.jsx)(hs,{className:"w-7 h-7 sm:w-8 sm:h-8 text-white"})}),(0,yr.jsx)("h2",{className:"text-2xl sm:text-3xl font-light text-[#1a1a1a] text-center mb-6 sm:mb-10",children:"Confirm Your Booking"}),(0,yr.jsxs)("div",{className:"space-y-3 sm:space-y-4 mb-6 sm:mb-10",children:[(0,yr.jsxs)(fB.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},className:"flex items-center justify-between py-3 sm:py-4 border-b border-[#1a1a1a]/10",children:[(0,yr.jsx)("span",{className:"text-[#1a1a1a]/50 text-sm sm:text-base",children:"Name"}),(0,yr.jsx)("span",{className:"font-medium text-[#1a1a1a] text-sm sm:text-base text-right",children:E})]}),(0,yr.jsxs)(fB.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},className:"flex items-center justify-between py-3 sm:py-4 border-b border-[#1a1a1a]/10",children:[(0,yr.jsx)("span",{className:"text-[#1a1a1a]/50 text-sm sm:text-base",children:"Email"}),(0,yr.jsx)("span",{className:"font-medium text-[#1a1a1a] text-sm sm:text-base text-right truncate max-w-[180px] sm:max-w-none",children:O})]}),(0,yr.jsxs)(fB.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},className:"flex items-center justify-between py-3 sm:py-4 border-b border-[#1a1a1a]/10",children:[(0,yr.jsx)("span",{className:"text-[#1a1a1a]/50 text-sm sm:text-base",children:"Date"}),(0,yr.jsx)("span",{className:"font-medium text-[#1a1a1a] text-sm sm:text-base text-right",children:m.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})})]}),(0,yr.jsxs)(fB.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5},className:"flex items-center justify-between py-3 sm:py-4",children:[(0,yr.jsx)("span",{className:"text-[#1a1a1a]/50 text-sm sm:text-base",children:"Time"}),(0,yr.jsx)("span",{className:"text-xl sm:text-2xl font-light text-[#1a1a1a]",children:p})]})]}),g&&(0,yr.jsx)(fB.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mb-4 sm:mb-6 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-xl text-red-600 text-xs sm:text-sm text-center",children:g}),(0,yr.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[(0,yr.jsx)(fB.button,{onClick:()=>N(3),whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full sm:flex-1 py-4 sm:py-5 border-2 border-[#1a1a1a]/20 text-[#1a1a1a] rounded-xl font-medium hover:border-[#1a1a1a]/40 transition-colors order-2 sm:order-1",children:"Back"}),(0,yr.jsx)(fB.button,{onClick:async()=>{if(!m||!p)return;if(!E||!E.trim())return void x("Please enter your name");if(!O||!O.trim())return void x("Please enter your email address");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(O.trim()))try{a(!0),x(null);const t=await xr.post("/api/public/booking/book/".concat(e),{date:m.toISOString().split("T")[0],time:p,name:E,email:O});t.data.success?b(!0):x(t.data.message||"Failed to book appointment")}catch(BB){var t,n;x((null===(t=BB.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Failed to book. Please try again.")}finally{a(!1)}else x("Please enter a valid email address")},disabled:r,whileHover:r?{}:{scale:1.02,y:-2},whileTap:r?{}:{scale:.98},className:"w-full sm:flex-1 py-4 sm:py-5 bg-[#1a1a1a] text-white rounded-xl font-medium shadow-xl shadow-black/20 hover:shadow-2xl hover:shadow-black/30 transition-all disabled:opacity-50 order-1 sm:order-2",children:r?(0,yr.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,yr.jsx)(fB.span,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full"}),"Booking..."]}):"Confirm Booking"})]})]})},"step4")]})]})]})},CB=()=>{const{user:e}=Nr(),[t,n]=(J(),(0,s.useState)([])),[r,a]=(0,s.useState)([]),[o,i]=(0,s.useState)(""),[l,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(0),[m,h]=(0,s.useState)({current:0,total:0,currentFileName:""}),[p,f]=(0,s.useState)(!1),[g,x]=(0,s.useState)(null),[y,b]=(0,s.useState)(!1),[v,w]=(0,s.useState)([]),[j,N]=(0,s.useState)([]),[k,S]=(0,s.useState)([]),[C,_]=(0,s.useState)(!1),[E,P]=(0,s.useState)(!0),[O,A]=(0,s.useState)(""),[T,D]=(0,s.useState)(!1),M=(0,s.useRef)(null),[I,L]=(0,s.useState)(!0),[R,F]=(0,s.useState)(null),[B,U]=(0,s.useState)(!1),z=(0,s.useRef)(null),[V,W]=(0,s.useState)({start:0,end:20}),[q,H]=(0,s.useState)(6),Y=(0,s.useRef)(null),G=(0,s.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;z.current&&z.current.abort(),z.current=new AbortController;try{e?(P(!0),n([]),F(null),L(!0)):U(!0),console.log("\ud83d\udcf8 Fetching photographer photos...",{cursor:t,limit:30});const r=await xr.get("/api/photos",{params:{limit:30,cursor:t||void 0,fields:"minimal"},signal:z.current.signal});if(console.log("\ud83d\udcf8 Photos response:",r.data),r.data.success){const t=r.data.photos||[];if(e){n(t);const e=[...new Set(t.map(e=>e.folder_path).filter(Boolean))];a(e)}else n(e=>{const n=new Set(e.map(e=>e.id)),r=t.filter(e=>!n.has(e.id)),s=[...e,...r],o=[...new Set(s.map(e=>e.folder_path).filter(Boolean))];return a(o),s});L(r.data.hasMore||!1),F(r.data.nextCursor||null)}}catch(r){if("CanceledError"===r.name||"canceled"===r.message)return void console.log("\ud83d\udcf8 Photo fetch cancelled");console.error("Error fetching photos:",r)}finally{P(!1),U(!1)}},[30]),X=(0,s.useCallback)(()=>{!B&&I&&R&&G(!1,R)},[B,I,R,G]);(0,s.useEffect)(()=>(G(!0),()=>{z.current&&z.current.abort()}),[]);const $=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!$.current||!I||B)return;const e=new IntersectionObserver(e=>{e[0].isIntersecting&&I&&!B&&X()},{threshold:.1});return e.observe($.current),()=>{$.current&&e.unobserve($.current)}},[I,B,X]),(0,s.useEffect)(()=>{const e=()=>{const e=window.innerWidth;return e>=1280?6:e>=1024?5:e>=768?4:e>=640?3:2};H(e());const t=()=>{H(e())};return window.addEventListener("resize",t,{passive:!0}),()=>window.removeEventListener("resize",t)},[]);const K=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!e||0===e.length)return;const n=Array.from(e),r=n.length;c(!0),u(0),h({current:0,total:r,currentFileName:""});let a=0,s=0;for(let l=0;l<n.length;l++){const e=n[l];h({current:l+1,total:r,currentFileName:e.name.length>25?e.name.substring(0,22)+"...":e.name});const c=new FormData;c.append("photo",e),t?c.append("folderPath",t):o&&c.append("folderPath",o);try{await xr.post("/api/photos/upload",c),a++}catch(i){console.error("Upload error:",i),s++}u(Math.round((l+1)/r*100))}c(!1),u(0),h({current:0,total:0,currentFileName:""}),G(!0),s>0?alert("Uploaded ".concat(a," of ").concat(r," photos. ").concat(s," failed.")):a>0&&alert("Successfully uploaded ".concat(a," photo").concat(a>1?"s":"","!"))},Q=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?f(!0):"dragleave"===e.type&&f(!1)},Z=(0,s.useCallback)(async()=>{_(!0);try{console.log("\ud83d\udccb Fetching leads...");const e=await xr.get("/api/leads",{params:{limit:100}});console.log("\ud83d\udccb Leads response:",e.data);const t=e.data.leads||e.data||[];if(console.log("\ud83d\udccb Total leads:",t.length),0===t.length)return console.log("\u26a0\ufe0f No leads returned from API"),N([]),void w([]);const n=t.sort((e,t)=>new Date(t.updated_at||t.created_at)-new Date(e.updated_at||e.created_at));console.log("\ud83d\udccb Available leads:",n.length),N(n),w([])}catch(t){var e;console.error("\u274c Error fetching leads:",(null===(e=t.response)||void 0===e?void 0:e.data)||t.message)}finally{_(!1)}},[]),ee=(0,s.useMemo)(()=>{const e=o?t.filter(e=>e.folder_path===o):t,n=new Set;return e.filter(e=>!n.has(e.id)&&(n.add(e.id),!0))},[t,o]);(0,s.useEffect)(()=>{W({start:0,end:Math.min(30,ee.length)})},[o,ee.length]),(0,s.useEffect)(()=>{if(0===ee.length)return;const e=()=>{const e=window.scrollY||document.documentElement.scrollTop,t=window.innerHeight,n=Math.floor(e/200),r=Math.max(0,(n-5)*q),a=Math.ceil(t/200),s=Math.min(ee.length,r+Math.max(20,(a+10)*q));W({start:r,end:s})};let t;e();const n=()=>{t&&clearTimeout(t),t=setTimeout(e,50)};return window.addEventListener("scroll",n,{passive:!0}),window.addEventListener("resize",n,{passive:!0}),()=>{window.removeEventListener("scroll",n),window.removeEventListener("resize",n),t&&clearTimeout(t)}},[ee.length,q,5,20]);const te=(0,s.useCallback)(e=>{if(e){const e=ee.map(e=>e.id);S(e)}else S([])},[ee]),ne=(0,s.useMemo)(()=>ee.length>0&&ee.every(e=>k.includes(e.id)),[ee,k]),re=(0,s.useMemo)(()=>ee.some(e=>k.includes(e.id)),[ee,k]);return(0,s.useEffect)(()=>{M.current&&(M.current.indeterminate=re&&!ne)},[re,ne]),(0,yr.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,yr.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,yr.jsxs)("div",{className:"mb-6",children:[(0,yr.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Photographer Dashboard"}),(0,yr.jsx)("p",{className:"text-gray-600 mt-2",children:"Upload and manage your photos"})]}),(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yr.jsx)("h2",{className:"text-lg font-semibold",children:"Folders"}),(0,yr.jsxs)("button",{onClick:()=>{const e=prompt("Enter folder name:");if(e&&e.trim()){const t=e.trim();r.includes(t)?alert("Folder already exists"):(a([...r,t]),i(t))}},className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,yr.jsx)(Ts,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"New Folder"})]})]}),(0,yr.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,yr.jsxs)("button",{onClick:()=>i(""),className:"px-4 py-2 rounded-lg transition-colors ".concat(""===o?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:["All Photos (",t.length,")"]}),r.map(e=>{const n=t.filter(t=>t.folder_path===e).length;return(0,yr.jsxs)("button",{onClick:()=>i(e),className:"px-4 py-2 rounded-lg transition-colors ".concat(o===e?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:[e," (",n,")"]},e)})]})]}),(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,yr.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Upload Photos"}),o&&(0,yr.jsxs)("p",{className:"text-sm text-blue-600 mb-2",children:["Photos will be uploaded to: ",(0,yr.jsx)("strong",{children:o})]}),(0,yr.jsx)("div",{onDragEnter:Q,onDragLeave:Q,onDragOver:Q,onDrop:e=>{e.preventDefault(),e.stopPropagation(),f(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0&&K(e.dataTransfer.files)},className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors ".concat(p?"border-blue-500 bg-blue-50":l?"border-blue-400 bg-blue-50":"border-gray-300 bg-gray-50 hover:border-blue-400"),children:l?(0,yr.jsxs)("div",{className:"space-y-4 py-4",children:[(0,yr.jsxs)("div",{className:"relative mx-auto w-16 h-16",children:[(0,yr.jsx)(Is,{className:"h-16 w-16 text-blue-600"}),(0,yr.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,yr.jsx)("div",{className:"w-20 h-20 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin"})})]}),(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsxs)("p",{className:"text-xl font-semibold text-blue-700",children:["Uploading ",m.current," of ",m.total]}),m.currentFileName&&(0,yr.jsx)("p",{className:"text-sm text-gray-500 mt-1 font-mono",children:m.currentFileName})]}),(0,yr.jsxs)("div",{className:"w-full max-w-md mx-auto",children:[(0,yr.jsxs)("div",{className:"flex justify-between text-sm text-gray-500 mb-2",children:[(0,yr.jsxs)("span",{children:[d,"% complete"]}),(0,yr.jsxs)("span",{children:[m.total-m.current," remaining"]})]}),(0,yr.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-4 overflow-hidden",children:(0,yr.jsx)("div",{className:"h-full rounded-full transition-all duration-300 ease-out relative overflow-hidden",style:{width:"".concat(d,"%"),background:"linear-gradient(90deg, #2563EB, #7C3AED)"},children:(0,yr.jsx)("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:"linear-gradient(45deg, rgba(255,255,255,.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,.15) 50%, rgba(255,255,255,.15) 75%, transparent 75%, transparent)",backgroundSize:"1rem 1rem",animation:"progress-stripes 1s linear infinite"}})})})]}),(0,yr.jsx)("p",{className:"text-sm text-gray-400",children:"Please don't close this page while uploading"})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(yo,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),(0,yr.jsx)("p",{className:"text-gray-600 mb-2",children:"Drag and drop photos here, or click to select"}),(0,yr.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Supports: JPEG, PNG, GIF, WebP, HEIC"}),(0,yr.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:e=>K(e.target.files),className:"hidden",id:"file-upload"}),(0,yr.jsx)("label",{htmlFor:"file-upload",className:"inline-block px-6 py-3 rounded-lg cursor-pointer transition-colors bg-blue-600 text-white hover:bg-blue-700",children:"Select Photos"})]})})]}),k.length>0&&(0,yr.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 flex items-center justify-between",children:[(0,yr.jsxs)("span",{className:"text-blue-800 font-medium",children:[k.length," photo(s) selected"]}),(0,yr.jsxs)("div",{className:"flex space-x-2",children:[(0,yr.jsxs)("button",{onClick:()=>{b(!0),Z()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,yr.jsx)(hs,{className:"inline h-4 w-4 mr-2"}),"Assign to Client"]}),(0,yr.jsxs)("button",{onClick:async()=>{if(0===k.length)return;const e="Are you sure you want to delete ".concat(k.length," photo(s)? This action cannot be undone.");if(window.confirm(e))try{let e=0,t=0;const n=k.map(async n=>{try{await xr.delete("/api/photos/".concat(n)),e++}catch(r){console.error("Error deleting photo ".concat(n,":"),r),t++}});await Promise.all(n),S([]),G(!0),t>0?alert("Deleted ".concat(e," of ").concat(k.length," photos. ").concat(t," failed.")):alert("Successfully deleted ".concat(e," photo(s)!"))}catch(t){console.error("Error during bulk delete:",t),alert("Error deleting photos. Please try again.")}},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[(0,yr.jsx)(ho,{className:"inline h-4 w-4 mr-2"}),"Delete Selected"]}),(0,yr.jsx)("button",{onClick:()=>S([]),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Clear Selection"})]})]}),y&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,yr.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[85vh] flex flex-col",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center p-5 border-b bg-gradient-to-r from-blue-600 to-indigo-600 rounded-t-xl",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h3",{className:"text-xl font-bold text-white",children:"Assign to Client"}),(0,yr.jsxs)("p",{className:"text-blue-100 text-sm",children:[k.length," photo(s) selected"]})]}),(0,yr.jsx)("button",{onClick:()=>{b(!1),x(null),A("")},className:"text-white/80 hover:text-white p-1",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]}),(0,yr.jsx)("div",{className:"p-4 border-b",children:(0,yr.jsx)("input",{type:"text",placeholder:"Search by name or phone...",value:O,onChange:e=>A(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),(0,yr.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:C?(0,yr.jsxs)("div",{className:"text-center py-8",children:[(0,yr.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-3"}),(0,yr.jsx)("p",{className:"text-gray-500",children:"Loading clients..."})]}):(0,yr.jsxs)(yr.Fragment,{children:[j.length>0&&(0,yr.jsxs)("div",{className:"mb-4",children:[(0,yr.jsxs)("h4",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 flex items-center",children:[(0,yr.jsx)(hs,{className:"h-3 w-3 mr-1"}),"Select a Client (",j.length," available)"]}),(0,yr.jsx)("div",{className:"space-y-1",children:j.filter(e=>{var t,n;return!O||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(O.toLowerCase()))||(null===(n=e.phone)||void 0===n?void 0:n.includes(O))}).map(e=>(0,yr.jsx)("button",{onClick:()=>x(e),className:"w-full text-left p-3 rounded-lg transition-all ".concat((null===g||void 0===g?void 0:g.id)===e.id?"bg-blue-100 border-2 border-blue-500":"bg-gray-50 hover:bg-gray-100 border-2 border-transparent"),children:(0,yr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yr.jsxs)("div",{className:"flex-1",children:[(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("span",{className:"font-medium text-gray-900",children:e.name||"Unnamed"}),(0,yr.jsx)("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full font-medium ".concat("Attended"===e.status?"bg-green-100 text-green-700":"Sale"===e.status?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"),children:e.status})]}),e.phone&&(0,yr.jsx)("span",{className:"text-sm text-gray-500",children:e.phone})]}),(null===g||void 0===g?void 0:g.id)===e.id&&(0,yr.jsx)(gs,{className:"h-5 w-5 text-blue-600"})]})},e.id))})]}),0===j.length&&(0,yr.jsxs)("div",{className:"text-center py-8",children:[(0,yr.jsx)(Is,{className:"h-12 w-12 mx-auto text-gray-300 mb-3"}),(0,yr.jsx)("p",{className:"text-gray-500 font-medium",children:"No clients found"}),(0,yr.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Only Booked, Attended, or Sale clients are available"})]})]})}),(0,yr.jsxs)("div",{className:"p-4 border-t bg-gray-50 rounded-b-xl",children:[g&&(0,yr.jsx)("div",{className:"mb-3 p-3 bg-blue-50 rounded-lg border border-blue-200",children:(0,yr.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,yr.jsx)("strong",{children:"Assigning to:"})," ",g.name]})}),(0,yr.jsxs)("div",{className:"flex space-x-3",children:[(0,yr.jsx)("button",{onClick:()=>{b(!1),x(null),A("")},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),(0,yr.jsx)("button",{onClick:async()=>{if(0!==k.length&&g){D(!0);try{let t=0;for(const n of k)try{await xr.put("/api/photos/".concat(n),{leadId:g.id}),t++}catch(e){console.error("Error assigning photo ".concat(n,":"),e)}t>0?(S([]),x(null),b(!1),A(""),G()):alert("Failed to assign photos. Please try again.")}catch(e){console.error("Error assigning photos:",e),alert("Error assigning photos. Please try again.")}finally{D(!1)}}else alert("Please select photos and a lead")},disabled:!g||T,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center",children:T?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Assigning..."]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(gs,{className:"h-4 w-4 mr-2"}),"Assign Photos"]})})]})]})]})}),(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yr.jsxs)("h2",{className:"text-lg font-semibold",children:[o?'Photos in "'.concat(o,'"'):"My Uploaded Photos"," (",ee.length,")"]}),!E&&ee.length>0&&(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("input",{type:"checkbox",ref:M,checked:ne,onChange:e=>te(e.target.checked),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer",title:ne?"Deselect all":re?"All selected (some)":"Select all"}),(0,yr.jsx)("label",{className:"text-sm text-gray-700 cursor-pointer select-none",onClick:()=>te(!ne),children:ne?"Deselect All":"Select All"})]})]}),E?(0,yr.jsxs)("div",{className:"text-center py-12",children:[(0,yr.jsx)("div",{className:"animate-spin h-12 w-12 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),(0,yr.jsx)("p",{className:"text-gray-500",children:"Loading your photos..."})]}):0===ee.length?(0,yr.jsxs)("div",{className:"text-center py-12",children:[(0,yr.jsx)(Is,{className:"h-16 w-16 mx-auto text-gray-300 mb-4"}),(0,yr.jsx)("p",{className:"text-gray-500",children:"No photos yet. Upload some photos to get started!"})]}):(0,yr.jsxs)("div",{className:"relative",ref:Y,children:[(0,yr.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",style:{minHeight:"400px"},children:[V.start>0&&(0,yr.jsx)("div",{style:{gridColumn:"1 / -1",height:"".concat(200*Math.ceil(V.start/q),"px")}}),ee.slice(V.start,V.end).map((e,t)=>{var n;const r=V.start+t,a=e.cloudinary_secure_url||e.cloudinary_url,s=k.includes(e.id);return(0,yr.jsxs)("div",{className:"relative group cursor-pointer border-2 rounded-lg overflow-hidden transition-all aspect-square bg-gray-100 ".concat(s?"border-blue-600 ring-2 ring-blue-300":"border-gray-200 hover:border-blue-400"),onClick:()=>{S(t=>t.includes(e.id)?t.filter(t=>t!==e.id):[...t,e.id])},children:[(0,yr.jsx)(kc,{src:a,alt:e.description||"Photo",size:"thumb",className:"w-full h-full object-cover",useBlur:!0,threshold:100,onError:e=>{e&&e.target&&e.target.style&&(e.target.style.display="none")}}),(0,yr.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-opacity flex items-center justify-center pointer-events-none",children:s&&(0,yr.jsx)("div",{className:"bg-blue-600 rounded-full p-2",children:(0,yr.jsx)(gs,{className:"h-6 w-6 text-white"})})}),(0,yr.jsx)("button",{onClick:t=>{t.stopPropagation(),(async e=>{if(window.confirm("Are you sure you want to delete this photo?"))try{await xr.delete("/api/photos/".concat(e)),G(!0),alert("Photo deleted successfully")}catch(t){console.error("Error deleting photo:",t),alert("Error deleting photo. Please try again.")}})(e.id)},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1.5 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600 z-10",title:"Delete photo",children:(0,yr.jsx)(ho,{className:"h-4 w-4"})}),e.lead_id&&(0,yr.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-blue-600 text-white text-xs p-1.5 text-center font-medium truncate z-10",children:(null===(n=e.leads)||void 0===n?void 0:n.name)||"Assigned"})]},"".concat(e.id,"-").concat(r))}),V.end<ee.length&&(0,yr.jsx)("div",{style:{gridColumn:"1 / -1",height:"".concat(200*Math.ceil((ee.length-V.end)/q),"px")}})]}),I&&(0,yr.jsx)("div",{ref:$,style:{height:"20px"}}),B&&(0,yr.jsxs)("div",{className:"text-center py-4",children:[(0,yr.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-2"}),(0,yr.jsx)("p",{className:"text-gray-500 text-sm",children:"Loading more photos..."})]}),!I&&ee.length>0&&(0,yr.jsx)("div",{className:"text-center py-4",children:(0,yr.jsxs)("p",{className:"text-gray-400 text-sm",children:["All photos loaded (",ee.length," total)"]})})]})]})]})})},_B=e=>{let{onSignatureChange:t,signature:n,height:r=100,small:a=!1,parentScale:o=1}=e;const i=(0,s.useRef)(null),l=(0,s.useRef)(null),[c,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!!n),[h,p]=(0,s.useState)(null),[f,g]=(0,s.useState)(350),x=(0,s.useRef)(!1);(0,s.useEffect)(()=>{const e=()=>{if(l.current){const e=l.current.offsetWidth-10;g(Math.max(e,100))}};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[a]),(0,s.useEffect)(()=>{const e=i.current;if(!e)return;const t=e.getContext("2d"),a=window.devicePixelRatio||1;if(e.width=f*a,e.height=r*a,e.style.width="".concat(f,"px"),e.style.height="".concat(r,"px"),t.scale(a,a),t.fillStyle="#ffffff",t.fillRect(0,0,f,r),t.strokeStyle="#1a1a2e",t.lineWidth=2,t.lineCap="round",t.lineJoin="round",p(t),n){const e=new Image;e.onload=()=>{t.drawImage(e,0,0,f,r),m(!0),x.current=!0},e.src=n}},[f,r]);const y=(0,s.useCallback)(e=>{const t=i.current.getBoundingClientRect(),n=o||1;return e.touches?{x:(e.touches[0].clientX-t.left)/n,y:(e.touches[0].clientY-t.top)/n}:{x:(e.clientX-t.left)/n,y:(e.clientY-t.top)/n}},[o]),b=(0,s.useCallback)(e=>{if(!h)return;e.preventDefault();const t=y(e);h.beginPath(),h.moveTo(t.x,t.y),d(!0)},[h,y]),v=(0,s.useCallback)(e=>{if(!c||!h)return;e.preventDefault();const t=y(e);h.lineTo(t.x,t.y),h.stroke(),x.current=!0,m(!0)},[c,h,y]),w=(0,s.useCallback)(()=>{if(!h)return;const e=c;h.closePath(),d(!1),e&&x.current&&i.current&&t(i.current.toDataURL("image/png"))},[h,c,t]),j=(0,s.useCallback)(()=>{c&&w()},[c,w]),N=(0,s.useCallback)(()=>{h&&(h.fillStyle="#ffffff",h.fillRect(0,0,f,r),m(!1),x.current=!1,t(null))},[h,f,r,t]);return(0,s.useEffect)(()=>{const e=i.current;if(e)return e.addEventListener("mousedown",b),e.addEventListener("mousemove",v),e.addEventListener("mouseup",w),e.addEventListener("mouseleave",j),e.addEventListener("touchstart",b,{passive:!1}),e.addEventListener("touchmove",v,{passive:!1}),e.addEventListener("touchend",w),()=>{e.removeEventListener("mousedown",b),e.removeEventListener("mousemove",v),e.removeEventListener("mouseup",w),e.removeEventListener("mouseleave",j),e.removeEventListener("touchstart",b),e.removeEventListener("touchmove",v),e.removeEventListener("touchend",w)}},[b,v,w,j]),(0,yr.jsxs)("div",{className:"relative w-full",ref:l,children:[(0,yr.jsx)("canvas",{ref:i,className:"border border-gray-300 cursor-crosshair touch-none bg-white block w-full",style:{height:"".concat(r,"px")}}),!u&&!a&&(0,yr.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,yr.jsx)("span",{className:"text-gray-300 italic text-sm",children:"Sign here"})}),u&&(0,yr.jsx)("button",{type:"button",onClick:N,className:"absolute top-1 right-1 p-1.5 bg-gray-100 rounded hover:bg-gray-200",children:(0,yr.jsx)(Qc,{className:"w-4 h-4 text-gray-500"})})]})},EB=()=>{const{token:e}=Q(),[t,n]=(0,s.useState)(!0),[r,a]=(0,s.useState)(null),[o,i]=(0,s.useState)(null),[l,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(""),[m,h]=(0,s.useState)(!1),[p,f]=(0,s.useState)(!1),[g,x]=(0,s.useState)(null),[y,b]=(0,s.useState)(1),[v,w]=(0,s.useState)(1),[j,N]=(0,s.useState)("auto"),[k,S]=(0,s.useState)({main:null,notAgency:null,noCancel:null,passDetails:null,happyPurchase:null}),[C,_]=(0,s.useState)({}),E=(0,s.useRef)(null),P=(0,s.useRef)(null),O=(0,s.useRef)(null);(0,s.useEffect)(()=>{e&&(async()=>{try{n(!0);const t=await fetch("/api/contracts/verify/".concat(e)),r=await t.json();if(!t.ok)throw new Error(r.message||"Invalid contract link");i(r.contract),c(r.template),u(r.html||"")}catch(BB){a(BB.message)}finally{n(!1)}})()},[e]);const A=(0,s.useCallback)(e=>{if(!d)return"";const t=(new DOMParser).parseFromString(d,"text/html"),n=t.querySelectorAll(".page"),r=t.querySelector("style"),a=r?r.outerHTML:"";return n.length>=e?a+n[e-1].outerHTML:""},[d]);(0,s.useEffect)(()=>{if(!E.current||!d)return;const e=setTimeout(()=>{const e=E.current.querySelectorAll("[data-signature]"),t={};e.forEach(e=>{const n=e.getAttribute("data-signature");n&&(e.innerHTML="",t[n]=e)}),_(t)},50);return()=>clearTimeout(e)},[d,y]),(0,s.useEffect)(()=>{const e=()=>{if(O.current){const e=O.current.offsetWidth,t=Math.min(1,e/794);w(t)}};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,s.useEffect)(()=>{const e=()=>{if(!P.current)return;const e=P.current.scrollHeight;N(Math.ceil(e*v))},t=setTimeout(e,100);return window.addEventListener("resize",e),()=>{clearTimeout(t),window.removeEventListener("resize",e)}},[v,d,y,C]);if(t)return(0,yr.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)(fc,{className:"w-12 h-12 text-gray-600 animate-spin mx-auto mb-4"}),(0,yr.jsx)("p",{className:"text-gray-600",children:"Loading contract..."})]})});if(r)return(0,yr.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md text-center",children:[(0,yr.jsx)(qc,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,yr.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Unable to Load Contract"}),(0,yr.jsx)("p",{className:"text-gray-600 mb-4",children:r}),(0,yr.jsxs)("p",{className:"text-sm text-gray-500",children:["Contact ",(0,yr.jsx)("a",{href:"mailto:sales@edgetalent.co.uk",className:"text-blue-600 hover:underline",children:"sales@edgetalent.co.uk"})]})]})});if(p)return(0,yr.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md text-center",children:[(0,yr.jsx)($c,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),(0,yr.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Contract Signed!"}),(0,yr.jsx)("p",{className:"text-gray-600 mb-6",children:"Thank you. A confirmation email has been sent."}),g&&(0,yr.jsxs)("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,yr.jsx)(Hc,{className:"w-5 h-5"}),(0,yr.jsx)("span",{children:"Download Signed Contract"})]})]})});const T=(null===o||void 0===o?void 0:o.data)||{},D=Object.values(k).filter(Boolean).length,M=1===y?["main"]:["notAgency","noCancel","passDetails","happyPurchase"];return(0,yr.jsx)("div",{className:"min-h-screen bg-gray-800 py-2 px-1 sm:py-4 sm:px-4",children:(0,yr.jsxs)("div",{className:"max-w-4xl mx-auto",ref:O,children:[(0,yr.jsxs)("div",{className:"bg-white rounded-t-lg p-3 sm:p-4 flex items-center justify-between border-b",children:[(0,yr.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,yr.jsx)("h1",{className:"text-sm sm:text-lg font-bold text-gray-900 truncate",children:"Edge Talent Contract"}),(0,yr.jsx)("p",{className:"text-xs sm:text-sm text-gray-500 truncate",children:T.customerName})]}),(0,yr.jsxs)("div",{className:"text-right ml-2 flex-shrink-0",children:[(0,yr.jsxs)("p",{className:"text-xs sm:text-sm text-gray-500",children:["Signatures: ",D,"/5"]}),(0,yr.jsx)("div",{className:"w-20 sm:w-32 h-2 bg-gray-200 rounded-full mt-1",children:(0,yr.jsx)("div",{className:"h-2 bg-green-500 rounded-full transition-all",style:{width:"".concat(D/5*100,"%")}})})]})]}),(0,yr.jsxs)("div",{className:"bg-gray-100 flex border-b",children:[(0,yr.jsx)("button",{onClick:()=>b(1),className:"flex-1 py-2 sm:py-3 text-xs sm:text-sm text-center font-medium transition-colors ".concat(1===y?"bg-white text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:bg-gray-50"),children:"Page 1: Invoice"}),(0,yr.jsx)("button",{onClick:()=>b(2),className:"flex-1 py-2 sm:py-3 text-xs sm:text-sm text-center font-medium transition-colors ".concat(2===y?"bg-white text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:bg-gray-50"),children:"Page 2: Confirm"})]}),(0,yr.jsx)("div",{className:"bg-white shadow-2xl overflow-hidden",style:{height:"auto"!==j?"".concat(j,"px"):"auto"},children:(0,yr.jsxs)("div",{ref:P,style:{transform:"scale(".concat(v,")"),transformOrigin:"top left",width:"".concat(794,"px")},children:[(0,yr.jsx)("style",{children:'\n              [data-signature] {\n                cursor: pointer;\n                position: relative;\n                transition: outline 0.2s;\n              }\n              [data-signature]:hover {\n                outline: 3px solid #22c55e;\n                outline-offset: 2px;\n                border-radius: 4px;\n              }\n              [data-editable]:hover {\n                outline: none !important;\n              }\n              .page {\n                min-height: auto !important;\n                padding: 20px !important;\n              }\n              \n              /* Mobile Responsive Styles */\n              @media (max-width: 640px) {\n                /* Page 2: Stack confirmation rows vertically for usable signature areas */\n                [data-editable^="confirmation"] {\n                  flex-direction: column !important;\n                  gap: 8px !important;\n                  margin-bottom: 20px !important;\n                }\n                /* Make signature boxes full width with larger touch targets */\n                [data-editable^="confirmation"] > [data-signature] {\n                  width: 100% !important;\n                  min-height: 120px !important;\n                  height: 120px !important;\n                  order: 2;\n                  border: 2px solid #333 !important;\n                }\n                /* Text comes first (above signature) */\n                [data-editable^="confirmation"] > div:not([data-signature]) {\n                  order: 1;\n                  padding-top: 0 !important;\n                }\n                /* Reduce font size on mobile for better fit */\n                [data-editable^="confirmation"] p {\n                  font-size: 12px !important;\n                  line-height: 1.4 !important;\n                }\n                /* Page 2 header smaller on mobile */\n                .page > div:first-child p {\n                  font-size: 12px !important;\n                  margin-bottom: 5px !important;\n                }\n                /* Reduce padding on page 2 */\n                .page {\n                  padding: 15px !important;\n                }\n                /* Gap between confirmation boxes */\n                .page > div {\n                  gap: 15px !important;\n                }\n                /* Signature canvas fills container */\n                [data-signature] canvas {\n                  width: 100% !important;\n                  height: 100% !important;\n                }\n              }\n              \n              /* Desktop styles - larger signature boxes */\n              @media (min-width: 641px) {\n                [data-editable^="confirmation"] {\n                  flex-direction: row !important;\n                  gap: 25px !important;\n                }\n                [data-editable^="confirmation"] > [data-signature] {\n                  width: 180px !important;\n                  min-height: 90px !important;\n                  order: 0;\n                }\n                [data-editable^="confirmation"] > div:not([data-signature]) {\n                  order: 0;\n                  padding-top: 10px !important;\n                }\n              }\n            '}),(0,yr.jsx)("div",{ref:E,dangerouslySetInnerHTML:{__html:A(y)}})]})}),M.map(e=>{const t=C[e];if(!t)return null;const n="main"!==e,r=n?window.innerWidth<=640?120:90:80;return ye.createPortal((0,yr.jsxs)("div",{style:{position:"relative",height:"100%"},children:[!k[e]&&n&&(0,yr.jsx)("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",zIndex:1},children:(0,yr.jsx)("span",{style:{color:"#ccc",fontSize:window.innerWidth<=640?"16px":"14px",fontStyle:"italic"},children:"Sign Here"})}),(0,yr.jsx)(_B,{onSignatureChange:t=>S(n=>Ye(Ye({},n),{},{[e]:t})),signature:k[e],height:r,small:n,parentScale:v})]}),t)}),(0,yr.jsxs)("div",{className:"bg-white rounded-b-lg p-3 sm:p-4 border-t flex flex-col sm:flex-row items-center justify-between gap-2",children:[(0,yr.jsx)("p",{className:"text-xs sm:text-sm text-gray-500",children:D<5?"".concat(5-D," signature(s) remaining"):"All signatures complete!"}),(0,yr.jsx)("button",{onClick:async()=>{const t=["main","notAgency","noCancel","passDetails","happyPurchase"].filter(e=>!k[e]);if(t.length>0)alert("Please complete all ".concat(t.length," remaining signature(s) before submitting."));else try{h(!0);const t=await fetch("/api/contracts/sign/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({signatures:k})}),n=await t.json();if(!t.ok)throw new Error(n.message||"Failed to submit signature");f(!0),x(n.pdfUrl)}catch(BB){alert(BB.message)}finally{h(!1)}},disabled:m||D<5,className:"w-full sm:w-auto px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:m?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(fc,{className:"w-5 h-5 animate-spin"}),(0,yr.jsx)("span",{children:"Submitting..."})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(mc,{className:"w-5 h-5"}),(0,yr.jsx)("span",{children:"Submit Contract"})]})})]}),(0,yr.jsxs)("div",{className:"text-center text-xs text-gray-400 mt-4 px-2",children:[(0,yr.jsx)("p",{children:(null===l||void 0===l?void 0:l.footer_line1)||""}),(0,yr.jsx)("p",{children:(null===l||void 0===l?void 0:l.footer_line2)||""})]})]})})},PB=e=>{let{value:t,onChange:n,rows:r=4,placeholder:a,showFontSize:o=!0}=e;const i=(0,s.useRef)(null),[l,c]=(0,s.useState)("normal"),d=(e,r)=>{const a=i.current;if(!a)return;const s=a.selectionStart,o=a.selectionEnd,l=t.substring(s,o),c=t.substring(0,s),d=t.substring(o);n(c+e+l+r+d),setTimeout(()=>{a.focus();const t=s+e.length+l.length+r.length;a.setSelectionRange(t,t)},0)},u=e=>{d("<".concat(e,">"),"</".concat(e,">"))};return(0,yr.jsxs)("div",{className:"border border-gray-300 rounded-lg overflow-hidden focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-transparent",children:[(0,yr.jsxs)("div",{className:"bg-gray-50 border-b border-gray-200 px-2 py-1.5 flex items-center gap-1 flex-wrap",children:[o&&(0,yr.jsxs)("div",{className:"relative",children:[(0,yr.jsxs)("select",{value:l,onChange:e=>(e=>{c(e);const t=i.current;if(!t)return;t.selectionStart!==t.selectionEnd&&d('<span style="font-size: '.concat({small:"10px",normal:"14px",large:"18px",xlarge:"24px"}[e],'">'),"</span>")})(e.target.value),className:"appearance-none bg-white border border-gray-300 rounded px-2 py-1 text-xs pr-6 cursor-pointer hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-blue-500",title:"Font Size",children:[(0,yr.jsx)("option",{value:"small",children:"Small"}),(0,yr.jsx)("option",{value:"normal",children:"Normal"}),(0,yr.jsx)("option",{value:"large",children:"Large"}),(0,yr.jsx)("option",{value:"xlarge",children:"X-Large"})]}),(0,yr.jsx)(fo,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none",size:12})]}),(0,yr.jsx)("div",{className:"w-px h-5 bg-gray-300 mx-1"}),(0,yr.jsx)("button",{type:"button",onClick:()=>u("strong"),className:"p-1.5 rounded hover:bg-gray-200 transition-colors text-gray-700",title:"Bold (wraps in <strong>)",children:(0,yr.jsx)(ms,{size:14})}),(0,yr.jsx)("button",{type:"button",onClick:()=>u("em"),className:"p-1.5 rounded hover:bg-gray-200 transition-colors text-gray-700",title:"Italic (wraps in <em>)",children:(0,yr.jsx)(Rs,{size:14})}),(0,yr.jsx)("button",{type:"button",onClick:()=>u("u"),className:"p-1.5 rounded hover:bg-gray-200 transition-colors text-gray-700",title:"Underline (wraps in <u>)",children:(0,yr.jsx)(go,{size:14})}),(0,yr.jsx)("div",{className:"w-px h-5 bg-gray-300 mx-1"}),(0,yr.jsx)("button",{type:"button",onClick:()=>d("<br/>",""),className:"px-2 py-1 rounded hover:bg-gray-200 transition-colors text-gray-600 text-xs font-medium",title:"Insert Line Break",children:"\u21b5 Break"})]}),(0,yr.jsx)("textarea",{ref:i,value:t||"",onChange:e=>n(e.target.value),rows:r,placeholder:a,className:"w-full px-3 py-2 text-sm focus:outline-none resize-none",style:{minHeight:24*r}}),(0,yr.jsxs)("div",{className:"bg-gray-50 border-t border-gray-200 px-3 py-1.5 text-xs text-gray-500",children:["Select text and click a format button. Use ",(0,yr.jsx)("code",{className:"bg-gray-200 px-1 rounded",children:"<strong>"})," for bold."]})]})},OB=()=>{const{user:e}=Nr(),[t,n]=(0,s.useState)(!0),[r,a]=(0,s.useState)(!1),[o,i]=(0,s.useState)(!1),[l,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(1),[p,f]=(0,s.useState)(100),[g,x]=(0,s.useState)(""),[y,b]=(0,s.useState)("normal"),v=(0,s.useRef)(null),w=(0,s.useRef)(null),[j,N]=(0,s.useState)({company_name:"",company_website:"",company_address:"",form_title:"",form_subtitle:"",form_contact_info:"",terms_and_conditions:"",signature_instruction:"",footer_line1:"",footer_line2:"",confirmation1_text:"",confirmation2_text:"",confirmation3_text:"",confirmation4_text:"",image_permission_text:"",image_no_permission_text:"",payment_details_html:"",finance_payment_label:"",non_finance_payment_label:"",finance_deposit_label:"",finance_amount_label:"",finance_provider_text:"",finance_info_text:"",cash_initial_text:""}),[k,S]=(0,s.useState)(null),C={header:{label:"Header & Company Info",fields:["company_name","company_website","company_address"],page:1},title:{label:"Form Title & Instructions",fields:["form_title","form_subtitle","form_contact_info"],page:1},terms:{label:"Terms and Conditions",fields:["terms_and_conditions"],page:1},signature_instruction:{label:"Signature Instruction",fields:["signature_instruction"],page:1},image_permission:{label:"Image Permission Text",fields:["image_permission_text","image_no_permission_text"],page:1},footer:{label:"Footer",fields:["footer_line1","footer_line2"],page:1},confirmation1:{label:"Confirmation 1 - Not an Agency",fields:["confirmation1_text"],page:2},confirmation2:{label:"Confirmation 2 - No Cancellation",fields:["confirmation2_text"],page:2},confirmation3:{label:"Confirmation 3 - Pass Details",fields:["confirmation3_text"],page:2},confirmation4:{label:"Confirmation 4 - Happy with Purchase",fields:["confirmation4_text"],page:2},finance:{label:"Finance Payment Section",description:"These labels appear only when Finance payment is selected",fields:["finance_payment_label","non_finance_payment_label","finance_deposit_label","finance_amount_label","finance_provider_text","finance_info_text"],page:1},payment:{label:"Payment Section",fields:["cash_initial_text"],page:1}},_={company_name:"Company Name",company_website:"Website",company_address:"Address",form_title:"Form Title",form_subtitle:"Subtitle",form_contact_info:"Contact Info",terms_and_conditions:"Terms & Conditions",signature_instruction:"Signature Instruction",footer_line1:"Footer Line 1",footer_line2:"Footer Line 2",confirmation1_text:"Confirmation Text",confirmation2_text:"Confirmation Text",confirmation3_text:"Confirmation Text",confirmation4_text:"Confirmation Text",image_permission_text:"Permission Granted",image_no_permission_text:"Permission Denied",finance_payment_label:'Finance Payment Label (e.g., "DEPOSIT TODAY")',non_finance_payment_label:'Non-Finance Payment Label (e.g., "PAYMENT TODAY")',finance_deposit_label:'Deposit Row Label (e.g., "DEPOSIT PAID")',finance_amount_label:'Finance Amount Label (e.g., "FINANCE AMOUNT")',finance_provider_text:'Finance Provider Text (e.g., "FINANCE VIA PAYL8R")',finance_info_text:'Finance Info Text (e.g., "Complete docs before receipt")',cash_initial_text:"Cash Initial Text (viewer instruction for cash payments)"},E=(0,s.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal";try{const t=localStorage.getItem("token"),n=await fetch("/api/contract-templates/preview?mode=".concat(e),{headers:{Authorization:"Bearer ".concat(t)}});if(n.ok){const e=await n.json();x(e.html),N(e.template),S(e.template)}}catch(t){console.error("Error fetching contract preview:",t)}finally{n(!1)}},[]);(0,s.useEffect)(()=>{E(y)},[]),(0,s.useEffect)(()=>{E(y)},[y]),(0,s.useEffect)(()=>{const e=w.current;if(!e)return;const t=e=>{const t=e.target.closest("[data-editable]");if(t){const e=t.getAttribute("data-editable");C[e]&&(u(e),h(C[e].page))}};return e.addEventListener("click",t),()=>e.removeEventListener("click",t)},[g]),(0,s.useEffect)(()=>{const e=e=>{if(v.current&&!v.current.contains(e.target)){e.target.closest("[data-editable]")||u(null)}};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const P=(e,t)=>{N(n=>Ye(Ye({},n),{},{[e]:t})),i(!0),c(null)},O=async()=>{try{a(!0);const e=localStorage.getItem("token"),t=await fetch("/api/contract-templates",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(j)});if(t.ok){const e=await t.json();N(e.template),S(e.template),i(!1),c({type:"success",text:"Saved successfully!"}),setTimeout(()=>c(null),3e3),await E(y)}else{const e=await t.json();c({type:"error",text:e.message||"Failed to save"})}}catch(e){c({type:"error",text:"Error saving template"})}finally{a(!1)}};if("admin"!==(null===e||void 0===e?void 0:e.role))return(0,yr.jsx)("div",{className:"p-6 bg-gray-100 min-h-screen flex items-center justify-center",children:(0,yr.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[(0,yr.jsx)("h2",{className:"text-xl font-bold text-red-600",children:"Access Denied"}),(0,yr.jsx)("p",{className:"text-gray-600 mt-2",children:"Only administrators can edit contract templates."})]})});if(t)return(0,yr.jsx)("div",{className:"p-6 bg-gray-100 min-h-screen flex items-center justify-center",children:(0,yr.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})});return(0,yr.jsxs)("div",{className:"h-[calc(100vh-80px)] bg-gray-900 flex flex-col overflow-hidden",children:[(0,yr.jsx)("style",{children:"\n    [data-editable] {\n      cursor: pointer;\n      transition: outline 0.2s, background-color 0.2s;\n      border-radius: 4px;\n    }\n    [data-editable]:hover {\n      outline: 2px solid #3b82f6;\n      outline-offset: 4px;\n      background-color: rgba(59, 130, 246, 0.05);\n    }\n    [data-editable].active {\n      outline: 2px solid #2563eb;\n      outline-offset: 4px;\n      background-color: rgba(59, 130, 246, 0.1);\n    }\n  "}),(0,yr.jsxs)("div",{className:"bg-gray-800 border-b border-gray-700 px-4 py-3 flex items-center justify-between flex-shrink-0",children:[(0,yr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,yr.jsx)("h1",{className:"text-white font-semibold text-lg",children:"Contract Editor"}),(0,yr.jsx)("div",{className:"h-6 w-px bg-gray-600"}),(0,yr.jsxs)("div",{className:"flex items-center gap-2 bg-gray-700 rounded-lg px-2 py-1",children:[(0,yr.jsx)("button",{onClick:()=>h(1),className:"px-3 py-1 rounded text-sm transition-colors ".concat(1===m?"bg-blue-500 text-white":"text-gray-300 hover:text-white"),children:"Page 1"}),(0,yr.jsx)("button",{onClick:()=>h(2),className:"px-3 py-1 rounded text-sm transition-colors ".concat(2===m?"bg-blue-500 text-white":"text-gray-300 hover:text-white"),children:"Page 2"})]}),(0,yr.jsxs)("div",{className:"flex items-center gap-1 bg-gray-700 rounded-lg px-2 py-1",children:[(0,yr.jsx)("button",{onClick:()=>f(Math.max(50,p-10)),className:"text-gray-300 hover:text-white p-1",children:(0,yr.jsx)(Co,{size:16})}),(0,yr.jsxs)("span",{className:"text-gray-300 text-sm w-12 text-center",children:[p,"%"]}),(0,yr.jsx)("button",{onClick:()=>f(Math.min(150,p+10)),className:"text-gray-300 hover:text-white p-1",children:(0,yr.jsx)(So,{size:16})})]}),(0,yr.jsx)("div",{className:"text-xs text-gray-400 ml-2",children:"Click highlighted sections to edit"}),(0,yr.jsx)("div",{className:"h-6 w-px bg-gray-600 ml-2"}),(0,yr.jsxs)("select",{value:d||"",onChange:e=>{e.target.value&&(u(e.target.value),h(C[e.target.value].page))},className:"bg-gray-700 text-gray-300 text-sm rounded px-2 py-1 border border-gray-600 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[(0,yr.jsx)("option",{value:"",children:"Jump to section..."}),(0,yr.jsx)("optgroup",{label:"Page 1",children:Object.entries(C).filter(e=>{let[t,n]=e;return 1===n.page}).map(e=>{let[t,n]=e;return(0,yr.jsx)("option",{value:t,children:n.label},t)})}),(0,yr.jsx)("optgroup",{label:"Page 2",children:Object.entries(C).filter(e=>{let[t,n]=e;return 2===n.page}).map(e=>{let[t,n]=e;return(0,yr.jsx)("option",{value:t,children:n.label},t)})})]}),(0,yr.jsx)("div",{className:"h-6 w-px bg-gray-600 ml-2"}),(0,yr.jsxs)("div",{className:"flex items-center gap-1 bg-gray-700 rounded-lg px-1 py-1",children:[(0,yr.jsx)("button",{onClick:()=>b("normal"),className:"px-3 py-1 text-xs font-medium rounded transition-all ".concat("normal"===y?"bg-green-500 text-white":"text-gray-400 hover:text-white"),children:"Normal"}),(0,yr.jsx)("button",{onClick:()=>b("finance"),className:"px-3 py-1 text-xs font-medium rounded transition-all ".concat("finance"===y?"bg-blue-500 text-white":"text-gray-400 hover:text-white"),children:"Finance"}),(0,yr.jsx)("button",{onClick:()=>b("payl8r"),className:"px-3 py-1 text-xs font-medium rounded transition-all ".concat("payl8r"===y?"bg-purple-500 text-white":"text-gray-400 hover:text-white"),children:"Payl8er"})]})]}),(0,yr.jsxs)("div",{className:"flex items-center gap-3",children:[l&&(0,yr.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1 rounded-lg text-sm ".concat("success"===l.type?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"),children:["success"===l.type?(0,yr.jsx)(gs,{size:14}):(0,yr.jsx)(ko,{size:14}),l.text]}),o&&(0,yr.jsx)("span",{className:"text-yellow-400 text-sm",children:"Unsaved changes"}),(0,yr.jsxs)("button",{onClick:async()=>{if(window.confirm("Reset to default template? This cannot be undone."))try{a(!0);const e=localStorage.getItem("token"),t=await fetch("/api/contract-templates/reset",{method:"POST",headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();N(e.template),S(e.template),i(!1),u(null),c({type:"success",text:"Reset to defaults!"}),setTimeout(()=>c(null),3e3),await E(y)}}catch(e){c({type:"error",text:"Error resetting template"})}finally{a(!1)}},disabled:r,className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg text-sm flex items-center gap-2 transition-colors",children:[(0,yr.jsx)(to,{size:14}),"Reset"]}),(0,yr.jsxs)("button",{onClick:O,disabled:r||!o,className:"px-4 py-1.5 rounded-lg text-sm flex items-center gap-2 transition-colors ".concat(o?"bg-blue-500 hover:bg-blue-600 text-white":"bg-gray-700 text-gray-500 cursor-not-allowed"),children:[(0,yr.jsx)(no,{size:14}),r?"Saving...":"Save Changes"]})]})]}),(0,yr.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,yr.jsx)("div",{className:"flex-1 overflow-auto p-8 bg-gray-900",style:{backgroundImage:"radial-gradient(circle at 1px 1px, #374151 1px, transparent 0)",backgroundSize:"20px 20px"},children:(0,yr.jsx)("div",{className:"flex items-center justify-center min-h-full",children:(0,yr.jsx)("div",{ref:w,className:"bg-white shadow-2xl transition-transform origin-top",style:{transform:"scale(".concat(p/100,")"),width:"210mm",minHeight:"297mm"},dangerouslySetInnerHTML:{__html:(e=>{if(!g)return"";const t=(new DOMParser).parseFromString(g,"text/html"),n=t.querySelectorAll(".page"),r=t.querySelector("style"),a=r?r.outerHTML:"";return n.length>=e?a+n[e-1].outerHTML:""})(m)}})})}),(0,yr.jsx)("div",{ref:v,className:"bg-white border-l border-gray-200 transition-all duration-300 flex flex-col ".concat(d?"w-96":"w-0"),style:{overflow:"hidden"},children:d&&C[d]&&(0,yr.jsxs)("div",{className:"flex flex-col h-full",children:[(0,yr.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 flex items-center justify-between bg-gray-50",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h3",{className:"font-semibold text-gray-900",children:C[d].label}),(0,yr.jsx)("p",{className:"text-xs text-gray-500",children:"Click outside to close"})]}),(0,yr.jsx)("button",{onClick:()=>u(null),className:"p-1 hover:bg-gray-200 rounded transition-colors",children:(0,yr.jsx)(ko,{size:18})})]}),(0,yr.jsx)("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:C[d].fields.map(e=>(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:_[e]}),"terms_and_conditions"===e?(0,yr.jsx)(PB,{value:j[e]||"",onChange:t=>P(e,t),rows:12,placeholder:"Enter ".concat(_[e].toLowerCase(),"..."),showFontSize:!0}):e.startsWith("confirmation")||"signature_instruction"===e?(0,yr.jsx)(PB,{value:j[e]||"",onChange:t=>P(e,t),rows:4,placeholder:"Enter ".concat(_[e].toLowerCase(),"..."),showFontSize:!0}):"image_permission_text"===e||"image_no_permission_text"===e?(0,yr.jsx)(PB,{value:j[e]||"",onChange:t=>P(e,t),rows:2,placeholder:"Enter ".concat(_[e].toLowerCase(),"..."),showFontSize:!1}):(0,yr.jsx)("input",{type:"text",value:j[e]||"",onChange:t=>P(e,t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter ".concat(_[e].toLowerCase(),"...")})]},e))}),(0,yr.jsx)("div",{className:"px-4 py-3 border-t border-gray-200 bg-gray-50",children:(0,yr.jsxs)("button",{onClick:O,disabled:r||!o,className:"w-full py-2 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors ".concat(o?"bg-blue-500 hover:bg-blue-600 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:[(0,yr.jsx)(no,{size:14}),r?"Saving...":"Save Changes"]})})]})})]}),(0,yr.jsxs)("div",{className:"bg-gray-800 border-t border-gray-700 px-4 py-2 flex items-center justify-center gap-4 flex-shrink-0",children:[(0,yr.jsx)("button",{onClick:()=>h(1),disabled:1===m,className:"p-2 rounded transition-colors ".concat(1===m?"text-gray-600":"text-gray-300 hover:text-white hover:bg-gray-700"),children:(0,yr.jsx)(ys,{size:20})}),(0,yr.jsxs)("span",{className:"text-gray-300 text-sm",children:["Page ",m," of 2"]}),(0,yr.jsx)("button",{onClick:()=>h(2),disabled:2===m,className:"p-2 rounded transition-colors ".concat(2===m?"text-gray-600":"text-gray-300 hover:text-white hover:bg-gray-700"),children:(0,yr.jsx)(bs,{size:20})})]})]})},AB=()=>{var e,t,n,r,a,o,i,l,c,d;const{user:u}=Nr(),[m,h]=(0,s.useState)([]),[p,f]=(0,s.useState)(!0),[g,x]=(0,s.useState)(""),[y,b]=(0,s.useState)(!1),[v,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)({name:"",email:"",client_id:"",client_secret:"",refresh_token:"",redirect_uri:"",display_name:"Edge Talent",is_default:!1}),[k,S]=(0,s.useState)({}),[C,_]=(0,s.useState)(!1),[E,P]=(0,s.useState)(null),[O,A]=(0,s.useState)(!1),[T,D]=(0,s.useState)(!1),[M,I]=(0,s.useState)(null),[L,R]=(0,s.useState)(!1),[F,B]=(0,s.useState)(null),[U,z]=(0,s.useState)({}),[V,W]=(0,s.useState)(!1);(0,s.useEffect)(()=>{"admin"===(null===u||void 0===u?void 0:u.role)&&q()},[u]);const q=async()=>{try{const e=await xr.get("/api/email-accounts");h(e.data)}catch(e){console.error("Error fetching email accounts:",e)}f(!1)},H=e=>{const{name:t,value:n,type:r,checked:a}=e.target;N(e=>Ye(Ye({},e),{},{[t]:"checkbox"===r?a:n})),k[t]&&S(e=>Ye(Ye({},e),{},{[t]:""}))},Y=()=>{b(!1),N({name:"",email:"",client_id:"",client_secret:"",refresh_token:"",redirect_uri:"",display_name:"Edge Talent",is_default:!1}),S({})},[G,X]=(0,s.useState)(!1),[$,K]=(0,s.useState)(null),[J,Q]=(0,s.useState)(!1),Z=m.filter(e=>e.name.toLowerCase().includes(g.toLowerCase())||e.email.toLowerCase().includes(g.toLowerCase()));return"admin"!==(null===u||void 0===u?void 0:u.role)?(0,yr.jsx)("div",{className:"text-center py-12",children:(0,yr.jsx)("p",{className:"text-gray-500",children:"Access denied. Admin privileges required."})}):p?(0,yr.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yr.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):(0,yr.jsxs)("div",{className:"space-y-6",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Email Accounts"}),(0,yr.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Manage email accounts for sending messages"})]}),(0,yr.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yr.jsxs)("button",{onClick:async()=>{Q(!0),X(!0);try{const e=await xr.get("/api/email-accounts/preview-env");K(e.data)}catch(n){var e,t;console.error("Error loading preview:",n),K({error:(null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to load preview"})}Q(!1)},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors flex items-center space-x-2",title:"Import accounts from server environment variables",children:[(0,yr.jsx)(ks,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Import from Env"})]}),(0,yr.jsxs)("button",{onClick:()=>b(!0),className:"btn-primary flex items-center space-x-2",children:[(0,yr.jsx)(eo,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Add Account"})]})]})]}),(0,yr.jsx)("div",{className:"flex flex-col sm:flex-row gap-4",children:(0,yr.jsxs)("div",{className:"relative flex-1",children:[(0,yr.jsx)(ro,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),(0,yr.jsx)("input",{type:"text",placeholder:"Search accounts...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md w-full focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:g,onChange:e=>x(e.target.value)})]})}),(0,yr.jsxs)("div",{className:"card",children:[(0,yr.jsx)("div",{className:"overflow-x-auto",children:(0,yr.jsxs)("table",{className:"min-w-full",children:[(0,yr.jsx)("thead",{children:(0,yr.jsxs)("tr",{className:"table-header",children:[(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Credentials"}),(0,yr.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,yr.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:Z.map(e=>(0,yr.jsxs)("tr",{className:"table-row",children:[(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center",children:(0,yr.jsx)(Vs,{className:"h-4 w-4 text-white"})}),(0,yr.jsxs)("div",{className:"ml-3",children:[(0,yr.jsxs)("div",{className:"text-sm font-medium text-gray-900 flex items-center",children:[e.name,e.is_default&&(0,yr.jsxs)("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800",children:[(0,yr.jsx)(lo,{className:"h-3 w-3 mr-1"}),"Default"]})]}),(0,yr.jsx)("div",{className:"text-sm text-gray-500",children:e.display_name||"Edge Talent"})]})]})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("div",{className:"text-sm text-gray-900",children:e.email})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsx)("span",{className:"status-badge ".concat(e.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.is_active?"Active":"Inactive"})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yr.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,yr.jsxs)("div",{className:"flex items-center space-x-2 flex-wrap gap-1",children:[(0,yr.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs ".concat(e.hasClientId?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:["ID ",e.hasClientId?(0,yr.jsx)(gs,{className:"ml-1 h-3 w-3"}):(0,yr.jsx)(ko,{className:"ml-1 h-3 w-3"})]}),(0,yr.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs ".concat(e.hasClientSecret?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:["Secret ",e.hasClientSecret?(0,yr.jsx)(gs,{className:"ml-1 h-3 w-3"}):(0,yr.jsx)(ko,{className:"ml-1 h-3 w-3"})]}),(0,yr.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs ".concat(e.hasRefreshToken?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:["Token ",e.hasRefreshToken?(0,yr.jsx)(gs,{className:"ml-1 h-3 w-3"}):(0,yr.jsx)(ko,{className:"ml-1 h-3 w-3"})]})]}),(0,yr.jsx)("div",{className:"flex items-center",children:U[e.id]?(0,yr.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs ".concat(U[e.id].success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:U[e.id].success?(0,yr.jsxs)(yr.Fragment,{children:["Connected ",(0,yr.jsx)(gs,{className:"ml-1 h-3 w-3"})]}):(0,yr.jsxs)(yr.Fragment,{children:[U[e.id].needsReauth?"Token Expired":"Failed",(0,yr.jsx)(ko,{className:"ml-1 h-3 w-3"})]})}):(0,yr.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-gray-100 text-gray-600",children:"Not tested"})})]})}),(0,yr.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,yr.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yr.jsx)("button",{onClick:()=>(async e=>{try{const t=await xr.get("/api/email-accounts/".concat(e,"/auth-url"));t.data.authUrl?window.location.href=t.data.authUrl:alert("Failed to get authorization URL")}catch(r){var t,n;console.error("Error starting authorization:",r),alert((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Failed to start authorization")}})(e.id),className:"".concat(e.hasClientId?"text-purple-600 hover:text-purple-900":"text-gray-300 cursor-not-allowed"),title:e.hasClientId?"Authorize with Google":"Add Client ID first",disabled:!e.hasClientId,children:(0,yr.jsx)(Fs,{className:"h-4 w-4"})}),(0,yr.jsx)("button",{onClick:()=>(async e=>{B(e);try{const t=await xr.post("/api/email-accounts/".concat(e,"/test"));t.data.success?(z(t=>Ye(Ye({},t),{},{[e]:{success:!0,testedAt:(new Date).toISOString()}})),alert("Connection successful!\nEmail: ".concat(t.data.email,"\nMessages: ").concat(t.data.messagesTotal))):(z(n=>Ye(Ye({},n),{},{[e]:{success:!1,error:t.data.error,needsReauth:t.data.needsReauth,testedAt:(new Date).toISOString()}})),alert("Connection failed: ".concat(t.data.error)))}catch(r){var t,n;console.error("Error testing email account:",r),z(t=>{var n,a;return Ye(Ye({},t),{},{[e]:{success:!1,error:(null===(n=r.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.error)||"Failed to test connection",testedAt:(new Date).toISOString()}})}),alert((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.error)||"Failed to test connection")}B(null)})(e.id),disabled:F===e.id,className:"text-green-600 hover:text-green-900 disabled:opacity-50",title:"Test Connection",children:F===e.id?(0,yr.jsx)(to,{className:"h-4 w-4 animate-spin"}):(0,yr.jsx)(to,{className:"h-4 w-4"})}),!e.is_default&&(0,yr.jsx)("button",{onClick:()=>(async e=>{try{await xr.post("/api/email-accounts/".concat(e,"/set-default")),await q(),alert("Default email account updated!")}catch(r){var t,n;console.error("Error setting default account:",r),alert((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Failed to set default account")}})(e.id),className:"text-yellow-600 hover:text-yellow-900",title:"Set as Default",children:(0,yr.jsx)(lo,{className:"h-4 w-4"})}),(0,yr.jsx)("button",{onClick:()=>{return P({id:(t=e).id,name:t.name,email:t.email,client_id:"",client_secret:"",refresh_token:"",redirect_uri:t.redirect_uri||"",display_name:t.display_name||"Edge Talent",is_active:t.is_active,is_default:t.is_default}),void _(!0);var t},className:"text-blue-600 hover:text-blue-900",title:"Edit",children:(0,yr.jsx)(Cs,{className:"h-4 w-4"})}),(0,yr.jsx)("button",{onClick:()=>{return t=e.id,I(t),void D(!0);var t},className:"".concat(e.is_default?"text-gray-300 cursor-not-allowed":"text-red-600 hover:text-red-900"),title:e.is_default?"Cannot delete default account":"Delete",disabled:e.is_default,children:(0,yr.jsx)(ho,{className:"h-4 w-4"})})]})})]},e.id))})]})}),0===Z.length&&(0,yr.jsxs)("div",{className:"text-center py-12",children:[(0,yr.jsx)(Vs,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,yr.jsx)("p",{className:"mt-2 text-gray-500",children:"No email accounts found"}),(0,yr.jsx)("p",{className:"text-sm text-gray-400",children:"Add an email account to get started"})]})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,yr.jsx)("div",{className:"card",children:(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("div",{className:"text-2xl font-semibold text-gray-900",children:m.length}),(0,yr.jsx)("div",{className:"text-sm text-gray-500",children:"Total Accounts"})]})}),(0,yr.jsx)("div",{className:"card",children:(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("div",{className:"text-2xl font-semibold text-green-600",children:m.filter(e=>e.is_active).length}),(0,yr.jsx)("div",{className:"text-sm text-gray-500",children:"Active Accounts"})]})}),(0,yr.jsx)("div",{className:"card",children:(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("div",{className:"text-2xl font-semibold text-blue-600",children:m.filter(e=>e.hasRefreshToken).length}),(0,yr.jsx)("div",{className:"text-sm text-gray-500",children:"Configured Accounts"})]})})]}),y&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yr.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add Email Account"}),(0,yr.jsx)("button",{onClick:Y,className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]}),(0,yr.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=(()=>{const e={};return j.name.trim()||(e.name="Name is required"),j.email.trim()?/\S+@\S+\.\S+/.test(j.email)||(e.email="Email is invalid"):e.email="Email is required",e})();if(Object.keys(t).length>0)S(t);else{w(!0),S({});try{const e=await xr.post("/api/email-accounts",j);h(t=>[e.data.account,...t]),N({name:"",email:"",client_id:"",client_secret:"",refresh_token:"",redirect_uri:"",display_name:"Edge Talent",is_default:!1}),b(!1),alert("Email account created successfully!")}catch(a){var n,r;console.error("Error creating email account:",a);const e=(null===(n=a.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||"Failed to create email account";S({submit:e})}w(!1)}},className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Name *"}),(0,yr.jsx)("input",{type:"text",name:"name",value:j.name,onChange:H,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ".concat(k.name?"border-red-500":"border-gray-300"),placeholder:"e.g., Hello Account, Diary Account"}),k.name&&(0,yr.jsx)("p",{className:"text-red-500 text-xs mt-1",children:k.name})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(Vs,{className:"inline h-4 w-4 mr-2"}),"Email Address *"]}),(0,yr.jsx)("input",{type:"email",name:"email",value:j.email,onChange:H,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ".concat(k.email?"border-red-500":"border-gray-300"),placeholder:"hello@edgetalent.co.uk"}),k.email&&(0,yr.jsx)("p",{className:"text-red-500 text-xs mt-1",children:k.email})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Name"}),(0,yr.jsx)("input",{type:"text",name:"display_name",value:j.display_name,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Edge Talent"})]}),(0,yr.jsx)("hr",{className:"my-4"}),(0,yr.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:"OAuth Credentials (Optional)"}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mb-4",children:"Configure these settings to enable sending emails from this account."}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yr.jsx)(Fs,{className:"inline h-4 w-4 mr-2"}),"Google Client ID"]}),(0,yr.jsx)("input",{type:"text",name:"client_id",value:j.client_id,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"xxx.apps.googleusercontent.com"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Secret"}),(0,yr.jsx)("input",{type:"password",name:"client_secret",value:j.client_secret,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter client secret"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Refresh Token"}),(0,yr.jsx)("input",{type:"password",name:"refresh_token",value:j.refresh_token,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter refresh token"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Redirect URI"}),(0,yr.jsx)("input",{type:"text",name:"redirect_uri",value:j.redirect_uri,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://your-domain/api/gmail/oauth2callback"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("input",{type:"checkbox",name:"is_default",id:"is_default",checked:j.is_default,onChange:H,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,yr.jsx)("label",{htmlFor:"is_default",className:"ml-2 block text-sm text-gray-700",children:"Set as default email account"})]}),k.submit&&(0,yr.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,yr.jsx)("p",{className:"text-red-600 text-sm",children:k.submit})}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,yr.jsx)("button",{type:"button",onClick:Y,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,yr.jsx)("button",{type:"submit",disabled:v,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:v?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,yr.jsx)("span",{children:"Creating..."})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(eo,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Create Account"})]})})]})]})]})}),C&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yr.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Email Account"}),(0,yr.jsx)("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]}),(0,yr.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),A(!0);try{await xr.put("/api/email-accounts/".concat(E.id),E);await q(),_(!1),P(null),alert("Email account updated successfully!")}catch(r){var t,n;console.error("Error updating email account:",r),alert((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Failed to update email account")}A(!1)},className:"space-y-4",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Name"}),(0,yr.jsx)("input",{type:"text",name:"name",value:E.name,onChange:e=>P(t=>Ye(Ye({},t),{},{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),(0,yr.jsx)("input",{type:"email",name:"email",value:E.email,onChange:e=>P(t=>Ye(Ye({},t),{},{email:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Name"}),(0,yr.jsx)("input",{type:"text",name:"display_name",value:E.display_name,onChange:e=>P(t=>Ye(Ye({},t),{},{display_name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsx)("hr",{className:"my-4"}),(0,yr.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:"Update OAuth Credentials"}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Credentials are hidden for security. Leave blank to keep existing."}),(0,yr.jsxs)("div",{className:"flex items-center space-x-2 mb-4 text-xs",children:[(0,yr.jsx)("span",{className:"text-gray-600",children:"Currently saved:"}),(0,yr.jsxs)("span",{className:null!==(e=m.find(e=>e.id===(null===E||void 0===E?void 0:E.id)))&&void 0!==e&&e.hasClientId?"text-green-600":"text-red-600",children:["ID ",null!==(t=m.find(e=>e.id===(null===E||void 0===E?void 0:E.id)))&&void 0!==t&&t.hasClientId?"\u2713":"\u2717"]}),(0,yr.jsxs)("span",{className:null!==(n=m.find(e=>e.id===(null===E||void 0===E?void 0:E.id)))&&void 0!==n&&n.hasClientSecret?"text-green-600":"text-red-600",children:["Secret ",null!==(r=m.find(e=>e.id===(null===E||void 0===E?void 0:E.id)))&&void 0!==r&&r.hasClientSecret?"\u2713":"\u2717"]}),(0,yr.jsxs)("span",{className:null!==(a=m.find(e=>e.id===(null===E||void 0===E?void 0:E.id)))&&void 0!==a&&a.hasRefreshToken?"text-green-600":"text-red-600",children:["Token ",null!==(o=m.find(e=>e.id===(null===E||void 0===E?void 0:E.id)))&&void 0!==o&&o.hasRefreshToken?"\u2713":"\u2717"]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Google Client ID"}),(0,yr.jsx)("input",{type:"text",name:"client_id",value:E.client_id,onChange:e=>P(t=>Ye(Ye({},t),{},{client_id:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Leave blank to keep existing"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Secret"}),(0,yr.jsx)("input",{type:"password",name:"client_secret",value:E.client_secret,onChange:e=>P(t=>Ye(Ye({},t),{},{client_secret:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Leave blank to keep existing"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Refresh Token"}),(0,yr.jsx)("input",{type:"password",name:"refresh_token",value:E.refresh_token,onChange:e=>P(t=>Ye(Ye({},t),{},{refresh_token:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Leave blank to keep existing"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Redirect URI"}),(0,yr.jsx)("input",{type:"text",name:"redirect_uri",value:E.redirect_uri,onChange:e=>P(t=>Ye(Ye({},t),{},{redirect_uri:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("div",{className:"flex items-center",children:[(0,yr.jsx)("input",{type:"checkbox",name:"is_active",id:"edit_is_active",checked:E.is_active,onChange:e=>P(t=>Ye(Ye({},t),{},{is_active:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,yr.jsx)("label",{htmlFor:"edit_is_active",className:"ml-2 block text-sm text-gray-700",children:"Account is active"})]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,yr.jsx)("button",{type:"button",onClick:()=>_(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,yr.jsx)("button",{type:"submit",disabled:O,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:O?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,yr.jsx)("span",{children:"Updating..."})]}):(0,yr.jsx)("span",{children:"Update Account"})})]})]})]})}),T&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,yr.jsxs)("div",{className:"text-center",children:[(0,yr.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:(0,yr.jsx)(ho,{className:"h-6 w-6 text-red-600"})}),(0,yr.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mt-4",children:"Delete Email Account"}),(0,yr.jsx)("div",{className:"mt-2 px-7 py-3",children:(0,yr.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this email account? Users assigned to this account will be unassigned."})})]}),(0,yr.jsxs)("div",{className:"mt-5 sm:mt-6 flex justify-center space-x-4",children:[(0,yr.jsx)("button",{type:"button",onClick:()=>D(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,yr.jsx)("button",{type:"button",onClick:async()=>{if(M){R(!0);try{await xr.delete("/api/email-accounts/".concat(M)),h(e=>e.filter(e=>e.id!==M)),D(!1),I(null),alert("Email account deleted successfully!")}catch(n){var e,t;console.error("Error deleting email account:",n),alert((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to delete email account")}R(!1)}},disabled:L,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:L?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,yr.jsx)("span",{children:"Deleting..."})]}):(0,yr.jsx)("span",{children:"Delete Account"})})]})]})}),G&&(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yr.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[(0,yr.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yr.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Import Email Accounts from Environment"}),(0,yr.jsx)("button",{onClick:()=>X(!1),className:"text-gray-400 hover:text-gray-600",children:(0,yr.jsx)(ko,{className:"h-6 w-6"})})]}),J?(0,yr.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,yr.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):null!==$&&void 0!==$&&$.error?(0,yr.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,yr.jsx)("p",{className:"text-red-600",children:$.error})}):(0,yr.jsxs)("div",{className:"space-y-6",children:[(0,yr.jsx)("p",{className:"text-sm text-gray-600",children:"The following email accounts were found in your server environment variables and will be imported with their credentials:"}),(null===$||void 0===$?void 0:$.primary)&&(0,yr.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,yr.jsxs)("h3",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[(0,yr.jsx)(Vs,{className:"h-5 w-5 mr-2 text-blue-500"}),"Primary Account",$.primary.exists&&(0,yr.jsx)("span",{className:"ml-2 text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded",children:"Already exists"})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Email:"}),(0,yr.jsx)("span",{className:"ml-2 font-mono",children:$.primary.email||"Not configured"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Google Client ID:"}),(0,yr.jsxs)("span",{className:"ml-2 ".concat($.primary.hasClientId?"text-green-600":"text-red-600"),children:[$.primary.hasClientId?(0,yr.jsx)(gs,{className:"inline h-4 w-4"}):(0,yr.jsx)(ko,{className:"inline h-4 w-4"}),$.primary.hasClientId?" Configured":" Missing"]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Client Secret:"}),(0,yr.jsxs)("span",{className:"ml-2 ".concat($.primary.hasClientSecret?"text-green-600":"text-red-600"),children:[$.primary.hasClientSecret?(0,yr.jsx)(gs,{className:"inline h-4 w-4"}):(0,yr.jsx)(ko,{className:"inline h-4 w-4"}),$.primary.hasClientSecret?" Configured":" Missing"]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Refresh Token:"}),(0,yr.jsxs)("span",{className:"ml-2 ".concat($.primary.hasRefreshToken?"text-green-600":"text-red-600"),children:[$.primary.hasRefreshToken?(0,yr.jsx)(gs,{className:"inline h-4 w-4"}):(0,yr.jsx)(ko,{className:"inline h-4 w-4"}),$.primary.hasRefreshToken?" Configured":" Missing"]})]})]})]}),(null===$||void 0===$?void 0:$.secondary)&&(0,yr.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,yr.jsxs)("h3",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[(0,yr.jsx)(Vs,{className:"h-5 w-5 mr-2 text-purple-500"}),"Secondary Account",$.secondary.exists&&(0,yr.jsx)("span",{className:"ml-2 text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded",children:"Already exists"})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Email:"}),(0,yr.jsx)("span",{className:"ml-2 font-mono",children:$.secondary.email||"Not configured"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Google Client ID:"}),(0,yr.jsxs)("span",{className:"ml-2 ".concat($.secondary.hasClientId?"text-green-600":"text-red-600"),children:[$.secondary.hasClientId?(0,yr.jsx)(gs,{className:"inline h-4 w-4"}):(0,yr.jsx)(ko,{className:"inline h-4 w-4"}),$.secondary.hasClientId?" Configured":" Missing"]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Client Secret:"}),(0,yr.jsxs)("span",{className:"ml-2 ".concat($.secondary.hasClientSecret?"text-green-600":"text-red-600"),children:[$.secondary.hasClientSecret?(0,yr.jsx)(gs,{className:"inline h-4 w-4"}):(0,yr.jsx)(ko,{className:"inline h-4 w-4"}),$.secondary.hasClientSecret?" Configured":" Missing"]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-gray-500",children:"Refresh Token:"}),(0,yr.jsxs)("span",{className:"ml-2 ".concat($.secondary.hasRefreshToken?"text-green-600":"text-red-600"),children:[$.secondary.hasRefreshToken?(0,yr.jsx)(gs,{className:"inline h-4 w-4"}):(0,yr.jsx)(ko,{className:"inline h-4 w-4"}),$.secondary.hasRefreshToken?" Configured":" Missing"]})]})]})]}),!(null!==$&&void 0!==$&&null!==(i=$.primary)&&void 0!==i&&i.email)&&!(null!==$&&void 0!==$&&null!==(l=$.secondary)&&void 0!==l&&l.email)&&(0,yr.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:(0,yr.jsx)("p",{className:"text-yellow-800",children:"No email accounts found in environment variables."})}),(0,yr.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,yr.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"Need to Re-authenticate?"}),(0,yr.jsx)("p",{className:"text-sm text-blue-800 mb-2",children:"If tokens are expired, visit these URLs to get new refresh tokens:"}),(0,yr.jsxs)("div",{className:"text-sm font-mono space-y-1",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-blue-600",children:"Primary:"})," /api/gmail/auth"]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("span",{className:"text-blue-600",children:"Secondary:"})," /api/gmail/auth2"]})]})]})]}),(0,yr.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 mt-6 border-t",children:[(0,yr.jsx)("button",{type:"button",onClick:()=>X(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,yr.jsx)("button",{type:"button",onClick:async()=>{W(!0);try{var e,t,n;const r=await xr.post("/api/email-accounts/import-from-env");let a=r.data.message;(null===(e=r.data.imported)||void 0===e?void 0:e.length)>0&&(a+="\n\nImported:\n"+r.data.imported.map(e=>"- ".concat(e.email)).join("\n")),(null===(t=r.data.skipped)||void 0===t?void 0:t.length)>0&&(a+="\n\nSkipped (already exist):\n"+r.data.skipped.map(e=>"- ".concat(e.email)).join("\n")),(null===(n=r.data.errors)||void 0===n?void 0:n.length)>0&&(a+="\n\nErrors:\n"+r.data.errors.map(e=>"- ".concat(e.email,": ").concat(e.error)).join("\n")),alert(a),X(!1),await q()}catch(s){var r,a;console.error("Error importing from env:",s),alert((null===(r=s.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||"Failed to import accounts")}W(!1)},disabled:V||J||!(null!==$&&void 0!==$&&null!==(c=$.primary)&&void 0!==c&&c.email)&&!(null!==$&&void 0!==$&&null!==(d=$.secondary)&&void 0!==d&&d.email),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:V?(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,yr.jsx)("span",{children:"Importing..."})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsx)(ks,{className:"h-4 w-4"}),(0,yr.jsx)("span",{children:"Import Accounts"})]})})]})]})})]})},TB={name:"",code:"",type:"main",price:"",vatInclusive:!0,vatRate:"20",imageCount:"",totalValue:"",description:"",includes:"",displayOrder:"0",isActive:!0},DB=()=>{const{user:e}=Nr(),[t,n]=(0,s.useState)([]),[r,a]=(0,s.useState)(!0),[o,i]=(0,s.useState)(null),[l,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)("create"),[m,h]=(0,s.useState)(TB),[p,f]=(0,s.useState)(null),[g,x]=(0,s.useState)(!1),[y,b]=(0,s.useState)(null),[v,w]=(0,s.useState)(null);(0,s.useEffect)(()=>{j()},[]);const j=async()=>{try{i(null);const e=localStorage.getItem("token"),t=await xr.get("/api/packages?includeInactive=true",{headers:e?{Authorization:"Bearer ".concat(e)}:{}});n(t.data.packages||[])}catch(BB){console.error("Error fetching packages:",BB),i("Failed to load packages")}finally{a(!1)}},N=t.filter(e=>"main"===e.type),k=t.filter(e=>"individual"===e.type),S=()=>{c(!1),b(null)},C=e=>{const{name:t,value:n,type:r,checked:a}=e.target;h(e=>Ye(Ye({},e),{},{[t]:"checkbox"===r?a:n}))},[_,E]=(0,s.useState)(null),P=e=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(e);if("admin"!==(null===e||void 0===e?void 0:e.role))return(0,yr.jsx)("div",{className:"text-center py-12",children:(0,yr.jsx)("p",{className:"text-gray-500",children:"Admin access required."})});const O=e=>{var t,n,r;let{pkg:a}=e;return(0,yr.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-5 transition-all hover:shadow-md ".concat(a.isActive?"border-gray-200":"opacity-50 border-gray-200"),children:[(0,yr.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,yr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,yr.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,yr.jsx)("h3",{className:"text-base font-semibold text-gray-900 truncate",children:a.name}),!a.isActive&&(0,yr.jsx)("span",{className:"text-xs bg-red-100 text-red-700 px-2 py-0.5 rounded-full font-medium",children:"Inactive"})]}),(0,yr.jsx)("p",{className:"text-xs text-gray-500 font-mono",children:a.code})]}),(0,yr.jsxs)("div",{className:"flex items-center gap-1 ml-2",children:[(0,yr.jsx)("button",{onClick:()=>(e=>{var t,n,r,a,s;h({name:e.name||"",code:e.code||"",type:e.type||"main",price:String(null!==(t=e.price)&&void 0!==t?t:""),vatInclusive:null===(n=e.vatInclusive)||void 0===n||n,vatRate:String(null!==(r=e.vatRate)&&void 0!==r?r:"20"),imageCount:null!=e.imageCount?String(e.imageCount):"",totalValue:null!=e.totalValue?String(e.totalValue):"",description:e.description||"",includes:Array.isArray(e.includes)?e.includes.join(", "):"",displayOrder:String(null!==(a=e.displayOrder)&&void 0!==a?a:0),isActive:null===(s=e.isActive)||void 0===s||s}),f(e.id),u("edit"),b(null),c(!0)})(a),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:(0,yr.jsx)(Cs,{className:"h-4 w-4"})}),(0,yr.jsx)("button",{onClick:()=>(async e=>{w(e.id),E(null);try{const t=localStorage.getItem("token"),n=t?{Authorization:"Bearer ".concat(t)}:{};await xr.put("/api/packages/".concat(e.id),{isActive:!e.isActive},{headers:n}),await j()}catch(BB){console.error("Error toggling package:",BB),E("Failed to ".concat(e.isActive?"deactivate":"activate"," ").concat(e.name)),setTimeout(()=>E(null),4e3)}finally{w(null)}})(a),disabled:v===a.id,className:"p-1.5 rounded-lg transition-colors ".concat(a.isActive?"text-green-600 hover:text-red-600 hover:bg-red-50":"text-gray-400 hover:text-green-600 hover:bg-green-50"),title:a.isActive?"Deactivate":"Activate",children:a.isActive?(0,yr.jsx)(mo,{className:"h-4 w-4"}):(0,yr.jsx)(uo,{className:"h-4 w-4"})})]})]}),(0,yr.jsxs)("div",{className:"mb-3",children:[(0,yr.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:P(null!==(t=a.price)&&void 0!==t?t:0)}),(0,yr.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-0.5",children:[(0,yr.jsx)("span",{children:a.vatInclusive?"VAT inclusive":"Excl. VAT"}),(0,yr.jsx)("span",{className:"text-gray-300",children:"|"}),(0,yr.jsxs)("span",{children:[null!==(n=a.vatRate)&&void 0!==n?n:20,"% VAT"]})]}),a.totalValue&&(0,yr.jsxs)("div",{className:"text-sm text-gray-400 line-through mt-0.5",children:["Total value: ",P(a.totalValue)]})]}),(0,yr.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,yr.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,yr.jsx)(Is,{className:"h-3.5 w-3.5 text-gray-400"}),(0,yr.jsx)("span",{children:null!=a.imageCount?"".concat(a.imageCount," images"):"Full Shoot"})]}),a.description&&(0,yr.jsx)("p",{className:"text-gray-500 text-xs leading-relaxed",children:a.description}),a.includes&&a.includes.length>0&&(0,yr.jsx)("div",{className:"flex flex-wrap gap-1 pt-1",children:a.includes.map((e,t)=>(0,yr.jsx)("span",{className:"inline-block bg-blue-50 text-blue-700 text-xs px-2 py-0.5 rounded-full",children:e},t))}),(0,yr.jsxs)("div",{className:"text-xs text-gray-400 pt-1",children:["Order: ",null!==(r=a.displayOrder)&&void 0!==r?r:0]})]})]})};return(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-6",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[(0,yr.jsx)(Ns,{className:"h-6 w-6 text-blue-600"}),"Price List"]}),(0,yr.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Manage packages and pricing for the Start Sale flow"})]}),(0,yr.jsxs)("button",{onClick:()=>{h(TB),f(null),u("create"),b(null),c(!0)},className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium shadow-sm",children:[(0,yr.jsx)(eo,{className:"h-4 w-4"}),"Add Package"]})]}),_&&(0,yr.jsxs)("div",{className:"mb-4 bg-red-50 border border-red-200 rounded-lg p-3 text-red-700 text-sm flex items-center justify-between",children:[_,(0,yr.jsx)("button",{onClick:()=>E(null),className:"text-red-400 hover:text-red-600",children:(0,yr.jsx)(ko,{className:"h-4 w-4"})})]}),r?(0,yr.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,yr.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500"})}):o?(0,yr.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700 text-sm",children:[o,(0,yr.jsx)("button",{onClick:j,className:"ml-2 underline hover:text-red-900",children:"Retry"})]}):(0,yr.jsxs)(yr.Fragment,{children:[(0,yr.jsxs)("section",{className:"mb-8",children:[(0,yr.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,yr.jsx)(Xs,{className:"h-5 w-5 text-indigo-600"}),(0,yr.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:"Main Packages"}),(0,yr.jsx)("span",{className:"text-xs bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded-full font-medium",children:N.length})]}),0===N.length?(0,yr.jsx)("p",{className:"text-sm text-gray-400",children:"No main packages yet."}):(0,yr.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:N.map(e=>(0,yr.jsx)(O,{pkg:e},e.id))})]}),(0,yr.jsxs)("section",{children:[(0,yr.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,yr.jsx)(Is,{className:"h-5 w-5 text-green-600"}),(0,yr.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:"Individual Items"}),(0,yr.jsx)("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-medium",children:k.length})]}),0===k.length?(0,yr.jsx)("p",{className:"text-sm text-gray-400",children:"No individual items yet."}):(0,yr.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:k.map(e=>(0,yr.jsx)(O,{pkg:e},e.id))})]})]}),l&&(0,yr.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,yr.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40",onClick:S}),(0,yr.jsxs)("div",{className:"relative bg-white rounded-2xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[(0,yr.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between rounded-t-2xl z-10",children:[(0,yr.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"create"===d?"Add Package":"Edit Package"}),(0,yr.jsx)("button",{onClick:S,className:"p-1 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:(0,yr.jsx)(ko,{className:"h-5 w-5"})})]}),(0,yr.jsx)("form",{onSubmit:async e=>{if(e.preventDefault(),b(null),m.name.trim()&&m.code.trim()&&""!==m.price){x(!0);try{const e=localStorage.getItem("token"),t=e?{Authorization:"Bearer ".concat(e)}:{},n={name:m.name.trim(),code:m.code.trim(),type:m.type,price:parseFloat(m.price),vatInclusive:m.vatInclusive,vatRate:parseFloat(m.vatRate)||20,imageCount:m.imageCount?parseInt(m.imageCount):null,totalValue:m.totalValue?parseFloat(m.totalValue):null,description:m.description.trim()||null,includes:m.includes?m.includes.split(",").map(e=>e.trim()).filter(Boolean):[],displayOrder:parseInt(m.displayOrder)||0,isActive:m.isActive};"create"===d?await xr.post("/api/packages",n,{headers:t}):await xr.put("/api/packages/".concat(p),n,{headers:t}),await j(),S()}catch(BB){var t,n;console.error("Error saving package:",BB),b((null===(t=BB.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Failed to save package")}finally{x(!1)}}else b("Name, code, and price are required")},className:"p-6 space-y-4",children:(0,yr.jsxs)("fieldset",{disabled:g,children:[y&&(0,yr.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-red-700 text-sm",children:y}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),(0,yr.jsxs)("select",{name:"type",value:m.type,onChange:C,className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,yr.jsx)("option",{value:"main",children:"Main Package"}),(0,yr.jsx)("option",{value:"individual",children:"Individual Item"})]})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,yr.jsx)("input",{type:"text",name:"name",value:m.name,onChange:C,placeholder:"e.g. Gold Package",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Code *"}),(0,yr.jsx)("input",{type:"text",name:"code",value:m.code,onChange:C,placeholder:"e.g. gold",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm font-mono focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price (GBP) *"}),(0,yr.jsx)("input",{type:"number",name:"price",value:m.price,onChange:C,step:"0.01",min:"0",placeholder:"0.00",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"VAT Rate (%)"}),(0,yr.jsx)("input",{type:"number",name:"vatRate",value:m.vatRate,onChange:C,step:"0.1",min:"0",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,yr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yr.jsx)("input",{type:"checkbox",name:"vatInclusive",id:"vatInclusive",checked:m.vatInclusive,onChange:C,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,yr.jsx)("label",{htmlFor:"vatInclusive",className:"text-sm text-gray-700",children:"Price is VAT inclusive"})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Image Count",(0,yr.jsx)("span",{className:"text-xs text-gray-400 ml-1",children:"(blank = Full Shoot)"})]}),(0,yr.jsx)("input",{type:"number",name:"imageCount",value:m.imageCount,onChange:C,min:"0",placeholder:"Leave blank for Full Shoot",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Total Value",(0,yr.jsx)("span",{className:"text-xs text-gray-400 ml-1",children:"(strikethrough)"})]}),(0,yr.jsx)("input",{type:"number",name:"totalValue",value:m.totalValue,onChange:C,step:"0.01",min:"0",placeholder:"Optional",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,yr.jsx)("textarea",{name:"description",value:m.description,onChange:C,rows:2,placeholder:"Optional description",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"})]}),(0,yr.jsxs)("div",{children:[(0,yr.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Includes",(0,yr.jsx)("span",{className:"text-xs text-gray-400 ml-1",children:"(comma-separated)"})]}),(0,yr.jsx)("input",{type:"text",name:"includes",value:m.includes,onChange:C,placeholder:"e.g. Headshots, Portfolio, Retouching",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,yr.jsxs)("div",{children:[(0,yr.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Order"}),(0,yr.jsx)("input",{type:"number",name:"displayOrder",value:m.displayOrder,onChange:C,min:"0",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yr.jsx)("div",{className:"flex items-end pb-2",children:(0,yr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yr.jsx)("input",{type:"checkbox",name:"isActive",id:"isActive",checked:m.isActive,onChange:C,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,yr.jsx)("label",{htmlFor:"isActive",className:"text-sm text-gray-700",children:"Active"})]})})]}),(0,yr.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-2",children:[(0,yr.jsx)("button",{type:"button",onClick:S,className:"px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,yr.jsxs)("button",{type:"submit",disabled:g,className:"px-4 py-2 text-sm text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center gap-2",children:[g&&(0,yr.jsx)("div",{className:"animate-spin rounded-full h-3.5 w-3.5 border-b-2 border-white"}),"create"===d?"Create Package":"Save Changes"]})]})]})})]})]})]})},MB=function(e){void 0===e&&(e={});var t=e.window,n=void 0===t?document.defaultView:t,r=n.history;function a(){var e=n.location,t=e.pathname,a=e.search,s=e.hash,o=r.state||{};return[o.idx,Me({pathname:t,search:a,hash:s,state:o.usr||null,key:o.key||"default"})]}var s=null;n.addEventListener(Le,function(){if(s)u.call(s),s=null;else{var e=De.Pop,t=a(),n=t[0],r=t[1];if(u.length){if(null!=n){var o=l-n;o&&(s={action:e,location:r,retry:function(){x(-1*o)}},x(o))}}else g(e)}});var o=De.Pop,i=a(),l=i[0],c=i[1],d=Fe(),u=Fe();function m(e){return"string"===typeof e?e:Ue(e)}function h(e,t){return void 0===t&&(t=null),Me(Te({pathname:c.pathname,hash:"",search:""},"string"===typeof e?ze(e):e,{state:t,key:Be()}))}function p(e,t){return[{usr:e.state,key:e.key,idx:t},m(e)]}function f(e,t,n){return!u.length||(u.call({action:e,location:t,retry:n}),!1)}function g(e){o=e;var t=a();l=t[0],c=t[1],d.call({action:o,location:c})}function x(e){r.go(e)}null==l&&(l=0,r.replaceState(Te({},r.state,{idx:l}),""));var y={get action(){return o},get location(){return c},createHref:m,push:function e(t,a){var s=De.Push,o=h(t,a);if(f(s,o,function(){e(t,a)})){var i=p(o,l+1),c=i[0],d=i[1];try{r.pushState(c,"",d)}catch(u){n.location.assign(d)}g(s)}},replace:function e(t,n){var a=De.Replace,s=h(t,n);if(f(a,s,function(){e(t,n)})){var o=p(s,l),i=o[0],c=o[1];r.replaceState(i,"",c),g(a)}},go:x,back:function(){x(-1)},forward:function(){x(1)},listen:function(e){return d.push(e)},block:function(e){var t=u.push(e);return 1===u.length&&n.addEventListener(Ie,Re),function(){t(),u.length||n.removeEventListener(Ie,Re)}}};return y}(),IB=e=>{let{children:t}=e;const{isAuthenticated:n,loading:r}=Nr();return r?(0,yr.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,yr.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):n?t:(0,yr.jsx)(he,{to:"/login"})},LB=e=>{let{children:t}=e;const{isAuthenticated:n}=Nr();return n?(0,yr.jsx)(he,{to:"/dashboard"}):t};const RB=function(){return(0,yr.jsx)(Ja,{children:(0,yr.jsx)(jr,{children:(0,yr.jsx)(Se,{history:MB,future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:(0,yr.jsx)("div",{className:"App",children:(0,yr.jsxs)(ge,{children:[(0,yr.jsx)(pe,{path:"/login",element:(0,yr.jsx)(LB,{children:(0,yr.jsx)(Yo,{})})}),(0,yr.jsx)(pe,{path:"/book/:leadId",element:(0,yr.jsx)(SB,{})}),(0,yr.jsx)(pe,{path:"/sign-contract/:token",element:(0,yr.jsx)(EB,{})}),(0,yr.jsx)(pe,{path:"/*",element:(0,yr.jsx)(IB,{children:(0,yr.jsx)($a,{children:(0,yr.jsx)(Ho,{children:(0,yr.jsxs)(ge,{children:[(0,yr.jsx)(pe,{path:"/dashboard",element:(0,yr.jsx)(Ml,{})}),(0,yr.jsx)(pe,{path:"/leads",element:(0,yr.jsx)(Zl,{})}),(0,yr.jsx)(pe,{path:"/leads/:id",element:(0,yr.jsx)(Oc,{})}),(0,yr.jsx)(pe,{path:"/users",element:(0,yr.jsx)(Ac,{})}),(0,yr.jsx)(pe,{path:"/templates",element:(0,yr.jsx)(sA,{})}),(0,yr.jsx)(pe,{path:"/contract-editor",element:(0,yr.jsx)(OB,{})}),(0,yr.jsx)(pe,{path:"/calendar",element:(0,yr.jsx)(kd,{})}),(0,yr.jsx)(pe,{path:"/reports",element:(0,yr.jsx)(aA,{})}),(0,yr.jsx)(pe,{path:"/bookers-templates",element:(0,yr.jsx)(oA,{})}),(0,yr.jsx)(pe,{path:"/finance",element:(0,yr.jsx)(lA,{})}),(0,yr.jsx)(pe,{path:"/sales",element:(0,yr.jsx)(uA,{})}),(0,yr.jsx)(pe,{path:"/messages",element:(0,yr.jsx)(mA,{})}),(0,yr.jsx)(pe,{path:"/blocked-slots",element:(0,yr.jsx)(hA,{})}),(0,yr.jsx)(pe,{path:"/photographer",element:(0,yr.jsx)(CB,{})}),(0,yr.jsx)(pe,{path:"/email-accounts",element:(0,yr.jsx)(AB,{})}),(0,yr.jsx)(pe,{path:"/price-list",element:(0,yr.jsx)(DB,{})}),(0,yr.jsx)(pe,{path:"/",element:(0,yr.jsx)(he,{to:"/dashboard"})})]})})})})})]})})})})})};i.createRoot(document.getElementById("root")).render((0,yr.jsx)(s.StrictMode,{children:(0,yr.jsx)(RB,{})}))})()})();
//# sourceMappingURL=main.1cbec244.js.map